c119d4390990827720bd91e8523707d5
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.queryByRole = exports.queryAllByRole = exports.getByRole = exports.getAllByRole = exports.findByRole = exports.findAllByRole = void 0;
var _domAccessibilityApi = require("dom-accessibility-api");
var _ariaQuery = require("aria-query");
var _roleHelpers = require("../role-helpers");
var _queryHelpers = require("../query-helpers");
var _helpers = require("../helpers");
var _allUtils = require("./all-utils");
/* eslint-disable complexity */
const queryAllByRole = (container, role, { hidden = (0, _allUtils.getConfig)().defaultHidden, name, description, queryFallbacks = false, selected, busy, checked, pressed, current, level, expanded, value: { now: valueNow, min: valueMin, max: valueMax, text: valueText } = {} } = {}) => {
    (0, _helpers.checkContainerType)(container);
    if (selected !== undefined) {
        // guard against unknown roles
        if (_ariaQuery.roles.get(role)?.props['aria-selected'] === undefined) {
            throw new Error(`"aria-selected" is not supported on role "${role}".`);
        }
    }
    if (busy !== undefined) {
        // guard against unknown roles
        if (_ariaQuery.roles.get(role)?.props['aria-busy'] === undefined) {
            throw new Error(`"aria-busy" is not supported on role "${role}".`);
        }
    }
    if (checked !== undefined) {
        // guard against unknown roles
        if (_ariaQuery.roles.get(role)?.props['aria-checked'] === undefined) {
            throw new Error(`"aria-checked" is not supported on role "${role}".`);
        }
    }
    if (pressed !== undefined) {
        // guard against unknown roles
        if (_ariaQuery.roles.get(role)?.props['aria-pressed'] === undefined) {
            throw new Error(`"aria-pressed" is not supported on role "${role}".`);
        }
    }
    if (current !== undefined) {
        /* istanbul ignore next */
        // guard against unknown roles
        // All currently released ARIA versions support `aria-current` on all roles.
        // Leaving this for symmetry and forward compatibility
        if (_ariaQuery.roles.get(role)?.props['aria-current'] === undefined) {
            throw new Error(`"aria-current" is not supported on role "${role}".`);
        }
    }
    if (level !== undefined) {
        // guard against using `level` option with any role other than `heading`
        if (role !== 'heading') {
            throw new Error(`Role "${role}" cannot have "level" property.`);
        }
    }
    if (valueNow !== undefined) {
        // guard against unknown roles
        if (_ariaQuery.roles.get(role)?.props['aria-valuenow'] === undefined) {
            throw new Error(`"aria-valuenow" is not supported on role "${role}".`);
        }
    }
    if (valueMax !== undefined) {
        // guard against unknown roles
        if (_ariaQuery.roles.get(role)?.props['aria-valuemax'] === undefined) {
            throw new Error(`"aria-valuemax" is not supported on role "${role}".`);
        }
    }
    if (valueMin !== undefined) {
        // guard against unknown roles
        if (_ariaQuery.roles.get(role)?.props['aria-valuemin'] === undefined) {
            throw new Error(`"aria-valuemin" is not supported on role "${role}".`);
        }
    }
    if (valueText !== undefined) {
        // guard against unknown roles
        if (_ariaQuery.roles.get(role)?.props['aria-valuetext'] === undefined) {
            throw new Error(`"aria-valuetext" is not supported on role "${role}".`);
        }
    }
    if (expanded !== undefined) {
        // guard against unknown roles
        if (_ariaQuery.roles.get(role)?.props['aria-expanded'] === undefined) {
            throw new Error(`"aria-expanded" is not supported on role "${role}".`);
        }
    }
    const subtreeIsInaccessibleCache = new WeakMap();
    function cachedIsSubtreeInaccessible(element) {
        if (!subtreeIsInaccessibleCache.has(element)) {
            subtreeIsInaccessibleCache.set(element, (0, _roleHelpers.isSubtreeInaccessible)(element));
        }
        return subtreeIsInaccessibleCache.get(element);
    }
    return Array.from(container.querySelectorAll(
    // Only query elements that can be matched by the following filters
    makeRoleSelector(role))).filter(node => {
        const isRoleSpecifiedExplicitly = node.hasAttribute('role');
        if (isRoleSpecifiedExplicitly) {
            const roleValue = node.getAttribute('role');
            if (queryFallbacks) {
                return roleValue.split(' ').filter(Boolean).some(roleAttributeToken => roleAttributeToken === role);
            }
            // other wise only send the first token to match
            const [firstRoleAttributeToken] = roleValue.split(' ');
            return firstRoleAttributeToken === role;
        }
        const implicitRoles = (0, _roleHelpers.getImplicitAriaRoles)(node);
        return implicitRoles.some(implicitRole => {
            return implicitRole === role;
        });
    }).filter(element => {
        if (selected !== undefined) {
            return selected === (0, _roleHelpers.computeAriaSelected)(element);
        }
        if (busy !== undefined) {
            return busy === (0, _roleHelpers.computeAriaBusy)(element);
        }
        if (checked !== undefined) {
            return checked === (0, _roleHelpers.computeAriaChecked)(element);
        }
        if (pressed !== undefined) {
            return pressed === (0, _roleHelpers.computeAriaPressed)(element);
        }
        if (current !== undefined) {
            return current === (0, _roleHelpers.computeAriaCurrent)(element);
        }
        if (expanded !== undefined) {
            return expanded === (0, _roleHelpers.computeAriaExpanded)(element);
        }
        if (level !== undefined) {
            return level === (0, _roleHelpers.computeHeadingLevel)(element);
        }
        if (valueNow !== undefined || valueMax !== undefined || valueMin !== undefined || valueText !== undefined) {
            let valueMatches = true;
            if (valueNow !== undefined) {
                valueMatches && (valueMatches = valueNow === (0, _roleHelpers.computeAriaValueNow)(element));
            }
            if (valueMax !== undefined) {
                valueMatches && (valueMatches = valueMax === (0, _roleHelpers.computeAriaValueMax)(element));
            }
            if (valueMin !== undefined) {
                valueMatches && (valueMatches = valueMin === (0, _roleHelpers.computeAriaValueMin)(element));
            }
            if (valueText !== undefined) {
                valueMatches && (valueMatches = (0, _allUtils.matches)((0, _roleHelpers.computeAriaValueText)(element) ?? null, element, valueText, text => text));
            }
            return valueMatches;
        }
        // don't care if aria attributes are unspecified
        return true;
    }).filter(element => {
        if (name === undefined) {
            // Don't care
            return true;
        }
        return (0, _allUtils.matches)((0, _domAccessibilityApi.computeAccessibleName)(element, {
            computedStyleSupportsPseudoElements: (0, _allUtils.getConfig)().computedStyleSupportsPseudoElements
        }), element, name, text => text);
    }).filter(element => {
        if (description === undefined) {
            // Don't care
            return true;
        }
        return (0, _allUtils.matches)((0, _domAccessibilityApi.computeAccessibleDescription)(element, {
            computedStyleSupportsPseudoElements: (0, _allUtils.getConfig)().computedStyleSupportsPseudoElements
        }), element, description, text => text);
    }).filter(element => {
        return hidden === false ? (0, _roleHelpers.isInaccessible)(element, {
            isSubtreeInaccessible: cachedIsSubtreeInaccessible
        }) === false : true;
    });
};
function makeRoleSelector(role) {
    const explicitRoleSelector = `*[role~="${role}"]`;
    const roleRelations = _ariaQuery.roleElements.get(role) ?? new Set();
    const implicitRoleSelectors = new Set(Array.from(roleRelations).map(({ name }) => name));
    // Current transpilation config sometimes assumes `...` is always applied to arrays.
    // `...` is equivalent to `Array.prototype.concat` for arrays.
    // If you replace this code with `[explicitRoleSelector, ...implicitRoleSelectors]`, make sure every transpilation target retains the `...` in favor of `Array.prototype.concat`.
    return [explicitRoleSelector].concat(Array.from(implicitRoleSelectors)).join(',');
}
const getNameHint = name => {
    let nameHint = '';
    if (name === undefined) {
        nameHint = '';
    }
    else if (typeof name === 'string') {
        nameHint = ` and name "${name}"`;
    }
    else {
        nameHint = ` and name \`${name}\``;
    }
    return nameHint;
};
const getMultipleError = (c, role, { name } = {}) => {
    return `Found multiple elements with the role "${role}"${getNameHint(name)}`;
};
const getMissingError = (container, role, { hidden = (0, _allUtils.getConfig)().defaultHidden, name, description } = {}) => {
    if ((0, _allUtils.getConfig)()._disableExpensiveErrorDiagnostics) {
        return `Unable to find role="${role}"${getNameHint(name)}`;
    }
    let roles = '';
    Array.from(container.children).forEach(childElement => {
        roles += (0, _roleHelpers.prettyRoles)(childElement, {
            hidden,
            includeDescription: description !== undefined
        });
    });
    let roleMessage;
    if (roles.length === 0) {
        if (hidden === false) {
            roleMessage = 'There are no accessible roles. But there might be some inaccessible roles. ' + 'If you wish to access them, then set the `hidden` option to `true`. ' + 'Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole';
        }
        else {
            roleMessage = 'There are no available roles.';
        }
    }
    else {
        roleMessage = `
Here are the ${hidden === false ? 'accessible' : 'available'} roles:

  ${roles.replace(/\n/g, '\n  ').replace(/\n\s\s\n/g, '\n\n')}
`.trim();
    }
    let nameHint = '';
    if (name === undefined) {
        nameHint = '';
    }
    else if (typeof name === 'string') {
        nameHint = ` and name "${name}"`;
    }
    else {
        nameHint = ` and name \`${name}\``;
    }
    let descriptionHint = '';
    if (description === undefined) {
        descriptionHint = '';
    }
    else if (typeof description === 'string') {
        descriptionHint = ` and description "${description}"`;
    }
    else {
        descriptionHint = ` and description \`${description}\``;
    }
    return `
Unable to find an ${hidden === false ? 'accessible ' : ''}element with the role "${role}"${nameHint}${descriptionHint}

${roleMessage}`.trim();
};
const queryAllByRoleWithSuggestions = exports.queryAllByRole = (0, _queryHelpers.wrapAllByQueryWithSuggestion)(queryAllByRole, queryAllByRole.name, 'queryAll');
const [queryByRole, getAllByRole, getByRole, findAllByRole, findByRole] = (0, _allUtils.buildQueries)(queryAllByRole, getMultipleError, getMissingError);
exports.findByRole = findByRole;
exports.findAllByRole = findAllByRole;
exports.getByRole = getByRole;
exports.getAllByRole = getAllByRole;
exports.queryByRole = queryByRole;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXG5vZGVfbW9kdWxlc1xcQHRlc3RpbmctbGlicmFyeVxcZG9tXFxkaXN0XFxxdWVyaWVzXFxyb2xlLmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztBQUViLE1BQU0sQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLFlBQVksRUFBRTtJQUMzQyxLQUFLLEVBQUUsSUFBSTtDQUNaLENBQUMsQ0FBQztBQUNILE9BQU8sQ0FBQyxXQUFXLEdBQUcsT0FBTyxDQUFDLGNBQWMsR0FBRyxPQUFPLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQyxZQUFZLEdBQUcsT0FBTyxDQUFDLFVBQVUsR0FBRyxPQUFPLENBQUMsYUFBYSxHQUFHLEtBQUssQ0FBQyxDQUFDO0FBQzlJLElBQUksb0JBQW9CLEdBQUcsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQUM7QUFDNUQsSUFBSSxVQUFVLEdBQUcsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3ZDLElBQUksWUFBWSxHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQzlDLElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0FBQ2hELElBQUksUUFBUSxHQUFHLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUNyQyxJQUFJLFNBQVMsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDdkMsK0JBQStCO0FBRS9CLE1BQU0sY0FBYyxHQUFHLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxFQUN2QyxNQUFNLEdBQUcsQ0FBQyxDQUFDLEVBQUUsU0FBUyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUNqRCxJQUFJLEVBQ0osV0FBVyxFQUNYLGNBQWMsR0FBRyxLQUFLLEVBQ3RCLFFBQVEsRUFDUixJQUFJLEVBQ0osT0FBTyxFQUNQLE9BQU8sRUFDUCxPQUFPLEVBQ1AsS0FBSyxFQUNMLFFBQVEsRUFDUixLQUFLLEVB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RUFBRSxVQUFVLENBQUMsQ0FBQztBQUNoSyxNQUFNLENBQUMsV0FBVyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsYUFBYSxFQUFFLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxjQUFjLEVBQUUsZ0JBQWdCLEVBQUUsZUFBZSxDQUFDLENBQUM7QUFDekosT0FBTyxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7QUFDaEMsT0FBTyxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7QUFDdEMsT0FBTyxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7QUFDOUIsT0FBTyxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7QUFDcEMsT0FBTyxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXG5vZGVfbW9kdWxlc1xcQHRlc3RpbmctbGlicmFyeVxcZG9tXFxkaXN0XFxxdWVyaWVzXFxyb2xlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5xdWVyeUJ5Um9sZSA9IGV4cG9ydHMucXVlcnlBbGxCeVJvbGUgPSBleHBvcnRzLmdldEJ5Um9sZSA9IGV4cG9ydHMuZ2V0QWxsQnlSb2xlID0gZXhwb3J0cy5maW5kQnlSb2xlID0gZXhwb3J0cy5maW5kQWxsQnlSb2xlID0gdm9pZCAwO1xudmFyIF9kb21BY2Nlc3NpYmlsaXR5QXBpID0gcmVxdWlyZShcImRvbS1hY2Nlc3NpYmlsaXR5LWFwaVwiKTtcbnZhciBfYXJpYVF1ZXJ5ID0gcmVxdWlyZShcImFyaWEtcXVlcnlcIik7XG52YXIgX3JvbGVIZWxwZXJzID0gcmVxdWlyZShcIi4uL3JvbGUtaGVscGVyc1wiKTtcbnZhciBfcXVlcnlIZWxwZXJzID0gcmVxdWlyZShcIi4uL3F1ZXJ5LWhlbHBlcnNcIik7XG52YXIgX2hlbHBlcnMgPSByZXF1aXJlKFwiLi4vaGVscGVyc1wiKTtcbnZhciBfYWxsVXRpbHMgPSByZXF1aXJlKFwiLi9hbGwtdXRpbHNcIik7XG4vKiBlc2xpbnQtZGlzYWJsZSBjb21wbGV4aXR5ICovXG5cbmNvbnN0IHF1ZXJ5QWxsQnlSb2xlID0gKGNvbnRhaW5lciwgcm9sZSwge1xuICBoaWRkZW4gPSAoMCwgX2FsbFV0aWxzLmdldENvbmZpZykoKS5kZWZhdWx0SGlkZGVuLFxuICBuYW1lLFxuICBkZXNjcmlwdGlvbixcbiAgcXVlcnlGYWxsYmFja3MgPSBmYWxzZSxcbiAgc2VsZWN0ZWQsXG4gIGJ1c3ksXG4gIGNoZWNrZWQsXG4gIHByZXNzZWQsXG4gIGN1cnJlbnQsXG4gIGxldmVsLFxuICBleHBhbmRlZCxcbiAgdmFsdWU6IHtcbiAgICBub3c6IHZhbHVlTm93LFxuICAgIG1pbjogdmFsdWVNaW4sXG4gICAgbWF4OiB2YWx1ZU1heCxcbiAgICB0ZXh0OiB2YWx1ZVRleHRcbiAgfSA9IHt9XG59ID0ge30pID0+IHtcbiAgKDAsIF9oZWxwZXJzLmNoZWNrQ29udGFpbmVyVHlwZSkoY29udGFpbmVyKTtcbiAgaWYgKHNlbGVjdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBndWFyZCBhZ2FpbnN0IHVua25vd24gcm9sZXNcbiAgICBpZiAoX2FyaWFRdWVyeS5yb2xlcy5nZXQocm9sZSk/LnByb3BzWydhcmlhLXNlbGVjdGVkJ10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBcImFyaWEtc2VsZWN0ZWRcIiBpcyBub3Qgc3VwcG9ydGVkIG9uIHJvbGUgXCIke3JvbGV9XCIuYCk7XG4gICAgfVxuICB9XG4gIGlmIChidXN5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBndWFyZCBhZ2FpbnN0IHVua25vd24gcm9sZXNcbiAgICBpZiAoX2FyaWFRdWVyeS5yb2xlcy5nZXQocm9sZSk/LnByb3BzWydhcmlhLWJ1c3knXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFwiYXJpYS1idXN5XCIgaXMgbm90IHN1cHBvcnRlZCBvbiByb2xlIFwiJHtyb2xlfVwiLmApO1xuICAgIH1cbiAgfVxuICBpZiAoY2hlY2tlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gZ3VhcmQgYWdhaW5zdCB1bmtub3duIHJvbGVzXG4gICAgaWYgKF9hcmlhUXVlcnkucm9sZXMuZ2V0KHJvbGUpPy5wcm9wc1snYXJpYS1jaGVja2VkJ10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBcImFyaWEtY2hlY2tlZFwiIGlzIG5vdCBzdXBwb3J0ZWQgb24gcm9sZSBcIiR7cm9sZX1cIi5gKTtcbiAgICB9XG4gIH1cbiAgaWYgKHByZXNzZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIGd1YXJkIGFnYWluc3QgdW5rbm93biByb2xlc1xuICAgIGlmIChfYXJpYVF1ZXJ5LnJvbGVzLmdldChyb2xlKT8ucHJvcHNbJ2FyaWEtcHJlc3NlZCddID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgXCJhcmlhLXByZXNzZWRcIiBpcyBub3Qgc3VwcG9ydGVkIG9uIHJvbGUgXCIke3JvbGV9XCIuYCk7XG4gICAgfVxuICB9XG4gIGlmIChjdXJyZW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgIC8vIGd1YXJkIGFnYWluc3QgdW5rbm93biByb2xlc1xuICAgIC8vIEFsbCBjdXJyZW50bHkgcmVsZWFzZWQgQVJJQSB2ZXJzaW9ucyBzdXBwb3J0IGBhcmlhLWN1cnJlbnRgIG9uIGFsbCByb2xlcy5cbiAgICAvLyBMZWF2aW5nIHRoaXMgZm9yIHN5bW1ldHJ5IGFuZCBmb3J3YXJkIGNvbXBhdGliaWxpdHlcbiAgICBpZiAoX2FyaWFRdWVyeS5yb2xlcy5nZXQocm9sZSk/LnByb3BzWydhcmlhLWN1cnJlbnQnXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFwiYXJpYS1jdXJyZW50XCIgaXMgbm90IHN1cHBvcnRlZCBvbiByb2xlIFwiJHtyb2xlfVwiLmApO1xuICAgIH1cbiAgfVxuICBpZiAobGV2ZWwgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIGd1YXJkIGFnYWluc3QgdXNpbmcgYGxldmVsYCBvcHRpb24gd2l0aCBhbnkgcm9sZSBvdGhlciB0aGFuIGBoZWFkaW5nYFxuICAgIGlmIChyb2xlICE9PSAnaGVhZGluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgUm9sZSBcIiR7cm9sZX1cIiBjYW5ub3QgaGF2ZSBcImxldmVsXCIgcHJvcGVydHkuYCk7XG4gICAgfVxuICB9XG4gIGlmICh2YWx1ZU5vdyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gZ3VhcmQgYWdhaW5zdCB1bmtub3duIHJvbGVzXG4gICAgaWYgKF9hcmlhUXVlcnkucm9sZXMuZ2V0KHJvbGUpPy5wcm9wc1snYXJpYS12YWx1ZW5vdyddID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgXCJhcmlhLXZhbHVlbm93XCIgaXMgbm90IHN1cHBvcnRlZCBvbiByb2xlIFwiJHtyb2xlfVwiLmApO1xuICAgIH1cbiAgfVxuICBpZiAodmFsdWVNYXggIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIGd1YXJkIGFnYWluc3QgdW5rbm93biByb2xlc1xuICAgIGlmIChfYXJpYVF1ZXJ5LnJvbGVzLmdldChyb2xlKT8ucHJvcHNbJ2FyaWEtdmFsdWVtYXgnXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFwiYXJpYS12YWx1ZW1heFwiIGlzIG5vdCBzdXBwb3J0ZWQgb24gcm9sZSBcIiR7cm9sZX1cIi5gKTtcbiAgICB9XG4gIH1cbiAgaWYgKHZhbHVlTWluICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBndWFyZCBhZ2FpbnN0IHVua25vd24gcm9sZXNcbiAgICBpZiAoX2FyaWFRdWVyeS5yb2xlcy5nZXQocm9sZSk/LnByb3BzWydhcmlhLXZhbHVlbWluJ10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBcImFyaWEtdmFsdWVtaW5cIiBpcyBub3Qgc3VwcG9ydGVkIG9uIHJvbGUgXCIke3JvbGV9XCIuYCk7XG4gICAgfVxuICB9XG4gIGlmICh2YWx1ZVRleHQgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIGd1YXJkIGFnYWluc3QgdW5rbm93biByb2xlc1xuICAgIGlmIChfYXJpYVF1ZXJ5LnJvbGVzLmdldChyb2xlKT8ucHJvcHNbJ2FyaWEtdmFsdWV0ZXh0J10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBcImFyaWEtdmFsdWV0ZXh0XCIgaXMgbm90IHN1cHBvcnRlZCBvbiByb2xlIFwiJHtyb2xlfVwiLmApO1xuICAgIH1cbiAgfVxuICBpZiAoZXhwYW5kZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIGd1YXJkIGFnYWluc3QgdW5rbm93biByb2xlc1xuICAgIGlmIChfYXJpYVF1ZXJ5LnJvbGVzLmdldChyb2xlKT8ucHJvcHNbJ2FyaWEtZXhwYW5kZWQnXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFwiYXJpYS1leHBhbmRlZFwiIGlzIG5vdCBzdXBwb3J0ZWQgb24gcm9sZSBcIiR7cm9sZX1cIi5gKTtcbiAgICB9XG4gIH1cbiAgY29uc3Qgc3VidHJlZUlzSW5hY2Nlc3NpYmxlQ2FjaGUgPSBuZXcgV2Vha01hcCgpO1xuICBmdW5jdGlvbiBjYWNoZWRJc1N1YnRyZWVJbmFjY2Vzc2libGUoZWxlbWVudCkge1xuICAgIGlmICghc3VidHJlZUlzSW5hY2Nlc3NpYmxlQ2FjaGUuaGFzKGVsZW1lbnQpKSB7XG4gICAgICBzdWJ0cmVlSXNJbmFjY2Vzc2libGVDYWNoZS5zZXQoZWxlbWVudCwgKDAsIF9yb2xlSGVscGVycy5pc1N1YnRyZWVJbmFjY2Vzc2libGUpKGVsZW1lbnQpKTtcbiAgICB9XG4gICAgcmV0dXJuIHN1YnRyZWVJc0luYWNjZXNzaWJsZUNhY2hlLmdldChlbGVtZW50KTtcbiAgfVxuICByZXR1cm4gQXJyYXkuZnJvbShjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcbiAgLy8gT25seSBxdWVyeSBlbGVtZW50cyB0aGF0IGNhbiBiZSBtYXRjaGVkIGJ5IHRoZSBmb2xsb3dpbmcgZmlsdGVyc1xuICBtYWtlUm9sZVNlbGVjdG9yKHJvbGUpKSkuZmlsdGVyKG5vZGUgPT4ge1xuICAgIGNvbnN0IGlzUm9sZVNwZWNpZmllZEV4cGxpY2l0bHkgPSBub2RlLmhhc0F0dHJpYnV0ZSgncm9sZScpO1xuICAgIGlmIChpc1JvbGVTcGVjaWZpZWRFeHBsaWNpdGx5KSB7XG4gICAgICBjb25zdCByb2xlVmFsdWUgPSBub2RlLmdldEF0dHJpYnV0ZSgncm9sZScpO1xuICAgICAgaWYgKHF1ZXJ5RmFsbGJhY2tzKSB7XG4gICAgICAgIHJldHVybiByb2xlVmFsdWUuc3BsaXQoJyAnKS5maWx0ZXIoQm9vbGVhbikuc29tZShyb2xlQXR0cmlidXRlVG9rZW4gPT4gcm9sZUF0dHJpYnV0ZVRva2VuID09PSByb2xlKTtcbiAgICAgIH1cbiAgICAgIC8vIG90aGVyIHdpc2Ugb25seSBzZW5kIHRoZSBmaXJzdCB0b2tlbiB0byBtYXRjaFxuICAgICAgY29uc3QgW2ZpcnN0Um9sZUF0dHJpYnV0ZVRva2VuXSA9IHJvbGVWYWx1ZS5zcGxpdCgnICcpO1xuICAgICAgcmV0dXJuIGZpcnN0Um9sZUF0dHJpYnV0ZVRva2VuID09PSByb2xlO1xuICAgIH1cbiAgICBjb25zdCBpbXBsaWNpdFJvbGVzID0gKDAsIF9yb2xlSGVscGVycy5nZXRJbXBsaWNpdEFyaWFSb2xlcykobm9kZSk7XG4gICAgcmV0dXJuIGltcGxpY2l0Um9sZXMuc29tZShpbXBsaWNpdFJvbGUgPT4ge1xuICAgICAgcmV0dXJuIGltcGxpY2l0Um9sZSA9PT0gcm9sZTtcbiAgICB9KTtcbiAgfSkuZmlsdGVyKGVsZW1lbnQgPT4ge1xuICAgIGlmIChzZWxlY3RlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gc2VsZWN0ZWQgPT09ICgwLCBfcm9sZUhlbHBlcnMuY29tcHV0ZUFyaWFTZWxlY3RlZCkoZWxlbWVudCk7XG4gICAgfVxuICAgIGlmIChidXN5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBidXN5ID09PSAoMCwgX3JvbGVIZWxwZXJzLmNvbXB1dGVBcmlhQnVzeSkoZWxlbWVudCk7XG4gICAgfVxuICAgIGlmIChjaGVja2VkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBjaGVja2VkID09PSAoMCwgX3JvbGVIZWxwZXJzLmNvbXB1dGVBcmlhQ2hlY2tlZCkoZWxlbWVudCk7XG4gICAgfVxuICAgIGlmIChwcmVzc2VkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBwcmVzc2VkID09PSAoMCwgX3JvbGVIZWxwZXJzLmNvbXB1dGVBcmlhUHJlc3NlZCkoZWxlbWVudCk7XG4gICAgfVxuICAgIGlmIChjdXJyZW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBjdXJyZW50ID09PSAoMCwgX3JvbGVIZWxwZXJzLmNvbXB1dGVBcmlhQ3VycmVudCkoZWxlbWVudCk7XG4gICAgfVxuICAgIGlmIChleHBhbmRlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gZXhwYW5kZWQgPT09ICgwLCBfcm9sZUhlbHBlcnMuY29tcHV0ZUFyaWFFeHBhbmRlZCkoZWxlbWVudCk7XG4gICAgfVxuICAgIGlmIChsZXZlbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gbGV2ZWwgPT09ICgwLCBfcm9sZUhlbHBlcnMuY29tcHV0ZUhlYWRpbmdMZXZlbCkoZWxlbWVudCk7XG4gICAgfVxuICAgIGlmICh2YWx1ZU5vdyAhPT0gdW5kZWZpbmVkIHx8IHZhbHVlTWF4ICE9PSB1bmRlZmluZWQgfHwgdmFsdWVNaW4gIT09IHVuZGVmaW5lZCB8fCB2YWx1ZVRleHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgbGV0IHZhbHVlTWF0Y2hlcyA9IHRydWU7XG4gICAgICBpZiAodmFsdWVOb3cgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YWx1ZU1hdGNoZXMgJiY9IHZhbHVlTm93ID09PSAoMCwgX3JvbGVIZWxwZXJzLmNvbXB1dGVBcmlhVmFsdWVOb3cpKGVsZW1lbnQpO1xuICAgICAgfVxuICAgICAgaWYgKHZhbHVlTWF4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFsdWVNYXRjaGVzICYmPSB2YWx1ZU1heCA9PT0gKDAsIF9yb2xlSGVscGVycy5jb21wdXRlQXJpYVZhbHVlTWF4KShlbGVtZW50KTtcbiAgICAgIH1cbiAgICAgIGlmICh2YWx1ZU1pbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhbHVlTWF0Y2hlcyAmJj0gdmFsdWVNaW4gPT09ICgwLCBfcm9sZUhlbHBlcnMuY29tcHV0ZUFyaWFWYWx1ZU1pbikoZWxlbWVudCk7XG4gICAgICB9XG4gICAgICBpZiAodmFsdWVUZXh0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFsdWVNYXRjaGVzICYmPSAoMCwgX2FsbFV0aWxzLm1hdGNoZXMpKCgwLCBfcm9sZUhlbHBlcnMuY29tcHV0ZUFyaWFWYWx1ZVRleHQpKGVsZW1lbnQpID8/IG51bGwsIGVsZW1lbnQsIHZhbHVlVGV4dCwgdGV4dCA9PiB0ZXh0KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZU1hdGNoZXM7XG4gICAgfVxuICAgIC8vIGRvbid0IGNhcmUgaWYgYXJpYSBhdHRyaWJ1dGVzIGFyZSB1bnNwZWNpZmllZFxuICAgIHJldHVybiB0cnVlO1xuICB9KS5maWx0ZXIoZWxlbWVudCA9PiB7XG4gICAgaWYgKG5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gRG9uJ3QgY2FyZVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiAoMCwgX2FsbFV0aWxzLm1hdGNoZXMpKCgwLCBfZG9tQWNjZXNzaWJpbGl0eUFwaS5jb21wdXRlQWNjZXNzaWJsZU5hbWUpKGVsZW1lbnQsIHtcbiAgICAgIGNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzOiAoMCwgX2FsbFV0aWxzLmdldENvbmZpZykoKS5jb21wdXRlZFN0eWxlU3VwcG9ydHNQc2V1ZG9FbGVtZW50c1xuICAgIH0pLCBlbGVtZW50LCBuYW1lLCB0ZXh0ID0+IHRleHQpO1xuICB9KS5maWx0ZXIoZWxlbWVudCA9PiB7XG4gICAgaWYgKGRlc2NyaXB0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIERvbid0IGNhcmVcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gKDAsIF9hbGxVdGlscy5tYXRjaGVzKSgoMCwgX2RvbUFjY2Vzc2liaWxpdHlBcGkuY29tcHV0ZUFjY2Vzc2libGVEZXNjcmlwdGlvbikoZWxlbWVudCwge1xuICAgICAgY29tcHV0ZWRTdHlsZVN1cHBvcnRzUHNldWRvRWxlbWVudHM6ICgwLCBfYWxsVXRpbHMuZ2V0Q29uZmlnKSgpLmNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzXG4gICAgfSksIGVsZW1lbnQsIGRlc2NyaXB0aW9uLCB0ZXh0ID0+IHRleHQpO1xuICB9KS5maWx0ZXIoZWxlbWVudCA9PiB7XG4gICAgcmV0dXJuIGhpZGRlbiA9PT0gZmFsc2UgPyAoMCwgX3JvbGVIZWxwZXJzLmlzSW5hY2Nlc3NpYmxlKShlbGVtZW50LCB7XG4gICAgICBpc1N1YnRyZWVJbmFjY2Vzc2libGU6IGNhY2hlZElzU3VidHJlZUluYWNjZXNzaWJsZVxuICAgIH0pID09PSBmYWxzZSA6IHRydWU7XG4gIH0pO1xufTtcbmZ1bmN0aW9uIG1ha2VSb2xlU2VsZWN0b3Iocm9sZSkge1xuICBjb25zdCBleHBsaWNpdFJvbGVTZWxlY3RvciA9IGAqW3JvbGV+PVwiJHtyb2xlfVwiXWA7XG4gIGNvbnN0IHJvbGVSZWxhdGlvbnMgPSBfYXJpYVF1ZXJ5LnJvbGVFbGVtZW50cy5nZXQocm9sZSkgPz8gbmV3IFNldCgpO1xuICBjb25zdCBpbXBsaWNpdFJvbGVTZWxlY3RvcnMgPSBuZXcgU2V0KEFycmF5LmZyb20ocm9sZVJlbGF0aW9ucykubWFwKCh7XG4gICAgbmFtZVxuICB9KSA9PiBuYW1lKSk7XG5cbiAgLy8gQ3VycmVudCB0cmFuc3BpbGF0aW9uIGNvbmZpZyBzb21ldGltZXMgYXNzdW1lcyBgLi4uYCBpcyBhbHdheXMgYXBwbGllZCB0byBhcnJheXMuXG4gIC8vIGAuLi5gIGlzIGVxdWl2YWxlbnQgdG8gYEFycmF5LnByb3RvdHlwZS5jb25jYXRgIGZvciBhcnJheXMuXG4gIC8vIElmIHlvdSByZXBsYWNlIHRoaXMgY29kZSB3aXRoIGBbZXhwbGljaXRSb2xlU2VsZWN0b3IsIC4uLmltcGxpY2l0Um9sZVNlbGVjdG9yc11gLCBtYWtlIHN1cmUgZXZlcnkgdHJhbnNwaWxhdGlvbiB0YXJnZXQgcmV0YWlucyB0aGUgYC4uLmAgaW4gZmF2b3Igb2YgYEFycmF5LnByb3RvdHlwZS5jb25jYXRgLlxuICByZXR1cm4gW2V4cGxpY2l0Um9sZVNlbGVjdG9yXS5jb25jYXQoQXJyYXkuZnJvbShpbXBsaWNpdFJvbGVTZWxlY3RvcnMpKS5qb2luKCcsJyk7XG59XG5jb25zdCBnZXROYW1lSGludCA9IG5hbWUgPT4ge1xuICBsZXQgbmFtZUhpbnQgPSAnJztcbiAgaWYgKG5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgIG5hbWVIaW50ID0gJyc7XG4gIH0gZWxzZSBpZiAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgbmFtZUhpbnQgPSBgIGFuZCBuYW1lIFwiJHtuYW1lfVwiYDtcbiAgfSBlbHNlIHtcbiAgICBuYW1lSGludCA9IGAgYW5kIG5hbWUgXFxgJHtuYW1lfVxcYGA7XG4gIH1cbiAgcmV0dXJuIG5hbWVIaW50O1xufTtcbmNvbnN0IGdldE11bHRpcGxlRXJyb3IgPSAoYywgcm9sZSwge1xuICBuYW1lXG59ID0ge30pID0+IHtcbiAgcmV0dXJuIGBGb3VuZCBtdWx0aXBsZSBlbGVtZW50cyB3aXRoIHRoZSByb2xlIFwiJHtyb2xlfVwiJHtnZXROYW1lSGludChuYW1lKX1gO1xufTtcbmNvbnN0IGdldE1pc3NpbmdFcnJvciA9IChjb250YWluZXIsIHJvbGUsIHtcbiAgaGlkZGVuID0gKDAsIF9hbGxVdGlscy5nZXRDb25maWcpKCkuZGVmYXVsdEhpZGRlbixcbiAgbmFtZSxcbiAgZGVzY3JpcHRpb25cbn0gPSB7fSkgPT4ge1xuICBpZiAoKDAsIF9hbGxVdGlscy5nZXRDb25maWcpKCkuX2Rpc2FibGVFeHBlbnNpdmVFcnJvckRpYWdub3N0aWNzKSB7XG4gICAgcmV0dXJuIGBVbmFibGUgdG8gZmluZCByb2xlPVwiJHtyb2xlfVwiJHtnZXROYW1lSGludChuYW1lKX1gO1xuICB9XG4gIGxldCByb2xlcyA9ICcnO1xuICBBcnJheS5mcm9tKGNvbnRhaW5lci5jaGlsZHJlbikuZm9yRWFjaChjaGlsZEVsZW1lbnQgPT4ge1xuICAgIHJvbGVzICs9ICgwLCBfcm9sZUhlbHBlcnMucHJldHR5Um9sZXMpKGNoaWxkRWxlbWVudCwge1xuICAgICAgaGlkZGVuLFxuICAgICAgaW5jbHVkZURlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkXG4gICAgfSk7XG4gIH0pO1xuICBsZXQgcm9sZU1lc3NhZ2U7XG4gIGlmIChyb2xlcy5sZW5ndGggPT09IDApIHtcbiAgICBpZiAoaGlkZGVuID09PSBmYWxzZSkge1xuICAgICAgcm9sZU1lc3NhZ2UgPSAnVGhlcmUgYXJlIG5vIGFjY2Vzc2libGUgcm9sZXMuIEJ1dCB0aGVyZSBtaWdodCBiZSBzb21lIGluYWNjZXNzaWJsZSByb2xlcy4gJyArICdJZiB5b3Ugd2lzaCB0byBhY2Nlc3MgdGhlbSwgdGhlbiBzZXQgdGhlIGBoaWRkZW5gIG9wdGlvbiB0byBgdHJ1ZWAuICcgKyAnTGVhcm4gbW9yZSBhYm91dCB0aGlzIGhlcmU6IGh0dHBzOi8vdGVzdGluZy1saWJyYXJ5LmNvbS9kb2NzL2RvbS10ZXN0aW5nLWxpYnJhcnkvYXBpLXF1ZXJpZXMjYnlyb2xlJztcbiAgICB9IGVsc2Uge1xuICAgICAgcm9sZU1lc3NhZ2UgPSAnVGhlcmUgYXJlIG5vIGF2YWlsYWJsZSByb2xlcy4nO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByb2xlTWVzc2FnZSA9IGBcbkhlcmUgYXJlIHRoZSAke2hpZGRlbiA9PT0gZmFsc2UgPyAnYWNjZXNzaWJsZScgOiAnYXZhaWxhYmxlJ30gcm9sZXM6XG5cbiAgJHtyb2xlcy5yZXBsYWNlKC9cXG4vZywgJ1xcbiAgJykucmVwbGFjZSgvXFxuXFxzXFxzXFxuL2csICdcXG5cXG4nKX1cbmAudHJpbSgpO1xuICB9XG4gIGxldCBuYW1lSGludCA9ICcnO1xuICBpZiAobmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbmFtZUhpbnQgPSAnJztcbiAgfSBlbHNlIGlmICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICBuYW1lSGludCA9IGAgYW5kIG5hbWUgXCIke25hbWV9XCJgO1xuICB9IGVsc2Uge1xuICAgIG5hbWVIaW50ID0gYCBhbmQgbmFtZSBcXGAke25hbWV9XFxgYDtcbiAgfVxuICBsZXQgZGVzY3JpcHRpb25IaW50ID0gJyc7XG4gIGlmIChkZXNjcmlwdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZGVzY3JpcHRpb25IaW50ID0gJyc7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGRlc2NyaXB0aW9uID09PSAnc3RyaW5nJykge1xuICAgIGRlc2NyaXB0aW9uSGludCA9IGAgYW5kIGRlc2NyaXB0aW9uIFwiJHtkZXNjcmlwdGlvbn1cImA7XG4gIH0gZWxzZSB7XG4gICAgZGVzY3JpcHRpb25IaW50ID0gYCBhbmQgZGVzY3JpcHRpb24gXFxgJHtkZXNjcmlwdGlvbn1cXGBgO1xuICB9XG4gIHJldHVybiBgXG5VbmFibGUgdG8gZmluZCBhbiAke2hpZGRlbiA9PT0gZmFsc2UgPyAnYWNjZXNzaWJsZSAnIDogJyd9ZWxlbWVudCB3aXRoIHRoZSByb2xlIFwiJHtyb2xlfVwiJHtuYW1lSGludH0ke2Rlc2NyaXB0aW9uSGludH1cblxuJHtyb2xlTWVzc2FnZX1gLnRyaW0oKTtcbn07XG5jb25zdCBxdWVyeUFsbEJ5Um9sZVdpdGhTdWdnZXN0aW9ucyA9IGV4cG9ydHMucXVlcnlBbGxCeVJvbGUgPSAoMCwgX3F1ZXJ5SGVscGVycy53cmFwQWxsQnlRdWVyeVdpdGhTdWdnZXN0aW9uKShxdWVyeUFsbEJ5Um9sZSwgcXVlcnlBbGxCeVJvbGUubmFtZSwgJ3F1ZXJ5QWxsJyk7XG5jb25zdCBbcXVlcnlCeVJvbGUsIGdldEFsbEJ5Um9sZSwgZ2V0QnlSb2xlLCBmaW5kQWxsQnlSb2xlLCBmaW5kQnlSb2xlXSA9ICgwLCBfYWxsVXRpbHMuYnVpbGRRdWVyaWVzKShxdWVyeUFsbEJ5Um9sZSwgZ2V0TXVsdGlwbGVFcnJvciwgZ2V0TWlzc2luZ0Vycm9yKTtcbmV4cG9ydHMuZmluZEJ5Um9sZSA9IGZpbmRCeVJvbGU7XG5leHBvcnRzLmZpbmRBbGxCeVJvbGUgPSBmaW5kQWxsQnlSb2xlO1xuZXhwb3J0cy5nZXRCeVJvbGUgPSBnZXRCeVJvbGU7XG5leHBvcnRzLmdldEFsbEJ5Um9sZSA9IGdldEFsbEJ5Um9sZTtcbmV4cG9ydHMucXVlcnlCeVJvbGUgPSBxdWVyeUJ5Um9sZTsiXSwidmVyc2lvbiI6M30=