911e7eb0e99da4b325e131d6008ccf9a
"use strict";
function _typeof(obj) {
    "@babel/helpers - typeof";
    return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj);
}
exports.__esModule = true;
exports.hasAnyConcreteRoles = hasAnyConcreteRoles;
exports.isElement = isElement;
exports.isHTMLFieldSetElement = isHTMLFieldSetElement;
exports.isHTMLInputElement = isHTMLInputElement;
exports.isHTMLLegendElement = isHTMLLegendElement;
exports.isHTMLOptGroupElement = isHTMLOptGroupElement;
exports.isHTMLSelectElement = isHTMLSelectElement;
exports.isHTMLSlotElement = isHTMLSlotElement;
exports.isHTMLTableCaptionElement = isHTMLTableCaptionElement;
exports.isHTMLTableElement = isHTMLTableElement;
exports.isHTMLTextAreaElement = isHTMLTextAreaElement;
exports.isSVGElement = isSVGElement;
exports.isSVGSVGElement = isSVGSVGElement;
exports.isSVGTitleElement = isSVGTitleElement;
exports.queryIdRefs = queryIdRefs;
exports.safeWindow = safeWindow;
var _getRole = _interopRequireWildcard(require("./getRole"));
exports.getLocalName = _getRole.getLocalName;
function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function")
    return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }
function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) {
    return obj;
} if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") {
    return { default: obj };
} var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) {
    return cache.get(obj);
} var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) {
    if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
        var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
        if (desc && (desc.get || desc.set)) {
            Object.defineProperty(newObj, key, desc);
        }
        else {
            newObj[key] = obj[key];
        }
    }
} newObj.default = obj; if (cache) {
    cache.set(obj, newObj);
} return newObj; }
function isElement(node) {
    return node !== null && node.nodeType === node.ELEMENT_NODE;
}
function isHTMLTableCaptionElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "caption";
}
function isHTMLInputElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "input";
}
function isHTMLOptGroupElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "optgroup";
}
function isHTMLSelectElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "select";
}
function isHTMLTableElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "table";
}
function isHTMLTextAreaElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "textarea";
}
function safeWindow(node) {
    var _ref = node.ownerDocument === null ? node : node.ownerDocument, defaultView = _ref.defaultView;
    if (defaultView === null) {
        throw new TypeError("no window available");
    }
    return defaultView;
}
function isHTMLFieldSetElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "fieldset";
}
function isHTMLLegendElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "legend";
}
function isHTMLSlotElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "slot";
}
function isSVGElement(node) {
    return isElement(node) && node.ownerSVGElement !== undefined;
}
function isSVGSVGElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "svg";
}
function isSVGTitleElement(node) {
    return isSVGElement(node) && (0, _getRole.getLocalName)(node) === "title";
}
/**
 *
 * @param {Node} node -
 * @param {string} attributeName -
 * @returns {Element[]} -
 */
function queryIdRefs(node, attributeName) {
    if (isElement(node) && node.hasAttribute(attributeName)) {
        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- safe due to hasAttribute check
        var ids = node.getAttribute(attributeName).split(" ");
        // Browsers that don't support shadow DOM won't have getRootNode
        var root = node.getRootNode ? node.getRootNode() : node.ownerDocument;
        return ids.map(function (id) {
            return root.getElementById(id);
        }).filter(function (element) {
            return element !== null;
        }
        // TODO: why does this not narrow?
        );
    }
    return [];
}
function hasAnyConcreteRoles(node, roles) {
    if (isElement(node)) {
        return roles.indexOf((0, _getRole.default)(node)) !== -1;
    }
    return false;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXG5vZGVfbW9kdWxlc1xcZG9tLWFjY2Vzc2liaWxpdHktYXBpXFxkaXN0XFx1dGlsLmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztBQUViLFNBQVMsT0FBTyxDQUFDLEdBQUc7SUFBSSx5QkFBeUIsQ0FBQztJQUFDLE9BQU8sT0FBTyxHQUFHLFVBQVUsSUFBSSxPQUFPLE1BQU0sSUFBSSxRQUFRLElBQUksT0FBTyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxVQUFVLEdBQUcsSUFBSSxPQUFPLE9BQU8sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLEdBQUcsSUFBSSxPQUFPLEdBQUcsSUFBSSxVQUFVLElBQUksT0FBTyxNQUFNLElBQUksR0FBRyxDQUFDLFdBQVcsS0FBSyxNQUFNLElBQUksR0FBRyxLQUFLLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQUMsQ0FBQztBQUNoVixPQUFPLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztBQUMxQixPQUFPLENBQUMsbUJBQW1CLEdBQUcsbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7QUFDOUIsT0FBTyxDQUFDLHFCQUFxQixHQUFHLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sQ0FBQyxrQkFBa0IsR0FBRyxrQkFBa0IsQ0FBQztBQUNoRCxPQUFPLENBQUMsbUJBQW1CLEdBQUcsbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxDQUFDLHFCQUFxQixHQUFHLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sQ0FBQyxtQkFBbUIsR0FBRyxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLENBQUMsaUJBQWlCLEdBQUcsaUJBQWlCLENBQUM7QUFDOUMsT0FBTyxDQUFDLHlCQUF5QixHQUFHLHlCQUF5QixDQUFDO0FBQzlELE9BQU8sQ0FBQyxrQkFBa0IsR0FBRyxrQkFBa0IsQ0FBQztBQUNoRCxPQUFPLENBQUMscUJBQXFCLEdBQUcscUJBQXFCLENBQUM7QUFDdEQsT0FBTyxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7QUFDcEMsT0FBTyxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7QUFDMUMsT0FBTyxDQUFDLGlCQUFpQixHQUFHLGlCQUFpQixDQUFDO0FBQzlDLE9BQU8sQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO0FBQ2xDLE9BQU8sQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO0FBQ2hDLElBQUksUUFBUSxHQUFHLHVCQUF1QixDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0FBQzdELE9BQU8sQ0FBQyxZQUFZLEdBQUcsUUFBUSxDQUFDLFlBQVksQ0FBQztBQUM3QyxTQUFTLHdCQUF3QixDQUFDLFdBQVcsSUFBSSxJQUFJLE9BQU8sT0FBTyxLQUFLLFVBQVU7SUFBRSxPQUFPLElBQUksQ0FBQyxDQUFDLElBQUksaUJBQWlCLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQyxDQUFDLElBQUksZ0JBQWdCLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyx3QkFBd0IsR0FBRyxTQUFTLHdCQUF3QixDQUFDLFdBQVcsSUFBSSxPQUFPLFdBQVcsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQy9VLFNBQVMsdUJBQXVCLENBQUMsR0FBRyxFQUFFLFdBQVcsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJLEdBQUcsSUFBSSxHQUFHLENBQUMsVUFBVSxFQUFFLENBQUM7SUFBQyxPQUFPLEdBQUcsQ0FBQztBQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsS0FBSyxJQUFJLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLFFBQVEsSUFBSSxPQUFPLEdBQUcsS0FBSyxVQUFVLEVBQUUsQ0FBQztJQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUM7QUFBQyxDQUFDLENBQUMsSUFBSSxLQUFLLEdBQUcsd0JBQXdCLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssSUFBSSxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7SUFBQyxPQUFPLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7QUFBQyxDQUFDLENBQUMsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDLENBQUMsSUFBSSxxQkFBcUIsR0FBRyxNQUFNLENBQUMsY0FBYyxJQUFJLE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLEtBQUssSUFBSSxHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7SUFBQyxJQUFJLEdBQUcsS0FBSyxTQUFTLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQUMsSUFBSSxJQUFJLEdBQUcscUJBQXFCLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUFDLElBQUksSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUFDLENBQUM7YUFBTSxDQUFDO1lBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUFDLENBQUM7SUFBQyxDQUFDO0FBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDLENBQUMsSUFBSSxLQUFLLEVBQUUsQ0FB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LElBQUksRUFBRSxLQUFLO0lBQ3RDLElBQUksU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7UUFDcEIsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQzNELENBQUM7SUFDRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXG5vZGVfbW9kdWxlc1xcZG9tLWFjY2Vzc2liaWxpdHktYXBpXFxkaXN0XFx1dGlsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7IHJldHVybiBfdHlwZW9mID0gXCJmdW5jdGlvblwiID09IHR5cGVvZiBTeW1ib2wgJiYgXCJzeW1ib2xcIiA9PSB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9XG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0cy5oYXNBbnlDb25jcmV0ZVJvbGVzID0gaGFzQW55Q29uY3JldGVSb2xlcztcbmV4cG9ydHMuaXNFbGVtZW50ID0gaXNFbGVtZW50O1xuZXhwb3J0cy5pc0hUTUxGaWVsZFNldEVsZW1lbnQgPSBpc0hUTUxGaWVsZFNldEVsZW1lbnQ7XG5leHBvcnRzLmlzSFRNTElucHV0RWxlbWVudCA9IGlzSFRNTElucHV0RWxlbWVudDtcbmV4cG9ydHMuaXNIVE1MTGVnZW5kRWxlbWVudCA9IGlzSFRNTExlZ2VuZEVsZW1lbnQ7XG5leHBvcnRzLmlzSFRNTE9wdEdyb3VwRWxlbWVudCA9IGlzSFRNTE9wdEdyb3VwRWxlbWVudDtcbmV4cG9ydHMuaXNIVE1MU2VsZWN0RWxlbWVudCA9IGlzSFRNTFNlbGVjdEVsZW1lbnQ7XG5leHBvcnRzLmlzSFRNTFNsb3RFbGVtZW50ID0gaXNIVE1MU2xvdEVsZW1lbnQ7XG5leHBvcnRzLmlzSFRNTFRhYmxlQ2FwdGlvbkVsZW1lbnQgPSBpc0hUTUxUYWJsZUNhcHRpb25FbGVtZW50O1xuZXhwb3J0cy5pc0hUTUxUYWJsZUVsZW1lbnQgPSBpc0hUTUxUYWJsZUVsZW1lbnQ7XG5leHBvcnRzLmlzSFRNTFRleHRBcmVhRWxlbWVudCA9IGlzSFRNTFRleHRBcmVhRWxlbWVudDtcbmV4cG9ydHMuaXNTVkdFbGVtZW50ID0gaXNTVkdFbGVtZW50O1xuZXhwb3J0cy5pc1NWR1NWR0VsZW1lbnQgPSBpc1NWR1NWR0VsZW1lbnQ7XG5leHBvcnRzLmlzU1ZHVGl0bGVFbGVtZW50ID0gaXNTVkdUaXRsZUVsZW1lbnQ7XG5leHBvcnRzLnF1ZXJ5SWRSZWZzID0gcXVlcnlJZFJlZnM7XG5leHBvcnRzLnNhZmVXaW5kb3cgPSBzYWZlV2luZG93O1xudmFyIF9nZXRSb2xlID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZShcIi4vZ2V0Um9sZVwiKSk7XG5leHBvcnRzLmdldExvY2FsTmFtZSA9IF9nZXRSb2xlLmdldExvY2FsTmFtZTtcbmZ1bmN0aW9uIF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZShub2RlSW50ZXJvcCkgeyBpZiAodHlwZW9mIFdlYWtNYXAgIT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIG51bGw7IHZhciBjYWNoZUJhYmVsSW50ZXJvcCA9IG5ldyBXZWFrTWFwKCk7IHZhciBjYWNoZU5vZGVJbnRlcm9wID0gbmV3IFdlYWtNYXAoKTsgcmV0dXJuIChfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUgPSBmdW5jdGlvbiBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUobm9kZUludGVyb3ApIHsgcmV0dXJuIG5vZGVJbnRlcm9wID8gY2FjaGVOb2RlSW50ZXJvcCA6IGNhY2hlQmFiZWxJbnRlcm9wOyB9KShub2RlSW50ZXJvcCk7IH1cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaiwgbm9kZUludGVyb3ApIHsgaWYgKCFub2RlSW50ZXJvcCAmJiBvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBpZiAob2JqID09PSBudWxsIHx8IF90eXBlb2Yob2JqKSAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2Ygb2JqICE9PSBcImZ1bmN0aW9uXCIpIHsgcmV0dXJuIHsgZGVmYXVsdDogb2JqIH07IH0gdmFyIGNhY2hlID0gX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlKG5vZGVJbnRlcm9wKTsgaWYgKGNhY2hlICYmIGNhY2hlLmhhcyhvYmopKSB7IHJldHVybiBjYWNoZS5nZXQob2JqKTsgfSB2YXIgbmV3T2JqID0ge307IHZhciBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoa2V5ICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gaGFzUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiBudWxsOyBpZiAoZGVzYyAmJiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyBpZiAoY2FjaGUpIHsgY2FjaGUuc2V0KG9iaiwgbmV3T2JqKTsgfSByZXR1cm4gbmV3T2JqOyB9XG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkge1xuICByZXR1cm4gbm9kZSAhPT0gbnVsbCAmJiBub2RlLm5vZGVUeXBlID09PSBub2RlLkVMRU1FTlRfTk9ERTtcbn1cbmZ1bmN0aW9uIGlzSFRNTFRhYmxlQ2FwdGlvbkVsZW1lbnQobm9kZSkge1xuICByZXR1cm4gaXNFbGVtZW50KG5vZGUpICYmICgwLCBfZ2V0Um9sZS5nZXRMb2NhbE5hbWUpKG5vZGUpID09PSBcImNhcHRpb25cIjtcbn1cbmZ1bmN0aW9uIGlzSFRNTElucHV0RWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwiaW5wdXRcIjtcbn1cbmZ1bmN0aW9uIGlzSFRNTE9wdEdyb3VwRWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwib3B0Z3JvdXBcIjtcbn1cbmZ1bmN0aW9uIGlzSFRNTFNlbGVjdEVsZW1lbnQobm9kZSkge1xuICByZXR1cm4gaXNFbGVtZW50KG5vZGUpICYmICgwLCBfZ2V0Um9sZS5nZXRMb2NhbE5hbWUpKG5vZGUpID09PSBcInNlbGVjdFwiO1xufVxuZnVuY3Rpb24gaXNIVE1MVGFibGVFbGVtZW50KG5vZGUpIHtcbiAgcmV0dXJuIGlzRWxlbWVudChub2RlKSAmJiAoMCwgX2dldFJvbGUuZ2V0TG9jYWxOYW1lKShub2RlKSA9PT0gXCJ0YWJsZVwiO1xufVxuZnVuY3Rpb24gaXNIVE1MVGV4dEFyZWFFbGVtZW50KG5vZGUpIHtcbiAgcmV0dXJuIGlzRWxlbWVudChub2RlKSAmJiAoMCwgX2dldFJvbGUuZ2V0TG9jYWxOYW1lKShub2RlKSA9PT0gXCJ0ZXh0YXJlYVwiO1xufVxuZnVuY3Rpb24gc2FmZVdpbmRvdyhub2RlKSB7XG4gIHZhciBfcmVmID0gbm9kZS5vd25lckRvY3VtZW50ID09PSBudWxsID8gbm9kZSA6IG5vZGUub3duZXJEb2N1bWVudCxcbiAgICBkZWZhdWx0VmlldyA9IF9yZWYuZGVmYXVsdFZpZXc7XG4gIGlmIChkZWZhdWx0VmlldyA9PT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJubyB3aW5kb3cgYXZhaWxhYmxlXCIpO1xuICB9XG4gIHJldHVybiBkZWZhdWx0Vmlldztcbn1cbmZ1bmN0aW9uIGlzSFRNTEZpZWxkU2V0RWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwiZmllbGRzZXRcIjtcbn1cbmZ1bmN0aW9uIGlzSFRNTExlZ2VuZEVsZW1lbnQobm9kZSkge1xuICByZXR1cm4gaXNFbGVtZW50KG5vZGUpICYmICgwLCBfZ2V0Um9sZS5nZXRMb2NhbE5hbWUpKG5vZGUpID09PSBcImxlZ2VuZFwiO1xufVxuZnVuY3Rpb24gaXNIVE1MU2xvdEVsZW1lbnQobm9kZSkge1xuICByZXR1cm4gaXNFbGVtZW50KG5vZGUpICYmICgwLCBfZ2V0Um9sZS5nZXRMb2NhbE5hbWUpKG5vZGUpID09PSBcInNsb3RcIjtcbn1cbmZ1bmN0aW9uIGlzU1ZHRWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgbm9kZS5vd25lclNWR0VsZW1lbnQgIT09IHVuZGVmaW5lZDtcbn1cbmZ1bmN0aW9uIGlzU1ZHU1ZHRWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwic3ZnXCI7XG59XG5mdW5jdGlvbiBpc1NWR1RpdGxlRWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc1NWR0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwidGl0bGVcIjtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIHtOb2RlfSBub2RlIC1cbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC1cbiAqIEByZXR1cm5zIHtFbGVtZW50W119IC1cbiAqL1xuZnVuY3Rpb24gcXVlcnlJZFJlZnMobm9kZSwgYXR0cmlidXRlTmFtZSkge1xuICBpZiAoaXNFbGVtZW50KG5vZGUpICYmIG5vZGUuaGFzQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb24gLS0gc2FmZSBkdWUgdG8gaGFzQXR0cmlidXRlIGNoZWNrXG4gICAgdmFyIGlkcyA9IG5vZGUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpLnNwbGl0KFwiIFwiKTtcblxuICAgIC8vIEJyb3dzZXJzIHRoYXQgZG9uJ3Qgc3VwcG9ydCBzaGFkb3cgRE9NIHdvbid0IGhhdmUgZ2V0Um9vdE5vZGVcbiAgICB2YXIgcm9vdCA9IG5vZGUuZ2V0Um9vdE5vZGUgPyBub2RlLmdldFJvb3ROb2RlKCkgOiBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgcmV0dXJuIGlkcy5tYXAoZnVuY3Rpb24gKGlkKSB7XG4gICAgICByZXR1cm4gcm9vdC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICByZXR1cm4gZWxlbWVudCAhPT0gbnVsbDtcbiAgICB9XG4gICAgLy8gVE9ETzogd2h5IGRvZXMgdGhpcyBub3QgbmFycm93P1xuICAgICk7XG4gIH1cblxuICByZXR1cm4gW107XG59XG5mdW5jdGlvbiBoYXNBbnlDb25jcmV0ZVJvbGVzKG5vZGUsIHJvbGVzKSB7XG4gIGlmIChpc0VsZW1lbnQobm9kZSkpIHtcbiAgICByZXR1cm4gcm9sZXMuaW5kZXhPZigoMCwgX2dldFJvbGUuZGVmYXVsdCkobm9kZSkpICE9PSAtMTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlsLmpzLm1hcCJdLCJ2ZXJzaW9uIjozfQ==