f71e8e20fcc11dd816eb6368f33947e4
"use strict";
exports.__esModule = true;
exports.computeTextAlternative = computeTextAlternative;
var _array = _interopRequireDefault(require("./polyfills/array.from"));
var _SetLike = _interopRequireDefault(require("./polyfills/SetLike"));
var _util = require("./util");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
/**
 * implements https://w3c.github.io/accname/
 */
/**
 *
 * @param {string} string -
 * @returns {FlatString} -
 */
function asFlatString(s) {
    return s.trim().replace(/\s\s+/g, " ");
}
/**
 *
 * @param node -
 * @param options - These are not optional to prevent accidentally calling it without options in `computeAccessibleName`
 * @returns {boolean} -
 */
function isHidden(node, getComputedStyleImplementation) {
    if (!(0, _util.isElement)(node)) {
        return false;
    }
    if (node.hasAttribute("hidden") || node.getAttribute("aria-hidden") === "true") {
        return true;
    }
    var style = getComputedStyleImplementation(node);
    return style.getPropertyValue("display") === "none" || style.getPropertyValue("visibility") === "hidden";
}
/**
 * @param {Node} node -
 * @returns {boolean} - As defined in step 2E of https://w3c.github.io/accname/#mapping_additional_nd_te
 */
function isControl(node) {
    return (0, _util.hasAnyConcreteRoles)(node, ["button", "combobox", "listbox", "textbox"]) || hasAbstractRole(node, "range");
}
function hasAbstractRole(node, role) {
    if (!(0, _util.isElement)(node)) {
        return false;
    }
    switch (role) {
        case "range":
            return (0, _util.hasAnyConcreteRoles)(node, ["meter", "progressbar", "scrollbar", "slider", "spinbutton"]);
        default:
            throw new TypeError("No knowledge about abstract role '".concat(role, "'. This is likely a bug :("));
    }
}
/**
 * element.querySelectorAll but also considers owned tree
 * @param element
 * @param selectors
 */
function querySelectorAllSubtree(element, selectors) {
    var elements = (0, _array.default)(element.querySelectorAll(selectors));
    (0, _util.queryIdRefs)(element, "aria-owns").forEach(function (root) {
        // babel transpiles this assuming an iterator
        elements.push.apply(elements, (0, _array.default)(root.querySelectorAll(selectors)));
    });
    return elements;
}
function querySelectedOptions(listbox) {
    if ((0, _util.isHTMLSelectElement)(listbox)) {
        // IE11 polyfill
        return listbox.selectedOptions || querySelectorAllSubtree(listbox, "[selected]");
    }
    return querySelectorAllSubtree(listbox, '[aria-selected="true"]');
}
function isMarkedPresentational(node) {
    return (0, _util.hasAnyConcreteRoles)(node, ["none", "presentation"]);
}
/**
 * Elements specifically listed in html-aam
 *
 * We don't need this for `label` or `legend` elements.
 * Their implicit roles already allow "naming from content".
 *
 * sources:
 *
 * - https://w3c.github.io/html-aam/#table-element
 */
function isNativeHostLanguageTextAlternativeElement(node) {
    return (0, _util.isHTMLTableCaptionElement)(node);
}
/**
 * https://w3c.github.io/aria/#namefromcontent
 */
function allowsNameFromContent(node) {
    return (0, _util.hasAnyConcreteRoles)(node, ["button", "cell", "checkbox", "columnheader", "gridcell", "heading", "label", "legend", "link", "menuitem", "menuitemcheckbox", "menuitemradio", "option", "radio", "row", "rowheader", "switch", "tab", "tooltip", "treeitem"]);
}
/**
 * TODO https://github.com/eps1lon/dom-accessibility-api/issues/100
 */
function isDescendantOfNativeHostLanguageTextAlternativeElement(
// eslint-disable-next-line @typescript-eslint/no-unused-vars -- not implemented yet
node) {
    return false;
}
function getValueOfTextbox(element) {
    if ((0, _util.isHTMLInputElement)(element) || (0, _util.isHTMLTextAreaElement)(element)) {
        return element.value;
    }
    // https://github.com/eps1lon/dom-accessibility-api/issues/4
    return element.textContent || "";
}
function getTextualContent(declaration) {
    var content = declaration.getPropertyValue("content");
    if (/^["'].*["']$/.test(content)) {
        return content.slice(1, -1);
    }
    return "";
}
/**
 * https://html.spec.whatwg.org/multipage/forms.html#category-label
 * TODO: form-associated custom elements
 * @param element
 */
function isLabelableElement(element) {
    var localName = (0, _util.getLocalName)(element);
    return localName === "button" || localName === "input" && element.getAttribute("type") !== "hidden" || localName === "meter" || localName === "output" || localName === "progress" || localName === "select" || localName === "textarea";
}
/**
 * > [...], then the first such descendant in tree order is the label element's labeled control.
 * -- https://html.spec.whatwg.org/multipage/forms.html#labeled-control
 * @param element
 */
function findLabelableElement(element) {
    if (isLabelableElement(element)) {
        return element;
    }
    var labelableElement = null;
    element.childNodes.forEach(function (childNode) {
        if (labelableElement === null && (0, _util.isElement)(childNode)) {
            var descendantLabelableElement = findLabelableElement(childNode);
            if (descendantLabelableElement !== null) {
                labelableElement = descendantLabelableElement;
            }
        }
    });
    return labelableElement;
}
/**
 * Polyfill of HTMLLabelElement.control
 * https://html.spec.whatwg.org/multipage/forms.html#labeled-control
 * @param label
 */
function getControlOfLabel(label) {
    if (label.control !== undefined) {
        return label.control;
    }
    var htmlFor = label.getAttribute("for");
    if (htmlFor !== null) {
        return label.ownerDocument.getElementById(htmlFor);
    }
    return findLabelableElement(label);
}
/**
 * Polyfill of HTMLInputElement.labels
 * https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/labels
 * @param element
 */
function getLabels(element) {
    var labelsProperty = element.labels;
    if (labelsProperty === null) {
        return labelsProperty;
    }
    if (labelsProperty !== undefined) {
        return (0, _array.default)(labelsProperty);
    }
    // polyfill
    if (!isLabelableElement(element)) {
        return null;
    }
    var document = element.ownerDocument;
    return (0, _array.default)(document.querySelectorAll("label")).filter(function (label) {
        return getControlOfLabel(label) === element;
    });
}
/**
 * Gets the contents of a slot used for computing the accname
 * @param slot
 */
function getSlotContents(slot) {
    // Computing the accessible name for elements containing slots is not
    // currently defined in the spec. This implementation reflects the
    // behavior of NVDA 2020.2/Firefox 81 and iOS VoiceOver/Safari 13.6.
    var assignedNodes = slot.assignedNodes();
    if (assignedNodes.length === 0) {
        // if no nodes are assigned to the slot, it displays the default content
        return (0, _array.default)(slot.childNodes);
    }
    return assignedNodes;
}
/**
 * implements https://w3c.github.io/accname/#mapping_additional_nd_te
 * @param root
 * @param options
 * @returns
 */
function computeTextAlternative(root) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var consultedNodes = new _SetLike.default();
    var window = (0, _util.safeWindow)(root);
    var _options$compute = options.compute, compute = _options$compute === void 0 ? "name" : _options$compute, _options$computedStyl = options.computedStyleSupportsPseudoElements, computedStyleSupportsPseudoElements = _options$computedStyl === void 0 ? options.getComputedStyle !== undefined : _options$computedStyl, _options$getComputedS = options.getComputedStyle, getComputedStyle = _options$getComputedS === void 0 ? window.getComputedStyle.bind(window) : _options$getComputedS, _options$hidden = options.hidden, hidden = _options$hidden === void 0 ? false : _options$hidden;
    // 2F.i
    function computeMiscTextAlternative(node, context) {
        var accumulatedText = "";
        if ((0, _util.isElement)(node) && computedStyleSupportsPseudoElements) {
            var pseudoBefore = getComputedStyle(node, "::before");
            var beforeContent = getTextualContent(pseudoBefore);
            accumulatedText = "".concat(beforeContent, " ").concat(accumulatedText);
        }
        // FIXME: Including aria-owns is not defined in the spec
        // But it is required in the web-platform-test
        var childNodes = (0, _util.isHTMLSlotElement)(node) ? getSlotContents(node) : (0, _array.default)(node.childNodes).concat((0, _util.queryIdRefs)(node, "aria-owns"));
        childNodes.forEach(function (child) {
            var result = computeTextAlternative(child, {
                isEmbeddedInLabel: context.isEmbeddedInLabel,
                isReferenced: false,
                recursion: true
            });
            // TODO: Unclear why display affects delimiter
            // see https://github.com/w3c/accname/issues/3
            var display = (0, _util.isElement)(child) ? getComputedStyle(child).getPropertyValue("display") : "inline";
            var separator = display !== "inline" ? " " : "";
            // trailing separator for wpt tests
            accumulatedText += "".concat(separator).concat(result).concat(separator);
        });
        if ((0, _util.isElement)(node) && computedStyleSupportsPseudoElements) {
            var pseudoAfter = getComputedStyle(node, "::after");
            var afterContent = getTextualContent(pseudoAfter);
            accumulatedText = "".concat(accumulatedText, " ").concat(afterContent);
        }
        return accumulatedText.trim();
    }
    /**
     *
     * @param element
     * @param attributeName
     * @returns A string non-empty string or `null`
     */
    function useAttribute(element, attributeName) {
        var attribute = element.getAttributeNode(attributeName);
        if (attribute !== null && !consultedNodes.has(attribute) && attribute.value.trim() !== "") {
            consultedNodes.add(attribute);
            return attribute.value;
        }
        return null;
    }
    function computeTooltipAttributeValue(node) {
        if (!(0, _util.isElement)(node)) {
            return null;
        }
        return useAttribute(node, "title");
    }
    function computeElementTextAlternative(node) {
        if (!(0, _util.isElement)(node)) {
            return null;
        }
        // https://w3c.github.io/html-aam/#fieldset-and-legend-elements
        if ((0, _util.isHTMLFieldSetElement)(node)) {
            consultedNodes.add(node);
            var children = (0, _array.default)(node.childNodes);
            for (var i = 0; i < children.length; i += 1) {
                var child = children[i];
                if ((0, _util.isHTMLLegendElement)(child)) {
                    return computeTextAlternative(child, {
                        isEmbeddedInLabel: false,
                        isReferenced: false,
                        recursion: false
                    });
                }
            }
        }
        else if ((0, _util.isHTMLTableElement)(node)) {
            // https://w3c.github.io/html-aam/#table-element
            consultedNodes.add(node);
            var _children = (0, _array.default)(node.childNodes);
            for (var _i = 0; _i < _children.length; _i += 1) {
                var _child = _children[_i];
                if ((0, _util.isHTMLTableCaptionElement)(_child)) {
                    return computeTextAlternative(_child, {
                        isEmbeddedInLabel: false,
                        isReferenced: false,
                        recursion: false
                    });
                }
            }
        }
        else if ((0, _util.isSVGSVGElement)(node)) {
            // https://www.w3.org/TR/svg-aam-1.0/
            consultedNodes.add(node);
            var _children2 = (0, _array.default)(node.childNodes);
            for (var _i2 = 0; _i2 < _children2.length; _i2 += 1) {
                var _child2 = _children2[_i2];
                if ((0, _util.isSVGTitleElement)(_child2)) {
                    return _child2.textContent;
                }
            }
            return null;
        }
        else if ((0, _util.getLocalName)(node) === "img" || (0, _util.getLocalName)(node) === "area") {
            // https://w3c.github.io/html-aam/#area-element
            // https://w3c.github.io/html-aam/#img-element
            var nameFromAlt = useAttribute(node, "alt");
            if (nameFromAlt !== null) {
                return nameFromAlt;
            }
        }
        else if ((0, _util.isHTMLOptGroupElement)(node)) {
            var nameFromLabel = useAttribute(node, "label");
            if (nameFromLabel !== null) {
                return nameFromLabel;
            }
        }
        if ((0, _util.isHTMLInputElement)(node) && (node.type === "button" || node.type === "submit" || node.type === "reset")) {
            // https://w3c.github.io/html-aam/#input-type-text-input-type-password-input-type-search-input-type-tel-input-type-email-input-type-url-and-textarea-element-accessible-description-computation
            var nameFromValue = useAttribute(node, "value");
            if (nameFromValue !== null) {
                return nameFromValue;
            }
            // TODO: l10n
            if (node.type === "submit") {
                return "Submit";
            }
            // TODO: l10n
            if (node.type === "reset") {
                return "Reset";
            }
        }
        var labels = getLabels(node);
        if (labels !== null && labels.length !== 0) {
            consultedNodes.add(node);
            return (0, _array.default)(labels).map(function (element) {
                return computeTextAlternative(element, {
                    isEmbeddedInLabel: true,
                    isReferenced: false,
                    recursion: true
                });
            }).filter(function (label) {
                return label.length > 0;
            }).join(" ");
        }
        // https://w3c.github.io/html-aam/#input-type-image-accessible-name-computation
        // TODO: wpt test consider label elements but html-aam does not mention them
        // We follow existing implementations over spec
        if ((0, _util.isHTMLInputElement)(node) && node.type === "image") {
            var _nameFromAlt = useAttribute(node, "alt");
            if (_nameFromAlt !== null) {
                return _nameFromAlt;
            }
            var nameFromTitle = useAttribute(node, "title");
            if (nameFromTitle !== null) {
                return nameFromTitle;
            }
            // TODO: l10n
            return "Submit Query";
        }
        if ((0, _util.hasAnyConcreteRoles)(node, ["button"])) {
            // https://www.w3.org/TR/html-aam-1.0/#button-element
            var nameFromSubTree = computeMiscTextAlternative(node, {
                isEmbeddedInLabel: false,
                isReferenced: false
            });
            if (nameFromSubTree !== "") {
                return nameFromSubTree;
            }
        }
        return null;
    }
    function computeTextAlternative(current, context) {
        if (consultedNodes.has(current)) {
            return "";
        }
        // 2A
        if (!hidden && isHidden(current, getComputedStyle) && !context.isReferenced) {
            consultedNodes.add(current);
            return "";
        }
        // 2B
        var labelAttributeNode = (0, _util.isElement)(current) ? current.getAttributeNode("aria-labelledby") : null;
        // TODO: Do we generally need to block query IdRefs of attributes we have already consulted?
        var labelElements = labelAttributeNode !== null && !consultedNodes.has(labelAttributeNode) ? (0, _util.queryIdRefs)(current, "aria-labelledby") : [];
        if (compute === "name" && !context.isReferenced && labelElements.length > 0) {
            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- Can't be null here otherwise labelElements would be empty
            consultedNodes.add(labelAttributeNode);
            return labelElements.map(function (element) {
                // TODO: Chrome will consider repeated values i.e. use a node multiple times while we'll bail out in computeTextAlternative.
                return computeTextAlternative(element, {
                    isEmbeddedInLabel: context.isEmbeddedInLabel,
                    isReferenced: true,
                    // this isn't recursion as specified, otherwise we would skip
                    // `aria-label` in
                    // <input id="myself" aria-label="foo" aria-labelledby="myself"
                    recursion: false
                });
            }).join(" ");
        }
        // 2C
        // Changed from the spec in anticipation of https://github.com/w3c/accname/issues/64
        // spec says we should only consider skipping if we have a non-empty label
        var skipToStep2E = context.recursion && isControl(current) && compute === "name";
        if (!skipToStep2E) {
            var ariaLabel = ((0, _util.isElement)(current) && current.getAttribute("aria-label") || "").trim();
            if (ariaLabel !== "" && compute === "name") {
                consultedNodes.add(current);
                return ariaLabel;
            }
            // 2D
            if (!isMarkedPresentational(current)) {
                var elementTextAlternative = computeElementTextAlternative(current);
                if (elementTextAlternative !== null) {
                    consultedNodes.add(current);
                    return elementTextAlternative;
                }
            }
        }
        // special casing, cheating to make tests pass
        // https://github.com/w3c/accname/issues/67
        if ((0, _util.hasAnyConcreteRoles)(current, ["menu"])) {
            consultedNodes.add(current);
            return "";
        }
        // 2E
        if (skipToStep2E || context.isEmbeddedInLabel || context.isReferenced) {
            if ((0, _util.hasAnyConcreteRoles)(current, ["combobox", "listbox"])) {
                consultedNodes.add(current);
                var selectedOptions = querySelectedOptions(current);
                if (selectedOptions.length === 0) {
                    // defined per test `name_heading_combobox`
                    return (0, _util.isHTMLInputElement)(current) ? current.value : "";
                }
                return (0, _array.default)(selectedOptions).map(function (selectedOption) {
                    return computeTextAlternative(selectedOption, {
                        isEmbeddedInLabel: context.isEmbeddedInLabel,
                        isReferenced: false,
                        recursion: true
                    });
                }).join(" ");
            }
            if (hasAbstractRole(current, "range")) {
                consultedNodes.add(current);
                if (current.hasAttribute("aria-valuetext")) {
                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- safe due to hasAttribute guard
                    return current.getAttribute("aria-valuetext");
                }
                if (current.hasAttribute("aria-valuenow")) {
                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- safe due to hasAttribute guard
                    return current.getAttribute("aria-valuenow");
                }
                // Otherwise, use the value as specified by a host language attribute.
                return current.getAttribute("value") || "";
            }
            if ((0, _util.hasAnyConcreteRoles)(current, ["textbox"])) {
                consultedNodes.add(current);
                return getValueOfTextbox(current);
            }
        }
        // 2F: https://w3c.github.io/accname/#step2F
        if (allowsNameFromContent(current) || (0, _util.isElement)(current) && context.isReferenced || isNativeHostLanguageTextAlternativeElement(current) || isDescendantOfNativeHostLanguageTextAlternativeElement(current)) {
            var accumulatedText2F = computeMiscTextAlternative(current, {
                isEmbeddedInLabel: context.isEmbeddedInLabel,
                isReferenced: false
            });
            if (accumulatedText2F !== "") {
                consultedNodes.add(current);
                return accumulatedText2F;
            }
        }
        if (current.nodeType === current.TEXT_NODE) {
            consultedNodes.add(current);
            return current.textContent || "";
        }
        if (context.recursion) {
            consultedNodes.add(current);
            return computeMiscTextAlternative(current, {
                isEmbeddedInLabel: context.isEmbeddedInLabel,
                isReferenced: false
            });
        }
        var tooltipAttributeValue = computeTooltipAttributeValue(current);
        if (tooltipAttributeValue !== null) {
            consultedNodes.add(current);
            return tooltipAttributeValue;
        }
        // TODO should this be reachable?
        consultedNodes.add(current);
        return "";
    }
    return asFlatString(computeTextAlternative(root, {
        isEmbeddedInLabel: false,
        // by spec computeAccessibleDescription starts with the referenced elements as roots
        isReferenced: compute === "description",
        recursion: false
    }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXG5vZGVfbW9kdWxlc1xcZG9tLWFjY2Vzc2liaWxpdHktYXBpXFxkaXN0XFxhY2Nlc3NpYmxlLW5hbWUtYW5kLWRlc2NyaXB0aW9uLmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztBQUViLE9BQU8sQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO0FBQzFCLE9BQU8sQ0FBQyxzQkFBc0IsR0FBRyxzQkFBc0IsQ0FBQztBQUN4RCxJQUFJLE1BQU0sR0FBRyxzQkFBc0IsQ0FBQyxPQUFPLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDO0FBQ3ZFLElBQUksUUFBUSxHQUFHLHNCQUFzQixDQUFDLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUM7QUFDdEUsSUFBSSxLQUFLLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzlCLFNBQVMsc0JBQXNCLENBQUMsR0FBRyxJQUFJLE9BQU8sR0FBRyxJQUFJLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQy9GOztHQUVHO0FBRUg7Ozs7R0FJRztBQUNILFNBQVMsWUFBWSxDQUFDLENBQUM7SUFDckIsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUN6QyxDQUFDO0FBRUQ7Ozs7O0dBS0c7QUFDSCxTQUFTLFFBQVEsQ0FBQyxJQUFJLEVBQUUsOEJBQThCO0lBQ3BELElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUNoQyxPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7SUFDRCxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLElBQUksSUFBSSxDQUFDLFlB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dHNcXENhcmRFdmVyeXRoaW5nXFxjYXJkYWxsLXByb3RvdHlwZVxcbm9kZV9tb2R1bGVzXFxkb20tYWNjZXNzaWJpbGl0eS1hcGlcXGRpc3RcXGFjY2Vzc2libGUtbmFtZS1hbmQtZGVzY3JpcHRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzLmNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUgPSBjb21wdXRlVGV4dEFsdGVybmF0aXZlO1xudmFyIF9hcnJheSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vcG9seWZpbGxzL2FycmF5LmZyb21cIikpO1xudmFyIF9TZXRMaWtlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9wb2x5ZmlsbHMvU2V0TGlrZVwiKSk7XG52YXIgX3V0aWwgPSByZXF1aXJlKFwiLi91dGlsXCIpO1xuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cbi8qKlxuICogaW1wbGVtZW50cyBodHRwczovL3czYy5naXRodWIuaW8vYWNjbmFtZS9cbiAqL1xuXG4vKipcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIC1cbiAqIEByZXR1cm5zIHtGbGF0U3RyaW5nfSAtXG4gKi9cbmZ1bmN0aW9uIGFzRmxhdFN0cmluZyhzKSB7XG4gIHJldHVybiBzLnRyaW0oKS5yZXBsYWNlKC9cXHNcXHMrL2csIFwiIFwiKTtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIG5vZGUgLVxuICogQHBhcmFtIG9wdGlvbnMgLSBUaGVzZSBhcmUgbm90IG9wdGlvbmFsIHRvIHByZXZlbnQgYWNjaWRlbnRhbGx5IGNhbGxpbmcgaXQgd2l0aG91dCBvcHRpb25zIGluIGBjb21wdXRlQWNjZXNzaWJsZU5hbWVgXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gLVxuICovXG5mdW5jdGlvbiBpc0hpZGRlbihub2RlLCBnZXRDb21wdXRlZFN0eWxlSW1wbGVtZW50YXRpb24pIHtcbiAgaWYgKCEoMCwgX3V0aWwuaXNFbGVtZW50KShub2RlKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBpZiAobm9kZS5oYXNBdHRyaWJ1dGUoXCJoaWRkZW5cIikgfHwgbm9kZS5nZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiKSA9PT0gXCJ0cnVlXCIpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlSW1wbGVtZW50YXRpb24obm9kZSk7XG4gIHJldHVybiBzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwiZGlzcGxheVwiKSA9PT0gXCJub25lXCIgfHwgc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShcInZpc2liaWxpdHlcIikgPT09IFwiaGlkZGVuXCI7XG59XG5cbi8qKlxuICogQHBhcmFtIHtOb2RlfSBub2RlIC1cbiAqIEByZXR1cm5zIHtib29sZWFufSAtIEFzIGRlZmluZWQgaW4gc3RlcCAyRSBvZiBodHRwczovL3czYy5naXRodWIuaW8vYWNjbmFtZS8jbWFwcGluZ19hZGRpdGlvbmFsX25kX3RlXG4gKi9cbmZ1bmN0aW9uIGlzQ29udHJvbChub2RlKSB7XG4gIHJldHVybiAoMCwgX3V0aWwuaGFzQW55Q29uY3JldGVSb2xlcykobm9kZSwgW1wiYnV0dG9uXCIsIFwiY29tYm9ib3hcIiwgXCJsaXN0Ym94XCIsIFwidGV4dGJveFwiXSkgfHwgaGFzQWJzdHJhY3RSb2xlKG5vZGUsIFwicmFuZ2VcIik7XG59XG5mdW5jdGlvbiBoYXNBYnN0cmFjdFJvbGUobm9kZSwgcm9sZSkge1xuICBpZiAoISgwLCBfdXRpbC5pc0VsZW1lbnQpKG5vZGUpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHN3aXRjaCAocm9sZSkge1xuICAgIGNhc2UgXCJyYW5nZVwiOlxuICAgICAgcmV0dXJuICgwLCBfdXRpbC5oYXNBbnlDb25jcmV0ZVJvbGVzKShub2RlLCBbXCJtZXRlclwiLCBcInByb2dyZXNzYmFyXCIsIFwic2Nyb2xsYmFyXCIsIFwic2xpZGVyXCIsIFwic3BpbmJ1dHRvblwiXSk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJObyBrbm93bGVkZ2UgYWJvdXQgYWJzdHJhY3Qgcm9sZSAnXCIuY29uY2F0KHJvbGUsIFwiJy4gVGhpcyBpcyBsaWtlbHkgYSBidWcgOihcIikpO1xuICB9XG59XG5cbi8qKlxuICogZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsIGJ1dCBhbHNvIGNvbnNpZGVycyBvd25lZCB0cmVlXG4gKiBAcGFyYW0gZWxlbWVudFxuICogQHBhcmFtIHNlbGVjdG9yc1xuICovXG5mdW5jdGlvbiBxdWVyeVNlbGVjdG9yQWxsU3VidHJlZShlbGVtZW50LCBzZWxlY3RvcnMpIHtcbiAgdmFyIGVsZW1lbnRzID0gKDAsIF9hcnJheS5kZWZhdWx0KShlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3JzKSk7XG4gICgwLCBfdXRpbC5xdWVyeUlkUmVmcykoZWxlbWVudCwgXCJhcmlhLW93bnNcIikuZm9yRWFjaChmdW5jdGlvbiAocm9vdCkge1xuICAgIC8vIGJhYmVsIHRyYW5zcGlsZXMgdGhpcyBhc3N1bWluZyBhbiBpdGVyYXRvclxuICAgIGVsZW1lbnRzLnB1c2guYXBwbHkoZWxlbWVudHMsICgwLCBfYXJyYXkuZGVmYXVsdCkocm9vdC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycykpKTtcbiAgfSk7XG4gIHJldHVybiBlbGVtZW50cztcbn1cbmZ1bmN0aW9uIHF1ZXJ5U2VsZWN0ZWRPcHRpb25zKGxpc3Rib3gpIHtcbiAgaWYgKCgwLCBfdXRpbC5pc0hUTUxTZWxlY3RFbGVtZW50KShsaXN0Ym94KSkge1xuICAgIC8vIElFMTEgcG9seWZpbGxcbiAgICByZXR1cm4gbGlzdGJveC5zZWxlY3RlZE9wdGlvbnMgfHwgcXVlcnlTZWxlY3RvckFsbFN1YnRyZWUobGlzdGJveCwgXCJbc2VsZWN0ZWRdXCIpO1xuICB9XG4gIHJldHVybiBxdWVyeVNlbGVjdG9yQWxsU3VidHJlZShsaXN0Ym94LCAnW2FyaWEtc2VsZWN0ZWQ9XCJ0cnVlXCJdJyk7XG59XG5mdW5jdGlvbiBpc01hcmtlZFByZXNlbnRhdGlvbmFsKG5vZGUpIHtcbiAgcmV0dXJuICgwLCBfdXRpbC5oYXNBbnlDb25jcmV0ZVJvbGVzKShub2RlLCBbXCJub25lXCIsIFwicHJlc2VudGF0aW9uXCJdKTtcbn1cblxuLyoqXG4gKiBFbGVtZW50cyBzcGVjaWZpY2FsbHkgbGlzdGVkIGluIGh0bWwtYWFtXG4gKlxuICogV2UgZG9uJ3QgbmVlZCB0aGlzIGZvciBgbGFiZWxgIG9yIGBsZWdlbmRgIGVsZW1lbnRzLlxuICogVGhlaXIgaW1wbGljaXQgcm9sZXMgYWxyZWFkeSBhbGxvdyBcIm5hbWluZyBmcm9tIGNvbnRlbnRcIi5cbiAqXG4gKiBzb3VyY2VzOlxuICpcbiAqIC0gaHR0cHM6Ly93M2MuZ2l0aHViLmlvL2h0bWwtYWFtLyN0YWJsZS1lbGVtZW50XG4gKi9cbmZ1bmN0aW9uIGlzTmF0aXZlSG9zdExhbmd1YWdlVGV4dEFsdGVybmF0aXZlRWxlbWVudChub2RlKSB7XG4gIHJldHVybiAoMCwgX3V0aWwuaXNIVE1MVGFibGVDYXB0aW9uRWxlbWVudCkobm9kZSk7XG59XG5cbi8qKlxuICogaHR0cHM6Ly93M2MuZ2l0aHViLmlvL2FyaWEvI25hbWVmcm9tY29udGVudFxuICovXG5mdW5jdGlvbiBhbGxvd3NOYW1lRnJvbUNvbnRlbnQobm9kZSkge1xuICByZXR1cm4gKDAsIF91dGlsLmhhc0FueUNvbmNyZXRlUm9sZXMpKG5vZGUsIFtcImJ1dHRvblwiLCBcImNlbGxcIiwgXCJjaGVja2JveFwiLCBcImNvbHVtbmhlYWRlclwiLCBcImdyaWRjZWxsXCIsIFwiaGVhZGluZ1wiLCBcImxhYmVsXCIsIFwibGVnZW5kXCIsIFwibGlua1wiLCBcIm1lbnVpdGVtXCIsIFwibWVudWl0ZW1jaGVja2JveFwiLCBcIm1lbnVpdGVtcmFkaW9cIiwgXCJvcHRpb25cIiwgXCJyYWRpb1wiLCBcInJvd1wiLCBcInJvd2hlYWRlclwiLCBcInN3aXRjaFwiLCBcInRhYlwiLCBcInRvb2x0aXBcIiwgXCJ0cmVlaXRlbVwiXSk7XG59XG5cbi8qKlxuICogVE9ETyBodHRwczovL2dpdGh1Yi5jb20vZXBzMWxvbi9kb20tYWNjZXNzaWJpbGl0eS1hcGkvaXNzdWVzLzEwMFxuICovXG5mdW5jdGlvbiBpc0Rlc2NlbmRhbnRPZk5hdGl2ZUhvc3RMYW5ndWFnZVRleHRBbHRlcm5hdGl2ZUVsZW1lbnQoXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzIC0tIG5vdCBpbXBsZW1lbnRlZCB5ZXRcbm5vZGUpIHtcbiAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gZ2V0VmFsdWVPZlRleHRib3goZWxlbWVudCkge1xuICBpZiAoKDAsIF91dGlsLmlzSFRNTElucHV0RWxlbWVudCkoZWxlbWVudCkgfHwgKDAsIF91dGlsLmlzSFRNTFRleHRBcmVhRWxlbWVudCkoZWxlbWVudCkpIHtcbiAgICByZXR1cm4gZWxlbWVudC52YWx1ZTtcbiAgfVxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vZXBzMWxvbi9kb20tYWNjZXNzaWJpbGl0eS1hcGkvaXNzdWVzLzRcbiAgcmV0dXJuIGVsZW1lbnQudGV4dENvbnRlbnQgfHwgXCJcIjtcbn1cbmZ1bmN0aW9uIGdldFRleHR1YWxDb250ZW50KGRlY2xhcmF0aW9uKSB7XG4gIHZhciBjb250ZW50ID0gZGVjbGFyYXRpb24uZ2V0UHJvcGVydHlWYWx1ZShcImNvbnRlbnRcIik7XG4gIGlmICgvXltcIiddLipbXCInXSQvLnRlc3QoY29udGVudCkpIHtcbiAgICByZXR1cm4gY29udGVudC5zbGljZSgxLCAtMSk7XG4gIH1cbiAgcmV0dXJuIFwiXCI7XG59XG5cbi8qKlxuICogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvZm9ybXMuaHRtbCNjYXRlZ29yeS1sYWJlbFxuICogVE9ETzogZm9ybS1hc3NvY2lhdGVkIGN1c3RvbSBlbGVtZW50c1xuICogQHBhcmFtIGVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gaXNMYWJlbGFibGVFbGVtZW50KGVsZW1lbnQpIHtcbiAgdmFyIGxvY2FsTmFtZSA9ICgwLCBfdXRpbC5nZXRMb2NhbE5hbWUpKGVsZW1lbnQpO1xuICByZXR1cm4gbG9jYWxOYW1lID09PSBcImJ1dHRvblwiIHx8IGxvY2FsTmFtZSA9PT0gXCJpbnB1dFwiICYmIGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidHlwZVwiKSAhPT0gXCJoaWRkZW5cIiB8fCBsb2NhbE5hbWUgPT09IFwibWV0ZXJcIiB8fCBsb2NhbE5hbWUgPT09IFwib3V0cHV0XCIgfHwgbG9jYWxOYW1lID09PSBcInByb2dyZXNzXCIgfHwgbG9jYWxOYW1lID09PSBcInNlbGVjdFwiIHx8IGxvY2FsTmFtZSA9PT0gXCJ0ZXh0YXJlYVwiO1xufVxuXG4vKipcbiAqID4gWy4uLl0sIHRoZW4gdGhlIGZpcnN0IHN1Y2ggZGVzY2VuZGFudCBpbiB0cmVlIG9yZGVyIGlzIHRoZSBsYWJlbCBlbGVtZW50J3MgbGFiZWxlZCBjb250cm9sLlxuICogLS0gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvZm9ybXMuaHRtbCNsYWJlbGVkLWNvbnRyb2xcbiAqIEBwYXJhbSBlbGVtZW50XG4gKi9cbmZ1bmN0aW9uIGZpbmRMYWJlbGFibGVFbGVtZW50KGVsZW1lbnQpIHtcbiAgaWYgKGlzTGFiZWxhYmxlRWxlbWVudChlbGVtZW50KSkge1xuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG4gIHZhciBsYWJlbGFibGVFbGVtZW50ID0gbnVsbDtcbiAgZWxlbWVudC5jaGlsZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkTm9kZSkge1xuICAgIGlmIChsYWJlbGFibGVFbGVtZW50ID09PSBudWxsICYmICgwLCBfdXRpbC5pc0VsZW1lbnQpKGNoaWxkTm9kZSkpIHtcbiAgICAgIHZhciBkZXNjZW5kYW50TGFiZWxhYmxlRWxlbWVudCA9IGZpbmRMYWJlbGFibGVFbGVtZW50KGNoaWxkTm9kZSk7XG4gICAgICBpZiAoZGVzY2VuZGFudExhYmVsYWJsZUVsZW1lbnQgIT09IG51bGwpIHtcbiAgICAgICAgbGFiZWxhYmxlRWxlbWVudCA9IGRlc2NlbmRhbnRMYWJlbGFibGVFbGVtZW50O1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIHJldHVybiBsYWJlbGFibGVFbGVtZW50O1xufVxuXG4vKipcbiAqIFBvbHlmaWxsIG9mIEhUTUxMYWJlbEVsZW1lbnQuY29udHJvbFxuICogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvZm9ybXMuaHRtbCNsYWJlbGVkLWNvbnRyb2xcbiAqIEBwYXJhbSBsYWJlbFxuICovXG5mdW5jdGlvbiBnZXRDb250cm9sT2ZMYWJlbChsYWJlbCkge1xuICBpZiAobGFiZWwuY29udHJvbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGxhYmVsLmNvbnRyb2w7XG4gIH1cbiAgdmFyIGh0bWxGb3IgPSBsYWJlbC5nZXRBdHRyaWJ1dGUoXCJmb3JcIik7XG4gIGlmIChodG1sRm9yICE9PSBudWxsKSB7XG4gICAgcmV0dXJuIGxhYmVsLm93bmVyRG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaHRtbEZvcik7XG4gIH1cbiAgcmV0dXJuIGZpbmRMYWJlbGFibGVFbGVtZW50KGxhYmVsKTtcbn1cblxuLyoqXG4gKiBQb2x5ZmlsbCBvZiBIVE1MSW5wdXRFbGVtZW50LmxhYmVsc1xuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxJbnB1dEVsZW1lbnQvbGFiZWxzXG4gKiBAcGFyYW0gZWxlbWVudFxuICovXG5mdW5jdGlvbiBnZXRMYWJlbHMoZWxlbWVudCkge1xuICB2YXIgbGFiZWxzUHJvcGVydHkgPSBlbGVtZW50LmxhYmVscztcbiAgaWYgKGxhYmVsc1Byb3BlcnR5ID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGxhYmVsc1Byb3BlcnR5O1xuICB9XG4gIGlmIChsYWJlbHNQcm9wZXJ0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuICgwLCBfYXJyYXkuZGVmYXVsdCkobGFiZWxzUHJvcGVydHkpO1xuICB9XG5cbiAgLy8gcG9seWZpbGxcbiAgaWYgKCFpc0xhYmVsYWJsZUVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICB2YXIgZG9jdW1lbnQgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQ7XG4gIHJldHVybiAoMCwgX2FycmF5LmRlZmF1bHQpKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJsYWJlbFwiKSkuZmlsdGVyKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgIHJldHVybiBnZXRDb250cm9sT2ZMYWJlbChsYWJlbCkgPT09IGVsZW1lbnQ7XG4gIH0pO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIGNvbnRlbnRzIG9mIGEgc2xvdCB1c2VkIGZvciBjb21wdXRpbmcgdGhlIGFjY25hbWVcbiAqIEBwYXJhbSBzbG90XG4gKi9cbmZ1bmN0aW9uIGdldFNsb3RDb250ZW50cyhzbG90KSB7XG4gIC8vIENvbXB1dGluZyB0aGUgYWNjZXNzaWJsZSBuYW1lIGZvciBlbGVtZW50cyBjb250YWluaW5nIHNsb3RzIGlzIG5vdFxuICAvLyBjdXJyZW50bHkgZGVmaW5lZCBpbiB0aGUgc3BlYy4gVGhpcyBpbXBsZW1lbnRhdGlvbiByZWZsZWN0cyB0aGVcbiAgLy8gYmVoYXZpb3Igb2YgTlZEQSAyMDIwLjIvRmlyZWZveCA4MSBhbmQgaU9TIFZvaWNlT3Zlci9TYWZhcmkgMTMuNi5cbiAgdmFyIGFzc2lnbmVkTm9kZXMgPSBzbG90LmFzc2lnbmVkTm9kZXMoKTtcbiAgaWYgKGFzc2lnbmVkTm9kZXMubGVuZ3RoID09PSAwKSB7XG4gICAgLy8gaWYgbm8gbm9kZXMgYXJlIGFzc2lnbmVkIHRvIHRoZSBzbG90LCBpdCBkaXNwbGF5cyB0aGUgZGVmYXVsdCBjb250ZW50XG4gICAgcmV0dXJuICgwLCBfYXJyYXkuZGVmYXVsdCkoc2xvdC5jaGlsZE5vZGVzKTtcbiAgfVxuICByZXR1cm4gYXNzaWduZWROb2Rlcztcbn1cblxuLyoqXG4gKiBpbXBsZW1lbnRzIGh0dHBzOi8vdzNjLmdpdGh1Yi5pby9hY2NuYW1lLyNtYXBwaW5nX2FkZGl0aW9uYWxfbmRfdGVcbiAqIEBwYXJhbSByb290XG4gKiBAcGFyYW0gb3B0aW9uc1xuICogQHJldHVybnNcbiAqL1xuZnVuY3Rpb24gY29tcHV0ZVRleHRBbHRlcm5hdGl2ZShyb290KSB7XG4gIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgdmFyIGNvbnN1bHRlZE5vZGVzID0gbmV3IF9TZXRMaWtlLmRlZmF1bHQoKTtcbiAgdmFyIHdpbmRvdyA9ICgwLCBfdXRpbC5zYWZlV2luZG93KShyb290KTtcbiAgdmFyIF9vcHRpb25zJGNvbXB1dGUgPSBvcHRpb25zLmNvbXB1dGUsXG4gICAgY29tcHV0ZSA9IF9vcHRpb25zJGNvbXB1dGUgPT09IHZvaWQgMCA/IFwibmFtZVwiIDogX29wdGlvbnMkY29tcHV0ZSxcbiAgICBfb3B0aW9ucyRjb21wdXRlZFN0eWwgPSBvcHRpb25zLmNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzLFxuICAgIGNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzID0gX29wdGlvbnMkY29tcHV0ZWRTdHlsID09PSB2b2lkIDAgPyBvcHRpb25zLmdldENvbXB1dGVkU3R5bGUgIT09IHVuZGVmaW5lZCA6IF9vcHRpb25zJGNvbXB1dGVkU3R5bCxcbiAgICBfb3B0aW9ucyRnZXRDb21wdXRlZFMgPSBvcHRpb25zLmdldENvbXB1dGVkU3R5bGUsXG4gICAgZ2V0Q29tcHV0ZWRTdHlsZSA9IF9vcHRpb25zJGdldENvbXB1dGVkUyA9PT0gdm9pZCAwID8gd2luZG93LmdldENvbXB1dGVkU3R5bGUuYmluZCh3aW5kb3cpIDogX29wdGlvbnMkZ2V0Q29tcHV0ZWRTLFxuICAgIF9vcHRpb25zJGhpZGRlbiA9IG9wdGlvbnMuaGlkZGVuLFxuICAgIGhpZGRlbiA9IF9vcHRpb25zJGhpZGRlbiA9PT0gdm9pZCAwID8gZmFsc2UgOiBfb3B0aW9ucyRoaWRkZW47XG5cbiAgLy8gMkYuaVxuICBmdW5jdGlvbiBjb21wdXRlTWlzY1RleHRBbHRlcm5hdGl2ZShub2RlLCBjb250ZXh0KSB7XG4gICAgdmFyIGFjY3VtdWxhdGVkVGV4dCA9IFwiXCI7XG4gICAgaWYgKCgwLCBfdXRpbC5pc0VsZW1lbnQpKG5vZGUpICYmIGNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzKSB7XG4gICAgICB2YXIgcHNldWRvQmVmb3JlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCBcIjo6YmVmb3JlXCIpO1xuICAgICAgdmFyIGJlZm9yZUNvbnRlbnQgPSBnZXRUZXh0dWFsQ29udGVudChwc2V1ZG9CZWZvcmUpO1xuICAgICAgYWNjdW11bGF0ZWRUZXh0ID0gXCJcIi5jb25jYXQoYmVmb3JlQ29udGVudCwgXCIgXCIpLmNvbmNhdChhY2N1bXVsYXRlZFRleHQpO1xuICAgIH1cblxuICAgIC8vIEZJWE1FOiBJbmNsdWRpbmcgYXJpYS1vd25zIGlzIG5vdCBkZWZpbmVkIGluIHRoZSBzcGVjXG4gICAgLy8gQnV0IGl0IGlzIHJlcXVpcmVkIGluIHRoZSB3ZWItcGxhdGZvcm0tdGVzdFxuICAgIHZhciBjaGlsZE5vZGVzID0gKDAsIF91dGlsLmlzSFRNTFNsb3RFbGVtZW50KShub2RlKSA/IGdldFNsb3RDb250ZW50cyhub2RlKSA6ICgwLCBfYXJyYXkuZGVmYXVsdCkobm9kZS5jaGlsZE5vZGVzKS5jb25jYXQoKDAsIF91dGlsLnF1ZXJ5SWRSZWZzKShub2RlLCBcImFyaWEtb3duc1wiKSk7XG4gICAgY2hpbGROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgdmFyIHJlc3VsdCA9IGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUoY2hpbGQsIHtcbiAgICAgICAgaXNFbWJlZGRlZEluTGFiZWw6IGNvbnRleHQuaXNFbWJlZGRlZEluTGFiZWwsXG4gICAgICAgIGlzUmVmZXJlbmNlZDogZmFsc2UsXG4gICAgICAgIHJlY3Vyc2lvbjogdHJ1ZVxuICAgICAgfSk7XG4gICAgICAvLyBUT0RPOiBVbmNsZWFyIHdoeSBkaXNwbGF5IGFmZmVjdHMgZGVsaW1pdGVyXG4gICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3czYy9hY2NuYW1lL2lzc3Vlcy8zXG4gICAgICB2YXIgZGlzcGxheSA9ICgwLCBfdXRpbC5pc0VsZW1lbnQpKGNoaWxkKSA/IGdldENvbXB1dGVkU3R5bGUoY2hpbGQpLmdldFByb3BlcnR5VmFsdWUoXCJkaXNwbGF5XCIpIDogXCJpbmxpbmVcIjtcbiAgICAgIHZhciBzZXBhcmF0b3IgPSBkaXNwbGF5ICE9PSBcImlubGluZVwiID8gXCIgXCIgOiBcIlwiO1xuICAgICAgLy8gdHJhaWxpbmcgc2VwYXJhdG9yIGZvciB3cHQgdGVzdHNcbiAgICAgIGFjY3VtdWxhdGVkVGV4dCArPSBcIlwiLmNvbmNhdChzZXBhcmF0b3IpLmNvbmNhdChyZXN1bHQpLmNvbmNhdChzZXBhcmF0b3IpO1xuICAgIH0pO1xuICAgIGlmICgoMCwgX3V0aWwuaXNFbGVtZW50KShub2RlKSAmJiBjb21wdXRlZFN0eWxlU3VwcG9ydHNQc2V1ZG9FbGVtZW50cykge1xuICAgICAgdmFyIHBzZXVkb0FmdGVyID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCBcIjo6YWZ0ZXJcIik7XG4gICAgICB2YXIgYWZ0ZXJDb250ZW50ID0gZ2V0VGV4dHVhbENvbnRlbnQocHNldWRvQWZ0ZXIpO1xuICAgICAgYWNjdW11bGF0ZWRUZXh0ID0gXCJcIi5jb25jYXQoYWNjdW11bGF0ZWRUZXh0LCBcIiBcIikuY29uY2F0KGFmdGVyQ29udGVudCk7XG4gICAgfVxuICAgIHJldHVybiBhY2N1bXVsYXRlZFRleHQudHJpbSgpO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSBlbGVtZW50XG4gICAqIEBwYXJhbSBhdHRyaWJ1dGVOYW1lXG4gICAqIEByZXR1cm5zIEEgc3RyaW5nIG5vbi1lbXB0eSBzdHJpbmcgb3IgYG51bGxgXG4gICAqL1xuICBmdW5jdGlvbiB1c2VBdHRyaWJ1dGUoZWxlbWVudCwgYXR0cmlidXRlTmFtZSkge1xuICAgIHZhciBhdHRyaWJ1dGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZU5vZGUoYXR0cmlidXRlTmFtZSk7XG4gICAgaWYgKGF0dHJpYnV0ZSAhPT0gbnVsbCAmJiAhY29uc3VsdGVkTm9kZXMuaGFzKGF0dHJpYnV0ZSkgJiYgYXR0cmlidXRlLnZhbHVlLnRyaW0oKSAhPT0gXCJcIikge1xuICAgICAgY29uc3VsdGVkTm9kZXMuYWRkKGF0dHJpYnV0ZSk7XG4gICAgICByZXR1cm4gYXR0cmlidXRlLnZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBmdW5jdGlvbiBjb21wdXRlVG9vbHRpcEF0dHJpYnV0ZVZhbHVlKG5vZGUpIHtcbiAgICBpZiAoISgwLCBfdXRpbC5pc0VsZW1lbnQpKG5vZGUpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHVzZUF0dHJpYnV0ZShub2RlLCBcInRpdGxlXCIpO1xuICB9XG4gIGZ1bmN0aW9uIGNvbXB1dGVFbGVtZW50VGV4dEFsdGVybmF0aXZlKG5vZGUpIHtcbiAgICBpZiAoISgwLCBfdXRpbC5pc0VsZW1lbnQpKG5vZGUpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBodHRwczovL3czYy5naXRodWIuaW8vaHRtbC1hYW0vI2ZpZWxkc2V0LWFuZC1sZWdlbmQtZWxlbWVudHNcbiAgICBpZiAoKDAsIF91dGlsLmlzSFRNTEZpZWxkU2V0RWxlbWVudCkobm9kZSkpIHtcbiAgICAgIGNvbnN1bHRlZE5vZGVzLmFkZChub2RlKTtcbiAgICAgIHZhciBjaGlsZHJlbiA9ICgwLCBfYXJyYXkuZGVmYXVsdCkobm9kZS5jaGlsZE5vZGVzKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgdmFyIGNoaWxkID0gY2hpbGRyZW5baV07XG4gICAgICAgIGlmICgoMCwgX3V0aWwuaXNIVE1MTGVnZW5kRWxlbWVudCkoY2hpbGQpKSB7XG4gICAgICAgICAgcmV0dXJuIGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUoY2hpbGQsIHtcbiAgICAgICAgICAgIGlzRW1iZWRkZWRJbkxhYmVsOiBmYWxzZSxcbiAgICAgICAgICAgIGlzUmVmZXJlbmNlZDogZmFsc2UsXG4gICAgICAgICAgICByZWN1cnNpb246IGZhbHNlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCgwLCBfdXRpbC5pc0hUTUxUYWJsZUVsZW1lbnQpKG5vZGUpKSB7XG4gICAgICAvLyBodHRwczovL3czYy5naXRodWIuaW8vaHRtbC1hYW0vI3RhYmxlLWVsZW1lbnRcbiAgICAgIGNvbnN1bHRlZE5vZGVzLmFkZChub2RlKTtcbiAgICAgIHZhciBfY2hpbGRyZW4gPSAoMCwgX2FycmF5LmRlZmF1bHQpKG5vZGUuY2hpbGROb2Rlcyk7XG4gICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgX2NoaWxkcmVuLmxlbmd0aDsgX2kgKz0gMSkge1xuICAgICAgICB2YXIgX2NoaWxkID0gX2NoaWxkcmVuW19pXTtcbiAgICAgICAgaWYgKCgwLCBfdXRpbC5pc0hUTUxUYWJsZUNhcHRpb25FbGVtZW50KShfY2hpbGQpKSB7XG4gICAgICAgICAgcmV0dXJuIGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUoX2NoaWxkLCB7XG4gICAgICAgICAgICBpc0VtYmVkZGVkSW5MYWJlbDogZmFsc2UsXG4gICAgICAgICAgICBpc1JlZmVyZW5jZWQ6IGZhbHNlLFxuICAgICAgICAgICAgcmVjdXJzaW9uOiBmYWxzZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICgoMCwgX3V0aWwuaXNTVkdTVkdFbGVtZW50KShub2RlKSkge1xuICAgICAgLy8gaHR0cHM6Ly93d3cudzMub3JnL1RSL3N2Zy1hYW0tMS4wL1xuICAgICAgY29uc3VsdGVkTm9kZXMuYWRkKG5vZGUpO1xuICAgICAgdmFyIF9jaGlsZHJlbjIgPSAoMCwgX2FycmF5LmRlZmF1bHQpKG5vZGUuY2hpbGROb2Rlcyk7XG4gICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBfY2hpbGRyZW4yLmxlbmd0aDsgX2kyICs9IDEpIHtcbiAgICAgICAgdmFyIF9jaGlsZDIgPSBfY2hpbGRyZW4yW19pMl07XG4gICAgICAgIGlmICgoMCwgX3V0aWwuaXNTVkdUaXRsZUVsZW1lbnQpKF9jaGlsZDIpKSB7XG4gICAgICAgICAgcmV0dXJuIF9jaGlsZDIudGV4dENvbnRlbnQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0gZWxzZSBpZiAoKDAsIF91dGlsLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwiaW1nXCIgfHwgKDAsIF91dGlsLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwiYXJlYVwiKSB7XG4gICAgICAvLyBodHRwczovL3czYy5naXRodWIuaW8vaHRtbC1hYW0vI2FyZWEtZWxlbWVudFxuICAgICAgLy8gaHR0cHM6Ly93M2MuZ2l0aHViLmlvL2h0bWwtYWFtLyNpbWctZWxlbWVudFxuICAgICAgdmFyIG5hbWVGcm9tQWx0ID0gdXNlQXR0cmlidXRlKG5vZGUsIFwiYWx0XCIpO1xuICAgICAgaWYgKG5hbWVGcm9tQWx0ICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBuYW1lRnJvbUFsdDtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCgwLCBfdXRpbC5pc0hUTUxPcHRHcm91cEVsZW1lbnQpKG5vZGUpKSB7XG4gICAgICB2YXIgbmFtZUZyb21MYWJlbCA9IHVzZUF0dHJpYnV0ZShub2RlLCBcImxhYmVsXCIpO1xuICAgICAgaWYgKG5hbWVGcm9tTGFiZWwgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG5hbWVGcm9tTGFiZWw7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICgoMCwgX3V0aWwuaXNIVE1MSW5wdXRFbGVtZW50KShub2RlKSAmJiAobm9kZS50eXBlID09PSBcImJ1dHRvblwiIHx8IG5vZGUudHlwZSA9PT0gXCJzdWJtaXRcIiB8fCBub2RlLnR5cGUgPT09IFwicmVzZXRcIikpIHtcbiAgICAgIC8vIGh0dHBzOi8vdzNjLmdpdGh1Yi5pby9odG1sLWFhbS8jaW5wdXQtdHlwZS10ZXh0LWlucHV0LXR5cGUtcGFzc3dvcmQtaW5wdXQtdHlwZS1zZWFyY2gtaW5wdXQtdHlwZS10ZWwtaW5wdXQtdHlwZS1lbWFpbC1pbnB1dC10eXBlLXVybC1hbmQtdGV4dGFyZWEtZWxlbWVudC1hY2Nlc3NpYmxlLWRlc2NyaXB0aW9uLWNvbXB1dGF0aW9uXG4gICAgICB2YXIgbmFtZUZyb21WYWx1ZSA9IHVzZUF0dHJpYnV0ZShub2RlLCBcInZhbHVlXCIpO1xuICAgICAgaWYgKG5hbWVGcm9tVmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG5hbWVGcm9tVmFsdWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFRPRE86IGwxMG5cbiAgICAgIGlmIChub2RlLnR5cGUgPT09IFwic3VibWl0XCIpIHtcbiAgICAgICAgcmV0dXJuIFwiU3VibWl0XCI7XG4gICAgICB9XG4gICAgICAvLyBUT0RPOiBsMTBuXG4gICAgICBpZiAobm9kZS50eXBlID09PSBcInJlc2V0XCIpIHtcbiAgICAgICAgcmV0dXJuIFwiUmVzZXRcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIGxhYmVscyA9IGdldExhYmVscyhub2RlKTtcbiAgICBpZiAobGFiZWxzICE9PSBudWxsICYmIGxhYmVscy5sZW5ndGggIT09IDApIHtcbiAgICAgIGNvbnN1bHRlZE5vZGVzLmFkZChub2RlKTtcbiAgICAgIHJldHVybiAoMCwgX2FycmF5LmRlZmF1bHQpKGxhYmVscykubWFwKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBjb21wdXRlVGV4dEFsdGVybmF0aXZlKGVsZW1lbnQsIHtcbiAgICAgICAgICBpc0VtYmVkZGVkSW5MYWJlbDogdHJ1ZSxcbiAgICAgICAgICBpc1JlZmVyZW5jZWQ6IGZhbHNlLFxuICAgICAgICAgIHJlY3Vyc2lvbjogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAobGFiZWwpIHtcbiAgICAgICAgcmV0dXJuIGxhYmVsLmxlbmd0aCA+IDA7XG4gICAgICB9KS5qb2luKFwiIFwiKTtcbiAgICB9XG5cbiAgICAvLyBodHRwczovL3czYy5naXRodWIuaW8vaHRtbC1hYW0vI2lucHV0LXR5cGUtaW1hZ2UtYWNjZXNzaWJsZS1uYW1lLWNvbXB1dGF0aW9uXG4gICAgLy8gVE9ETzogd3B0IHRlc3QgY29uc2lkZXIgbGFiZWwgZWxlbWVudHMgYnV0IGh0bWwtYWFtIGRvZXMgbm90IG1lbnRpb24gdGhlbVxuICAgIC8vIFdlIGZvbGxvdyBleGlzdGluZyBpbXBsZW1lbnRhdGlvbnMgb3ZlciBzcGVjXG4gICAgaWYgKCgwLCBfdXRpbC5pc0hUTUxJbnB1dEVsZW1lbnQpKG5vZGUpICYmIG5vZGUudHlwZSA9PT0gXCJpbWFnZVwiKSB7XG4gICAgICB2YXIgX25hbWVGcm9tQWx0ID0gdXNlQXR0cmlidXRlKG5vZGUsIFwiYWx0XCIpO1xuICAgICAgaWYgKF9uYW1lRnJvbUFsdCAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gX25hbWVGcm9tQWx0O1xuICAgICAgfVxuICAgICAgdmFyIG5hbWVGcm9tVGl0bGUgPSB1c2VBdHRyaWJ1dGUobm9kZSwgXCJ0aXRsZVwiKTtcbiAgICAgIGlmIChuYW1lRnJvbVRpdGxlICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBuYW1lRnJvbVRpdGxlO1xuICAgICAgfVxuXG4gICAgICAvLyBUT0RPOiBsMTBuXG4gICAgICByZXR1cm4gXCJTdWJtaXQgUXVlcnlcIjtcbiAgICB9XG4gICAgaWYgKCgwLCBfdXRpbC5oYXNBbnlDb25jcmV0ZVJvbGVzKShub2RlLCBbXCJidXR0b25cIl0pKSB7XG4gICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvaHRtbC1hYW0tMS4wLyNidXR0b24tZWxlbWVudFxuICAgICAgdmFyIG5hbWVGcm9tU3ViVHJlZSA9IGNvbXB1dGVNaXNjVGV4dEFsdGVybmF0aXZlKG5vZGUsIHtcbiAgICAgICAgaXNFbWJlZGRlZEluTGFiZWw6IGZhbHNlLFxuICAgICAgICBpc1JlZmVyZW5jZWQ6IGZhbHNlXG4gICAgICB9KTtcbiAgICAgIGlmIChuYW1lRnJvbVN1YlRyZWUgIT09IFwiXCIpIHtcbiAgICAgICAgcmV0dXJuIG5hbWVGcm9tU3ViVHJlZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgZnVuY3Rpb24gY29tcHV0ZVRleHRBbHRlcm5hdGl2ZShjdXJyZW50LCBjb250ZXh0KSB7XG4gICAgaWYgKGNvbnN1bHRlZE5vZGVzLmhhcyhjdXJyZW50KSkge1xuICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuXG4gICAgLy8gMkFcbiAgICBpZiAoIWhpZGRlbiAmJiBpc0hpZGRlbihjdXJyZW50LCBnZXRDb21wdXRlZFN0eWxlKSAmJiAhY29udGV4dC5pc1JlZmVyZW5jZWQpIHtcbiAgICAgIGNvbnN1bHRlZE5vZGVzLmFkZChjdXJyZW50KTtcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cblxuICAgIC8vIDJCXG4gICAgdmFyIGxhYmVsQXR0cmlidXRlTm9kZSA9ICgwLCBfdXRpbC5pc0VsZW1lbnQpKGN1cnJlbnQpID8gY3VycmVudC5nZXRBdHRyaWJ1dGVOb2RlKFwiYXJpYS1sYWJlbGxlZGJ5XCIpIDogbnVsbDtcbiAgICAvLyBUT0RPOiBEbyB3ZSBnZW5lcmFsbHkgbmVlZCB0byBibG9jayBxdWVyeSBJZFJlZnMgb2YgYXR0cmlidXRlcyB3ZSBoYXZlIGFscmVhZHkgY29uc3VsdGVkP1xuICAgIHZhciBsYWJlbEVsZW1lbnRzID0gbGFiZWxBdHRyaWJ1dGVOb2RlICE9PSBudWxsICYmICFjb25zdWx0ZWROb2Rlcy5oYXMobGFiZWxBdHRyaWJ1dGVOb2RlKSA/ICgwLCBfdXRpbC5xdWVyeUlkUmVmcykoY3VycmVudCwgXCJhcmlhLWxhYmVsbGVkYnlcIikgOiBbXTtcbiAgICBpZiAoY29tcHV0ZSA9PT0gXCJuYW1lXCIgJiYgIWNvbnRleHQuaXNSZWZlcmVuY2VkICYmIGxhYmVsRWxlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb24gLS0gQ2FuJ3QgYmUgbnVsbCBoZXJlIG90aGVyd2lzZSBsYWJlbEVsZW1lbnRzIHdvdWxkIGJlIGVtcHR5XG4gICAgICBjb25zdWx0ZWROb2Rlcy5hZGQobGFiZWxBdHRyaWJ1dGVOb2RlKTtcbiAgICAgIHJldHVybiBsYWJlbEVsZW1lbnRzLm1hcChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAvLyBUT0RPOiBDaHJvbWUgd2lsbCBjb25zaWRlciByZXBlYXRlZCB2YWx1ZXMgaS5lLiB1c2UgYSBub2RlIG11bHRpcGxlIHRpbWVzIHdoaWxlIHdlJ2xsIGJhaWwgb3V0IGluIGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUuXG4gICAgICAgIHJldHVybiBjb21wdXRlVGV4dEFsdGVybmF0aXZlKGVsZW1lbnQsIHtcbiAgICAgICAgICBpc0VtYmVkZGVkSW5MYWJlbDogY29udGV4dC5pc0VtYmVkZGVkSW5MYWJlbCxcbiAgICAgICAgICBpc1JlZmVyZW5jZWQ6IHRydWUsXG4gICAgICAgICAgLy8gdGhpcyBpc24ndCByZWN1cnNpb24gYXMgc3BlY2lmaWVkLCBvdGhlcndpc2Ugd2Ugd291bGQgc2tpcFxuICAgICAgICAgIC8vIGBhcmlhLWxhYmVsYCBpblxuICAgICAgICAgIC8vIDxpbnB1dCBpZD1cIm15c2VsZlwiIGFyaWEtbGFiZWw9XCJmb29cIiBhcmlhLWxhYmVsbGVkYnk9XCJteXNlbGZcIlxuICAgICAgICAgIHJlY3Vyc2lvbjogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICB9KS5qb2luKFwiIFwiKTtcbiAgICB9XG5cbiAgICAvLyAyQ1xuICAgIC8vIENoYW5nZWQgZnJvbSB0aGUgc3BlYyBpbiBhbnRpY2lwYXRpb24gb2YgaHR0cHM6Ly9naXRodWIuY29tL3czYy9hY2NuYW1lL2lzc3Vlcy82NFxuICAgIC8vIHNwZWMgc2F5cyB3ZSBzaG91bGQgb25seSBjb25zaWRlciBza2lwcGluZyBpZiB3ZSBoYXZlIGEgbm9uLWVtcHR5IGxhYmVsXG4gICAgdmFyIHNraXBUb1N0ZXAyRSA9IGNvbnRleHQucmVjdXJzaW9uICYmIGlzQ29udHJvbChjdXJyZW50KSAmJiBjb21wdXRlID09PSBcIm5hbWVcIjtcbiAgICBpZiAoIXNraXBUb1N0ZXAyRSkge1xuICAgICAgdmFyIGFyaWFMYWJlbCA9ICgoMCwgX3V0aWwuaXNFbGVtZW50KShjdXJyZW50KSAmJiBjdXJyZW50LmdldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIikgfHwgXCJcIikudHJpbSgpO1xuICAgICAgaWYgKGFyaWFMYWJlbCAhPT0gXCJcIiAmJiBjb21wdXRlID09PSBcIm5hbWVcIikge1xuICAgICAgICBjb25zdWx0ZWROb2Rlcy5hZGQoY3VycmVudCk7XG4gICAgICAgIHJldHVybiBhcmlhTGFiZWw7XG4gICAgICB9XG5cbiAgICAgIC8vIDJEXG4gICAgICBpZiAoIWlzTWFya2VkUHJlc2VudGF0aW9uYWwoY3VycmVudCkpIHtcbiAgICAgICAgdmFyIGVsZW1lbnRUZXh0QWx0ZXJuYXRpdmUgPSBjb21wdXRlRWxlbWVudFRleHRBbHRlcm5hdGl2ZShjdXJyZW50KTtcbiAgICAgICAgaWYgKGVsZW1lbnRUZXh0QWx0ZXJuYXRpdmUgIT09IG51bGwpIHtcbiAgICAgICAgICBjb25zdWx0ZWROb2Rlcy5hZGQoY3VycmVudCk7XG4gICAgICAgICAgcmV0dXJuIGVsZW1lbnRUZXh0QWx0ZXJuYXRpdmU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBzcGVjaWFsIGNhc2luZywgY2hlYXRpbmcgdG8gbWFrZSB0ZXN0cyBwYXNzXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3czYy9hY2NuYW1lL2lzc3Vlcy82N1xuICAgIGlmICgoMCwgX3V0aWwuaGFzQW55Q29uY3JldGVSb2xlcykoY3VycmVudCwgW1wibWVudVwiXSkpIHtcbiAgICAgIGNvbnN1bHRlZE5vZGVzLmFkZChjdXJyZW50KTtcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cblxuICAgIC8vIDJFXG4gICAgaWYgKHNraXBUb1N0ZXAyRSB8fCBjb250ZXh0LmlzRW1iZWRkZWRJbkxhYmVsIHx8IGNvbnRleHQuaXNSZWZlcmVuY2VkKSB7XG4gICAgICBpZiAoKDAsIF91dGlsLmhhc0FueUNvbmNyZXRlUm9sZXMpKGN1cnJlbnQsIFtcImNvbWJvYm94XCIsIFwibGlzdGJveFwiXSkpIHtcbiAgICAgICAgY29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuICAgICAgICB2YXIgc2VsZWN0ZWRPcHRpb25zID0gcXVlcnlTZWxlY3RlZE9wdGlvbnMoY3VycmVudCk7XG4gICAgICAgIGlmIChzZWxlY3RlZE9wdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgLy8gZGVmaW5lZCBwZXIgdGVzdCBgbmFtZV9oZWFkaW5nX2NvbWJvYm94YFxuICAgICAgICAgIHJldHVybiAoMCwgX3V0aWwuaXNIVE1MSW5wdXRFbGVtZW50KShjdXJyZW50KSA/IGN1cnJlbnQudmFsdWUgOiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoMCwgX2FycmF5LmRlZmF1bHQpKHNlbGVjdGVkT3B0aW9ucykubWFwKGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbikge1xuICAgICAgICAgIHJldHVybiBjb21wdXRlVGV4dEFsdGVybmF0aXZlKHNlbGVjdGVkT3B0aW9uLCB7XG4gICAgICAgICAgICBpc0VtYmVkZGVkSW5MYWJlbDogY29udGV4dC5pc0VtYmVkZGVkSW5MYWJlbCxcbiAgICAgICAgICAgIGlzUmVmZXJlbmNlZDogZmFsc2UsXG4gICAgICAgICAgICByZWN1cnNpb246IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSkuam9pbihcIiBcIik7XG4gICAgICB9XG4gICAgICBpZiAoaGFzQWJzdHJhY3RSb2xlKGN1cnJlbnQsIFwicmFuZ2VcIikpIHtcbiAgICAgICAgY29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuICAgICAgICBpZiAoY3VycmVudC5oYXNBdHRyaWJ1dGUoXCJhcmlhLXZhbHVldGV4dFwiKSkge1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uIC0tIHNhZmUgZHVlIHRvIGhhc0F0dHJpYnV0ZSBndWFyZFxuICAgICAgICAgIHJldHVybiBjdXJyZW50LmdldEF0dHJpYnV0ZShcImFyaWEtdmFsdWV0ZXh0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50Lmhhc0F0dHJpYnV0ZShcImFyaWEtdmFsdWVub3dcIikpIHtcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvbiAtLSBzYWZlIGR1ZSB0byBoYXNBdHRyaWJ1dGUgZ3VhcmRcbiAgICAgICAgICByZXR1cm4gY3VycmVudC5nZXRBdHRyaWJ1dGUoXCJhcmlhLXZhbHVlbm93XCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIE90aGVyd2lzZSwgdXNlIHRoZSB2YWx1ZSBhcyBzcGVjaWZpZWQgYnkgYSBob3N0IGxhbmd1YWdlIGF0dHJpYnV0ZS5cbiAgICAgICAgcmV0dXJuIGN1cnJlbnQuZ2V0QXR0cmlidXRlKFwidmFsdWVcIikgfHwgXCJcIjtcbiAgICAgIH1cbiAgICAgIGlmICgoMCwgX3V0aWwuaGFzQW55Q29uY3JldGVSb2xlcykoY3VycmVudCwgW1widGV4dGJveFwiXSkpIHtcbiAgICAgICAgY29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuICAgICAgICByZXR1cm4gZ2V0VmFsdWVPZlRleHRib3goY3VycmVudCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gMkY6IGh0dHBzOi8vdzNjLmdpdGh1Yi5pby9hY2NuYW1lLyNzdGVwMkZcbiAgICBpZiAoYWxsb3dzTmFtZUZyb21Db250ZW50KGN1cnJlbnQpIHx8ICgwLCBfdXRpbC5pc0VsZW1lbnQpKGN1cnJlbnQpICYmIGNvbnRleHQuaXNSZWZlcmVuY2VkIHx8IGlzTmF0aXZlSG9zdExhbmd1YWdlVGV4dEFsdGVybmF0aXZlRWxlbWVudChjdXJyZW50KSB8fCBpc0Rlc2NlbmRhbnRPZk5hdGl2ZUhvc3RMYW5ndWFnZVRleHRBbHRlcm5hdGl2ZUVsZW1lbnQoY3VycmVudCkpIHtcbiAgICAgIHZhciBhY2N1bXVsYXRlZFRleHQyRiA9IGNvbXB1dGVNaXNjVGV4dEFsdGVybmF0aXZlKGN1cnJlbnQsIHtcbiAgICAgICAgaXNFbWJlZGRlZEluTGFiZWw6IGNvbnRleHQuaXNFbWJlZGRlZEluTGFiZWwsXG4gICAgICAgIGlzUmVmZXJlbmNlZDogZmFsc2VcbiAgICAgIH0pO1xuICAgICAgaWYgKGFjY3VtdWxhdGVkVGV4dDJGICE9PSBcIlwiKSB7XG4gICAgICAgIGNvbnN1bHRlZE5vZGVzLmFkZChjdXJyZW50KTtcbiAgICAgICAgcmV0dXJuIGFjY3VtdWxhdGVkVGV4dDJGO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY3VycmVudC5ub2RlVHlwZSA9PT0gY3VycmVudC5URVhUX05PREUpIHtcbiAgICAgIGNvbnN1bHRlZE5vZGVzLmFkZChjdXJyZW50KTtcbiAgICAgIHJldHVybiBjdXJyZW50LnRleHRDb250ZW50IHx8IFwiXCI7XG4gICAgfVxuICAgIGlmIChjb250ZXh0LnJlY3Vyc2lvbikge1xuICAgICAgY29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuICAgICAgcmV0dXJuIGNvbXB1dGVNaXNjVGV4dEFsdGVybmF0aXZlKGN1cnJlbnQsIHtcbiAgICAgICAgaXNFbWJlZGRlZEluTGFiZWw6IGNvbnRleHQuaXNFbWJlZGRlZEluTGFiZWwsXG4gICAgICAgIGlzUmVmZXJlbmNlZDogZmFsc2VcbiAgICAgIH0pO1xuICAgIH1cbiAgICB2YXIgdG9vbHRpcEF0dHJpYnV0ZVZhbHVlID0gY29tcHV0ZVRvb2x0aXBBdHRyaWJ1dGVWYWx1ZShjdXJyZW50KTtcbiAgICBpZiAodG9vbHRpcEF0dHJpYnV0ZVZhbHVlICE9PSBudWxsKSB7XG4gICAgICBjb25zdWx0ZWROb2Rlcy5hZGQoY3VycmVudCk7XG4gICAgICByZXR1cm4gdG9vbHRpcEF0dHJpYnV0ZVZhbHVlO1xuICAgIH1cblxuICAgIC8vIFRPRE8gc2hvdWxkIHRoaXMgYmUgcmVhY2hhYmxlP1xuICAgIGNvbnN1bHRlZE5vZGVzLmFkZChjdXJyZW50KTtcbiAgICByZXR1cm4gXCJcIjtcbiAgfVxuICByZXR1cm4gYXNGbGF0U3RyaW5nKGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUocm9vdCwge1xuICAgIGlzRW1iZWRkZWRJbkxhYmVsOiBmYWxzZSxcbiAgICAvLyBieSBzcGVjIGNvbXB1dGVBY2Nlc3NpYmxlRGVzY3JpcHRpb24gc3RhcnRzIHdpdGggdGhlIHJlZmVyZW5jZWQgZWxlbWVudHMgYXMgcm9vdHNcbiAgICBpc1JlZmVyZW5jZWQ6IGNvbXB1dGUgPT09IFwiZGVzY3JpcHRpb25cIixcbiAgICByZWN1cnNpb246IGZhbHNlXG4gIH0pKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFjY2Vzc2libGUtbmFtZS1hbmQtZGVzY3JpcHRpb24uanMubWFwIl0sInZlcnNpb24iOjN9