374a0d2a88fbb4f64f100eb57c4751c1
"use strict";
exports.__esModule = true;
exports.default = getRole;
exports.getLocalName = getLocalName;
// https://w3c.github.io/html-aria/#document-conformance-requirements-for-use-of-aria-attributes-in-html
/**
 * Safe Element.localName for all supported environments
 * @param element
 */
function getLocalName(element) {
    var _element$localName;
    return ( // eslint-disable-next-line no-restricted-properties -- actual guard for environments without localName
    (_element$localName = element.localName) !== null && _element$localName !== void 0 ? _element$localName :
        // eslint-disable-next-line no-restricted-properties -- required for the fallback
        element.tagName.toLowerCase());
}
var localNameToRoleMappings = {
    article: "article",
    aside: "complementary",
    button: "button",
    datalist: "listbox",
    dd: "definition",
    details: "group",
    dialog: "dialog",
    dt: "term",
    fieldset: "group",
    figure: "figure",
    // WARNING: Only with an accessible name
    form: "form",
    footer: "contentinfo",
    h1: "heading",
    h2: "heading",
    h3: "heading",
    h4: "heading",
    h5: "heading",
    h6: "heading",
    header: "banner",
    hr: "separator",
    html: "document",
    legend: "legend",
    li: "listitem",
    math: "math",
    main: "main",
    menu: "list",
    nav: "navigation",
    ol: "list",
    optgroup: "group",
    // WARNING: Only in certain context
    option: "option",
    output: "status",
    progress: "progressbar",
    // WARNING: Only with an accessible name
    section: "region",
    summary: "button",
    table: "table",
    tbody: "rowgroup",
    textarea: "textbox",
    tfoot: "rowgroup",
    // WARNING: Only in certain context
    td: "cell",
    th: "columnheader",
    thead: "rowgroup",
    tr: "row",
    ul: "list"
};
var prohibitedAttributes = {
    caption: new Set(["aria-label", "aria-labelledby"]),
    code: new Set(["aria-label", "aria-labelledby"]),
    deletion: new Set(["aria-label", "aria-labelledby"]),
    emphasis: new Set(["aria-label", "aria-labelledby"]),
    generic: new Set(["aria-label", "aria-labelledby", "aria-roledescription"]),
    insertion: new Set(["aria-label", "aria-labelledby"]),
    paragraph: new Set(["aria-label", "aria-labelledby"]),
    presentation: new Set(["aria-label", "aria-labelledby"]),
    strong: new Set(["aria-label", "aria-labelledby"]),
    subscript: new Set(["aria-label", "aria-labelledby"]),
    superscript: new Set(["aria-label", "aria-labelledby"])
};
/**
 *
 * @param element
 * @param role The role used for this element. This is specified to control whether you want to use the implicit or explicit role.
 */
function hasGlobalAriaAttributes(element, role) {
    // https://rawgit.com/w3c/aria/stable/#global_states
    // commented attributes are deprecated
    return ["aria-atomic", "aria-busy", "aria-controls", "aria-current", "aria-describedby", "aria-details",
        // "disabled",
        "aria-dropeffect",
        // "errormessage",
        "aria-flowto", "aria-grabbed",
        // "haspopup",
        "aria-hidden",
        // "invalid",
        "aria-keyshortcuts", "aria-label", "aria-labelledby", "aria-live", "aria-owns", "aria-relevant", "aria-roledescription"].some(function (attributeName) {
        var _prohibitedAttributes;
        return element.hasAttribute(attributeName) && !((_prohibitedAttributes = prohibitedAttributes[role]) !== null && _prohibitedAttributes !== void 0 && _prohibitedAttributes.has(attributeName));
    });
}
function ignorePresentationalRole(element, implicitRole) {
    // https://rawgit.com/w3c/aria/stable/#conflict_resolution_presentation_none
    return hasGlobalAriaAttributes(element, implicitRole);
}
function getRole(element) {
    var explicitRole = getExplicitRole(element);
    if (explicitRole === null || explicitRole === "presentation") {
        var implicitRole = getImplicitRole(element);
        if (explicitRole !== "presentation" || ignorePresentationalRole(element, implicitRole || "")) {
            return implicitRole;
        }
    }
    return explicitRole;
}
function getImplicitRole(element) {
    var mappedByTag = localNameToRoleMappings[getLocalName(element)];
    if (mappedByTag !== undefined) {
        return mappedByTag;
    }
    switch (getLocalName(element)) {
        case "a":
        case "area":
        case "link":
            if (element.hasAttribute("href")) {
                return "link";
            }
            break;
        case "img":
            if (element.getAttribute("alt") === "" && !ignorePresentationalRole(element, "img")) {
                return "presentation";
            }
            return "img";
        case "input":
            {
                var _ref = element, type = _ref.type;
                switch (type) {
                    case "button":
                    case "image":
                    case "reset":
                    case "submit":
                        return "button";
                    case "checkbox":
                    case "radio":
                        return type;
                    case "range":
                        return "slider";
                    case "email":
                    case "tel":
                    case "text":
                    case "url":
                        if (element.hasAttribute("list")) {
                            return "combobox";
                        }
                        return "textbox";
                    case "search":
                        if (element.hasAttribute("list")) {
                            return "combobox";
                        }
                        return "searchbox";
                    case "number":
                        return "spinbutton";
                    default:
                        return null;
                }
            }
        case "select":
            if (element.hasAttribute("multiple") || element.size > 1) {
                return "listbox";
            }
            return "combobox";
    }
    return null;
}
function getExplicitRole(element) {
    var role = element.getAttribute("role");
    if (role !== null) {
        var explicitRole = role.trim().split(" ")[0];
        // String.prototype.split(sep, limit) will always return an array with at least one member
        // as long as limit is either undefined or > 0
        if (explicitRole.length > 0) {
            return explicitRole;
        }
    }
    return null;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXG5vZGVfbW9kdWxlc1xcZG9tLWFjY2Vzc2liaWxpdHktYXBpXFxkaXN0XFxnZXRSb2xlLmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztBQUViLE9BQU8sQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO0FBQzFCLE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0FBQzFCLE9BQU8sQ0FBQyxZQUFZLEdBQUcsWUFBWSxDQUFDO0FBQ3BDLHdHQUF3RztBQUV4Rzs7O0dBR0c7QUFDSCxTQUFTLFlBQVksQ0FBQyxPQUFPO0lBQzNCLElBQUksa0JBQWtCLENBQUM7SUFDdkIsT0FBTyxFQUFDLHVHQUF1RztJQUM3RyxDQUFDLGtCQUFrQixHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsS0FBSyxJQUFJLElBQUksa0JBQWtCLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUM7UUFDekcsaUZBQWlGO1FBQ2pGLE9BQU8sQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLENBQzlCLENBQUM7QUFDSixDQUFDO0FBQ0QsSUFBSSx1QkFBdUIsR0FBRztJQUM1QixPQUFPLEVBQUUsU0FBUztJQUNsQixLQUFLLEVBQUUsZUFBZTtJQUN0QixNQUFNLEVBQUUsUUFBUTtJQUNoQixRQUFRLEVBQUUsU0FBUztJQUNuQixFQUFFLEVBQUUsWUFBWTtJQUNoQixPQUFPLEVBQUUsT0FBTztJQUNoQixNQUFNLEVBQUUsUUFBUTtJQUNoQixFQUFFLEVBQUUsTUFBTTtJQUNWLFFBQVEsRUFBRSxPQUFPO0lBQ2pCLE1BQU0sRUFBRSxRQUFRO0lBQ2hCLHdDQUF3QztJQUN4QyxJQUFJLEVBQUUsTUFBTTtJQUNaLE1BQU0sRUFBRSxhQUFhO0lBQ3JCLEVBQUUsRUFBRSxTQUFTO0lBQ2IsRUFBRSxFQUFFLFNBQVM7SUFDYixFQUFFLEVBQUUsU0FBUztJQUNiLEVBQUUsRUFBRSxTQUFTO0lBQ2IsRUFB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LE9BQU8sQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLElBQUksT0FBTyxDQUFDLElBQUksR0FBRyxDQUFDLEVBQUUsQ0FBQztnQkFDekQsT0FBTyxTQUFTLENBQUM7WUFDbkIsQ0FBQztZQUNELE9BQU8sVUFBVSxDQUFDO0lBQ3RCLENBQUM7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUM7QUFDRCxTQUFTLGVBQWUsQ0FBQyxPQUFPO0lBQzlCLElBQUksSUFBSSxHQUFHLE9BQU8sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDeEMsSUFBSSxJQUFJLEtBQUssSUFBSSxFQUFFLENBQUM7UUFDbEIsSUFBSSxZQUFZLEdBQUcsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3QywwRkFBMEY7UUFDMUYsOENBQThDO1FBQzlDLElBQUksWUFBWSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUM1QixPQUFPLFlBQVksQ0FBQztRQUN0QixDQUFDO0lBQ0gsQ0FBQztJQUNELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJEOlxcUHJvamVjdHNcXENhcmRFdmVyeXRoaW5nXFxjYXJkYWxsLXByb3RvdHlwZVxcbm9kZV9tb2R1bGVzXFxkb20tYWNjZXNzaWJpbGl0eS1hcGlcXGRpc3RcXGdldFJvbGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzLmRlZmF1bHQgPSBnZXRSb2xlO1xuZXhwb3J0cy5nZXRMb2NhbE5hbWUgPSBnZXRMb2NhbE5hbWU7XG4vLyBodHRwczovL3czYy5naXRodWIuaW8vaHRtbC1hcmlhLyNkb2N1bWVudC1jb25mb3JtYW5jZS1yZXF1aXJlbWVudHMtZm9yLXVzZS1vZi1hcmlhLWF0dHJpYnV0ZXMtaW4taHRtbFxuXG4vKipcbiAqIFNhZmUgRWxlbWVudC5sb2NhbE5hbWUgZm9yIGFsbCBzdXBwb3J0ZWQgZW52aXJvbm1lbnRzXG4gKiBAcGFyYW0gZWxlbWVudFxuICovXG5mdW5jdGlvbiBnZXRMb2NhbE5hbWUoZWxlbWVudCkge1xuICB2YXIgX2VsZW1lbnQkbG9jYWxOYW1lO1xuICByZXR1cm4gKC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXByb3BlcnRpZXMgLS0gYWN0dWFsIGd1YXJkIGZvciBlbnZpcm9ubWVudHMgd2l0aG91dCBsb2NhbE5hbWVcbiAgICAoX2VsZW1lbnQkbG9jYWxOYW1lID0gZWxlbWVudC5sb2NhbE5hbWUpICE9PSBudWxsICYmIF9lbGVtZW50JGxvY2FsTmFtZSAhPT0gdm9pZCAwID8gX2VsZW1lbnQkbG9jYWxOYW1lIDpcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1wcm9wZXJ0aWVzIC0tIHJlcXVpcmVkIGZvciB0aGUgZmFsbGJhY2tcbiAgICBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKVxuICApO1xufVxudmFyIGxvY2FsTmFtZVRvUm9sZU1hcHBpbmdzID0ge1xuICBhcnRpY2xlOiBcImFydGljbGVcIixcbiAgYXNpZGU6IFwiY29tcGxlbWVudGFyeVwiLFxuICBidXR0b246IFwiYnV0dG9uXCIsXG4gIGRhdGFsaXN0OiBcImxpc3Rib3hcIixcbiAgZGQ6IFwiZGVmaW5pdGlvblwiLFxuICBkZXRhaWxzOiBcImdyb3VwXCIsXG4gIGRpYWxvZzogXCJkaWFsb2dcIixcbiAgZHQ6IFwidGVybVwiLFxuICBmaWVsZHNldDogXCJncm91cFwiLFxuICBmaWd1cmU6IFwiZmlndXJlXCIsXG4gIC8vIFdBUk5JTkc6IE9ubHkgd2l0aCBhbiBhY2Nlc3NpYmxlIG5hbWVcbiAgZm9ybTogXCJmb3JtXCIsXG4gIGZvb3RlcjogXCJjb250ZW50aW5mb1wiLFxuICBoMTogXCJoZWFkaW5nXCIsXG4gIGgyOiBcImhlYWRpbmdcIixcbiAgaDM6IFwiaGVhZGluZ1wiLFxuICBoNDogXCJoZWFkaW5nXCIsXG4gIGg1OiBcImhlYWRpbmdcIixcbiAgaDY6IFwiaGVhZGluZ1wiLFxuICBoZWFkZXI6IFwiYmFubmVyXCIsXG4gIGhyOiBcInNlcGFyYXRvclwiLFxuICBodG1sOiBcImRvY3VtZW50XCIsXG4gIGxlZ2VuZDogXCJsZWdlbmRcIixcbiAgbGk6IFwibGlzdGl0ZW1cIixcbiAgbWF0aDogXCJtYXRoXCIsXG4gIG1haW46IFwibWFpblwiLFxuICBtZW51OiBcImxpc3RcIixcbiAgbmF2OiBcIm5hdmlnYXRpb25cIixcbiAgb2w6IFwibGlzdFwiLFxuICBvcHRncm91cDogXCJncm91cFwiLFxuICAvLyBXQVJOSU5HOiBPbmx5IGluIGNlcnRhaW4gY29udGV4dFxuICBvcHRpb246IFwib3B0aW9uXCIsXG4gIG91dHB1dDogXCJzdGF0dXNcIixcbiAgcHJvZ3Jlc3M6IFwicHJvZ3Jlc3NiYXJcIixcbiAgLy8gV0FSTklORzogT25seSB3aXRoIGFuIGFjY2Vzc2libGUgbmFtZVxuICBzZWN0aW9uOiBcInJlZ2lvblwiLFxuICBzdW1tYXJ5OiBcImJ1dHRvblwiLFxuICB0YWJsZTogXCJ0YWJsZVwiLFxuICB0Ym9keTogXCJyb3dncm91cFwiLFxuICB0ZXh0YXJlYTogXCJ0ZXh0Ym94XCIsXG4gIHRmb290OiBcInJvd2dyb3VwXCIsXG4gIC8vIFdBUk5JTkc6IE9ubHkgaW4gY2VydGFpbiBjb250ZXh0XG4gIHRkOiBcImNlbGxcIixcbiAgdGg6IFwiY29sdW1uaGVhZGVyXCIsXG4gIHRoZWFkOiBcInJvd2dyb3VwXCIsXG4gIHRyOiBcInJvd1wiLFxuICB1bDogXCJsaXN0XCJcbn07XG52YXIgcHJvaGliaXRlZEF0dHJpYnV0ZXMgPSB7XG4gIGNhcHRpb246IG5ldyBTZXQoW1wiYXJpYS1sYWJlbFwiLCBcImFyaWEtbGFiZWxsZWRieVwiXSksXG4gIGNvZGU6IG5ldyBTZXQoW1wiYXJpYS1sYWJlbFwiLCBcImFyaWEtbGFiZWxsZWRieVwiXSksXG4gIGRlbGV0aW9uOiBuZXcgU2V0KFtcImFyaWEtbGFiZWxcIiwgXCJhcmlhLWxhYmVsbGVkYnlcIl0pLFxuICBlbXBoYXNpczogbmV3IFNldChbXCJhcmlhLWxhYmVsXCIsIFwiYXJpYS1sYWJlbGxlZGJ5XCJdKSxcbiAgZ2VuZXJpYzogbmV3IFNldChbXCJhcmlhLWxhYmVsXCIsIFwiYXJpYS1sYWJlbGxlZGJ5XCIsIFwiYXJpYS1yb2xlZGVzY3JpcHRpb25cIl0pLFxuICBpbnNlcnRpb246IG5ldyBTZXQoW1wiYXJpYS1sYWJlbFwiLCBcImFyaWEtbGFiZWxsZWRieVwiXSksXG4gIHBhcmFncmFwaDogbmV3IFNldChbXCJhcmlhLWxhYmVsXCIsIFwiYXJpYS1sYWJlbGxlZGJ5XCJdKSxcbiAgcHJlc2VudGF0aW9uOiBuZXcgU2V0KFtcImFyaWEtbGFiZWxcIiwgXCJhcmlhLWxhYmVsbGVkYnlcIl0pLFxuICBzdHJvbmc6IG5ldyBTZXQoW1wiYXJpYS1sYWJlbFwiLCBcImFyaWEtbGFiZWxsZWRieVwiXSksXG4gIHN1YnNjcmlwdDogbmV3IFNldChbXCJhcmlhLWxhYmVsXCIsIFwiYXJpYS1sYWJlbGxlZGJ5XCJdKSxcbiAgc3VwZXJzY3JpcHQ6IG5ldyBTZXQoW1wiYXJpYS1sYWJlbFwiLCBcImFyaWEtbGFiZWxsZWRieVwiXSlcbn07XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBlbGVtZW50XG4gKiBAcGFyYW0gcm9sZSBUaGUgcm9sZSB1c2VkIGZvciB0aGlzIGVsZW1lbnQuIFRoaXMgaXMgc3BlY2lmaWVkIHRvIGNvbnRyb2wgd2hldGhlciB5b3Ugd2FudCB0byB1c2UgdGhlIGltcGxpY2l0IG9yIGV4cGxpY2l0IHJvbGUuXG4gKi9cbmZ1bmN0aW9uIGhhc0dsb2JhbEFyaWFBdHRyaWJ1dGVzKGVsZW1lbnQsIHJvbGUpIHtcbiAgLy8gaHR0cHM6Ly9yYXdnaXQuY29tL3czYy9hcmlhL3N0YWJsZS8jZ2xvYmFsX3N0YXRlc1xuICAvLyBjb21tZW50ZWQgYXR0cmlidXRlcyBhcmUgZGVwcmVjYXRlZFxuICByZXR1cm4gW1wiYXJpYS1hdG9taWNcIiwgXCJhcmlhLWJ1c3lcIiwgXCJhcmlhLWNvbnRyb2xzXCIsIFwiYXJpYS1jdXJyZW50XCIsIFwiYXJpYS1kZXNjcmliZWRieVwiLCBcImFyaWEtZGV0YWlsc1wiLFxuICAvLyBcImRpc2FibGVkXCIsXG4gIFwiYXJpYS1kcm9wZWZmZWN0XCIsXG4gIC8vIFwiZXJyb3JtZXNzYWdlXCIsXG4gIFwiYXJpYS1mbG93dG9cIiwgXCJhcmlhLWdyYWJiZWRcIixcbiAgLy8gXCJoYXNwb3B1cFwiLFxuICBcImFyaWEtaGlkZGVuXCIsXG4gIC8vIFwiaW52YWxpZFwiLFxuICBcImFyaWEta2V5c2hvcnRjdXRzXCIsIFwiYXJpYS1sYWJlbFwiLCBcImFyaWEtbGFiZWxsZWRieVwiLCBcImFyaWEtbGl2ZVwiLCBcImFyaWEtb3duc1wiLCBcImFyaWEtcmVsZXZhbnRcIiwgXCJhcmlhLXJvbGVkZXNjcmlwdGlvblwiXS5zb21lKGZ1bmN0aW9uIChhdHRyaWJ1dGVOYW1lKSB7XG4gICAgdmFyIF9wcm9oaWJpdGVkQXR0cmlidXRlcztcbiAgICByZXR1cm4gZWxlbWVudC5oYXNBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSkgJiYgISgoX3Byb2hpYml0ZWRBdHRyaWJ1dGVzID0gcHJvaGliaXRlZEF0dHJpYnV0ZXNbcm9sZV0pICE9PSBudWxsICYmIF9wcm9oaWJpdGVkQXR0cmlidXRlcyAhPT0gdm9pZCAwICYmIF9wcm9oaWJpdGVkQXR0cmlidXRlcy5oYXMoYXR0cmlidXRlTmFtZSkpO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGlnbm9yZVByZXNlbnRhdGlvbmFsUm9sZShlbGVtZW50LCBpbXBsaWNpdFJvbGUpIHtcbiAgLy8gaHR0cHM6Ly9yYXdnaXQuY29tL3czYy9hcmlhL3N0YWJsZS8jY29uZmxpY3RfcmVzb2x1dGlvbl9wcmVzZW50YXRpb25fbm9uZVxuICByZXR1cm4gaGFzR2xvYmFsQXJpYUF0dHJpYnV0ZXMoZWxlbWVudCwgaW1wbGljaXRSb2xlKTtcbn1cbmZ1bmN0aW9uIGdldFJvbGUoZWxlbWVudCkge1xuICB2YXIgZXhwbGljaXRSb2xlID0gZ2V0RXhwbGljaXRSb2xlKGVsZW1lbnQpO1xuICBpZiAoZXhwbGljaXRSb2xlID09PSBudWxsIHx8IGV4cGxpY2l0Um9sZSA9PT0gXCJwcmVzZW50YXRpb25cIikge1xuICAgIHZhciBpbXBsaWNpdFJvbGUgPSBnZXRJbXBsaWNpdFJvbGUoZWxlbWVudCk7XG4gICAgaWYgKGV4cGxpY2l0Um9sZSAhPT0gXCJwcmVzZW50YXRpb25cIiB8fCBpZ25vcmVQcmVzZW50YXRpb25hbFJvbGUoZWxlbWVudCwgaW1wbGljaXRSb2xlIHx8IFwiXCIpKSB7XG4gICAgICByZXR1cm4gaW1wbGljaXRSb2xlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZXhwbGljaXRSb2xlO1xufVxuZnVuY3Rpb24gZ2V0SW1wbGljaXRSb2xlKGVsZW1lbnQpIHtcbiAgdmFyIG1hcHBlZEJ5VGFnID0gbG9jYWxOYW1lVG9Sb2xlTWFwcGluZ3NbZ2V0TG9jYWxOYW1lKGVsZW1lbnQpXTtcbiAgaWYgKG1hcHBlZEJ5VGFnICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gbWFwcGVkQnlUYWc7XG4gIH1cbiAgc3dpdGNoIChnZXRMb2NhbE5hbWUoZWxlbWVudCkpIHtcbiAgICBjYXNlIFwiYVwiOlxuICAgIGNhc2UgXCJhcmVhXCI6XG4gICAgY2FzZSBcImxpbmtcIjpcbiAgICAgIGlmIChlbGVtZW50Lmhhc0F0dHJpYnV0ZShcImhyZWZcIikpIHtcbiAgICAgICAgcmV0dXJuIFwibGlua1wiO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImltZ1wiOlxuICAgICAgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiYWx0XCIpID09PSBcIlwiICYmICFpZ25vcmVQcmVzZW50YXRpb25hbFJvbGUoZWxlbWVudCwgXCJpbWdcIikpIHtcbiAgICAgICAgcmV0dXJuIFwicHJlc2VudGF0aW9uXCI7XG4gICAgICB9XG4gICAgICByZXR1cm4gXCJpbWdcIjtcbiAgICBjYXNlIFwiaW5wdXRcIjpcbiAgICAgIHtcbiAgICAgICAgdmFyIF9yZWYgPSBlbGVtZW50LFxuICAgICAgICAgIHR5cGUgPSBfcmVmLnR5cGU7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgIGNhc2UgXCJidXR0b25cIjpcbiAgICAgICAgICBjYXNlIFwiaW1hZ2VcIjpcbiAgICAgICAgICBjYXNlIFwicmVzZXRcIjpcbiAgICAgICAgICBjYXNlIFwic3VibWl0XCI6XG4gICAgICAgICAgICByZXR1cm4gXCJidXR0b25cIjtcbiAgICAgICAgICBjYXNlIFwiY2hlY2tib3hcIjpcbiAgICAgICAgICBjYXNlIFwicmFkaW9cIjpcbiAgICAgICAgICAgIHJldHVybiB0eXBlO1xuICAgICAgICAgIGNhc2UgXCJyYW5nZVwiOlxuICAgICAgICAgICAgcmV0dXJuIFwic2xpZGVyXCI7XG4gICAgICAgICAgY2FzZSBcImVtYWlsXCI6XG4gICAgICAgICAgY2FzZSBcInRlbFwiOlxuICAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICAgICAgY2FzZSBcInVybFwiOlxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKFwibGlzdFwiKSkge1xuICAgICAgICAgICAgICByZXR1cm4gXCJjb21ib2JveFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFwidGV4dGJveFwiO1xuICAgICAgICAgIGNhc2UgXCJzZWFyY2hcIjpcbiAgICAgICAgICAgIGlmIChlbGVtZW50Lmhhc0F0dHJpYnV0ZShcImxpc3RcIikpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFwiY29tYm9ib3hcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBcInNlYXJjaGJveFwiO1xuICAgICAgICAgIGNhc2UgXCJudW1iZXJcIjpcbiAgICAgICAgICAgIHJldHVybiBcInNwaW5idXR0b25cIjtcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBjYXNlIFwic2VsZWN0XCI6XG4gICAgICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJtdWx0aXBsZVwiKSB8fCBlbGVtZW50LnNpemUgPiAxKSB7XG4gICAgICAgIHJldHVybiBcImxpc3Rib3hcIjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBcImNvbWJvYm94XCI7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5mdW5jdGlvbiBnZXRFeHBsaWNpdFJvbGUoZWxlbWVudCkge1xuICB2YXIgcm9sZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwicm9sZVwiKTtcbiAgaWYgKHJvbGUgIT09IG51bGwpIHtcbiAgICB2YXIgZXhwbGljaXRSb2xlID0gcm9sZS50cmltKCkuc3BsaXQoXCIgXCIpWzBdO1xuICAgIC8vIFN0cmluZy5wcm90b3R5cGUuc3BsaXQoc2VwLCBsaW1pdCkgd2lsbCBhbHdheXMgcmV0dXJuIGFuIGFycmF5IHdpdGggYXQgbGVhc3Qgb25lIG1lbWJlclxuICAgIC8vIGFzIGxvbmcgYXMgbGltaXQgaXMgZWl0aGVyIHVuZGVmaW5lZCBvciA+IDBcbiAgICBpZiAoZXhwbGljaXRSb2xlLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBleHBsaWNpdFJvbGU7XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2V0Um9sZS5qcy5tYXAiXSwidmVyc2lvbiI6M30=