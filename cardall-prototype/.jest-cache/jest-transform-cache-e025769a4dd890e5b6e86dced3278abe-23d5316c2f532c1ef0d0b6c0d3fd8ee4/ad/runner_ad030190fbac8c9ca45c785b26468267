439c6a38eb84bace850b752fbf17c498
"use strict";
/*!
 * /**
 *  * Copyright (c) Meta Platforms, Inc. and affiliates.
 *  *
 *  * This source code is licensed under the MIT license found in the
 *  * LICENSE file in the root directory of this source tree.
 *  * /
 */
/******/ (() => {
    /******/ "use strict";
    /******/ var __webpack_modules__ = ({
        /***/ "./src/legacy-code-todo-rewrite/jestAdapter.ts": 
        /***/ ((__unused_webpack_module, exports) => {
            Object.defineProperty(exports, "__esModule", ({
                value: true
            }));
            exports["default"] = void 0;
            var _jestUtil = require("jest-util");
            var Symbol = globalThis['jest-symbol-do-not-touch'] || globalThis.Symbol;
            var Symbol = globalThis['jest-symbol-do-not-touch'] || globalThis.Symbol;
            var jestNow = globalThis[Symbol.for('jest-native-now')] || globalThis.Date.now;
            /**
             * Copyright (c) Meta Platforms, Inc. and affiliates.
             *
             * This source code is licensed under the MIT license found in the
             * LICENSE file in the root directory of this source tree.
             */
            const FRAMEWORK_INITIALIZER = require.resolve('./jestAdapterInit');
            const jestAdapter = async (globalConfig, config, environment, runtime, testPath, sendMessageToJest) => {
                const { initialize, runAndTransformResultsToJestFormat } = runtime.requireInternalModule(FRAMEWORK_INITIALIZER);
                const { globals, snapshotState } = await initialize({
                    config,
                    environment,
                    globalConfig,
                    localRequire: runtime.requireModule.bind(runtime),
                    parentProcess: process,
                    runtime,
                    sendMessageToJest,
                    setGlobalsForRuntime: runtime.setGlobalsForRuntime.bind(runtime),
                    testPath
                });
                if (config.fakeTimers.enableGlobally) {
                    if (config.fakeTimers.legacyFakeTimers) {
                        // during setup, this cannot be null (and it's fine to explode if it is)
                        environment.fakeTimers.useFakeTimers();
                    }
                    else {
                        environment.fakeTimersModern.useFakeTimers();
                    }
                }
                globals.beforeEach(() => {
                    if (config.resetModules) {
                        runtime.resetModules();
                    }
                    if (config.clearMocks) {
                        runtime.clearAllMocks();
                    }
                    if (config.resetMocks) {
                        runtime.resetAllMocks();
                        if (config.fakeTimers.enableGlobally && config.fakeTimers.legacyFakeTimers) {
                            // during setup, this cannot be null (and it's fine to explode if it is)
                            environment.fakeTimers.useFakeTimers();
                        }
                    }
                    if (config.restoreMocks) {
                        runtime.restoreAllMocks();
                    }
                });
                const setupAfterEnvStart = jestNow();
                for (const path of config.setupFilesAfterEnv) {
                    const esm = runtime.unstable_shouldLoadAsEsm(path);
                    if (esm) {
                        await runtime.unstable_importModule(path);
                    }
                    else {
                        const setupFile = runtime.requireModule(path);
                        if (typeof setupFile === 'function') {
                            await setupFile();
                        }
                    }
                }
                const setupAfterEnvEnd = jestNow();
                const esm = runtime.unstable_shouldLoadAsEsm(testPath);
                if (esm) {
                    await runtime.unstable_importModule(testPath);
                }
                else {
                    runtime.requireModule(testPath);
                }
                const setupAfterEnvPerfStats = {
                    setupAfterEnvEnd,
                    setupAfterEnvStart
                };
                const results = await runAndTransformResultsToJestFormat({
                    config,
                    globalConfig,
                    setupAfterEnvPerfStats,
                    testPath
                });
                _addSnapshotData(results, snapshotState);
                // We need to copy the results object to ensure we don't leaks the prototypes
                // from the VM. Jasmine creates the result objects in the parent process, we
                // should consider doing that for circus as well.
                return (0, _jestUtil.deepCyclicCopy)(results, {
                    keepPrototype: false
                });
            };
            const _addSnapshotData = (results, snapshotState) => {
                for (const { fullName, status, failing } of results.testResults) {
                    if (status === 'pending' || status === 'failed' || failing && status === 'passed') {
                        // If test is skipped or failed, we don't want to mark
                        // its snapshots as obsolete.
                        // When tests called with test.failing pass, they've thrown an exception,
                        // so maintain any snapshots after the error.
                        snapshotState.markSnapshotsAsCheckedForTest(fullName);
                    }
                }
                const uncheckedCount = snapshotState.getUncheckedCount();
                const uncheckedKeys = snapshotState.getUncheckedKeys();
                if (uncheckedCount) {
                    snapshotState.removeUncheckedKeys();
                }
                const status = snapshotState.save();
                results.snapshot.fileDeleted = status.deleted;
                results.snapshot.added = snapshotState.added;
                results.snapshot.matched = snapshotState.matched;
                results.snapshot.unmatched = snapshotState.unmatched;
                results.snapshot.updated = snapshotState.updated;
                results.snapshot.unchecked = status.deleted ? 0 : uncheckedCount;
                // Copy the array to prevent memory leaks
                results.snapshot.uncheckedKeys = [...uncheckedKeys];
            };
            var _default = exports["default"] = jestAdapter;
            /***/ 
        })
        /******/ 
    });
    /************************************************************************/
    /******/ // The module cache
    /******/ var __webpack_module_cache__ = {};
    /******/
    /******/ // The require function
    /******/ function __webpack_require__(moduleId) {
        /******/ // Check if module is in cache
        /******/ var cachedModule = __webpack_module_cache__[moduleId];
        /******/ if (cachedModule !== undefined) {
            /******/ return cachedModule.exports;
            /******/ }
        /******/ // Create a new module (and put it into the cache)
        /******/ var module = __webpack_module_cache__[moduleId] = {
            /******/ // no module.id needed
            /******/ // no module.loaded needed
            /******/ exports: {}
            /******/ 
        };
        /******/
        /******/ // Execute the module function
        /******/ __webpack_modules__[moduleId](module, module.exports, __webpack_require__);
        /******/
        /******/ // Return the exports of the module
        /******/ return module.exports;
        /******/ 
    }
    /******/
    /************************************************************************/
    var __webpack_exports__ = {};
    // This entry needs to be wrapped in an IIFE because it uses a non-standard name for the exports (exports).
    (() => {
        var exports = __webpack_exports__;
        Object.defineProperty(exports, "__esModule", ({
            value: true
        }));
        exports["default"] = void 0;
        var _jestAdapter = _interopRequireDefault(__webpack_require__("./src/legacy-code-todo-rewrite/jestAdapter.ts"));
        function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
        /**
         * Copyright (c) Meta Platforms, Inc. and affiliates.
         *
         * This source code is licensed under the MIT license found in the
         * LICENSE file in the root directory of this source tree.
         */
        // Allow people to use `jest-circus/runner` as a runner.
        var _default = exports["default"] = _jestAdapter.default;
    })();
    module.exports = __webpack_exports__;
    /******/ 
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXG5vZGVfbW9kdWxlc1xcamVzdC1jaXJjdXNcXGJ1aWxkXFxydW5uZXIuanMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7O0dBT0c7QUFDSCxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUU7SUFDZixRQUFRLENBQUUsWUFBWSxDQUFDO0lBQ3ZCLFFBQVEsQ0FBRSxJQUFJLG1CQUFtQixHQUFHLENBQUM7UUFFckMsS0FBSyxDQUFDLCtDQUErQztRQUNyRCxLQUFLLENBQUMsQ0FBQyxDQUFDLHVCQUF1QixFQUFFLE9BQU8sRUFBRSxFQUFFO1lBSTVDLE1BQU0sQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLFlBQVksRUFBRSxDQUFDO2dCQUM1QyxLQUFLLEVBQUUsSUFBSTthQUNaLENBQUMsQ0FBQyxDQUFDO1lBQ0osT0FBTyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDO1lBQzVCLElBQUksU0FBUyxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNyQyxJQUFJLE1BQU0sR0FBRyxVQUFVLENBQUMsMEJBQTBCLENBQUMsSUFBSSxVQUFVLENBQUMsTUFBTSxDQUFDO1lBQ3pFLElBQUksTUFBTSxHQUFHLFVBQVUsQ0FBQywwQkFBMEIsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxNQUFNLENBQUM7WUFDekUsSUFBSSxPQUFPLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1lBQy9FOzs7OztlQUtHO1lBQ0gsTUFBTSxxQkFBcUIsR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUM7WUFDbkUsTUFBTSxXQUFXLEdBQUcsS0FBSyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsaUJBQWlCLEVBQUUsRUFBRTtnQkFD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UUFDSCx3REFBd0Q7UUFDeEQsSUFBSSxRQUFRLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxHQUFHLFlBQVksQ0FBQyxPQUFPLENBQUM7SUFDekQsQ0FBQyxDQUFDLEVBQUUsQ0FBQztJQUVMLE1BQU0sQ0FBQyxPQUFPLEdBQUcsbUJBQW1CLENBQUM7SUFDckMsUUFBUTtBQUFDLENBQUMsQ0FBQyxFQUFFLENBQ1oiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXG5vZGVfbW9kdWxlc1xcamVzdC1jaXJjdXNcXGJ1aWxkXFxydW5uZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiAvKipcbiAqICAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKiAgKlxuICogICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiAgKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKiAgKiAvXG4gKi9cbi8qKioqKiovICgoKSA9PiB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0XCJ1c2Ugc3RyaWN0XCI7XG4vKioqKioqLyBcdHZhciBfX3dlYnBhY2tfbW9kdWxlc19fID0gKHtcblxuLyoqKi8gXCIuL3NyYy9sZWdhY3ktY29kZS10b2RvLXJld3JpdGUvamVzdEFkYXB0ZXIudHNcIjpcbi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHtcblxuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHtcbiAgdmFsdWU6IHRydWVcbn0pKTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gdm9pZCAwO1xudmFyIF9qZXN0VXRpbCA9IHJlcXVpcmUoXCJqZXN0LXV0aWxcIik7XG52YXIgU3ltYm9sID0gZ2xvYmFsVGhpc1snamVzdC1zeW1ib2wtZG8tbm90LXRvdWNoJ10gfHwgZ2xvYmFsVGhpcy5TeW1ib2w7XG52YXIgU3ltYm9sID0gZ2xvYmFsVGhpc1snamVzdC1zeW1ib2wtZG8tbm90LXRvdWNoJ10gfHwgZ2xvYmFsVGhpcy5TeW1ib2w7XG52YXIgamVzdE5vdyA9IGdsb2JhbFRoaXNbU3ltYm9sLmZvcignamVzdC1uYXRpdmUtbm93JyldIHx8IGdsb2JhbFRoaXMuRGF0ZS5ub3c7XG4vKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cbmNvbnN0IEZSQU1FV09SS19JTklUSUFMSVpFUiA9IHJlcXVpcmUucmVzb2x2ZSgnLi9qZXN0QWRhcHRlckluaXQnKTtcbmNvbnN0IGplc3RBZGFwdGVyID0gYXN5bmMgKGdsb2JhbENvbmZpZywgY29uZmlnLCBlbnZpcm9ubWVudCwgcnVudGltZSwgdGVzdFBhdGgsIHNlbmRNZXNzYWdlVG9KZXN0KSA9PiB7XG4gIGNvbnN0IHtcbiAgICBpbml0aWFsaXplLFxuICAgIHJ1bkFuZFRyYW5zZm9ybVJlc3VsdHNUb0plc3RGb3JtYXRcbiAgfSA9IHJ1bnRpbWUucmVxdWlyZUludGVybmFsTW9kdWxlKEZSQU1FV09SS19JTklUSUFMSVpFUik7XG4gIGNvbnN0IHtcbiAgICBnbG9iYWxzLFxuICAgIHNuYXBzaG90U3RhdGVcbiAgfSA9IGF3YWl0IGluaXRpYWxpemUoe1xuICAgIGNvbmZpZyxcbiAgICBlbnZpcm9ubWVudCxcbiAgICBnbG9iYWxDb25maWcsXG4gICAgbG9jYWxSZXF1aXJlOiBydW50aW1lLnJlcXVpcmVNb2R1bGUuYmluZChydW50aW1lKSxcbiAgICBwYXJlbnRQcm9jZXNzOiBwcm9jZXNzLFxuICAgIHJ1bnRpbWUsXG4gICAgc2VuZE1lc3NhZ2VUb0plc3QsXG4gICAgc2V0R2xvYmFsc0ZvclJ1bnRpbWU6IHJ1bnRpbWUuc2V0R2xvYmFsc0ZvclJ1bnRpbWUuYmluZChydW50aW1lKSxcbiAgICB0ZXN0UGF0aFxuICB9KTtcbiAgaWYgKGNvbmZpZy5mYWtlVGltZXJzLmVuYWJsZUdsb2JhbGx5KSB7XG4gICAgaWYgKGNvbmZpZy5mYWtlVGltZXJzLmxlZ2FjeUZha2VUaW1lcnMpIHtcbiAgICAgIC8vIGR1cmluZyBzZXR1cCwgdGhpcyBjYW5ub3QgYmUgbnVsbCAoYW5kIGl0J3MgZmluZSB0byBleHBsb2RlIGlmIGl0IGlzKVxuICAgICAgZW52aXJvbm1lbnQuZmFrZVRpbWVycy51c2VGYWtlVGltZXJzKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVudmlyb25tZW50LmZha2VUaW1lcnNNb2Rlcm4udXNlRmFrZVRpbWVycygpO1xuICAgIH1cbiAgfVxuICBnbG9iYWxzLmJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGlmIChjb25maWcucmVzZXRNb2R1bGVzKSB7XG4gICAgICBydW50aW1lLnJlc2V0TW9kdWxlcygpO1xuICAgIH1cbiAgICBpZiAoY29uZmlnLmNsZWFyTW9ja3MpIHtcbiAgICAgIHJ1bnRpbWUuY2xlYXJBbGxNb2NrcygpO1xuICAgIH1cbiAgICBpZiAoY29uZmlnLnJlc2V0TW9ja3MpIHtcbiAgICAgIHJ1bnRpbWUucmVzZXRBbGxNb2NrcygpO1xuICAgICAgaWYgKGNvbmZpZy5mYWtlVGltZXJzLmVuYWJsZUdsb2JhbGx5ICYmIGNvbmZpZy5mYWtlVGltZXJzLmxlZ2FjeUZha2VUaW1lcnMpIHtcbiAgICAgICAgLy8gZHVyaW5nIHNldHVwLCB0aGlzIGNhbm5vdCBiZSBudWxsIChhbmQgaXQncyBmaW5lIHRvIGV4cGxvZGUgaWYgaXQgaXMpXG4gICAgICAgIGVudmlyb25tZW50LmZha2VUaW1lcnMudXNlRmFrZVRpbWVycygpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY29uZmlnLnJlc3RvcmVNb2Nrcykge1xuICAgICAgcnVudGltZS5yZXN0b3JlQWxsTW9ja3MoKTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCBzZXR1cEFmdGVyRW52U3RhcnQgPSBqZXN0Tm93KCk7XG4gIGZvciAoY29uc3QgcGF0aCBvZiBjb25maWcuc2V0dXBGaWxlc0FmdGVyRW52KSB7XG4gICAgY29uc3QgZXNtID0gcnVudGltZS51bnN0YWJsZV9zaG91bGRMb2FkQXNFc20ocGF0aCk7XG4gICAgaWYgKGVzbSkge1xuICAgICAgYXdhaXQgcnVudGltZS51bnN0YWJsZV9pbXBvcnRNb2R1bGUocGF0aCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHNldHVwRmlsZSA9IHJ1bnRpbWUucmVxdWlyZU1vZHVsZShwYXRoKTtcbiAgICAgIGlmICh0eXBlb2Ygc2V0dXBGaWxlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGF3YWl0IHNldHVwRmlsZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBjb25zdCBzZXR1cEFmdGVyRW52RW5kID0gamVzdE5vdygpO1xuICBjb25zdCBlc20gPSBydW50aW1lLnVuc3RhYmxlX3Nob3VsZExvYWRBc0VzbSh0ZXN0UGF0aCk7XG4gIGlmIChlc20pIHtcbiAgICBhd2FpdCBydW50aW1lLnVuc3RhYmxlX2ltcG9ydE1vZHVsZSh0ZXN0UGF0aCk7XG4gIH0gZWxzZSB7XG4gICAgcnVudGltZS5yZXF1aXJlTW9kdWxlKHRlc3RQYXRoKTtcbiAgfVxuICBjb25zdCBzZXR1cEFmdGVyRW52UGVyZlN0YXRzID0ge1xuICAgIHNldHVwQWZ0ZXJFbnZFbmQsXG4gICAgc2V0dXBBZnRlckVudlN0YXJ0XG4gIH07XG4gIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBydW5BbmRUcmFuc2Zvcm1SZXN1bHRzVG9KZXN0Rm9ybWF0KHtcbiAgICBjb25maWcsXG4gICAgZ2xvYmFsQ29uZmlnLFxuICAgIHNldHVwQWZ0ZXJFbnZQZXJmU3RhdHMsXG4gICAgdGVzdFBhdGhcbiAgfSk7XG4gIF9hZGRTbmFwc2hvdERhdGEocmVzdWx0cywgc25hcHNob3RTdGF0ZSk7XG5cbiAgLy8gV2UgbmVlZCB0byBjb3B5IHRoZSByZXN1bHRzIG9iamVjdCB0byBlbnN1cmUgd2UgZG9uJ3QgbGVha3MgdGhlIHByb3RvdHlwZXNcbiAgLy8gZnJvbSB0aGUgVk0uIEphc21pbmUgY3JlYXRlcyB0aGUgcmVzdWx0IG9iamVjdHMgaW4gdGhlIHBhcmVudCBwcm9jZXNzLCB3ZVxuICAvLyBzaG91bGQgY29uc2lkZXIgZG9pbmcgdGhhdCBmb3IgY2lyY3VzIGFzIHdlbGwuXG4gIHJldHVybiAoMCwgX2plc3RVdGlsLmRlZXBDeWNsaWNDb3B5KShyZXN1bHRzLCB7XG4gICAga2VlcFByb3RvdHlwZTogZmFsc2VcbiAgfSk7XG59O1xuY29uc3QgX2FkZFNuYXBzaG90RGF0YSA9IChyZXN1bHRzLCBzbmFwc2hvdFN0YXRlKSA9PiB7XG4gIGZvciAoY29uc3Qge1xuICAgIGZ1bGxOYW1lLFxuICAgIHN0YXR1cyxcbiAgICBmYWlsaW5nXG4gIH0gb2YgcmVzdWx0cy50ZXN0UmVzdWx0cykge1xuICAgIGlmIChzdGF0dXMgPT09ICdwZW5kaW5nJyB8fCBzdGF0dXMgPT09ICdmYWlsZWQnIHx8IGZhaWxpbmcgJiYgc3RhdHVzID09PSAncGFzc2VkJykge1xuICAgICAgLy8gSWYgdGVzdCBpcyBza2lwcGVkIG9yIGZhaWxlZCwgd2UgZG9uJ3Qgd2FudCB0byBtYXJrXG4gICAgICAvLyBpdHMgc25hcHNob3RzIGFzIG9ic29sZXRlLlxuICAgICAgLy8gV2hlbiB0ZXN0cyBjYWxsZWQgd2l0aCB0ZXN0LmZhaWxpbmcgcGFzcywgdGhleSd2ZSB0aHJvd24gYW4gZXhjZXB0aW9uLFxuICAgICAgLy8gc28gbWFpbnRhaW4gYW55IHNuYXBzaG90cyBhZnRlciB0aGUgZXJyb3IuXG4gICAgICBzbmFwc2hvdFN0YXRlLm1hcmtTbmFwc2hvdHNBc0NoZWNrZWRGb3JUZXN0KGZ1bGxOYW1lKTtcbiAgICB9XG4gIH1cbiAgY29uc3QgdW5jaGVja2VkQ291bnQgPSBzbmFwc2hvdFN0YXRlLmdldFVuY2hlY2tlZENvdW50KCk7XG4gIGNvbnN0IHVuY2hlY2tlZEtleXMgPSBzbmFwc2hvdFN0YXRlLmdldFVuY2hlY2tlZEtleXMoKTtcbiAgaWYgKHVuY2hlY2tlZENvdW50KSB7XG4gICAgc25hcHNob3RTdGF0ZS5yZW1vdmVVbmNoZWNrZWRLZXlzKCk7XG4gIH1cbiAgY29uc3Qgc3RhdHVzID0gc25hcHNob3RTdGF0ZS5zYXZlKCk7XG4gIHJlc3VsdHMuc25hcHNob3QuZmlsZURlbGV0ZWQgPSBzdGF0dXMuZGVsZXRlZDtcbiAgcmVzdWx0cy5zbmFwc2hvdC5hZGRlZCA9IHNuYXBzaG90U3RhdGUuYWRkZWQ7XG4gIHJlc3VsdHMuc25hcHNob3QubWF0Y2hlZCA9IHNuYXBzaG90U3RhdGUubWF0Y2hlZDtcbiAgcmVzdWx0cy5zbmFwc2hvdC51bm1hdGNoZWQgPSBzbmFwc2hvdFN0YXRlLnVubWF0Y2hlZDtcbiAgcmVzdWx0cy5zbmFwc2hvdC51cGRhdGVkID0gc25hcHNob3RTdGF0ZS51cGRhdGVkO1xuICByZXN1bHRzLnNuYXBzaG90LnVuY2hlY2tlZCA9IHN0YXR1cy5kZWxldGVkID8gMCA6IHVuY2hlY2tlZENvdW50O1xuICAvLyBDb3B5IHRoZSBhcnJheSB0byBwcmV2ZW50IG1lbW9yeSBsZWFrc1xuICByZXN1bHRzLnNuYXBzaG90LnVuY2hlY2tlZEtleXMgPSBbLi4udW5jaGVja2VkS2V5c107XG59O1xudmFyIF9kZWZhdWx0ID0gZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBqZXN0QWRhcHRlcjtcblxuLyoqKi8gfSlcblxuLyoqKioqKi8gXHR9KTtcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuLyoqKioqKi8gXHRcbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuLyoqKioqKi8gXHRcdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuLyoqKioqKi8gXHRcdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovIFx0XG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqLyBcdFxuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqLyBcdFxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0ge307XG4vLyBUaGlzIGVudHJ5IG5lZWRzIHRvIGJlIHdyYXBwZWQgaW4gYW4gSUlGRSBiZWNhdXNlIGl0IHVzZXMgYSBub24tc3RhbmRhcmQgbmFtZSBmb3IgdGhlIGV4cG9ydHMgKGV4cG9ydHMpLlxuKCgpID0+IHtcbnZhciBleHBvcnRzID0gX193ZWJwYWNrX2V4cG9ydHNfXztcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7XG4gIHZhbHVlOiB0cnVlXG59KSk7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHZvaWQgMDtcbnZhciBfamVzdEFkYXB0ZXIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oXCIuL3NyYy9sZWdhY3ktY29kZS10b2RvLXJld3JpdGUvamVzdEFkYXB0ZXIudHNcIikpO1xuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChlKSB7IHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7IGRlZmF1bHQ6IGUgfTsgfVxuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG4vLyBBbGxvdyBwZW9wbGUgdG8gdXNlIGBqZXN0LWNpcmN1cy9ydW5uZXJgIGFzIGEgcnVubmVyLlxudmFyIF9kZWZhdWx0ID0gZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBfamVzdEFkYXB0ZXIuZGVmYXVsdDtcbn0pKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX2V4cG9ydHNfXztcbi8qKioqKiovIH0pKClcbjsiXSwidmVyc2lvbiI6M30=