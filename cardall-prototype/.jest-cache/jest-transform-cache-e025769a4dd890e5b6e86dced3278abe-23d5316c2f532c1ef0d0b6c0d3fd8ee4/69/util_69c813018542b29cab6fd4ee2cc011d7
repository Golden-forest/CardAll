33223e0f04368c607e5aff43275e7e78
"use strict";
function _typeof(o) {
    "@babel/helpers - typeof";
    return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o);
}
exports.__esModule = true;
exports.hasAnyConcreteRoles = hasAnyConcreteRoles;
exports.isElement = isElement;
exports.isHTMLFieldSetElement = isHTMLFieldSetElement;
exports.isHTMLInputElement = isHTMLInputElement;
exports.isHTMLLegendElement = isHTMLLegendElement;
exports.isHTMLOptGroupElement = isHTMLOptGroupElement;
exports.isHTMLSelectElement = isHTMLSelectElement;
exports.isHTMLSlotElement = isHTMLSlotElement;
exports.isHTMLTableCaptionElement = isHTMLTableCaptionElement;
exports.isHTMLTableElement = isHTMLTableElement;
exports.isHTMLTextAreaElement = isHTMLTextAreaElement;
exports.isSVGElement = isSVGElement;
exports.isSVGSVGElement = isSVGSVGElement;
exports.isSVGTitleElement = isSVGTitleElement;
exports.presentationRoles = void 0;
exports.queryIdRefs = queryIdRefs;
exports.safeWindow = safeWindow;
var _getRole = _interopRequireWildcard(require("./getRole"));
exports.getLocalName = _getRole.getLocalName;
function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function")
    return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }
function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) {
    return obj;
} if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") {
    return { default: obj };
} var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) {
    return cache.get(obj);
} var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) {
    if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
        var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
        if (desc && (desc.get || desc.set)) {
            Object.defineProperty(newObj, key, desc);
        }
        else {
            newObj[key] = obj[key];
        }
    }
} newObj.default = obj; if (cache) {
    cache.set(obj, newObj);
} return newObj; }
var presentationRoles = ["presentation", "none"];
exports.presentationRoles = presentationRoles;
function isElement(node) {
    return node !== null && node.nodeType === node.ELEMENT_NODE;
}
function isHTMLTableCaptionElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "caption";
}
function isHTMLInputElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "input";
}
function isHTMLOptGroupElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "optgroup";
}
function isHTMLSelectElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "select";
}
function isHTMLTableElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "table";
}
function isHTMLTextAreaElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "textarea";
}
function safeWindow(node) {
    var _ref = node.ownerDocument === null ? node : node.ownerDocument, defaultView = _ref.defaultView;
    if (defaultView === null) {
        throw new TypeError("no window available");
    }
    return defaultView;
}
function isHTMLFieldSetElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "fieldset";
}
function isHTMLLegendElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "legend";
}
function isHTMLSlotElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "slot";
}
function isSVGElement(node) {
    return isElement(node) && node.ownerSVGElement !== undefined;
}
function isSVGSVGElement(node) {
    return isElement(node) && (0, _getRole.getLocalName)(node) === "svg";
}
function isSVGTitleElement(node) {
    return isSVGElement(node) && (0, _getRole.getLocalName)(node) === "title";
}
/**
 *
 * @param {Node} node -
 * @param {string} attributeName -
 * @returns {Element[]} -
 */
function queryIdRefs(node, attributeName) {
    if (isElement(node) && node.hasAttribute(attributeName)) {
        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- safe due to hasAttribute check
        var ids = node.getAttribute(attributeName).split(" ");
        // Browsers that don't support shadow DOM won't have getRootNode
        var root = node.getRootNode ? node.getRootNode() : node.ownerDocument;
        return ids.map(function (id) {
            return root.getElementById(id);
        }).filter(function (element) {
            return element !== null;
        }
        // TODO: why does this not narrow?
        );
    }
    return [];
}
function hasAnyConcreteRoles(node, roles) {
    if (isElement(node)) {
        return roles.indexOf((0, _getRole.default)(node)) !== -1;
    }
    return false;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXG5vZGVfbW9kdWxlc1xcQHRlc3RpbmctbGlicmFyeVxcamVzdC1kb21cXG5vZGVfbW9kdWxlc1xcZG9tLWFjY2Vzc2liaWxpdHktYXBpXFxkaXN0XFx1dGlsLmpzIiwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQztBQUViLFNBQVMsT0FBTyxDQUFDLENBQUM7SUFBSSx5QkFBeUIsQ0FBQztJQUFDLE9BQU8sT0FBTyxHQUFHLFVBQVUsSUFBSSxPQUFPLE1BQU0sSUFBSSxRQUFRLElBQUksT0FBTyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBSSxPQUFPLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBSSxPQUFPLENBQUMsSUFBSSxVQUFVLElBQUksT0FBTyxNQUFNLElBQUksQ0FBQyxDQUFDLFdBQVcsS0FBSyxNQUFNLElBQUksQ0FBQyxLQUFLLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQUMsQ0FBQztBQUM5VCxPQUFPLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztBQUMxQixPQUFPLENBQUMsbUJBQW1CLEdBQUcsbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7QUFDOUIsT0FBTyxDQUFDLHFCQUFxQixHQUFHLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sQ0FBQyxrQkFBa0IsR0FBRyxrQkFBa0IsQ0FBQztBQUNoRCxPQUFPLENBQUMsbUJBQW1CLEdBQUcsbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxDQUFDLHFCQUFxQixHQUFHLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sQ0FBQyxtQkFBbUIsR0FBRyxtQkFBbUIsQ0FBQztBQUNsRCxP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LENBQUMsQ0FBQztRQUNqQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBVSxPQUFPO1lBQ3pCLE9BQU8sT0FBTyxLQUFLLElBQUksQ0FBQztRQUMxQixDQUFDO1FBQ0Qsa0NBQWtDO1NBQ2pDLENBQUM7SUFDSixDQUFDO0lBRUQsT0FBTyxFQUFFLENBQUM7QUFDWixDQUFDO0FBQ0QsU0FBUyxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsS0FBSztJQUN0QyxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ3BCLE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUMzRCxDQUFDO0lBQ0QsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkQ6XFxQcm9qZWN0c1xcQ2FyZEV2ZXJ5dGhpbmdcXGNhcmRhbGwtcHJvdG90eXBlXFxub2RlX21vZHVsZXNcXEB0ZXN0aW5nLWxpYnJhcnlcXGplc3QtZG9tXFxub2RlX21vZHVsZXNcXGRvbS1hY2Nlc3NpYmlsaXR5LWFwaVxcZGlzdFxcdXRpbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX3R5cGVvZihvKSB7IFwiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2ZcIjsgcmV0dXJuIF90eXBlb2YgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiBcInN5bWJvbFwiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAobykgeyByZXR1cm4gdHlwZW9mIG87IH0gOiBmdW5jdGlvbiAobykgeyByZXR1cm4gbyAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiBvLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgbyAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2YgbzsgfSwgX3R5cGVvZihvKTsgfVxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHMuaGFzQW55Q29uY3JldGVSb2xlcyA9IGhhc0FueUNvbmNyZXRlUm9sZXM7XG5leHBvcnRzLmlzRWxlbWVudCA9IGlzRWxlbWVudDtcbmV4cG9ydHMuaXNIVE1MRmllbGRTZXRFbGVtZW50ID0gaXNIVE1MRmllbGRTZXRFbGVtZW50O1xuZXhwb3J0cy5pc0hUTUxJbnB1dEVsZW1lbnQgPSBpc0hUTUxJbnB1dEVsZW1lbnQ7XG5leHBvcnRzLmlzSFRNTExlZ2VuZEVsZW1lbnQgPSBpc0hUTUxMZWdlbmRFbGVtZW50O1xuZXhwb3J0cy5pc0hUTUxPcHRHcm91cEVsZW1lbnQgPSBpc0hUTUxPcHRHcm91cEVsZW1lbnQ7XG5leHBvcnRzLmlzSFRNTFNlbGVjdEVsZW1lbnQgPSBpc0hUTUxTZWxlY3RFbGVtZW50O1xuZXhwb3J0cy5pc0hUTUxTbG90RWxlbWVudCA9IGlzSFRNTFNsb3RFbGVtZW50O1xuZXhwb3J0cy5pc0hUTUxUYWJsZUNhcHRpb25FbGVtZW50ID0gaXNIVE1MVGFibGVDYXB0aW9uRWxlbWVudDtcbmV4cG9ydHMuaXNIVE1MVGFibGVFbGVtZW50ID0gaXNIVE1MVGFibGVFbGVtZW50O1xuZXhwb3J0cy5pc0hUTUxUZXh0QXJlYUVsZW1lbnQgPSBpc0hUTUxUZXh0QXJlYUVsZW1lbnQ7XG5leHBvcnRzLmlzU1ZHRWxlbWVudCA9IGlzU1ZHRWxlbWVudDtcbmV4cG9ydHMuaXNTVkdTVkdFbGVtZW50ID0gaXNTVkdTVkdFbGVtZW50O1xuZXhwb3J0cy5pc1NWR1RpdGxlRWxlbWVudCA9IGlzU1ZHVGl0bGVFbGVtZW50O1xuZXhwb3J0cy5wcmVzZW50YXRpb25Sb2xlcyA9IHZvaWQgMDtcbmV4cG9ydHMucXVlcnlJZFJlZnMgPSBxdWVyeUlkUmVmcztcbmV4cG9ydHMuc2FmZVdpbmRvdyA9IHNhZmVXaW5kb3c7XG52YXIgX2dldFJvbGUgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwiLi9nZXRSb2xlXCIpKTtcbmV4cG9ydHMuZ2V0TG9jYWxOYW1lID0gX2dldFJvbGUuZ2V0TG9jYWxOYW1lO1xuZnVuY3Rpb24gX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlKG5vZGVJbnRlcm9wKSB7IGlmICh0eXBlb2YgV2Vha01hcCAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gbnVsbDsgdmFyIGNhY2hlQmFiZWxJbnRlcm9wID0gbmV3IFdlYWtNYXAoKTsgdmFyIGNhY2hlTm9kZUludGVyb3AgPSBuZXcgV2Vha01hcCgpOyByZXR1cm4gKF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSA9IGZ1bmN0aW9uIF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZShub2RlSW50ZXJvcCkgeyByZXR1cm4gbm9kZUludGVyb3AgPyBjYWNoZU5vZGVJbnRlcm9wIDogY2FjaGVCYWJlbEludGVyb3A7IH0pKG5vZGVJbnRlcm9wKTsgfVxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqLCBub2RlSW50ZXJvcCkgeyBpZiAoIW5vZGVJbnRlcm9wICYmIG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGlmIChvYmogPT09IG51bGwgfHwgX3R5cGVvZihvYmopICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvYmogIT09IFwiZnVuY3Rpb25cIikgeyByZXR1cm4geyBkZWZhdWx0OiBvYmogfTsgfSB2YXIgY2FjaGUgPSBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUobm9kZUludGVyb3ApOyBpZiAoY2FjaGUgJiYgY2FjaGUuaGFzKG9iaikpIHsgcmV0dXJuIGNhY2hlLmdldChvYmopOyB9IHZhciBuZXdPYmogPSB7fTsgdmFyIGhhc1Byb3BlcnR5RGVzY3JpcHRvciA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChrZXkgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsgdmFyIGRlc2MgPSBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IG51bGw7IGlmIChkZXNjICYmIChkZXNjLmdldCB8fCBkZXNjLnNldCkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IGlmIChjYWNoZSkgeyBjYWNoZS5zZXQob2JqLCBuZXdPYmopOyB9IHJldHVybiBuZXdPYmo7IH1cbnZhciBwcmVzZW50YXRpb25Sb2xlcyA9IFtcInByZXNlbnRhdGlvblwiLCBcIm5vbmVcIl07XG5leHBvcnRzLnByZXNlbnRhdGlvblJvbGVzID0gcHJlc2VudGF0aW9uUm9sZXM7XG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkge1xuICByZXR1cm4gbm9kZSAhPT0gbnVsbCAmJiBub2RlLm5vZGVUeXBlID09PSBub2RlLkVMRU1FTlRfTk9ERTtcbn1cbmZ1bmN0aW9uIGlzSFRNTFRhYmxlQ2FwdGlvbkVsZW1lbnQobm9kZSkge1xuICByZXR1cm4gaXNFbGVtZW50KG5vZGUpICYmICgwLCBfZ2V0Um9sZS5nZXRMb2NhbE5hbWUpKG5vZGUpID09PSBcImNhcHRpb25cIjtcbn1cbmZ1bmN0aW9uIGlzSFRNTElucHV0RWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwiaW5wdXRcIjtcbn1cbmZ1bmN0aW9uIGlzSFRNTE9wdEdyb3VwRWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwib3B0Z3JvdXBcIjtcbn1cbmZ1bmN0aW9uIGlzSFRNTFNlbGVjdEVsZW1lbnQobm9kZSkge1xuICByZXR1cm4gaXNFbGVtZW50KG5vZGUpICYmICgwLCBfZ2V0Um9sZS5nZXRMb2NhbE5hbWUpKG5vZGUpID09PSBcInNlbGVjdFwiO1xufVxuZnVuY3Rpb24gaXNIVE1MVGFibGVFbGVtZW50KG5vZGUpIHtcbiAgcmV0dXJuIGlzRWxlbWVudChub2RlKSAmJiAoMCwgX2dldFJvbGUuZ2V0TG9jYWxOYW1lKShub2RlKSA9PT0gXCJ0YWJsZVwiO1xufVxuZnVuY3Rpb24gaXNIVE1MVGV4dEFyZWFFbGVtZW50KG5vZGUpIHtcbiAgcmV0dXJuIGlzRWxlbWVudChub2RlKSAmJiAoMCwgX2dldFJvbGUuZ2V0TG9jYWxOYW1lKShub2RlKSA9PT0gXCJ0ZXh0YXJlYVwiO1xufVxuZnVuY3Rpb24gc2FmZVdpbmRvdyhub2RlKSB7XG4gIHZhciBfcmVmID0gbm9kZS5vd25lckRvY3VtZW50ID09PSBudWxsID8gbm9kZSA6IG5vZGUub3duZXJEb2N1bWVudCxcbiAgICBkZWZhdWx0VmlldyA9IF9yZWYuZGVmYXVsdFZpZXc7XG4gIGlmIChkZWZhdWx0VmlldyA9PT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJubyB3aW5kb3cgYXZhaWxhYmxlXCIpO1xuICB9XG4gIHJldHVybiBkZWZhdWx0Vmlldztcbn1cbmZ1bmN0aW9uIGlzSFRNTEZpZWxkU2V0RWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwiZmllbGRzZXRcIjtcbn1cbmZ1bmN0aW9uIGlzSFRNTExlZ2VuZEVsZW1lbnQobm9kZSkge1xuICByZXR1cm4gaXNFbGVtZW50KG5vZGUpICYmICgwLCBfZ2V0Um9sZS5nZXRMb2NhbE5hbWUpKG5vZGUpID09PSBcImxlZ2VuZFwiO1xufVxuZnVuY3Rpb24gaXNIVE1MU2xvdEVsZW1lbnQobm9kZSkge1xuICByZXR1cm4gaXNFbGVtZW50KG5vZGUpICYmICgwLCBfZ2V0Um9sZS5nZXRMb2NhbE5hbWUpKG5vZGUpID09PSBcInNsb3RcIjtcbn1cbmZ1bmN0aW9uIGlzU1ZHRWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgbm9kZS5vd25lclNWR0VsZW1lbnQgIT09IHVuZGVmaW5lZDtcbn1cbmZ1bmN0aW9uIGlzU1ZHU1ZHRWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwic3ZnXCI7XG59XG5mdW5jdGlvbiBpc1NWR1RpdGxlRWxlbWVudChub2RlKSB7XG4gIHJldHVybiBpc1NWR0VsZW1lbnQobm9kZSkgJiYgKDAsIF9nZXRSb2xlLmdldExvY2FsTmFtZSkobm9kZSkgPT09IFwidGl0bGVcIjtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIHtOb2RlfSBub2RlIC1cbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyaWJ1dGVOYW1lIC1cbiAqIEByZXR1cm5zIHtFbGVtZW50W119IC1cbiAqL1xuZnVuY3Rpb24gcXVlcnlJZFJlZnMobm9kZSwgYXR0cmlidXRlTmFtZSkge1xuICBpZiAoaXNFbGVtZW50KG5vZGUpICYmIG5vZGUuaGFzQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb24gLS0gc2FmZSBkdWUgdG8gaGFzQXR0cmlidXRlIGNoZWNrXG4gICAgdmFyIGlkcyA9IG5vZGUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpLnNwbGl0KFwiIFwiKTtcblxuICAgIC8vIEJyb3dzZXJzIHRoYXQgZG9uJ3Qgc3VwcG9ydCBzaGFkb3cgRE9NIHdvbid0IGhhdmUgZ2V0Um9vdE5vZGVcbiAgICB2YXIgcm9vdCA9IG5vZGUuZ2V0Um9vdE5vZGUgPyBub2RlLmdldFJvb3ROb2RlKCkgOiBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgcmV0dXJuIGlkcy5tYXAoZnVuY3Rpb24gKGlkKSB7XG4gICAgICByZXR1cm4gcm9vdC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICByZXR1cm4gZWxlbWVudCAhPT0gbnVsbDtcbiAgICB9XG4gICAgLy8gVE9ETzogd2h5IGRvZXMgdGhpcyBub3QgbmFycm93P1xuICAgICk7XG4gIH1cblxuICByZXR1cm4gW107XG59XG5mdW5jdGlvbiBoYXNBbnlDb25jcmV0ZVJvbGVzKG5vZGUsIHJvbGVzKSB7XG4gIGlmIChpc0VsZW1lbnQobm9kZSkpIHtcbiAgICByZXR1cm4gcm9sZXMuaW5kZXhPZigoMCwgX2dldFJvbGUuZGVmYXVsdCkobm9kZSkpICE9PSAtMTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlsLmpzLm1hcCJdLCJ2ZXJzaW9uIjozfQ==