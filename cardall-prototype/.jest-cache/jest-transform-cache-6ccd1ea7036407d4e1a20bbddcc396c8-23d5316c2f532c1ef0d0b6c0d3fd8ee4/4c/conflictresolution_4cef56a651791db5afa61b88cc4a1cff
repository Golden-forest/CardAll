94023e997bf953ed517af9ccaee38c7b
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ConflictResolutionEngine = void 0;
class ConflictResolutionEngine {
    /**
     * 生成冲突解决建议
     */
    static generateSuggestions(conflict) {
        const suggestions = [];
        switch (conflict.type) {
            case 'card_content':
                suggestions.push(...this.generateCardContentSuggestions(conflict));
                break;
            case 'folder_name':
                suggestions.push(...this.generateFolderNameSuggestions(conflict));
                break;
            case 'tag_rename':
                suggestions.push(...this.generateTagRenameSuggestions(conflict));
                break;
            default:
                suggestions.push(this.getDefaultSuggestion());
        }
        return suggestions.sort((a, b) => b.confidence - a.confidence);
    }
    /**
     * 卡片内容冲突建议
     */
    static generateCardContentSuggestions(conflict) {
        const suggestions = [];
        const { localVersion, remoteVersion } = conflict;
        // 1. 内容相似度分析
        const titleSimilarity = this.calculateSimilarity(localVersion.content.frontContent.title, remoteVersion.content.frontContent.title);
        const textSimilarity = this.calculateSimilarity(localVersion.content.frontContent.text, remoteVersion.content.frontContent.text);
        // 2. 时间戳分析
        const timeDiff = Math.abs(localVersion.updatedAt.getTime() - remoteVersion.updatedAt.getTime());
        const isRecentConflict = timeDiff < 5 * 60 * 1000; // 5分钟内
        // 3. 内容长度分析
        const localLength = localVersion.content.frontContent.text.length;
        const remoteLength = remoteVersion.content.frontContent.text.length;
        const lengthRatio = Math.max(localLength, remoteLength) / Math.min(localLength, remoteLength);
        // 高相似度且时间接近，建议合并
        if (titleSimilarity > 0.8 && textSimilarity > 0.6 && isRecentConflict) {
            suggestions.push({
                type: 'merge',
                confidence: 0.9,
                reason: '内容高度相似，建议智能合并保留最佳内容',
                preview: {
                    mergedTitle: this.mergeTitles(localVersion.content.frontContent.title, remoteVersion.content.frontContent.title),
                    mergedLength: Math.max(localLength, remoteLength)
                }
            });
        }
        // 远程版本更新很多，建议保留远程
        if (remoteVersion.updatedAt.getTime() > localVersion.updatedAt.getTime() &&
            lengthRatio > 2 &&
            remoteLength > localLength) {
            suggestions.push({
                type: 'keep_remote',
                confidence: 0.8,
                reason: '远程版本内容更丰富且更新时间更近'
            });
        }
        // 本地版本包含独特标签，建议保留本地
        const localTags = new Set(localVersion.content.frontContent.tags);
        const remoteTags = new Set(remoteVersion.content.frontContent.tags);
        const uniqueLocalTags = [...localTags].filter(tag => !remoteTags.has(tag));
        if (uniqueLocalTags.length > 0 && uniqueLocalTags.length / localTags.size > 0.3) {
            suggestions.push({
                type: 'keep_local',
                confidence: 0.7,
                reason: '本地版本包含独特标签，可能包含重要分类信息'
            });
        }
        // 默认建议保留最新版本
        const latestVersion = localVersion.updatedAt.getTime() > remoteVersion.updatedAt.getTime() ? 'local' : 'remote';
        suggestions.push({
            type: latestVersion === 'local' ? 'keep_local' : 'keep_remote',
            confidence: 0.6,
            reason: `保留最新版本（${latestVersion === 'local' ? '本地' : '远程'}设备）`
        });
        return suggestions;
    }
    /**
     * 文件夹名称冲突建议
     */
    static generateFolderNameSuggestions(conflict) {
        const suggestions = [];
        const { localVersion, remoteVersion } = conflict;
        const localName = localVersion.name.toLowerCase();
        const remoteName = remoteVersion.name.toLowerCase();
        // 名称完全相同，不需要处理
        if (localName === remoteName) {
            return [];
        }
        // 相似度高，建议合并
        const similarity = this.calculateSimilarity(localVersion.name, remoteVersion.name);
        if (similarity > 0.8) {
            suggestions.push({
                type: 'merge',
                confidence: 0.9,
                reason: '文件夹名称相似，建议统一命名'
            });
        }
        // 一个是另一个的子集，建议保留更完整的
        if (localName.includes(remoteName) || remoteName.includes(localName)) {
            const longerName = localVersion.name.length > remoteVersion.name.length ? 'local' : 'remote';
            suggestions.push({
                type: longerName === 'local' ? 'keep_local' : 'keep_remote',
                confidence: 0.8,
                reason: '保留更具描述性的文件夹名称'
            });
        }
        // 按时间戳建议保留最新
        const latestVersion = localVersion.updatedAt.getTime() > remoteVersion.updatedAt.getTime() ? 'local' : 'remote';
        suggestions.push({
            type: latestVersion === 'local' ? 'keep_local' : 'keep_remote',
            confidence: 0.6,
            reason: `保留最新修改的版本（${latestVersion === 'local' ? '本地' : '远程'}）`
        });
        return suggestions;
    }
    /**
     * 标签重命名冲突建议
     */
    static generateTagRenameSuggestions(conflict) {
        const suggestions = [];
        const { localVersion, remoteVersion } = conflict;
        // 分析使用频率
        const usageRatio = localVersion.count / Math.max(remoteVersion.count, 1);
        // 使用频率差异大，建议保留高频使用的
        if (usageRatio > 2) {
            suggestions.push({
                type: 'keep_local',
                confidence: 0.9,
                reason: `本地标签使用频率更高（${localVersion.count}次 vs ${remoteVersion.count}次）`
            });
        }
        else if (usageRatio < 0.5) {
            suggestions.push({
                type: 'keep_remote',
                confidence: 0.9,
                reason: `远程标签使用频率更高（${remoteVersion.count}次 vs ${localVersion.count}次）`
            });
        }
        // 名称质量分析
        const localQuality = this.evaluateTagNameQuality(localVersion.name);
        const remoteQuality = this.evaluateTagNameQuality(remoteVersion.name);
        if (Math.abs(localQuality - remoteQuality) > 0.3) {
            const betterVersion = localQuality > remoteQuality ? 'local' : 'remote';
            suggestions.push({
                type: betterVersion === 'local' ? 'keep_local' : 'keep_remote',
                confidence: 0.8,
                reason: `${betterVersion === 'local' ? '本地' : '远程'}标签名称质量更好`
            });
        }
        // 按时间戳建议
        const latestVersion = localVersion.updatedAt.getTime() > remoteVersion.updatedAt.getTime() ? 'local' : 'remote';
        suggestions.push({
            type: latestVersion === 'local' ? 'keep_local' : 'keep_remote',
            confidence: 0.6,
            reason: `保留最新修改的版本`
        });
        return suggestions;
    }
    /**
     * 计算文本相似度（简化版）
     */
    static calculateSimilarity(text1, text2) {
        if (!text1 || !text2)
            return 0;
        // 转换为小写并去除空格
        const clean1 = text1.toLowerCase().trim();
        const clean2 = text2.toLowerCase().trim();
        if (clean1 === clean2)
            return 1.0;
        // 计算编辑距离相似度
        const maxLength = Math.max(clean1.length, clean2.length);
        if (maxLength === 0)
            return 1.0;
        const distance = this.levenshteinDistance(clean1, clean2);
        return 1 - (distance / maxLength);
    }
    /**
     * 计算Levenshtein距离
     */
    static levenshteinDistance(str1, str2) {
        const matrix = Array(str2.length + 1).fill(null).map(() => Array(str1.length + 1).fill(null));
        for (let i = 0; i <= str1.length; i += 1)
            matrix[0][i] = i;
        for (let j = 0; j <= str2.length; j += 1)
            matrix[j][0] = j;
        for (let j = 1; j <= str2.length; j += 1) {
            for (let i = 1; i <= str1.length; i += 1) {
                const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1;
                matrix[j][i] = Math.min(matrix[j][i - 1] + 1, // deletion
                matrix[j - 1][i] + 1, // insertion
                matrix[j - 1][i - 1] + indicator // substitution
                );
            }
        }
        return matrix[str2.length][str1.length];
    }
    /**
     * 合并标题
     */
    static mergeTitles(title1, title2) {
        if (title1 === title2)
            return title1;
        // 如果一个标题是另一个的扩展，选择更长的
        if (title1.includes(title2) && title1.length > title2.length)
            return title1;
        if (title2.includes(title1) && title2.length > title1.length)
            return title2;
        // 合并两个标题的关键词
        const words1 = new Set(title1.toLowerCase().split(/\s+/));
        const words2 = new Set(title2.toLowerCase().split(/\s+/));
        const allWords = new Set([...words1, ...words2]);
        // 重新组合，保留原有顺序
        const title1Words = title1.split(/\s+/);
        const title2Words = title2.split(/\s+/);
        const mergedWords = [];
        // 添加第一个标题的词汇
        title1Words.forEach(word => {
            if (!mergedWords.includes(word) && allWords.has(word.toLowerCase())) {
                mergedWords.push(word);
            }
        });
        // 添加第二个标题的独特词汇
        title2Words.forEach(word => {
            if (!mergedWords.includes(word) && allWords.has(word.toLowerCase())) {
                mergedWords.push(word);
            }
        });
        return mergedWords.join(' ');
    }
    /**
     * 评估标签名称质量
     */
    static evaluateTagNameQuality(tagName) {
        let score = 0.5; // 基础分数
        // 长度评分
        if (tagName.length >= 3 && tagName.length <= 20)
            score += 0.2;
        if (tagName.length > 30)
            score -= 0.1;
        // 字符评分
        const hasValidChars = /^[a-zA-Z0-9\u4e00-\u9fff\s\-_]+$/.test(tagName);
        if (hasValidChars)
            score += 0.2;
        // 大小写评分
        if (tagName === tagName.toLowerCase() ||
            /^[A-Z][a-z]+([A-Z][a-z]*)*$/.test(tagName)) {
            score += 0.1;
        }
        // 特殊字符评分
        const specialChars = tagName.match(/[^a-zA-Z0-9\u4e00-\u9fff\s]/g);
        if (specialChars && specialChars.length > 2)
            score -= 0.1;
        return Math.max(0, Math.min(1, score));
    }
    /**
     * 默认建议
     */
    static getDefaultSuggestion() {
        return {
            type: 'manual',
            confidence: 0.5,
            reason: '无法自动确定最佳解决方案，建议手动处理'
        };
    }
    /**
     * 应用解决方案
     */
    static applyResolution(conflict, resolution) {
        switch (resolution.type) {
            case 'keep_local':
                return this.getLocalVersion(conflict);
            case 'keep_remote':
                return this.getRemoteVersion(conflict);
            case 'merge':
                return this.mergeVersions(conflict, resolution.mergedData);
            case 'manual':
                return resolution.mergedData || resolution.manualChanges;
            default:
                throw new Error(`Unknown resolution type: ${resolution.type}`);
        }
    }
    /**
     * 获取本地版本
     */
    static getLocalVersion(conflict) {
        if (conflict.entityType === 'card') {
            const cardConflict = conflict;
            return cardConflict.localVersion;
        }
        return conflict.localVersion;
    }
    /**
     * 获取远程版本
     */
    static getRemoteVersion(conflict) {
        if (conflict.entityType === 'card') {
            const cardConflict = conflict;
            return cardConflict.remoteVersion;
        }
        return conflict.remoteVersion;
    }
    /**
     * 合并版本
     */
    static mergeVersions(conflict, mergedData) {
        if (!mergedData) {
            // 如果没有提供合并数据，使用智能合并
            return this.smartMerge(conflict);
        }
        return mergedData;
    }
    /**
     * 智能合并
     */
    static smartMerge(conflict) {
        if (conflict.entityType === 'card') {
            const cardConflict = conflict;
            const local = cardConflict.localVersion;
            const remote = cardConflict.remoteVersion;
            return {
                content: {
                    frontContent: {
                        title: this.mergeTitles(local.content.frontContent.title, remote.content.frontContent.title),
                        text: this.mergeText(local.content.frontContent.text, remote.content.frontContent.text),
                        tags: [...new Set([
                                ...local.content.frontContent.tags,
                                ...remote.content.frontContent.tags
                            ])],
                        lastModified: new Date()
                    },
                    backContent: {
                        title: this.mergeTitles(local.content.backContent.title, remote.content.backContent.title),
                        text: this.mergeText(local.content.backContent.text, remote.content.backContent.text),
                        tags: [...new Set([
                                ...local.content.backContent.tags,
                                ...remote.content.backContent.tags
                            ])],
                        lastModified: new Date()
                    }
                },
                style: local.style,
                folderId: local.folderId,
                isFlipped: local.isFlipped,
                updatedAt: new Date()
            };
        }
        // 其他类型冲突的默认合并策略
        return this.getLocalVersion(conflict);
    }
    /**
     * 合并文本内容
     */
    static mergeText(text1, text2) {
        if (text1 === text2)
            return text1;
        // 简单的文本合并策略
        const sentences1 = text1.split(/[.!?]+/).filter(s => s.trim());
        const sentences2 = text2.split(/[.!?]+/).filter(s => s.trim());
        // 去重合并
        const allSentences = new Set([
            ...sentences1.map(s => s.trim()),
            ...sentences2.map(s => s.trim())
        ]);
        return Array.from(allSentences)
            .filter(s => s.length > 0)
            .join('. ') + '.';
    }
}
exports.ConflictResolutionEngine = ConflictResolutionEngine;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcdXRpbHNcXGNvbmZsaWN0LXJlc29sdXRpb24udHMiLCJtYXBwaW5ncyI6Ijs7O0FBU0EsTUFBYSx3QkFBd0I7SUFDbkM7O09BRUc7SUFDSCxNQUFNLENBQUMsbUJBQW1CLENBQUMsUUFBc0I7UUFDL0MsTUFBTSxXQUFXLEdBQXlCLEVBQUUsQ0FBQTtRQUU1QyxRQUFRLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUN0QixLQUFLLGNBQWM7Z0JBQ2pCLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsOEJBQThCLENBQUMsUUFBd0IsQ0FBQyxDQUFDLENBQUE7Z0JBQ2xGLE1BQUs7WUFDUCxLQUFLLGFBQWE7Z0JBQ2hCLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsNkJBQTZCLENBQUMsUUFBMEIsQ0FBQyxDQUFDLENBQUE7Z0JBQ25GLE1BQUs7WUFDUCxLQUFLLFlBQVk7Z0JBQ2YsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxRQUF1QixDQUFDLENBQUMsQ0FBQTtnQkFDL0UsTUFBSztZQUNQO2dCQUNFLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUMsQ0FBQTtRQUNqRCxDQUFDO1FBRUQsT0FBTyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUE7SUFDaEUsQ0FBQztJQUVEOztPQUVHO0lBQ0ssTUFBTSxDQUFDLDhCQUE4QixDQUFDLFFBQXNCO1FBQ2xFLE1BQU0sV0FBVyxHQUF5QixFQUFFLENBQUE7UUFDNUMsTUFBTSxFQUFFLFlBQVksRUFBRSxhQUFhLEVBQUUsR0FBRyxRQUFRLENBQUE7UUFFaEQsYUFBYTtRQUNiLE1BQU0sZUFBZSxHQUFHLElB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LE1BQU0sWUFBWSxHQUFHLElBQUksR0FBRyxDQUFDO1lBQzNCLEdBQUcsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUNoQyxHQUFHLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7U0FDakMsQ0FBQyxDQUFBO1FBRUYsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQzthQUM1QixNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQzthQUN6QixJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFBO0lBQ3JCLENBQUM7Q0FDRjtBQTViRCw0REE0YkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcdXRpbHNcXGNvbmZsaWN0LXJlc29sdXRpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUge1xyXG4gIENvbmZsaWN0QmFzZSxcclxuICBDYXJkQ29uZmxpY3QsXHJcbiAgRm9sZGVyQ29uZmxpY3QsXHJcbiAgVGFnQ29uZmxpY3QsXHJcbiAgQ29uZmxpY3RTdWdnZXN0aW9uLFxyXG4gIENvbmZsaWN0UmVzb2x1dGlvblxyXG59IGZyb20gJy4uL3R5cGVzL2NvbmZsaWN0J1xyXG5cclxuZXhwb3J0IGNsYXNzIENvbmZsaWN0UmVzb2x1dGlvbkVuZ2luZSB7XHJcbiAgLyoqXHJcbiAgICog55Sf5oiQ5Yay56qB6Kej5Yaz5bu66K6uXHJcbiAgICovXHJcbiAgc3RhdGljIGdlbmVyYXRlU3VnZ2VzdGlvbnMoY29uZmxpY3Q6IENvbmZsaWN0QmFzZSk6IENvbmZsaWN0U3VnZ2VzdGlvbltdIHtcclxuICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBDb25mbGljdFN1Z2dlc3Rpb25bXSA9IFtdXHJcblxyXG4gICAgc3dpdGNoIChjb25mbGljdC50eXBlKSB7XHJcbiAgICAgIGNhc2UgJ2NhcmRfY29udGVudCc6XHJcbiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCguLi50aGlzLmdlbmVyYXRlQ2FyZENvbnRlbnRTdWdnZXN0aW9ucyhjb25mbGljdCBhcyBDYXJkQ29uZmxpY3QpKVxyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGNhc2UgJ2ZvbGRlcl9uYW1lJzpcclxuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKC4uLnRoaXMuZ2VuZXJhdGVGb2xkZXJOYW1lU3VnZ2VzdGlvbnMoY29uZmxpY3QgYXMgRm9sZGVyQ29uZmxpY3QpKVxyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGNhc2UgJ3RhZ19yZW5hbWUnOlxyXG4gICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goLi4udGhpcy5nZW5lcmF0ZVRhZ1JlbmFtZVN1Z2dlc3Rpb25zKGNvbmZsaWN0IGFzIFRhZ0NvbmZsaWN0KSlcclxuICAgICAgICBicmVha1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHN1Z2dlc3Rpb25zLnB1c2godGhpcy5nZXREZWZhdWx0U3VnZ2VzdGlvbigpKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBzdWdnZXN0aW9ucy5zb3J0KChhLCBiKSA9PiBiLmNvbmZpZGVuY2UgLSBhLmNvbmZpZGVuY2UpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDljaHniYflhoXlrrnlhrLnqoHlu7rorq5cclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZUNhcmRDb250ZW50U3VnZ2VzdGlvbnMoY29uZmxpY3Q6IENhcmRDb25mbGljdCk6IENvbmZsaWN0U3VnZ2VzdGlvbltdIHtcclxuICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBDb25mbGljdFN1Z2dlc3Rpb25bXSA9IFtdXHJcbiAgICBjb25zdCB7IGxvY2FsVmVyc2lvbiwgcmVtb3RlVmVyc2lvbiB9ID0gY29uZmxpY3RcclxuXHJcbiAgICAvLyAxLiDlhoXlrrnnm7jkvLzluqbliIbmnpBcclxuICAgIGNvbnN0IHRpdGxlU2ltaWxhcml0eSA9IHRoaXMuY2FsY3VsYXRlU2ltaWxhcml0eShcclxuICAgICAgbG9jYWxWZXJzaW9uLmNvbnRlbnQuZnJvbnRDb250ZW50LnRpdGxlLFxyXG4gICAgICByZW1vdGVWZXJzaW9uLmNvbnRlbnQuZnJvbnRDb250ZW50LnRpdGxlXHJcbiAgICApXHJcbiAgICBjb25zdCB0ZXh0U2ltaWxhcml0eSA9IHRoaXMuY2FsY3VsYXRlU2ltaWxhcml0eShcclxuICAgICAgbG9jYWxWZXJzaW9uLmNvbnRlbnQuZnJvbnRDb250ZW50LnRleHQsXHJcbiAgICAgIHJlbW90ZVZlcnNpb24uY29udGVudC5mcm9udENvbnRlbnQudGV4dFxyXG4gICAgKVxyXG5cclxuICAgIC8vIDIuIOaXtumXtOaIs+WIhuaekFxyXG4gICAgY29uc3QgdGltZURpZmYgPSBNYXRoLmFicyhcclxuICAgICAgbG9jYWxWZXJzaW9uLnVwZGF0ZWRBdC5nZXRUaW1lKCkgLSByZW1vdGVWZXJzaW9uLnVwZGF0ZWRBdC5nZXRUaW1lKClcclxuICAgIClcclxuICAgIGNvbnN0IGlzUmVjZW50Q29uZmxpY3QgPSB0aW1lRGlmZiA8IDUgKiA2MCAqIDEwMDAgLy8gNeWIhumSn+WGhVxyXG5cclxuICAgIC8vIDMuIOWGheWuuemVv+W6puWIhuaekFxyXG4gICAgY29uc3QgbG9jYWxMZW5ndGggPSBsb2NhbFZlcnNpb24uY29udGVudC5mcm9udENvbnRlbnQudGV4dC5sZW5ndGhcclxuICAgIGNvbnN0IHJlbW90ZUxlbmd0aCA9IHJlbW90ZVZlcnNpb24uY29udGVudC5mcm9udENvbnRlbnQudGV4dC5sZW5ndGhcclxuICAgIGNvbnN0IGxlbmd0aFJhdGlvID0gTWF0aC5tYXgobG9jYWxMZW5ndGgsIHJlbW90ZUxlbmd0aCkgLyBNYXRoLm1pbihsb2NhbExlbmd0aCwgcmVtb3RlTGVuZ3RoKVxyXG5cclxuICAgIC8vIOmrmOebuOS8vOW6puS4lOaXtumXtOaOpei/ke+8jOW7uuiuruWQiOW5tlxyXG4gICAgaWYgKHRpdGxlU2ltaWxhcml0eSA+IDAuOCAmJiB0ZXh0U2ltaWxhcml0eSA+IDAuNiAmJiBpc1JlY2VudENvbmZsaWN0KSB7XHJcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdtZXJnZScsXHJcbiAgICAgICAgY29uZmlkZW5jZTogMC45LFxyXG4gICAgICAgIHJlYXNvbjogJ+WGheWuuemrmOW6puebuOS8vO+8jOW7uuiuruaZuuiDveWQiOW5tuS/neeVmeacgOS9s+WGheWuuScsXHJcbiAgICAgICAgcHJldmlldzoge1xyXG4gICAgICAgICAgbWVyZ2VkVGl0bGU6IHRoaXMubWVyZ2VUaXRsZXMobG9jYWxWZXJzaW9uLmNvbnRlbnQuZnJvbnRDb250ZW50LnRpdGxlLCByZW1vdGVWZXJzaW9uLmNvbnRlbnQuZnJvbnRDb250ZW50LnRpdGxlKSxcclxuICAgICAgICAgIG1lcmdlZExlbmd0aDogTWF0aC5tYXgobG9jYWxMZW5ndGgsIHJlbW90ZUxlbmd0aClcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8g6L+c56iL54mI5pys5pu05paw5b6I5aSa77yM5bu66K6u5L+d55WZ6L+c56iLXHJcbiAgICBpZiAocmVtb3RlVmVyc2lvbi51cGRhdGVkQXQuZ2V0VGltZSgpID4gbG9jYWxWZXJzaW9uLnVwZGF0ZWRBdC5nZXRUaW1lKCkgJiYgXHJcbiAgICAgICAgbGVuZ3RoUmF0aW8gPiAyICYmIFxyXG4gICAgICAgIHJlbW90ZUxlbmd0aCA+IGxvY2FsTGVuZ3RoKSB7XHJcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdrZWVwX3JlbW90ZScsXHJcbiAgICAgICAgY29uZmlkZW5jZTogMC44LFxyXG4gICAgICAgIHJlYXNvbjogJ+i/nOeoi+eJiOacrOWGheWuueabtOS4sOWvjOS4lOabtOaWsOaXtumXtOabtOi/kSdcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDmnKzlnLDniYjmnKzljIXlkKvni6znibnmoIfnrb7vvIzlu7rorq7kv53nlZnmnKzlnLBcclxuICAgIGNvbnN0IGxvY2FsVGFncyA9IG5ldyBTZXQobG9jYWxWZXJzaW9uLmNvbnRlbnQuZnJvbnRDb250ZW50LnRhZ3MpXHJcbiAgICBjb25zdCByZW1vdGVUYWdzID0gbmV3IFNldChyZW1vdGVWZXJzaW9uLmNvbnRlbnQuZnJvbnRDb250ZW50LnRhZ3MpXHJcbiAgICBjb25zdCB1bmlxdWVMb2NhbFRhZ3MgPSBbLi4ubG9jYWxUYWdzXS5maWx0ZXIodGFnID0+ICFyZW1vdGVUYWdzLmhhcyh0YWcpKVxyXG4gICAgXHJcbiAgICBpZiAodW5pcXVlTG9jYWxUYWdzLmxlbmd0aCA+IDAgJiYgdW5pcXVlTG9jYWxUYWdzLmxlbmd0aCAvIGxvY2FsVGFncy5zaXplID4gMC4zKSB7XHJcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdrZWVwX2xvY2FsJyxcclxuICAgICAgICBjb25maWRlbmNlOiAwLjcsXHJcbiAgICAgICAgcmVhc29uOiAn5pys5Zyw54mI5pys5YyF5ZCr54us54m55qCH562+77yM5Y+v6IO95YyF5ZCr6YeN6KaB5YiG57G75L+h5oGvJ1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOm7mOiupOW7uuiuruS/neeVmeacgOaWsOeJiOacrFxyXG4gICAgY29uc3QgbGF0ZXN0VmVyc2lvbiA9IGxvY2FsVmVyc2lvbi51cGRhdGVkQXQuZ2V0VGltZSgpID4gcmVtb3RlVmVyc2lvbi51cGRhdGVkQXQuZ2V0VGltZSgpID8gJ2xvY2FsJyA6ICdyZW1vdGUnXHJcbiAgICBzdWdnZXN0aW9ucy5wdXNoKHtcclxuICAgICAgdHlwZTogbGF0ZXN0VmVyc2lvbiA9PT0gJ2xvY2FsJyA/ICdrZWVwX2xvY2FsJyA6ICdrZWVwX3JlbW90ZScsXHJcbiAgICAgIGNvbmZpZGVuY2U6IDAuNixcclxuICAgICAgcmVhc29uOiBg5L+d55WZ5pyA5paw54mI5pys77yIJHtsYXRlc3RWZXJzaW9uID09PSAnbG9jYWwnID8gJ+acrOWcsCcgOiAn6L+c56iLJ33orr7lpIfvvIlgXHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBzdWdnZXN0aW9uc1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5paH5Lu25aS55ZCN56ew5Yay56qB5bu66K6uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVGb2xkZXJOYW1lU3VnZ2VzdGlvbnMoY29uZmxpY3Q6IEZvbGRlckNvbmZsaWN0KTogQ29uZmxpY3RTdWdnZXN0aW9uW10ge1xyXG4gICAgY29uc3Qgc3VnZ2VzdGlvbnM6IENvbmZsaWN0U3VnZ2VzdGlvbltdID0gW11cclxuICAgIGNvbnN0IHsgbG9jYWxWZXJzaW9uLCByZW1vdGVWZXJzaW9uIH0gPSBjb25mbGljdFxyXG5cclxuICAgIGNvbnN0IGxvY2FsTmFtZSA9IGxvY2FsVmVyc2lvbi5uYW1lLnRvTG93ZXJDYXNlKClcclxuICAgIGNvbnN0IHJlbW90ZU5hbWUgPSByZW1vdGVWZXJzaW9uLm5hbWUudG9Mb3dlckNhc2UoKVxyXG5cclxuICAgIC8vIOWQjeensOWujOWFqOebuOWQjO+8jOS4jemcgOimgeWkhOeQhlxyXG4gICAgaWYgKGxvY2FsTmFtZSA9PT0gcmVtb3RlTmFtZSkge1xyXG4gICAgICByZXR1cm4gW11cclxuICAgIH1cclxuXHJcbiAgICAvLyDnm7jkvLzluqbpq5jvvIzlu7rorq7lkIjlubZcclxuICAgIGNvbnN0IHNpbWlsYXJpdHkgPSB0aGlzLmNhbGN1bGF0ZVNpbWlsYXJpdHkobG9jYWxWZXJzaW9uLm5hbWUsIHJlbW90ZVZlcnNpb24ubmFtZSlcclxuICAgIGlmIChzaW1pbGFyaXR5ID4gMC44KSB7XHJcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdtZXJnZScsXHJcbiAgICAgICAgY29uZmlkZW5jZTogMC45LFxyXG4gICAgICAgIHJlYXNvbjogJ+aWh+S7tuWkueWQjeensOebuOS8vO+8jOW7uuiurue7n+S4gOWRveWQjSdcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDkuIDkuKrmmK/lj6bkuIDkuKrnmoTlrZDpm4bvvIzlu7rorq7kv53nlZnmm7TlrozmlbTnmoRcclxuICAgIGlmIChsb2NhbE5hbWUuaW5jbHVkZXMocmVtb3RlTmFtZSkgfHwgcmVtb3RlTmFtZS5pbmNsdWRlcyhsb2NhbE5hbWUpKSB7XHJcbiAgICAgIGNvbnN0IGxvbmdlck5hbWUgPSBsb2NhbFZlcnNpb24ubmFtZS5sZW5ndGggPiByZW1vdGVWZXJzaW9uLm5hbWUubGVuZ3RoID8gJ2xvY2FsJyA6ICdyZW1vdGUnXHJcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xyXG4gICAgICAgIHR5cGU6IGxvbmdlck5hbWUgPT09ICdsb2NhbCcgPyAna2VlcF9sb2NhbCcgOiAna2VlcF9yZW1vdGUnLFxyXG4gICAgICAgIGNvbmZpZGVuY2U6IDAuOCxcclxuICAgICAgICByZWFzb246ICfkv53nlZnmm7Tlhbfmj4/ov7DmgKfnmoTmlofku7blpLnlkI3np7AnXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5oyJ5pe26Ze05oiz5bu66K6u5L+d55WZ5pyA5pawXHJcbiAgICBjb25zdCBsYXRlc3RWZXJzaW9uID0gbG9jYWxWZXJzaW9uLnVwZGF0ZWRBdC5nZXRUaW1lKCkgPiByZW1vdGVWZXJzaW9uLnVwZGF0ZWRBdC5nZXRUaW1lKCkgPyAnbG9jYWwnIDogJ3JlbW90ZSdcclxuICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xyXG4gICAgICB0eXBlOiBsYXRlc3RWZXJzaW9uID09PSAnbG9jYWwnID8gJ2tlZXBfbG9jYWwnIDogJ2tlZXBfcmVtb3RlJyxcclxuICAgICAgY29uZmlkZW5jZTogMC42LFxyXG4gICAgICByZWFzb246IGDkv53nlZnmnIDmlrDkv67mlLnnmoTniYjmnKzvvIgke2xhdGVzdFZlcnNpb24gPT09ICdsb2NhbCcgPyAn5pys5ZywJyA6ICfov5znqIsnfe+8iWBcclxuICAgIH0pXHJcblxyXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmoIfnrb7ph43lkb3lkI3lhrLnqoHlu7rorq5cclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZVRhZ1JlbmFtZVN1Z2dlc3Rpb25zKGNvbmZsaWN0OiBUYWdDb25mbGljdCk6IENvbmZsaWN0U3VnZ2VzdGlvbltdIHtcclxuICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBDb25mbGljdFN1Z2dlc3Rpb25bXSA9IFtdXHJcbiAgICBjb25zdCB7IGxvY2FsVmVyc2lvbiwgcmVtb3RlVmVyc2lvbiB9ID0gY29uZmxpY3RcclxuXHJcbiAgICAvLyDliIbmnpDkvb/nlKjpopHnjodcclxuICAgIGNvbnN0IHVzYWdlUmF0aW8gPSBsb2NhbFZlcnNpb24uY291bnQgLyBNYXRoLm1heChyZW1vdGVWZXJzaW9uLmNvdW50LCAxKVxyXG5cclxuICAgIC8vIOS9v+eUqOmikeeOh+W3ruW8guWkp++8jOW7uuiuruS/neeVmemrmOmikeS9v+eUqOeahFxyXG4gICAgaWYgKHVzYWdlUmF0aW8gPiAyKSB7XHJcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdrZWVwX2xvY2FsJyxcclxuICAgICAgICBjb25maWRlbmNlOiAwLjksXHJcbiAgICAgICAgcmVhc29uOiBg5pys5Zyw5qCH562+5L2/55So6aKR546H5pu06auY77yIJHtsb2NhbFZlcnNpb24uY291bnR95qyhIHZzICR7cmVtb3RlVmVyc2lvbi5jb3VudH3mrKHvvIlgXHJcbiAgICAgIH0pXHJcbiAgICB9IGVsc2UgaWYgKHVzYWdlUmF0aW8gPCAwLjUpIHtcclxuICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XHJcbiAgICAgICAgdHlwZTogJ2tlZXBfcmVtb3RlJyxcclxuICAgICAgICBjb25maWRlbmNlOiAwLjksXHJcbiAgICAgICAgcmVhc29uOiBg6L+c56iL5qCH562+5L2/55So6aKR546H5pu06auY77yIJHtyZW1vdGVWZXJzaW9uLmNvdW50feasoSB2cyAke2xvY2FsVmVyc2lvbi5jb3VudH3mrKHvvIlgXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5ZCN56ew6LSo6YeP5YiG5p6QXHJcbiAgICBjb25zdCBsb2NhbFF1YWxpdHkgPSB0aGlzLmV2YWx1YXRlVGFnTmFtZVF1YWxpdHkobG9jYWxWZXJzaW9uLm5hbWUpXHJcbiAgICBjb25zdCByZW1vdGVRdWFsaXR5ID0gdGhpcy5ldmFsdWF0ZVRhZ05hbWVRdWFsaXR5KHJlbW90ZVZlcnNpb24ubmFtZSlcclxuXHJcbiAgICBpZiAoTWF0aC5hYnMobG9jYWxRdWFsaXR5IC0gcmVtb3RlUXVhbGl0eSkgPiAwLjMpIHtcclxuICAgICAgY29uc3QgYmV0dGVyVmVyc2lvbiA9IGxvY2FsUXVhbGl0eSA+IHJlbW90ZVF1YWxpdHkgPyAnbG9jYWwnIDogJ3JlbW90ZSdcclxuICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XHJcbiAgICAgICAgdHlwZTogYmV0dGVyVmVyc2lvbiA9PT0gJ2xvY2FsJyA/ICdrZWVwX2xvY2FsJyA6ICdrZWVwX3JlbW90ZScsXHJcbiAgICAgICAgY29uZmlkZW5jZTogMC44LFxyXG4gICAgICAgIHJlYXNvbjogYCR7YmV0dGVyVmVyc2lvbiA9PT0gJ2xvY2FsJyA/ICfmnKzlnLAnIDogJ+i/nOeoiyd95qCH562+5ZCN56ew6LSo6YeP5pu05aW9YFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOaMieaXtumXtOaIs+W7uuiurlxyXG4gICAgY29uc3QgbGF0ZXN0VmVyc2lvbiA9IGxvY2FsVmVyc2lvbi51cGRhdGVkQXQuZ2V0VGltZSgpID4gcmVtb3RlVmVyc2lvbi51cGRhdGVkQXQuZ2V0VGltZSgpID8gJ2xvY2FsJyA6ICdyZW1vdGUnXHJcbiAgICBzdWdnZXN0aW9ucy5wdXNoKHtcclxuICAgICAgdHlwZTogbGF0ZXN0VmVyc2lvbiA9PT0gJ2xvY2FsJyA/ICdrZWVwX2xvY2FsJyA6ICdrZWVwX3JlbW90ZScsXHJcbiAgICAgIGNvbmZpZGVuY2U6IDAuNixcclxuICAgICAgcmVhc29uOiBg5L+d55WZ5pyA5paw5L+u5pS555qE54mI5pysYFxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnNcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiuoeeul+aWh+acrOebuOS8vOW6pu+8iOeugOWMlueJiO+8iVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIGNhbGN1bGF0ZVNpbWlsYXJpdHkodGV4dDE6IHN0cmluZywgdGV4dDI6IHN0cmluZyk6IG51bWJlciB7XHJcbiAgICBpZiAoIXRleHQxIHx8ICF0ZXh0MikgcmV0dXJuIDBcclxuXHJcbiAgICAvLyDovazmjaLkuLrlsI/lhpnlubbljrvpmaTnqbrmoLxcclxuICAgIGNvbnN0IGNsZWFuMSA9IHRleHQxLnRvTG93ZXJDYXNlKCkudHJpbSgpXHJcbiAgICBjb25zdCBjbGVhbjIgPSB0ZXh0Mi50b0xvd2VyQ2FzZSgpLnRyaW0oKVxyXG5cclxuICAgIGlmIChjbGVhbjEgPT09IGNsZWFuMikgcmV0dXJuIDEuMFxyXG5cclxuICAgIC8vIOiuoeeul+e8lui+kei3neemu+ebuOS8vOW6plxyXG4gICAgY29uc3QgbWF4TGVuZ3RoID0gTWF0aC5tYXgoY2xlYW4xLmxlbmd0aCwgY2xlYW4yLmxlbmd0aClcclxuICAgIGlmIChtYXhMZW5ndGggPT09IDApIHJldHVybiAxLjBcclxuXHJcbiAgICBjb25zdCBkaXN0YW5jZSA9IHRoaXMubGV2ZW5zaHRlaW5EaXN0YW5jZShjbGVhbjEsIGNsZWFuMilcclxuICAgIHJldHVybiAxIC0gKGRpc3RhbmNlIC8gbWF4TGVuZ3RoKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6K6h566XTGV2ZW5zaHRlaW7ot53nprtcclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyBsZXZlbnNodGVpbkRpc3RhbmNlKHN0cjE6IHN0cmluZywgc3RyMjogc3RyaW5nKTogbnVtYmVyIHtcclxuICAgIGNvbnN0IG1hdHJpeCA9IEFycmF5KHN0cjIubGVuZ3RoICsgMSkuZmlsbChudWxsKS5tYXAoKCkgPT4gQXJyYXkoc3RyMS5sZW5ndGggKyAxKS5maWxsKG51bGwpKVxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHN0cjEubGVuZ3RoOyBpICs9IDEpIG1hdHJpeFswXVtpXSA9IGlcclxuICAgIGZvciAobGV0IGogPSAwOyBqIDw9IHN0cjIubGVuZ3RoOyBqICs9IDEpIG1hdHJpeFtqXVswXSA9IGpcclxuXHJcbiAgICBmb3IgKGxldCBqID0gMTsgaiA8PSBzdHIyLmxlbmd0aDsgaiArPSAxKSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHN0cjEubGVuZ3RoOyBpICs9IDEpIHtcclxuICAgICAgICBjb25zdCBpbmRpY2F0b3IgPSBzdHIxW2kgLSAxXSA9PT0gc3RyMltqIC0gMV0gPyAwIDogMVxyXG4gICAgICAgIG1hdHJpeFtqXVtpXSA9IE1hdGgubWluKFxyXG4gICAgICAgICAgbWF0cml4W2pdW2kgLSAxXSArIDEsIC8vIGRlbGV0aW9uXHJcbiAgICAgICAgICBtYXRyaXhbaiAtIDFdW2ldICsgMSwgLy8gaW5zZXJ0aW9uXHJcbiAgICAgICAgICBtYXRyaXhbaiAtIDFdW2kgLSAxXSArIGluZGljYXRvciAvLyBzdWJzdGl0dXRpb25cclxuICAgICAgICApXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbWF0cml4W3N0cjIubGVuZ3RoXVtzdHIxLmxlbmd0aF1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWQiOW5tuagh+mimFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIG1lcmdlVGl0bGVzKHRpdGxlMTogc3RyaW5nLCB0aXRsZTI6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBpZiAodGl0bGUxID09PSB0aXRsZTIpIHJldHVybiB0aXRsZTFcclxuICAgIFxyXG4gICAgLy8g5aaC5p6c5LiA5Liq5qCH6aKY5piv5Y+m5LiA5Liq55qE5omp5bGV77yM6YCJ5oup5pu06ZW/55qEXHJcbiAgICBpZiAodGl0bGUxLmluY2x1ZGVzKHRpdGxlMikgJiYgdGl0bGUxLmxlbmd0aCA+IHRpdGxlMi5sZW5ndGgpIHJldHVybiB0aXRsZTFcclxuICAgIGlmICh0aXRsZTIuaW5jbHVkZXModGl0bGUxKSAmJiB0aXRsZTIubGVuZ3RoID4gdGl0bGUxLmxlbmd0aCkgcmV0dXJuIHRpdGxlMlxyXG4gICAgXHJcbiAgICAvLyDlkIjlubbkuKTkuKrmoIfpopjnmoTlhbPplK7or41cclxuICAgIGNvbnN0IHdvcmRzMSA9IG5ldyBTZXQodGl0bGUxLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKSlcclxuICAgIGNvbnN0IHdvcmRzMiA9IG5ldyBTZXQodGl0bGUyLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKSlcclxuICAgIGNvbnN0IGFsbFdvcmRzID0gbmV3IFNldChbLi4ud29yZHMxLCAuLi53b3JkczJdKVxyXG4gICAgXHJcbiAgICAvLyDph43mlrDnu4TlkIjvvIzkv53nlZnljp/mnInpobrluo9cclxuICAgIGNvbnN0IHRpdGxlMVdvcmRzID0gdGl0bGUxLnNwbGl0KC9cXHMrLylcclxuICAgIGNvbnN0IHRpdGxlMldvcmRzID0gdGl0bGUyLnNwbGl0KC9cXHMrLylcclxuICAgIGNvbnN0IG1lcmdlZFdvcmRzOiBzdHJpbmdbXSA9IFtdXHJcbiAgICBcclxuICAgIC8vIOa3u+WKoOesrOS4gOS4quagh+mimOeahOivjeaxh1xyXG4gICAgdGl0bGUxV29yZHMuZm9yRWFjaCh3b3JkID0+IHtcclxuICAgICAgaWYgKCFtZXJnZWRXb3Jkcy5pbmNsdWRlcyh3b3JkKSAmJiBhbGxXb3Jkcy5oYXMod29yZC50b0xvd2VyQ2FzZSgpKSkge1xyXG4gICAgICAgIG1lcmdlZFdvcmRzLnB1c2god29yZClcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIFxyXG4gICAgLy8g5re75Yqg56ys5LqM5Liq5qCH6aKY55qE54us54m56K+N5rGHXHJcbiAgICB0aXRsZTJXb3Jkcy5mb3JFYWNoKHdvcmQgPT4ge1xyXG4gICAgICBpZiAoIW1lcmdlZFdvcmRzLmluY2x1ZGVzKHdvcmQpICYmIGFsbFdvcmRzLmhhcyh3b3JkLnRvTG93ZXJDYXNlKCkpKSB7XHJcbiAgICAgICAgbWVyZ2VkV29yZHMucHVzaCh3b3JkKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICByZXR1cm4gbWVyZ2VkV29yZHMuam9pbignICcpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDor4TkvLDmoIfnrb7lkI3np7DotKjph49cclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyBldmFsdWF0ZVRhZ05hbWVRdWFsaXR5KHRhZ05hbWU6IHN0cmluZyk6IG51bWJlciB7XHJcbiAgICBsZXQgc2NvcmUgPSAwLjUgLy8g5Z+656GA5YiG5pWwXHJcblxyXG4gICAgLy8g6ZW/5bqm6K+E5YiGXHJcbiAgICBpZiAodGFnTmFtZS5sZW5ndGggPj0gMyAmJiB0YWdOYW1lLmxlbmd0aCA8PSAyMCkgc2NvcmUgKz0gMC4yXHJcbiAgICBpZiAodGFnTmFtZS5sZW5ndGggPiAzMCkgc2NvcmUgLT0gMC4xXHJcblxyXG4gICAgLy8g5a2X56ym6K+E5YiGXHJcbiAgICBjb25zdCBoYXNWYWxpZENoYXJzID0gL15bYS16QS1aMC05XFx1NGUwMC1cXHU5ZmZmXFxzXFwtX10rJC8udGVzdCh0YWdOYW1lKVxyXG4gICAgaWYgKGhhc1ZhbGlkQ2hhcnMpIHNjb3JlICs9IDAuMlxyXG5cclxuICAgIC8vIOWkp+Wwj+WGmeivhOWIhlxyXG4gICAgaWYgKHRhZ05hbWUgPT09IHRhZ05hbWUudG9Mb3dlckNhc2UoKSB8fCBcclxuICAgICAgICAvXltBLVpdW2Etel0rKFtBLVpdW2Etel0qKSokLy50ZXN0KHRhZ05hbWUpKSB7XHJcbiAgICAgIHNjb3JlICs9IDAuMVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOeJueauiuWtl+espuivhOWIhlxyXG4gICAgY29uc3Qgc3BlY2lhbENoYXJzID0gdGFnTmFtZS5tYXRjaCgvW15hLXpBLVowLTlcXHU0ZTAwLVxcdTlmZmZcXHNdL2cpXHJcbiAgICBpZiAoc3BlY2lhbENoYXJzICYmIHNwZWNpYWxDaGFycy5sZW5ndGggPiAyKSBzY29yZSAtPSAwLjFcclxuXHJcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgc2NvcmUpKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6buY6K6k5bu66K6uXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0RGVmYXVsdFN1Z2dlc3Rpb24oKTogQ29uZmxpY3RTdWdnZXN0aW9uIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHR5cGU6ICdtYW51YWwnLFxyXG4gICAgICBjb25maWRlbmNlOiAwLjUsXHJcbiAgICAgIHJlYXNvbjogJ+aXoOazleiHquWKqOehruWumuacgOS9s+ino+WGs+aWueahiO+8jOW7uuiuruaJi+WKqOWkhOeQhidcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOW6lOeUqOino+WGs+aWueahiFxyXG4gICAqL1xyXG4gIHN0YXRpYyBhcHBseVJlc29sdXRpb24oXHJcbiAgICBjb25mbGljdDogQ29uZmxpY3RCYXNlLCBcclxuICAgIHJlc29sdXRpb246IENvbmZsaWN0UmVzb2x1dGlvblxyXG4gICk6IGFueSB7XHJcbiAgICBzd2l0Y2ggKHJlc29sdXRpb24udHlwZSkge1xyXG4gICAgICBjYXNlICdrZWVwX2xvY2FsJzpcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRMb2NhbFZlcnNpb24oY29uZmxpY3QpXHJcbiAgICAgIFxyXG4gICAgICBjYXNlICdrZWVwX3JlbW90ZSc6XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVtb3RlVmVyc2lvbihjb25mbGljdClcclxuICAgICAgXHJcbiAgICAgIGNhc2UgJ21lcmdlJzpcclxuICAgICAgICByZXR1cm4gdGhpcy5tZXJnZVZlcnNpb25zKGNvbmZsaWN0LCByZXNvbHV0aW9uLm1lcmdlZERhdGEpXHJcbiAgICAgIFxyXG4gICAgICBjYXNlICdtYW51YWwnOlxyXG4gICAgICAgIHJldHVybiByZXNvbHV0aW9uLm1lcmdlZERhdGEgfHwgcmVzb2x1dGlvbi5tYW51YWxDaGFuZ2VzXHJcbiAgICAgIFxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biByZXNvbHV0aW9uIHR5cGU6ICR7cmVzb2x1dGlvbi50eXBlfWApXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bmnKzlnLDniYjmnKxcclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyBnZXRMb2NhbFZlcnNpb24oY29uZmxpY3Q6IENvbmZsaWN0QmFzZSk6IGFueSB7XHJcbiAgICBpZiAoY29uZmxpY3QuZW50aXR5VHlwZSA9PT0gJ2NhcmQnKSB7XHJcbiAgICAgIGNvbnN0IGNhcmRDb25mbGljdCA9IGNvbmZsaWN0IGFzIENhcmRDb25mbGljdFxyXG4gICAgICByZXR1cm4gY2FyZENvbmZsaWN0LmxvY2FsVmVyc2lvblxyXG4gICAgfVxyXG4gICAgcmV0dXJuIChjb25mbGljdCBhcyBhbnkpLmxvY2FsVmVyc2lvblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W6L+c56iL54mI5pysXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0UmVtb3RlVmVyc2lvbihjb25mbGljdDogQ29uZmxpY3RCYXNlKTogYW55IHtcclxuICAgIGlmIChjb25mbGljdC5lbnRpdHlUeXBlID09PSAnY2FyZCcpIHtcclxuICAgICAgY29uc3QgY2FyZENvbmZsaWN0ID0gY29uZmxpY3QgYXMgQ2FyZENvbmZsaWN0XHJcbiAgICAgIHJldHVybiBjYXJkQ29uZmxpY3QucmVtb3RlVmVyc2lvblxyXG4gICAgfVxyXG4gICAgcmV0dXJuIChjb25mbGljdCBhcyBhbnkpLnJlbW90ZVZlcnNpb25cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWQiOW5tueJiOacrFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIG1lcmdlVmVyc2lvbnMoY29uZmxpY3Q6IENvbmZsaWN0QmFzZSwgbWVyZ2VkRGF0YT86IGFueSk6IGFueSB7XHJcbiAgICBpZiAoIW1lcmdlZERhdGEpIHtcclxuICAgICAgLy8g5aaC5p6c5rKh5pyJ5o+Q5L6b5ZCI5bm25pWw5o2u77yM5L2/55So5pm66IO95ZCI5bm2XHJcbiAgICAgIHJldHVybiB0aGlzLnNtYXJ0TWVyZ2UoY29uZmxpY3QpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWVyZ2VkRGF0YVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5pm66IO95ZCI5bm2XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgc21hcnRNZXJnZShjb25mbGljdDogQ29uZmxpY3RCYXNlKTogYW55IHtcclxuICAgIGlmIChjb25mbGljdC5lbnRpdHlUeXBlID09PSAnY2FyZCcpIHtcclxuICAgICAgY29uc3QgY2FyZENvbmZsaWN0ID0gY29uZmxpY3QgYXMgQ2FyZENvbmZsaWN0XHJcbiAgICAgIGNvbnN0IGxvY2FsID0gY2FyZENvbmZsaWN0LmxvY2FsVmVyc2lvblxyXG4gICAgICBjb25zdCByZW1vdGUgPSBjYXJkQ29uZmxpY3QucmVtb3RlVmVyc2lvblxyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBjb250ZW50OiB7XHJcbiAgICAgICAgICBmcm9udENvbnRlbnQ6IHtcclxuICAgICAgICAgICAgdGl0bGU6IHRoaXMubWVyZ2VUaXRsZXMoXHJcbiAgICAgICAgICAgICAgbG9jYWwuY29udGVudC5mcm9udENvbnRlbnQudGl0bGUsXHJcbiAgICAgICAgICAgICAgcmVtb3RlLmNvbnRlbnQuZnJvbnRDb250ZW50LnRpdGxlXHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIHRleHQ6IHRoaXMubWVyZ2VUZXh0KFxyXG4gICAgICAgICAgICAgIGxvY2FsLmNvbnRlbnQuZnJvbnRDb250ZW50LnRleHQsXHJcbiAgICAgICAgICAgICAgcmVtb3RlLmNvbnRlbnQuZnJvbnRDb250ZW50LnRleHRcclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgdGFnczogWy4uLm5ldyBTZXQoW1xyXG4gICAgICAgICAgICAgIC4uLmxvY2FsLmNvbnRlbnQuZnJvbnRDb250ZW50LnRhZ3MsXHJcbiAgICAgICAgICAgICAgLi4ucmVtb3RlLmNvbnRlbnQuZnJvbnRDb250ZW50LnRhZ3NcclxuICAgICAgICAgICAgXSldLFxyXG4gICAgICAgICAgICBsYXN0TW9kaWZpZWQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBiYWNrQ29udGVudDoge1xyXG4gICAgICAgICAgICB0aXRsZTogdGhpcy5tZXJnZVRpdGxlcyhcclxuICAgICAgICAgICAgICBsb2NhbC5jb250ZW50LmJhY2tDb250ZW50LnRpdGxlLFxyXG4gICAgICAgICAgICAgIHJlbW90ZS5jb250ZW50LmJhY2tDb250ZW50LnRpdGxlXHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIHRleHQ6IHRoaXMubWVyZ2VUZXh0KFxyXG4gICAgICAgICAgICAgIGxvY2FsLmNvbnRlbnQuYmFja0NvbnRlbnQudGV4dCxcclxuICAgICAgICAgICAgICByZW1vdGUuY29udGVudC5iYWNrQ29udGVudC50ZXh0XHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIHRhZ3M6IFsuLi5uZXcgU2V0KFtcclxuICAgICAgICAgICAgICAuLi5sb2NhbC5jb250ZW50LmJhY2tDb250ZW50LnRhZ3MsXHJcbiAgICAgICAgICAgICAgLi4ucmVtb3RlLmNvbnRlbnQuYmFja0NvbnRlbnQudGFnc1xyXG4gICAgICAgICAgICBdKV0sXHJcbiAgICAgICAgICAgIGxhc3RNb2RpZmllZDogbmV3IERhdGUoKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3R5bGU6IGxvY2FsLnN0eWxlLFxyXG4gICAgICAgIGZvbGRlcklkOiBsb2NhbC5mb2xkZXJJZCxcclxuICAgICAgICBpc0ZsaXBwZWQ6IGxvY2FsLmlzRmxpcHBlZCxcclxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWFtuS7luexu+Wei+WGsueqgeeahOm7mOiupOWQiOW5tuetlueVpVxyXG4gICAgcmV0dXJuIHRoaXMuZ2V0TG9jYWxWZXJzaW9uKGNvbmZsaWN0KVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5ZCI5bm25paH5pys5YaF5a65XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgbWVyZ2VUZXh0KHRleHQxOiBzdHJpbmcsIHRleHQyOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaWYgKHRleHQxID09PSB0ZXh0MikgcmV0dXJuIHRleHQxXHJcbiAgICBcclxuICAgIC8vIOeugOWNleeahOaWh+acrOWQiOW5tuetlueVpVxyXG4gICAgY29uc3Qgc2VudGVuY2VzMSA9IHRleHQxLnNwbGl0KC9bLiE/XSsvKS5maWx0ZXIocyA9PiBzLnRyaW0oKSlcclxuICAgIGNvbnN0IHNlbnRlbmNlczIgPSB0ZXh0Mi5zcGxpdCgvWy4hP10rLykuZmlsdGVyKHMgPT4gcy50cmltKCkpXHJcbiAgICBcclxuICAgIC8vIOWOu+mHjeWQiOW5tlxyXG4gICAgY29uc3QgYWxsU2VudGVuY2VzID0gbmV3IFNldChbXHJcbiAgICAgIC4uLnNlbnRlbmNlczEubWFwKHMgPT4gcy50cmltKCkpLFxyXG4gICAgICAuLi5zZW50ZW5jZXMyLm1hcChzID0+IHMudHJpbSgpKVxyXG4gICAgXSlcclxuICAgIFxyXG4gICAgcmV0dXJuIEFycmF5LmZyb20oYWxsU2VudGVuY2VzKVxyXG4gICAgICAuZmlsdGVyKHMgPT4gcy5sZW5ndGggPiAwKVxyXG4gICAgICAuam9pbignLiAnKSArICcuJ1xyXG4gIH1cclxufSJdLCJ2ZXJzaW9uIjozfQ==