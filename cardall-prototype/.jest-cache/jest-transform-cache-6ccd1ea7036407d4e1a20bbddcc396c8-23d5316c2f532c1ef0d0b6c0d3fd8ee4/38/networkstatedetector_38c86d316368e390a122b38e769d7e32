a34f62a155e18482101e0541dd318353
"use strict";
// ============================================================================
// 网络状态检测器 - 为数据库层统一提供网络支持
// ============================================================================
Object.defineProperty(exports, "__esModule", { value: true });
exports.networkStateDetector = exports.NetworkStateDetector = void 0;
const network_monitor_1 = require("./network-monitor");
// ============================================================================
// 网络状态检测器主类
// ============================================================================
class NetworkStateDetector {
    constructor() {
        Object.defineProperty(this, "currentState", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "syncStrategy", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "listeners", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Set()
        });
        // 断路器状态
        Object.defineProperty(this, "circuitBreakers", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Map()
        });
        // 请求队列和批处理
        Object.defineProperty(this, "pendingRequests", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Map()
        });
        Object.defineProperty(this, "batchTimer", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: null
        });
        Object.defineProperty(this, "isProcessing", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        // 统计信息
        Object.defineProperty(this, "stats", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: {
                totalRequests: 0,
                successfulRequests: 0,
                failedRequests: 0,
                averageResponseTime: 0,
                lastError: null,
                circuitBreakerTrips: 0
            }
        });
        // 网络历史记录
        Object.defineProperty(this, "networkHistory", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        this.currentState = this.getInitialState();
        this.syncStrategy = this.getDefaultStrategy();
        this.initialize();
    }
    static getInstance() {
        if (!NetworkStateDetector.instance) {
            NetworkStateDetector.instance = new NetworkStateDetector();
        }
        return NetworkStateDetector.instance;
    }
    // 获取初始状态
    getInitialState() {
        const networkInfo = network_monitor_1.networkMonitorService.getCurrentState();
        return {
            isOnline: networkInfo.online,
            isReliable: this.calculateReliability(networkInfo),
            quality: network_monitor_1.networkMonitorService.getNetworkQuality(),
            qualityScore: network_monitor_1.networkMonitorService.getNetworkQualityScore(),
            connectionType: networkInfo.connectionType,
            effectiveType: networkInfo.effectiveType,
            downlink: networkInfo.downlink,
            rtt: networkInfo.rtt,
            canSync: this.canPerformSync(networkInfo),
            syncStrategy: this.getDefaultStrategy(),
            estimatedSyncTime: this.estimateSyncTime(networkInfo),
            lastUpdated: new Date()
        };
    }
    // 获取默认同步策略
    getDefaultStrategy() {
        return {
            batchSize: 10,
            batchDelay: 1000,
            connectTimeout: 5000,
            requestTimeout: 30000,
            totalTimeout: 120000,
            maxRetries: 3,
            retryDelay: 1000,
            retryBackoffMultiplier: 2,
            compressionEnabled: true,
            prioritySyncEnabled: true,
            backgroundSyncEnabled: true,
            circuitBreakerEnabled: true,
            failureThreshold: 5,
            recoveryTimeout: 60000
        };
    }
    // 初始化检测器
    initialize() {
        // 监听网络监控服务事件
        network_monitor_1.networkMonitorService.addEventListener(this.handleNetworkEvent.bind(this));
        // 初始化断路器
        this.initializeCircuitBreakers();
        // 初始化请求队列
        this.initializeRequestQueues();
        // 开始网络状态检查
        this.startPeriodicChecks();
        console.log('NetworkStateDetector initialized');
    }
    // 初始化断路器
    initializeCircuitBreakers() {
        const operations = ['read', 'write', 'delete', 'batch'];
        operations.forEach(operation => {
            const config = {
                failureThreshold: this.syncStrategy.failureThreshold,
                recoveryTimeout: this.syncStrategy.recoveryTimeout,
                expectedException: ['timeout', 'connection_lost', 'network_slow']
            };
            this.circuitBreakers.set(operation, {
                status: {
                    state: 'closed',
                    failureCount: 0,
                    config
                }
            });
        });
    }
    // 初始化请求队列
    initializeRequestQueues() {
        const priorities = ['critical', 'high', 'normal', 'low', 'background'];
        priorities.forEach(priority => {
            this.pendingRequests.set(priority, []);
        });
    }
    // 开始定期检查
    startPeriodicChecks() {
        // 每30秒检查一次网络状态
        setInterval(() => {
            this.updateNetworkState();
        }, 30000);
        // 每5分钟更新同步策略
        setInterval(() => {
            this.updateSyncStrategy();
        }, 300000);
    }
    // 处理网络事件
    handleNetworkEvent(event) {
        console.log('Network event detected:', event.type);
        // 更新网络状态
        this.updateNetworkState();
        // 根据事件类型采取不同行动
        switch (event.type) {
            case 'online':
                this.handleNetworkRestored();
                break;
            case 'offline':
                this.handleNetworkLost();
                break;
            case 'quality-change':
                this.handleQualityChange(event);
                break;
            case 'error':
                this.handleNetworkError(event);
                break;
        }
    }
    // 更新网络状态
    async updateNetworkState() {
        try {
            const networkInfo = await network_monitor_1.networkMonitorService.checkNetwork();
            const healthStatus = await network_monitor_1.networkMonitorService.performHealthCheck();
            const newState = {
                isOnline: networkInfo.online && healthStatus,
                isReliable: this.calculateReliability(networkInfo),
                quality: network_monitor_1.networkMonitorService.getNetworkQuality(),
                qualityScore: network_monitor_1.networkMonitorService.getNetworkQualityScore(),
                connectionType: networkInfo.connectionType,
                effectiveType: networkInfo.effectiveType,
                downlink: networkInfo.downlink,
                rtt: networkInfo.rtt,
                canSync: this.canPerformSync(networkInfo) && healthStatus,
                syncStrategy: this.syncStrategy,
                estimatedSyncTime: this.estimateSyncTime(networkInfo),
                lastUpdated: new Date(),
                lastStableTime: networkInfo.online ? new Date() : this.currentState.lastStableTime
            };
            // 检查状态是否有显著变化
            if (this.hasSignificantChange(this.currentState, newState)) {
                this.currentState = newState;
                this.notifyStateChanged();
                // 如果网络恢复，尝试处理队列
                if (newState.isOnline && newState.isReliable) {
                    this.processPendingRequests();
                }
            }
        }
        catch (error) {
            console.error('Failed to update network state:', error);
        }
    }
    // 更新同步策略
    updateSyncStrategy() {
        const newStrategy = this.calculateOptimalStrategy();
        if (this.hasStrategyChanged(this.syncStrategy, newStrategy)) {
            this.syncStrategy = newStrategy;
            this.currentState.syncStrategy = newStrategy;
            this.notifyStrategyChanged();
        }
    }
    // 计算最优同步策略
    calculateOptimalStrategy() {
        const quality = this.currentState.quality;
        const score = this.currentState.qualityScore;
        const baseStrategy = { ...this.getDefaultStrategy() };
        switch (quality) {
            case 'excellent':
                return {
                    ...baseStrategy,
                    batchSize: 50,
                    batchDelay: 500,
                    requestTimeout: 10000,
                    retryDelay: 500,
                    compressionEnabled: false
                };
            case 'good':
                return {
                    ...baseStrategy,
                    batchSize: 25,
                    batchDelay: 1000,
                    requestTimeout: 20000,
                    retryDelay: 1000
                };
            case 'fair':
                return {
                    ...baseStrategy,
                    batchSize: 10,
                    batchDelay: 2000,
                    requestTimeout: 30000,
                    compressionEnabled: true
                };
            case 'poor':
                return {
                    ...baseStrategy,
                    batchSize: 5,
                    batchDelay: 5000,
                    requestTimeout: 60000,
                    maxRetries: 5,
                    retryDelay: 2000,
                    compressionEnabled: true
                };
            default: // offline
                return {
                    ...baseStrategy,
                    batchSize: 1,
                    batchDelay: 10000,
                    requestTimeout: 120000,
                    maxRetries: 10,
                    compressionEnabled: true
                };
        }
    }
    // 计算网络可靠性
    calculateReliability(info) {
        if (!info.online)
            return false;
        // 多维度可靠性评估
        const factors = this.calculateReliabilityFactors(info);
        const overallScore = this.calculateOverallReliabilityScore(factors);
        return overallScore >= 0.6; // 60%的可靠性阈值
    }
    calculateReliabilityFactors(info) {
        // 连通性因子
        const connectivity = info.online ? 1.0 : 0.0;
        // 延迟因子 (0-1分，越低越好)
        let latency = 1.0;
        if (info.rtt) {
            if (info.rtt <= 100)
                latency = 1.0;
            else if (info.rtt <= 300)
                latency = 0.8;
            else if (info.rtt <= 1000)
                latency = 0.6;
            else if (info.rtt <= 2000)
                latency = 0.3;
            else
                latency = 0.1;
        }
        // 带宽因子 (0-1分)
        let bandwidth = 0.5;
        if (info.downlink) {
            if (info.downlink >= 10)
                bandwidth = 1.0;
            else if (info.downlink >= 5)
                bandwidth = 0.8;
            else if (info.downlink >= 1)
                bandwidth = 0.6;
            else if (info.downlink >= 0.5)
                bandwidth = 0.4;
            else
                bandwidth = 0.2;
        }
        // 稳定性因子 (基于历史数据)
        const stability = this.calculateNetworkStability();
        // 连接类型因子
        const connectionTypeScores = {
            'ethernet': 1.0,
            'wifi': 0.9,
            '5g': 0.8,
            '4g': 0.7,
            '3g': 0.4,
            '2g': 0.2,
            'unknown': 0.3
        };
        const connectionType = connectionTypeScores[info.connectionType] || 0.3;
        return {
            connectivity,
            latency,
            bandwidth,
            stability,
            connectionType
        };
    }
    calculateOverallReliabilityScore(factors) {
        // 权重配置
        const weights = {
            connectivity: 0.3, // 连通性最重要
            latency: 0.25, // 延迟影响用户体验
            bandwidth: 0.2, // 带宽影响传输速度
            stability: 0.15, // 稳定性影响长期体验
            connectionType: 0.1 // 连接类型作为补充
        };
        return (factors.connectivity * weights.connectivity +
            factors.latency * weights.latency +
            factors.bandwidth * weights.bandwidth +
            factors.stability * weights.stability +
            factors.connectionType * weights.connectionType);
    }
    calculateNetworkStability() {
        const now = Date.now();
        const stabilityWindow = 5 * 60 * 1000; // 5分钟稳定性窗口
        // 计算最近5分钟内的网络变化次数
        const recentChanges = this.networkHistory.filter(event => now - event.timestamp.getTime() < stabilityWindow).length;
        // 变化次数越少，稳定性越高
        if (recentChanges === 0)
            return 1.0;
        if (recentChanges <= 2)
            return 0.8;
        if (recentChanges <= 5)
            return 0.6;
        if (recentChanges <= 10)
            return 0.4;
        return 0.2;
    }
    // 判断是否可以执行同步
    canPerformSync(info) {
        if (!info.online)
            return false;
        // 根据网络质量判断
        const minQualityScore = 0.3; // 最低质量分数要求
        return network_monitor_1.networkMonitorService.getNetworkQualityScore() >= minQualityScore;
    }
    // 估计同步时间
    estimateSyncTime(info) {
        if (!info.online)
            return Infinity;
        const baseTime = 1000; // 基础时间 1秒
        // 根据RTT调整
        const rttMultiplier = info.rtt ? Math.max(1, info.rtt / 100) : 1;
        // 根据下行速度调整
        const downlinkMultiplier = info.downlink ? Math.max(0.5, 5 / info.downlink) : 2;
        return baseTime * rttMultiplier * downlinkMultiplier;
    }
    // 网络状态预测
    predictNetworkStability(windowMinutes = 30) {
        const now = Date.now();
        const windowMs = windowMinutes * 60 * 1000;
        // 获取历史数据
        const recentHistory = this.networkHistory.filter(event => now - event.timestamp.getTime() <= windowMs);
        if (recentHistory.length < 5) {
            return {
                isStable: true,
                confidence: 0.3,
                predictedDowntime: 0,
                recommendations: ['数据不足，建议监控网络状态']
            };
        }
        // 计算稳定性指标
        const offlineEvents = recentHistory.filter(e => !e.networkInfo.online);
        const stabilityScore = 1 - (offlineEvents.length / recentHistory.length);
        // 计算平均在线时间
        const onlineDurations = this.calculateOnlineDurations(recentHistory);
        const avgOnlineDuration = onlineDurations.reduce((a, b) => a + b, 0) / onlineDurations.length || 0;
        // 预测未来可能的离线时间
        const predictedDowntime = this.predictDowntime(recentHistory, windowMs);
        // 生成建议
        const recommendations = this.generateNetworkRecommendations(stabilityScore, avgOnlineDuration, predictedDowntime);
        return {
            isStable: stabilityScore >= 0.8,
            confidence: Math.min(stabilityScore, 0.9),
            predictedDowntime,
            recommendations
        };
    }
    calculateOnlineDurations(history) {
        const durations = [];
        let onlineStartTime = null;
        for (const event of history) {
            if (event.networkInfo.online && onlineStartTime === null) {
                onlineStartTime = event.timestamp.getTime();
            }
            else if (!event.networkInfo.online && onlineStartTime !== null) {
                durations.push(event.timestamp.getTime() - onlineStartTime);
                onlineStartTime = null;
            }
        }
        // 处理当前在线状态
        if (onlineStartTime !== null) {
            durations.push(Date.now() - onlineStartTime);
        }
        return durations;
    }
    predictDowntime(history, windowMs) {
        const offlineEvents = history.filter(e => !e.networkInfo.online);
        if (offlineEvents.length === 0)
            return 0;
        // 计算平均离线时长
        const offlineDurations = [];
        let offlineStartTime = null;
        for (const event of history) {
            if (!event.networkInfo.online && offlineStartTime === null) {
                offlineStartTime = event.timestamp.getTime();
            }
            else if (event.networkInfo.online && offlineStartTime !== null) {
                offlineDurations.push(event.timestamp.getTime() - offlineStartTime);
                offlineStartTime = null;
            }
        }
        if (offlineDurations.length === 0)
            return 0;
        const avgOfflineDuration = offlineDurations.reduce((a, b) => a + b, 0) / offlineDurations.length;
        const offlineFrequency = offlineEvents.length / (windowMs / (60 * 1000)); // 每分钟离线次数
        return avgOfflineDuration * offlineFrequency;
    }
    generateNetworkRecommendations(stabilityScore, avgOnlineDuration, predictedDowntime) {
        const recommendations = [];
        if (stabilityScore < 0.6) {
            recommendations.push('网络连接不稳定，建议切换到更稳定的网络');
            recommendations.push('建议启用离线模式');
        }
        if (avgOnlineDuration < 5 * 60 * 1000) { // 少于5分钟
            recommendations.push('网络连接持续时间短，建议检查网络设备');
        }
        if (predictedDowntime > 10 * 60 * 1000) { // 超过10分钟
            recommendations.push('预计网络中断时间较长，建议提前完成重要操作');
        }
        if (stabilityScore >= 0.9 && avgOnlineDuration > 30 * 60 * 1000) {
            recommendations.push('网络状态良好，适合进行大规模同步操作');
        }
        return recommendations;
    }
    // 检查状态是否有显著变化
    hasSignificantChange(oldState, newState) {
        // 在线状态变化
        if (oldState.isOnline !== newState.isOnline)
            return true;
        // 可靠性变化
        if (oldState.isReliable !== newState.isReliable)
            return true;
        // 质量等级变化
        if (oldState.quality !== newState.quality)
            return true;
        // 质量分数显著变化（超过10%）
        const qualityChange = Math.abs(oldState.qualityScore - newState.qualityScore);
        if (qualityChange > 0.1)
            return true;
        // 同步能力变化
        if (oldState.canSync !== newState.canSync)
            return true;
        return false;
    }
    // 检查策略是否变化
    hasStrategyChanged(oldStrategy, newStrategy) {
        return (oldStrategy.batchSize !== newStrategy.batchSize ||
            oldStrategy.requestTimeout !== newStrategy.requestTimeout ||
            oldStrategy.compressionEnabled !== newStrategy.compressionEnabled ||
            oldStrategy.maxRetries !== newStrategy.maxRetries);
    }
    // 处理网络恢复
    handleNetworkRestored() {
        console.log('Network restored, processing pending requests...');
        // 重置所有断路器
        this.resetAllCircuitBreakers();
        // 处理等待中的请求
        this.processPendingRequests();
    }
    // 处理网络丢失
    handleNetworkLost() {
        console.log('Network lost, pausing sync operations...');
        // 清空批处理定时器
        if (this.batchTimer) {
            clearTimeout(this.batchTimer);
            this.batchTimer = null;
        }
    }
    // 处理质量变化
    handleQualityChange(event) {
        console.log('Network quality changed:', event.details);
        // 更新同步策略
        this.updateSyncStrategy();
    }
    // 处理网络错误
    handleNetworkError(event) {
        const error = {
            type: 'network_slow',
            message: 'Network quality degraded',
            timestamp: new Date(),
            details: event.details
        };
        this.notifyError(error, 'quality_degradation');
    }
    // ============================================================================
    // 断路器管理
    // ============================================================================
    // 检查断路器状态
    checkCircuitBreaker(operation) {
        const breaker = this.circuitBreakers.get(operation);
        if (!breaker || !this.syncStrategy.circuitBreakerEnabled)
            return true;
        const status = breaker.status;
        // 如果断路器开启，检查是否可以尝试恢复
        if (status.state === 'open') {
            if (Date.now() >= (status.nextAttemptTime?.getTime() || 0)) {
                // 切换到半开状态
                status.state = 'half_open';
                console.log(`Circuit breaker for ${operation} moved to half-open state`);
                return true;
            }
            return false;
        }
        return status.state !== 'open';
    }
    // 记录成功
    recordSuccess(operation) {
        const breaker = this.circuitBreakers.get(operation);
        if (!breaker)
            return;
        const status = breaker.status;
        // 重置失败计数
        status.failureCount = 0;
        status.state = 'closed';
        // 清除恢复定时器
        if (breaker.timer) {
            clearTimeout(breaker.timer);
            breaker.timer = undefined;
        }
    }
    // 记录失败
    recordFailure(operation, error) {
        const breaker = this.circuitBreakers.get(operation);
        if (!breaker || !this.syncStrategy.circuitBreakerEnabled)
            return;
        const status = breaker.status;
        const config = status.config;
        // 检查是否是预期异常
        if (config.expectedException && !config.expectedException.includes(error.type)) {
            return;
        }
        // 增加失败计数
        status.failureCount++;
        status.lastFailureTime = new Date();
        // 检查是否达到阈值
        if (status.failureCount >= config.failureThreshold) {
            status.state = 'open';
            status.nextAttemptTime = new Date(Date.now() + config.recoveryTimeout);
            this.stats.circuitBreakerTrips++;
            console.log(`Circuit breaker for ${operation} tripped: ${status.failureCount} failures`);
            // 设置恢复定时器
            if (breaker.timer) {
                clearTimeout(breaker.timer);
            }
            breaker.timer = setTimeout(() => {
                status.state = 'half_open';
                console.log(`Circuit breaker for ${operation} moved to half-open state`);
            }, config.recoveryTimeout);
        }
    }
    // 重置断路器
    resetCircuitBreaker(operation) {
        const breaker = this.circuitBreakers.get(operation);
        if (!breaker)
            return;
        const status = breaker.status;
        status.failureCount = 0;
        status.state = 'closed';
        status.lastFailureTime = undefined;
        status.nextAttemptTime = undefined;
        if (breaker.timer) {
            clearTimeout(breaker.timer);
            breaker.timer = undefined;
        }
    }
    // 重置所有断路器
    resetAllCircuitBreakers() {
        this.circuitBreakers.forEach((breaker, operation) => {
            this.resetCircuitBreaker(operation);
        });
    }
    // ============================================================================
    // 请求处理
    // ============================================================================
    // 添加同步请求
    async addSyncRequest(request) {
        this.stats.totalRequests++;
        // 检查网络状态
        if (!this.currentState.canSync) {
            const error = {
                type: 'connection_lost',
                message: 'Network not available for sync',
                timestamp: new Date()
            };
            this.stats.failedRequests++;
            return { success: false, error, duration: 0, retryCount: 0, networkState: this.currentState };
        }
        // 检查断路器
        const operation = request.type === 'batch' ? 'batch' : request.type;
        if (!this.checkCircuitBreaker(operation)) {
            const error = {
                type: 'rate_limited',
                message: 'Circuit breaker is open',
                timestamp: new Date()
            };
            this.stats.failedRequests++;
            return { success: false, error, duration: 0, retryCount: 0, networkState: this.currentState };
        }
        // 添加到队列
        const queue = this.pendingRequests.get(request.priority);
        queue.push(request);
        // 如果是高优先级或队列达到批处理大小，立即处理
        if (request.priority === 'critical' || queue.length >= this.syncStrategy.batchSize) {
            await this.processPriorityQueue(request.priority);
        }
        else if (!this.batchTimer) {
            // 设置批处理定时器
            this.batchTimer = setTimeout(() => {
                this.processAllQueues();
            }, this.syncStrategy.batchDelay);
        }
        return { success: true, duration: 0, retryCount: 0, networkState: this.currentState };
    }
    // 处理特定优先级的队列
    async processPriorityQueue(priority) {
        if (this.isProcessing)
            return;
        this.isProcessing = true;
        const queue = this.pendingRequests.get(priority);
        if (queue.length === 0) {
            this.isProcessing = false;
            return;
        }
        const batchSize = Math.min(queue.length, this.syncStrategy.batchSize);
        const requests = queue.splice(0, batchSize);
        try {
            // 批量处理请求
            await this.executeBatchRequests(requests);
        }
        catch (error) {
            console.error('Failed to process batch requests:', error);
        }
        finally {
            this.isProcessing = false;
        }
    }
    // 处理所有队列
    async processAllQueues() {
        if (this.isProcessing)
            return;
        this.isProcessing = true;
        this.batchTimer = null;
        const priorities = ['critical', 'high', 'normal', 'low', 'background'];
        try {
            for (const priority of priorities) {
                const queue = this.pendingRequests.get(priority);
                if (queue.length > 0) {
                    await this.processPriorityQueue(priority);
                }
            }
        }
        catch (error) {
            console.error('Failed to process request queues:', error);
        }
        finally {
            this.isProcessing = false;
        }
    }
    // 处理等待中的请求
    async processPendingRequests() {
        if (this.currentState.canSync && !this.isProcessing) {
            await this.processAllQueues();
        }
    }
    // 执行批量请求
    async executeBatchRequests(requests) {
        for (const request of requests) {
            try {
                const response = await this.executeRequest(request);
                this.notifySyncCompleted(request, response);
                if (response.success) {
                    this.recordSuccess(request.type);
                    this.stats.successfulRequests++;
                }
                else {
                    this.recordFailure(request.type, response.error);
                    this.stats.failedRequests++;
                    this.stats.lastError = response.error;
                }
            }
            catch (error) {
                const errorResponse = {
                    type: 'server_error',
                    message: error instanceof Error ? error.message : 'Unknown error',
                    timestamp: new Date()
                };
                this.recordFailure(request.type, errorResponse);
                this.stats.failedRequests++;
                this.stats.lastError = errorResponse;
                this.notifySyncCompleted(request, {
                    success: false,
                    error: errorResponse,
                    duration: 0,
                    retryCount: 0,
                    networkState: this.currentState
                });
            }
        }
    }
    // 执行单个请求
    async executeRequest(request) {
        const startTime = Date.now();
        // 这里应该实现实际的请求逻辑
        // 目前返回模拟响应
        await new Promise(resolve => setTimeout(resolve, 100)); // 模拟网络延迟
        return {
            success: true,
            data: { id: request.id, processed: true },
            duration: Date.now() - startTime,
            retryCount: request.retryCount,
            networkState: this.currentState
        };
    }
    // ============================================================================
    // 事件通知
    // ============================================================================
    // 添加监听器
    addListener(listener) {
        this.listeners.add(listener);
    }
    // 移除监听器
    removeListener(listener) {
        this.listeners.delete(listener);
    }
    // 通知状态变化
    notifyStateChanged() {
        this.listeners.forEach(listener => {
            try {
                listener.onNetworkStateChanged(this.currentState);
            }
            catch (error) {
                console.error('Error in network state listener:', error);
            }
        });
    }
    // 通知错误
    notifyError(error, context) {
        this.listeners.forEach(listener => {
            try {
                listener.onNetworkError(error, context);
            }
            catch (error) {
                console.error('Error in network error listener:', error);
            }
        });
    }
    // 通知同步完成
    notifySyncCompleted(request, response) {
        this.listeners.forEach(listener => {
            try {
                listener.onSyncCompleted(request, response);
            }
            catch (error) {
                console.error('Error in sync completion listener:', error);
            }
        });
    }
    // 通知策略变化
    notifyStrategyChanged() {
        this.listeners.forEach(listener => {
            try {
                listener.onSyncStrategyChanged(this.syncStrategy);
            }
            catch (error) {
                console.error('Error in sync strategy listener:', error);
            }
        });
    }
    // ============================================================================
    // 公共API
    // ============================================================================
    // 获取当前网络状态
    getCurrentState() {
        return { ...this.currentState };
    }
    // 获取同步策略
    getSyncStrategy() {
        return { ...this.syncStrategy };
    }
    // 获取断路器状态
    getCircuitBreakerStatus(operation) {
        const breaker = this.circuitBreakers.get(operation);
        return breaker ? { ...breaker.status } : null;
    }
    // 获取统计信息
    getStats() {
        return { ...this.stats };
    }
    // 强制更新网络状态
    async forceUpdateNetworkState() {
        await this.updateNetworkState();
    }
    // 重置所有状态
    reset() {
        this.resetAllCircuitBreakers();
        this.pendingRequests.forEach(queue => queue.length = 0);
        if (this.batchTimer) {
            clearTimeout(this.batchTimer);
            this.batchTimer = null;
        }
        this.stats = {
            totalRequests: 0,
            successfulRequests: 0,
            failedRequests: 0,
            averageResponseTime: 0,
            lastError: null,
            circuitBreakerTrips: 0
        };
    }
}
exports.NetworkStateDetector = NetworkStateDetector;
// 导出单例实例
exports.networkStateDetector = NetworkStateDetector.getInstance();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXG5ldHdvcmstc3RhdGUtZGV0ZWN0b3IudHMiLCJtYXBwaW5ncyI6IjtBQUFBLCtFQUErRTtBQUMvRSwwQkFBMEI7QUFDMUIsK0VBQStFOzs7QUFFL0UsdURBQW1IO0FBOEhuSCwrRUFBK0U7QUFDL0UsWUFBWTtBQUNaLCtFQUErRTtBQUUvRSxNQUFhLG9CQUFvQjtJQThCL0I7UUE1QlE7Ozs7O1dBQTBCO1FBQzFCOzs7OztXQUEwQjtRQUMxQjs7OzttQkFBMEMsSUFBSSxHQUFHLEVBQUU7V0FBQTtRQUUzRCxRQUFRO1FBQ0E7Ozs7bUJBR0gsSUFBSSxHQUFHLEVBQUU7V0FBQTtRQUVkLFdBQVc7UUFDSDs7OzttQkFBb0QsSUFBSSxHQUFHLEVBQUU7V0FBQTtRQUM3RDs7OzttQkFBb0MsSUFBSTtXQUFBO1FBQ3hDOzs7O21CQUFlLEtBQUs7V0FBQTtRQUU1QixPQUFPO1FBQ0M7Ozs7bUJBQVE7Z0JBQ2QsYUFBYSxFQUFFLENBQUM7Z0JBQ2hCLGtCQUFrQixFQUFFLENBQUM7Z0JBQ3JCLGNBQWMsRUFBRSxDQUFDO2dCQUNqQixtQkFBbUIsRUFBRSxDQUFDO2dCQUN0QixTQUFTLEVBQUUsSUFBMkI7Z0JBQ3RDLG1CQUFtQixFQUFFLENBQUM7YUFDdkI7V0FBQTtRQUVELFNBQVM7UUFDRDs7OzttQkFBaUMsRUFBRTtXQUFBO1FBR3pDLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFBO1FBQzFDLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUE7UUFDN0MsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFBO0lBQ25CLENBQUM7SUFFRCxNQUFNLENBQUMsV0FBVztRQUNoQixJQUFJLENBQUMsb0JBQW9CLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDbkMsb0JBQW9CLENBQUMsUUFBUSxHQUFHLElBQUksb0JBQW9CLEVBQUUs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QUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUM3QixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQTtRQUN4QixDQUFDO1FBQ0QsSUFBSSxDQUFDLEtBQUssR0FBRztZQUNYLGFBQWEsRUFBRSxDQUFDO1lBQ2hCLGtCQUFrQixFQUFFLENBQUM7WUFDckIsY0FBYyxFQUFFLENBQUM7WUFDakIsbUJBQW1CLEVBQUUsQ0FBQztZQUN0QixTQUFTLEVBQUUsSUFBSTtZQUNmLG1CQUFtQixFQUFFLENBQUM7U0FDdkIsQ0FBQTtJQUNILENBQUM7Q0FDRjtBQXY4QkQsb0RBdThCQztBQUVELFNBQVM7QUFDSSxRQUFBLG9CQUFvQixHQUFHLG9CQUFvQixDQUFDLFdBQVcsRUFBRSxDQUFBIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkQ6XFxQcm9qZWN0c1xcQ2FyZEV2ZXJ5dGhpbmdcXGNhcmRhbGwtcHJvdG90eXBlXFxzcmNcXHNlcnZpY2VzXFxuZXR3b3JrLXN0YXRlLWRldGVjdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g572R57uc54q25oCB5qOA5rWL5ZmoIC0g5Li65pWw5o2u5bqT5bGC57uf5LiA5o+Q5L6b572R57uc5pSv5oyBXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmltcG9ydCB7IG5ldHdvcmtNb25pdG9yU2VydmljZSwgdHlwZSBOZXR3b3JrSW5mbywgdHlwZSBOZXR3b3JrUXVhbGl0eSwgdHlwZSBOZXR3b3JrRXZlbnQgfSBmcm9tICcuL25ldHdvcmstbW9uaXRvcidcclxuXHJcbi8vIOe9kee7nOeKtuaAgeaOpeWPo1xyXG5leHBvcnQgaW50ZXJmYWNlIE5ldHdvcmtTdGF0ZSB7XHJcbiAgLy8g5Z+656GA54q25oCBXHJcbiAgaXNPbmxpbmU6IGJvb2xlYW5cclxuICBpc1JlbGlhYmxlOiBib29sZWFuXHJcbiAgcXVhbGl0eTogTmV0d29ya1F1YWxpdHlcclxuICBxdWFsaXR5U2NvcmU6IG51bWJlclxyXG4gIFxyXG4gIC8vIOi/nuaOpeivpuaDhVxyXG4gIGNvbm5lY3Rpb25UeXBlOiBzdHJpbmdcclxuICBlZmZlY3RpdmVUeXBlOiBzdHJpbmdcclxuICBkb3dubGluaz86IG51bWJlclxyXG4gIHJ0dD86IG51bWJlclxyXG4gIFxyXG4gIC8vIOWQjOatpeebuOWFs1xyXG4gIGNhblN5bmM6IGJvb2xlYW5cclxuICBzeW5jU3RyYXRlZ3k6IFN5bmNTdHJhdGVneVxyXG4gIGVzdGltYXRlZFN5bmNUaW1lOiBudW1iZXJcclxuICBcclxuICAvLyDml7bpl7TmiLNcclxuICBsYXN0VXBkYXRlZDogRGF0ZVxyXG4gIGxhc3RTdGFibGVUaW1lPzogRGF0ZVxyXG59XHJcblxyXG4vLyDlkIzmraXnrZbnlaXphY3nva5cclxuZXhwb3J0IGludGVyZmFjZSBTeW5jU3RyYXRlZ3kge1xyXG4gIC8vIOaJueWkhOeQhuiuvue9rlxyXG4gIGJhdGNoU2l6ZTogbnVtYmVyXHJcbiAgYmF0Y2hEZWxheTogbnVtYmVyXHJcbiAgXHJcbiAgLy8g6LaF5pe26K6+572uXHJcbiAgY29ubmVjdFRpbWVvdXQ6IG51bWJlclxyXG4gIHJlcXVlc3RUaW1lb3V0OiBudW1iZXJcclxuICB0b3RhbFRpbWVvdXQ6IG51bWJlclxyXG4gIFxyXG4gIC8vIOmHjeivleiuvue9rlxyXG4gIG1heFJldHJpZXM6IG51bWJlclxyXG4gIHJldHJ5RGVsYXk6IG51bWJlclxyXG4gIHJldHJ5QmFja29mZk11bHRpcGxpZXI6IG51bWJlclxyXG4gIFxyXG4gIC8vIOS8mOWMluiuvue9rlxyXG4gIGNvbXByZXNzaW9uRW5hYmxlZDogYm9vbGVhblxyXG4gIHByaW9yaXR5U3luY0VuYWJsZWQ6IGJvb2xlYW5cclxuICBiYWNrZ3JvdW5kU3luY0VuYWJsZWQ6IGJvb2xlYW5cclxuICBcclxuICAvLyDplJnor6/lpITnkIZcclxuICBjaXJjdWl0QnJlYWtlckVuYWJsZWQ6IGJvb2xlYW5cclxuICBmYWlsdXJlVGhyZXNob2xkOiBudW1iZXJcclxuICByZWNvdmVyeVRpbWVvdXQ6IG51bWJlclxyXG59XHJcblxyXG4vLyDnvZHnu5zlvILluLjnsbvlnotcclxuZXhwb3J0IHR5cGUgTmV0d29ya0Vycm9yVHlwZSA9IFxyXG4gIHwgJ2Nvbm5lY3Rpb25fbG9zdCdcclxuICB8ICd0aW1lb3V0JyBcclxuICB8ICdzZXJ2ZXJfZXJyb3InXHJcbiAgfCAncmF0ZV9saW1pdGVkJ1xyXG4gIHwgJ25ldHdvcmtfc2xvdydcclxuICB8ICd1bnJlbGlhYmxlX2Nvbm5lY3Rpb24nXHJcblxyXG4vLyDnvZHnu5zlvILluLjkv6Hmga9cclxuZXhwb3J0IGludGVyZmFjZSBOZXR3b3JrRXJyb3Ige1xyXG4gIHR5cGU6IE5ldHdvcmtFcnJvclR5cGVcclxuICBtZXNzYWdlOiBzdHJpbmdcclxuICBjb2RlPzogc3RyaW5nXHJcbiAgcmV0cnlBZnRlcj86IG51bWJlclxyXG4gIGRldGFpbHM/OiBhbnlcclxuICB0aW1lc3RhbXA6IERhdGVcclxuICBjb250ZXh0Pzogc3RyaW5nXHJcbn1cclxuXHJcbi8vIOWQjOatpeaTjeS9nOS8mOWFiOe6p1xyXG5leHBvcnQgdHlwZSBTeW5jUHJpb3JpdHkgPSAnY3JpdGljYWwnIHwgJ2hpZ2gnIHwgJ25vcm1hbCcgfCAnbG93JyB8ICdiYWNrZ3JvdW5kJ1xyXG5cclxuLy8g5ZCM5q2l5pON5L2c6K+35rGCXHJcbmV4cG9ydCBpbnRlcmZhY2UgU3luY1JlcXVlc3Qge1xyXG4gIGlkOiBzdHJpbmdcclxuICB0eXBlOiAncmVhZCcgfCAnd3JpdGUnIHwgJ2RlbGV0ZSdcclxuICBlbnRpdHk6ICdjYXJkJyB8ICdmb2xkZXInIHwgJ3RhZycgfCAnaW1hZ2UnIHwgJ2JhdGNoJ1xyXG4gIHByaW9yaXR5OiBTeW5jUHJpb3JpdHlcclxuICBkYXRhOiBhbnlcclxuICB0aW1lb3V0PzogbnVtYmVyXHJcbiAgcmV0cnlDb3VudDogbnVtYmVyXHJcbiAgbWF4UmV0cmllczogbnVtYmVyXHJcbiAgdGltZXN0YW1wOiBEYXRlXHJcbn1cclxuXHJcbi8vIOWQjOatpeaTjeS9nOWTjeW6lFxyXG5leHBvcnQgaW50ZXJmYWNlIFN5bmNSZXNwb25zZTxUID0gYW55PiB7XHJcbiAgc3VjY2VzczogYm9vbGVhblxyXG4gIGRhdGE/OiBUXHJcbiAgZXJyb3I/OiBOZXR3b3JrRXJyb3JcclxuICBkdXJhdGlvbjogbnVtYmVyXHJcbiAgcmV0cnlDb3VudDogbnVtYmVyXHJcbiAgbmV0d29ya1N0YXRlOiBOZXR3b3JrU3RhdGVcclxufVxyXG5cclxuLy8g5pWw5o2u5bqT572R57uc54q25oCB55uR5ZCs5ZmoXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGF0YWJhc2VOZXR3b3JrTGlzdGVuZXIge1xyXG4gIG9uTmV0d29ya1N0YXRlQ2hhbmdlZChzdGF0ZTogTmV0d29ya1N0YXRlKTogdm9pZFxyXG4gIG9uTmV0d29ya0Vycm9yKGVycm9yOiBOZXR3b3JrRXJyb3IsIGNvbnRleHQ/OiBzdHJpbmcpOiB2b2lkXHJcbiAgb25TeW5jQ29tcGxldGVkKHJlcXVlc3Q6IFN5bmNSZXF1ZXN0LCByZXNwb25zZTogU3luY1Jlc3BvbnNlKTogdm9pZFxyXG4gIG9uU3luY1N0cmF0ZWd5Q2hhbmdlZChzdHJhdGVneTogU3luY1N0cmF0ZWd5KTogdm9pZFxyXG59XHJcblxyXG4vLyDmlq3ot6/lmajnirbmgIFcclxuZXhwb3J0IHR5cGUgQ2lyY3VpdEJyZWFrZXJTdGF0ZSA9ICdjbG9zZWQnIHwgJ29wZW4nIHwgJ2hhbGZfb3BlbidcclxuXHJcbi8vIOaWrei3r+WZqOmFjee9rlxyXG5leHBvcnQgaW50ZXJmYWNlIENpcmN1aXRCcmVha2VyQ29uZmlnIHtcclxuICBmYWlsdXJlVGhyZXNob2xkOiBudW1iZXIgLy8g5aSx6LSl6ZiI5YC8XHJcbiAgcmVjb3ZlcnlUaW1lb3V0OiBudW1iZXIgLy8g5oGi5aSN6LaF5pe277yI5q+r56eS77yJXHJcbiAgZXhwZWN0ZWRFeGNlcHRpb24/OiBOZXR3b3JrRXJyb3JUeXBlW10gLy8g6aKE5pyf55qE5byC5bi457G75Z6LXHJcbn1cclxuXHJcbi8vIOaWrei3r+WZqOeKtuaAgeS/oeaBr1xyXG5leHBvcnQgaW50ZXJmYWNlIENpcmN1aXRCcmVha2VyU3RhdHVzIHtcclxuICBzdGF0ZTogQ2lyY3VpdEJyZWFrZXJTdGF0ZVxyXG4gIGZhaWx1cmVDb3VudDogbnVtYmVyXHJcbiAgbGFzdEZhaWx1cmVUaW1lPzogRGF0ZVxyXG4gIG5leHRBdHRlbXB0VGltZT86IERhdGVcclxuICBjb25maWc6IENpcmN1aXRCcmVha2VyQ29uZmlnXHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g572R57uc54q25oCB5qOA5rWL5Zmo5Li757G7XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjbGFzcyBOZXR3b3JrU3RhdGVEZXRlY3RvciB7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IE5ldHdvcmtTdGF0ZURldGVjdG9yXHJcbiAgcHJpdmF0ZSBjdXJyZW50U3RhdGU6IE5ldHdvcmtTdGF0ZVxyXG4gIHByaXZhdGUgc3luY1N0cmF0ZWd5OiBTeW5jU3RyYXRlZ3lcclxuICBwcml2YXRlIGxpc3RlbmVyczogU2V0PERhdGFiYXNlTmV0d29ya0xpc3RlbmVyPiA9IG5ldyBTZXQoKVxyXG4gIFxyXG4gIC8vIOaWrei3r+WZqOeKtuaAgVxyXG4gIHByaXZhdGUgY2lyY3VpdEJyZWFrZXJzOiBNYXA8c3RyaW5nLCB7XHJcbiAgICBzdGF0dXM6IENpcmN1aXRCcmVha2VyU3RhdHVzXHJcbiAgICB0aW1lcj86IE5vZGVKUy5UaW1lb3V0XHJcbiAgfT4gPSBuZXcgTWFwKClcclxuICBcclxuICAvLyDor7fmsYLpmJ/liJflkozmibnlpITnkIZcclxuICBwcml2YXRlIHBlbmRpbmdSZXF1ZXN0czogTWFwPFN5bmNQcmlvcml0eSwgU3luY1JlcXVlc3RbXT4gPSBuZXcgTWFwKClcclxuICBwcml2YXRlIGJhdGNoVGltZXI6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGxcclxuICBwcml2YXRlIGlzUHJvY2Vzc2luZyA9IGZhbHNlXHJcbiAgXHJcbiAgLy8g57uf6K6h5L+h5oGvXHJcbiAgcHJpdmF0ZSBzdGF0cyA9IHtcclxuICAgIHRvdGFsUmVxdWVzdHM6IDAsXHJcbiAgICBzdWNjZXNzZnVsUmVxdWVzdHM6IDAsXHJcbiAgICBmYWlsZWRSZXF1ZXN0czogMCxcclxuICAgIGF2ZXJhZ2VSZXNwb25zZVRpbWU6IDAsXHJcbiAgICBsYXN0RXJyb3I6IG51bGwgYXMgTmV0d29ya0Vycm9yIHwgbnVsbCxcclxuICAgIGNpcmN1aXRCcmVha2VyVHJpcHM6IDBcclxuICB9XHJcblxyXG4gIC8vIOe9kee7nOWOhuWPsuiusOW9lVxyXG4gIHByaXZhdGUgbmV0d29ya0hpc3Rvcnk6IE5ldHdvcmtFdmVudFtdID0gW11cclxuXHJcbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuY3VycmVudFN0YXRlID0gdGhpcy5nZXRJbml0aWFsU3RhdGUoKVxyXG4gICAgdGhpcy5zeW5jU3RyYXRlZ3kgPSB0aGlzLmdldERlZmF1bHRTdHJhdGVneSgpXHJcbiAgICB0aGlzLmluaXRpYWxpemUoKVxyXG4gIH1cclxuXHJcbiAgc3RhdGljIGdldEluc3RhbmNlKCk6IE5ldHdvcmtTdGF0ZURldGVjdG9yIHtcclxuICAgIGlmICghTmV0d29ya1N0YXRlRGV0ZWN0b3IuaW5zdGFuY2UpIHtcclxuICAgICAgTmV0d29ya1N0YXRlRGV0ZWN0b3IuaW5zdGFuY2UgPSBuZXcgTmV0d29ya1N0YXRlRGV0ZWN0b3IoKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIE5ldHdvcmtTdGF0ZURldGVjdG9yLmluc3RhbmNlXHJcbiAgfVxyXG5cclxuICAvLyDojrflj5bliJ3lp4vnirbmgIFcclxuICBwcml2YXRlIGdldEluaXRpYWxTdGF0ZSgpOiBOZXR3b3JrU3RhdGUge1xyXG4gICAgY29uc3QgbmV0d29ya0luZm8gPSBuZXR3b3JrTW9uaXRvclNlcnZpY2UuZ2V0Q3VycmVudFN0YXRlKClcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzT25saW5lOiBuZXR3b3JrSW5mby5vbmxpbmUsXHJcbiAgICAgIGlzUmVsaWFibGU6IHRoaXMuY2FsY3VsYXRlUmVsaWFiaWxpdHkobmV0d29ya0luZm8pLFxyXG4gICAgICBxdWFsaXR5OiBuZXR3b3JrTW9uaXRvclNlcnZpY2UuZ2V0TmV0d29ya1F1YWxpdHkoKSxcclxuICAgICAgcXVhbGl0eVNjb3JlOiBuZXR3b3JrTW9uaXRvclNlcnZpY2UuZ2V0TmV0d29ya1F1YWxpdHlTY29yZSgpLFxyXG4gICAgICBjb25uZWN0aW9uVHlwZTogbmV0d29ya0luZm8uY29ubmVjdGlvblR5cGUsXHJcbiAgICAgIGVmZmVjdGl2ZVR5cGU6IG5ldHdvcmtJbmZvLmVmZmVjdGl2ZVR5cGUsXHJcbiAgICAgIGRvd25saW5rOiBuZXR3b3JrSW5mby5kb3dubGluayxcclxuICAgICAgcnR0OiBuZXR3b3JrSW5mby5ydHQsXHJcbiAgICAgIGNhblN5bmM6IHRoaXMuY2FuUGVyZm9ybVN5bmMobmV0d29ya0luZm8pLFxyXG4gICAgICBzeW5jU3RyYXRlZ3k6IHRoaXMuZ2V0RGVmYXVsdFN0cmF0ZWd5KCksXHJcbiAgICAgIGVzdGltYXRlZFN5bmNUaW1lOiB0aGlzLmVzdGltYXRlU3luY1RpbWUobmV0d29ya0luZm8pLFxyXG4gICAgICBsYXN0VXBkYXRlZDogbmV3IERhdGUoKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8g6I635Y+W6buY6K6k5ZCM5q2l562W55WlXHJcbiAgcHJpdmF0ZSBnZXREZWZhdWx0U3RyYXRlZ3koKTogU3luY1N0cmF0ZWd5IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGJhdGNoU2l6ZTogMTAsXHJcbiAgICAgIGJhdGNoRGVsYXk6IDEwMDAsXHJcbiAgICAgIGNvbm5lY3RUaW1lb3V0OiA1MDAwLFxyXG4gICAgICByZXF1ZXN0VGltZW91dDogMzAwMDAsXHJcbiAgICAgIHRvdGFsVGltZW91dDogMTIwMDAwLFxyXG4gICAgICBtYXhSZXRyaWVzOiAzLFxyXG4gICAgICByZXRyeURlbGF5OiAxMDAwLFxyXG4gICAgICByZXRyeUJhY2tvZmZNdWx0aXBsaWVyOiAyLFxyXG4gICAgICBjb21wcmVzc2lvbkVuYWJsZWQ6IHRydWUsXHJcbiAgICAgIHByaW9yaXR5U3luY0VuYWJsZWQ6IHRydWUsXHJcbiAgICAgIGJhY2tncm91bmRTeW5jRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgY2lyY3VpdEJyZWFrZXJFbmFibGVkOiB0cnVlLFxyXG4gICAgICBmYWlsdXJlVGhyZXNob2xkOiA1LFxyXG4gICAgICByZWNvdmVyeVRpbWVvdXQ6IDYwMDAwXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDliJ3lp4vljJbmo4DmtYvlmahcclxuICBwcml2YXRlIGluaXRpYWxpemUoKTogdm9pZCB7XHJcbiAgICAvLyDnm5HlkKznvZHnu5znm5HmjqfmnI3liqHkuovku7ZcclxuICAgIG5ldHdvcmtNb25pdG9yU2VydmljZS5hZGRFdmVudExpc3RlbmVyKHRoaXMuaGFuZGxlTmV0d29ya0V2ZW50LmJpbmQodGhpcykpXHJcbiAgICBcclxuICAgIC8vIOWIneWni+WMluaWrei3r+WZqFxyXG4gICAgdGhpcy5pbml0aWFsaXplQ2lyY3VpdEJyZWFrZXJzKClcclxuICAgIFxyXG4gICAgLy8g5Yid5aeL5YyW6K+35rGC6Zif5YiXXHJcbiAgICB0aGlzLmluaXRpYWxpemVSZXF1ZXN0UXVldWVzKClcclxuICAgIFxyXG4gICAgLy8g5byA5aeL572R57uc54q25oCB5qOA5p+lXHJcbiAgICB0aGlzLnN0YXJ0UGVyaW9kaWNDaGVja3MoKVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZygnTmV0d29ya1N0YXRlRGV0ZWN0b3IgaW5pdGlhbGl6ZWQnKVxyXG4gIH1cclxuXHJcbiAgLy8g5Yid5aeL5YyW5pat6Lev5ZmoXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplQ2lyY3VpdEJyZWFrZXJzKCk6IHZvaWQge1xyXG4gICAgY29uc3Qgb3BlcmF0aW9ucyA9IFsncmVhZCcsICd3cml0ZScsICdkZWxldGUnLCAnYmF0Y2gnXVxyXG4gICAgXHJcbiAgICBvcGVyYXRpb25zLmZvckVhY2gob3BlcmF0aW9uID0+IHtcclxuICAgICAgY29uc3QgY29uZmlnOiBDaXJjdWl0QnJlYWtlckNvbmZpZyA9IHtcclxuICAgICAgICBmYWlsdXJlVGhyZXNob2xkOiB0aGlzLnN5bmNTdHJhdGVneS5mYWlsdXJlVGhyZXNob2xkLFxyXG4gICAgICAgIHJlY292ZXJ5VGltZW91dDogdGhpcy5zeW5jU3RyYXRlZ3kucmVjb3ZlcnlUaW1lb3V0LFxyXG4gICAgICAgIGV4cGVjdGVkRXhjZXB0aW9uOiBbJ3RpbWVvdXQnLCAnY29ubmVjdGlvbl9sb3N0JywgJ25ldHdvcmtfc2xvdyddXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHRoaXMuY2lyY3VpdEJyZWFrZXJzLnNldChvcGVyYXRpb24sIHtcclxuICAgICAgICBzdGF0dXM6IHtcclxuICAgICAgICAgIHN0YXRlOiAnY2xvc2VkJyxcclxuICAgICAgICAgIGZhaWx1cmVDb3VudDogMCxcclxuICAgICAgICAgIGNvbmZpZ1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyDliJ3lp4vljJbor7fmsYLpmJ/liJdcclxuICBwcml2YXRlIGluaXRpYWxpemVSZXF1ZXN0UXVldWVzKCk6IHZvaWQge1xyXG4gICAgY29uc3QgcHJpb3JpdGllczogU3luY1ByaW9yaXR5W10gPSBbJ2NyaXRpY2FsJywgJ2hpZ2gnLCAnbm9ybWFsJywgJ2xvdycsICdiYWNrZ3JvdW5kJ11cclxuICAgIFxyXG4gICAgcHJpb3JpdGllcy5mb3JFYWNoKHByaW9yaXR5ID0+IHtcclxuICAgICAgdGhpcy5wZW5kaW5nUmVxdWVzdHMuc2V0KHByaW9yaXR5LCBbXSlcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyDlvIDlp4vlrprmnJ/mo4Dmn6VcclxuICBwcml2YXRlIHN0YXJ0UGVyaW9kaWNDaGVja3MoKTogdm9pZCB7XHJcbiAgICAvLyDmr48zMOenkuajgOafpeS4gOasoee9kee7nOeKtuaAgVxyXG4gICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICB0aGlzLnVwZGF0ZU5ldHdvcmtTdGF0ZSgpXHJcbiAgICB9LCAzMDAwMClcclxuICAgIFxyXG4gICAgLy8g5q+PNeWIhumSn+abtOaWsOWQjOatpeetlueVpVxyXG4gICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICB0aGlzLnVwZGF0ZVN5bmNTdHJhdGVneSgpXHJcbiAgICB9LCAzMDAwMDApXHJcbiAgfVxyXG5cclxuICAvLyDlpITnkIbnvZHnu5zkuovku7ZcclxuICBwcml2YXRlIGhhbmRsZU5ldHdvcmtFdmVudChldmVudDogTmV0d29ya0V2ZW50KTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZygnTmV0d29yayBldmVudCBkZXRlY3RlZDonLCBldmVudC50eXBlKVxyXG4gICAgXHJcbiAgICAvLyDmm7TmlrDnvZHnu5znirbmgIFcclxuICAgIHRoaXMudXBkYXRlTmV0d29ya1N0YXRlKClcclxuICAgIFxyXG4gICAgLy8g5qC55o2u5LqL5Lu257G75Z6L6YeH5Y+W5LiN5ZCM6KGM5YqoXHJcbiAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcclxuICAgICAgY2FzZSAnb25saW5lJzpcclxuICAgICAgICB0aGlzLmhhbmRsZU5ldHdvcmtSZXN0b3JlZCgpXHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgY2FzZSAnb2ZmbGluZSc6XHJcbiAgICAgICAgdGhpcy5oYW5kbGVOZXR3b3JrTG9zdCgpXHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgY2FzZSAncXVhbGl0eS1jaGFuZ2UnOlxyXG4gICAgICAgIHRoaXMuaGFuZGxlUXVhbGl0eUNoYW5nZShldmVudClcclxuICAgICAgICBicmVha1xyXG4gICAgICBjYXNlICdlcnJvcic6XHJcbiAgICAgICAgdGhpcy5oYW5kbGVOZXR3b3JrRXJyb3IoZXZlbnQpXHJcbiAgICAgICAgYnJlYWtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIOabtOaWsOe9kee7nOeKtuaAgVxyXG4gIHByaXZhdGUgYXN5bmMgdXBkYXRlTmV0d29ya1N0YXRlKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgbmV0d29ya0luZm8gPSBhd2FpdCBuZXR3b3JrTW9uaXRvclNlcnZpY2UuY2hlY2tOZXR3b3JrKClcclxuICAgICAgY29uc3QgaGVhbHRoU3RhdHVzID0gYXdhaXQgbmV0d29ya01vbml0b3JTZXJ2aWNlLnBlcmZvcm1IZWFsdGhDaGVjaygpXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBuZXdTdGF0ZTogTmV0d29ya1N0YXRlID0ge1xyXG4gICAgICAgIGlzT25saW5lOiBuZXR3b3JrSW5mby5vbmxpbmUgJiYgaGVhbHRoU3RhdHVzLFxyXG4gICAgICAgIGlzUmVsaWFibGU6IHRoaXMuY2FsY3VsYXRlUmVsaWFiaWxpdHkobmV0d29ya0luZm8pLFxyXG4gICAgICAgIHF1YWxpdHk6IG5ldHdvcmtNb25pdG9yU2VydmljZS5nZXROZXR3b3JrUXVhbGl0eSgpLFxyXG4gICAgICAgIHF1YWxpdHlTY29yZTogbmV0d29ya01vbml0b3JTZXJ2aWNlLmdldE5ldHdvcmtRdWFsaXR5U2NvcmUoKSxcclxuICAgICAgICBjb25uZWN0aW9uVHlwZTogbmV0d29ya0luZm8uY29ubmVjdGlvblR5cGUsXHJcbiAgICAgICAgZWZmZWN0aXZlVHlwZTogbmV0d29ya0luZm8uZWZmZWN0aXZlVHlwZSxcclxuICAgICAgICBkb3dubGluazogbmV0d29ya0luZm8uZG93bmxpbmssXHJcbiAgICAgICAgcnR0OiBuZXR3b3JrSW5mby5ydHQsXHJcbiAgICAgICAgY2FuU3luYzogdGhpcy5jYW5QZXJmb3JtU3luYyhuZXR3b3JrSW5mbykgJiYgaGVhbHRoU3RhdHVzLFxyXG4gICAgICAgIHN5bmNTdHJhdGVneTogdGhpcy5zeW5jU3RyYXRlZ3ksXHJcbiAgICAgICAgZXN0aW1hdGVkU3luY1RpbWU6IHRoaXMuZXN0aW1hdGVTeW5jVGltZShuZXR3b3JrSW5mbyksXHJcbiAgICAgICAgbGFzdFVwZGF0ZWQ6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgbGFzdFN0YWJsZVRpbWU6IG5ldHdvcmtJbmZvLm9ubGluZSA/IG5ldyBEYXRlKCkgOiB0aGlzLmN1cnJlbnRTdGF0ZS5sYXN0U3RhYmxlVGltZVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyDmo4Dmn6XnirbmgIHmmK/lkKbmnInmmL7okZflj5jljJZcclxuICAgICAgaWYgKHRoaXMuaGFzU2lnbmlmaWNhbnRDaGFuZ2UodGhpcy5jdXJyZW50U3RhdGUsIG5ld1N0YXRlKSkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudFN0YXRlID0gbmV3U3RhdGVcclxuICAgICAgICB0aGlzLm5vdGlmeVN0YXRlQ2hhbmdlZCgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g5aaC5p6c572R57uc5oGi5aSN77yM5bCd6K+V5aSE55CG6Zif5YiXXHJcbiAgICAgICAgaWYgKG5ld1N0YXRlLmlzT25saW5lICYmIG5ld1N0YXRlLmlzUmVsaWFibGUpIHtcclxuICAgICAgICAgIHRoaXMucHJvY2Vzc1BlbmRpbmdSZXF1ZXN0cygpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gdXBkYXRlIG5ldHdvcmsgc3RhdGU6JywgZXJyb3IpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDmm7TmlrDlkIzmraXnrZbnlaVcclxuICBwcml2YXRlIHVwZGF0ZVN5bmNTdHJhdGVneSgpOiB2b2lkIHtcclxuICAgIGNvbnN0IG5ld1N0cmF0ZWd5ID0gdGhpcy5jYWxjdWxhdGVPcHRpbWFsU3RyYXRlZ3koKVxyXG4gICAgXHJcbiAgICBpZiAodGhpcy5oYXNTdHJhdGVneUNoYW5nZWQodGhpcy5zeW5jU3RyYXRlZ3ksIG5ld1N0cmF0ZWd5KSkge1xyXG4gICAgICB0aGlzLnN5bmNTdHJhdGVneSA9IG5ld1N0cmF0ZWd5XHJcbiAgICAgIHRoaXMuY3VycmVudFN0YXRlLnN5bmNTdHJhdGVneSA9IG5ld1N0cmF0ZWd5XHJcbiAgICAgIHRoaXMubm90aWZ5U3RyYXRlZ3lDaGFuZ2VkKClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIOiuoeeul+acgOS8mOWQjOatpeetlueVpVxyXG4gIHByaXZhdGUgY2FsY3VsYXRlT3B0aW1hbFN0cmF0ZWd5KCk6IFN5bmNTdHJhdGVneSB7XHJcbiAgICBjb25zdCBxdWFsaXR5ID0gdGhpcy5jdXJyZW50U3RhdGUucXVhbGl0eVxyXG4gICAgY29uc3Qgc2NvcmUgPSB0aGlzLmN1cnJlbnRTdGF0ZS5xdWFsaXR5U2NvcmVcclxuICAgIFxyXG4gICAgY29uc3QgYmFzZVN0cmF0ZWd5ID0geyAuLi50aGlzLmdldERlZmF1bHRTdHJhdGVneSgpIH1cclxuICAgIFxyXG4gICAgc3dpdGNoIChxdWFsaXR5KSB7XHJcbiAgICAgIGNhc2UgJ2V4Y2VsbGVudCc6XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIC4uLmJhc2VTdHJhdGVneSxcclxuICAgICAgICAgIGJhdGNoU2l6ZTogNTAsXHJcbiAgICAgICAgICBiYXRjaERlbGF5OiA1MDAsXHJcbiAgICAgICAgICByZXF1ZXN0VGltZW91dDogMTAwMDAsXHJcbiAgICAgICAgICByZXRyeURlbGF5OiA1MDAsXHJcbiAgICAgICAgICBjb21wcmVzc2lvbkVuYWJsZWQ6IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICBjYXNlICdnb29kJzpcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgLi4uYmFzZVN0cmF0ZWd5LFxyXG4gICAgICAgICAgYmF0Y2hTaXplOiAyNSxcclxuICAgICAgICAgIGJhdGNoRGVsYXk6IDEwMDAsXHJcbiAgICAgICAgICByZXF1ZXN0VGltZW91dDogMjAwMDAsXHJcbiAgICAgICAgICByZXRyeURlbGF5OiAxMDAwXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICBjYXNlICdmYWlyJzpcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgLi4uYmFzZVN0cmF0ZWd5LFxyXG4gICAgICAgICAgYmF0Y2hTaXplOiAxMCxcclxuICAgICAgICAgIGJhdGNoRGVsYXk6IDIwMDAsXHJcbiAgICAgICAgICByZXF1ZXN0VGltZW91dDogMzAwMDAsXHJcbiAgICAgICAgICBjb21wcmVzc2lvbkVuYWJsZWQ6IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgIGNhc2UgJ3Bvb3InOlxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAuLi5iYXNlU3RyYXRlZ3ksXHJcbiAgICAgICAgICBiYXRjaFNpemU6IDUsXHJcbiAgICAgICAgICBiYXRjaERlbGF5OiA1MDAwLFxyXG4gICAgICAgICAgcmVxdWVzdFRpbWVvdXQ6IDYwMDAwLFxyXG4gICAgICAgICAgbWF4UmV0cmllczogNSxcclxuICAgICAgICAgIHJldHJ5RGVsYXk6IDIwMDAsXHJcbiAgICAgICAgICBjb21wcmVzc2lvbkVuYWJsZWQ6IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgIGRlZmF1bHQ6IC8vIG9mZmxpbmVcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgLi4uYmFzZVN0cmF0ZWd5LFxyXG4gICAgICAgICAgYmF0Y2hTaXplOiAxLFxyXG4gICAgICAgICAgYmF0Y2hEZWxheTogMTAwMDAsXHJcbiAgICAgICAgICByZXF1ZXN0VGltZW91dDogMTIwMDAwLFxyXG4gICAgICAgICAgbWF4UmV0cmllczogMTAsXHJcbiAgICAgICAgICBjb21wcmVzc2lvbkVuYWJsZWQ6IHRydWVcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDorqHnrpfnvZHnu5zlj6/pnaDmgKdcclxuICBwcml2YXRlIGNhbGN1bGF0ZVJlbGlhYmlsaXR5KGluZm86IE5ldHdvcmtJbmZvKTogYm9vbGVhbiB7XHJcbiAgICBpZiAoIWluZm8ub25saW5lKSByZXR1cm4gZmFsc2VcclxuICAgIFxyXG4gICAgLy8g5aSa57u05bqm5Y+v6Z2g5oCn6K+E5LywXHJcbiAgICBjb25zdCBmYWN0b3JzID0gdGhpcy5jYWxjdWxhdGVSZWxpYWJpbGl0eUZhY3RvcnMoaW5mbylcclxuICAgIGNvbnN0IG92ZXJhbGxTY29yZSA9IHRoaXMuY2FsY3VsYXRlT3ZlcmFsbFJlbGlhYmlsaXR5U2NvcmUoZmFjdG9ycylcclxuICAgIFxyXG4gICAgcmV0dXJuIG92ZXJhbGxTY29yZSA+PSAwLjYgLy8gNjAl55qE5Y+v6Z2g5oCn6ZiI5YC8XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZVJlbGlhYmlsaXR5RmFjdG9ycyhpbmZvOiBOZXR3b3JrSW5mbyk6IHtcclxuICAgIGNvbm5lY3Rpdml0eTogbnVtYmVyXHJcbiAgICBsYXRlbmN5OiBudW1iZXJcclxuICAgIGJhbmR3aWR0aDogbnVtYmVyXHJcbiAgICBzdGFiaWxpdHk6IG51bWJlclxyXG4gICAgY29ubmVjdGlvblR5cGU6IG51bWJlclxyXG4gIH0ge1xyXG4gICAgLy8g6L+e6YCa5oCn5Zug5a2QXHJcbiAgICBjb25zdCBjb25uZWN0aXZpdHkgPSBpbmZvLm9ubGluZSA/IDEuMCA6IDAuMFxyXG4gICAgXHJcbiAgICAvLyDlu7bov5/lm6DlrZAgKDAtMeWIhu+8jOi2iuS9jui2iuWlvSlcclxuICAgIGxldCBsYXRlbmN5ID0gMS4wXHJcbiAgICBpZiAoaW5mby5ydHQpIHtcclxuICAgICAgaWYgKGluZm8ucnR0IDw9IDEwMCkgbGF0ZW5jeSA9IDEuMFxyXG4gICAgICBlbHNlIGlmIChpbmZvLnJ0dCA8PSAzMDApIGxhdGVuY3kgPSAwLjhcclxuICAgICAgZWxzZSBpZiAoaW5mby5ydHQgPD0gMTAwMCkgbGF0ZW5jeSA9IDAuNlxyXG4gICAgICBlbHNlIGlmIChpbmZvLnJ0dCA8PSAyMDAwKSBsYXRlbmN5ID0gMC4zXHJcbiAgICAgIGVsc2UgbGF0ZW5jeSA9IDAuMVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDluKblrr3lm6DlrZAgKDAtMeWIhilcclxuICAgIGxldCBiYW5kd2lkdGggPSAwLjVcclxuICAgIGlmIChpbmZvLmRvd25saW5rKSB7XHJcbiAgICAgIGlmIChpbmZvLmRvd25saW5rID49IDEwKSBiYW5kd2lkdGggPSAxLjBcclxuICAgICAgZWxzZSBpZiAoaW5mby5kb3dubGluayA+PSA1KSBiYW5kd2lkdGggPSAwLjhcclxuICAgICAgZWxzZSBpZiAoaW5mby5kb3dubGluayA+PSAxKSBiYW5kd2lkdGggPSAwLjZcclxuICAgICAgZWxzZSBpZiAoaW5mby5kb3dubGluayA+PSAwLjUpIGJhbmR3aWR0aCA9IDAuNFxyXG4gICAgICBlbHNlIGJhbmR3aWR0aCA9IDAuMlxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDnqLPlrprmgKflm6DlrZAgKOWfuuS6juWOhuWPsuaVsOaNrilcclxuICAgIGNvbnN0IHN0YWJpbGl0eSA9IHRoaXMuY2FsY3VsYXRlTmV0d29ya1N0YWJpbGl0eSgpXHJcbiAgICBcclxuICAgIC8vIOi/nuaOpeexu+Wei+WboOWtkFxyXG4gICAgY29uc3QgY29ubmVjdGlvblR5cGVTY29yZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7XHJcbiAgICAgICdldGhlcm5ldCc6IDEuMCxcclxuICAgICAgJ3dpZmknOiAwLjksXHJcbiAgICAgICc1Zyc6IDAuOCxcclxuICAgICAgJzRnJzogMC43LFxyXG4gICAgICAnM2cnOiAwLjQsXHJcbiAgICAgICcyZyc6IDAuMixcclxuICAgICAgJ3Vua25vd24nOiAwLjNcclxuICAgIH1cclxuICAgIGNvbnN0IGNvbm5lY3Rpb25UeXBlID0gY29ubmVjdGlvblR5cGVTY29yZXNbaW5mby5jb25uZWN0aW9uVHlwZV0gfHwgMC4zXHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvbm5lY3Rpdml0eSxcclxuICAgICAgbGF0ZW5jeSxcclxuICAgICAgYmFuZHdpZHRoLFxyXG4gICAgICBzdGFiaWxpdHksXHJcbiAgICAgIGNvbm5lY3Rpb25UeXBlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZU92ZXJhbGxSZWxpYWJpbGl0eVNjb3JlKGZhY3RvcnM6IHtcclxuICAgIGNvbm5lY3Rpdml0eTogbnVtYmVyXHJcbiAgICBsYXRlbmN5OiBudW1iZXJcclxuICAgIGJhbmR3aWR0aDogbnVtYmVyXHJcbiAgICBzdGFiaWxpdHk6IG51bWJlclxyXG4gICAgY29ubmVjdGlvblR5cGU6IG51bWJlclxyXG4gIH0pOiBudW1iZXIge1xyXG4gICAgLy8g5p2D6YeN6YWN572uXHJcbiAgICBjb25zdCB3ZWlnaHRzID0ge1xyXG4gICAgICBjb25uZWN0aXZpdHk6IDAuMywgICAgLy8g6L+e6YCa5oCn5pyA6YeN6KaBXHJcbiAgICAgIGxhdGVuY3k6IDAuMjUsICAgICAgICAvLyDlu7bov5/lvbHlk43nlKjmiLfkvZPpqoxcclxuICAgICAgYmFuZHdpZHRoOiAwLjIsICAgICAgIC8vIOW4puWuveW9seWTjeS8oOi+k+mAn+W6plxyXG4gICAgICBzdGFiaWxpdHk6IDAuMTUsICAgICAgLy8g56iz5a6a5oCn5b2x5ZON6ZW/5pyf5L2T6aqMXHJcbiAgICAgIGNvbm5lY3Rpb25UeXBlOiAwLjEgICAvLyDov57mjqXnsbvlnovkvZzkuLrooaXlhYVcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIChcclxuICAgICAgZmFjdG9ycy5jb25uZWN0aXZpdHkgKiB3ZWlnaHRzLmNvbm5lY3Rpdml0eSArXHJcbiAgICAgIGZhY3RvcnMubGF0ZW5jeSAqIHdlaWdodHMubGF0ZW5jeSArXHJcbiAgICAgIGZhY3RvcnMuYmFuZHdpZHRoICogd2VpZ2h0cy5iYW5kd2lkdGggK1xyXG4gICAgICBmYWN0b3JzLnN0YWJpbGl0eSAqIHdlaWdodHMuc3RhYmlsaXR5ICtcclxuICAgICAgZmFjdG9ycy5jb25uZWN0aW9uVHlwZSAqIHdlaWdodHMuY29ubmVjdGlvblR5cGVcclxuICAgIClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlTmV0d29ya1N0YWJpbGl0eSgpOiBudW1iZXIge1xyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxyXG4gICAgY29uc3Qgc3RhYmlsaXR5V2luZG93ID0gNSAqIDYwICogMTAwMCAvLyA15YiG6ZKf56iz5a6a5oCn56qX5Y+jXHJcbiAgICBcclxuICAgIC8vIOiuoeeul+acgOi/kTXliIbpkp/lhoXnmoTnvZHnu5zlj5jljJbmrKHmlbBcclxuICAgIGNvbnN0IHJlY2VudENoYW5nZXMgPSB0aGlzLm5ldHdvcmtIaXN0b3J5LmZpbHRlcihldmVudCA9PiBcclxuICAgICAgbm93IC0gZXZlbnQudGltZXN0YW1wLmdldFRpbWUoKSA8IHN0YWJpbGl0eVdpbmRvd1xyXG4gICAgKS5sZW5ndGhcclxuICAgIFxyXG4gICAgLy8g5Y+Y5YyW5qyh5pWw6LaK5bCR77yM56iz5a6a5oCn6LaK6auYXHJcbiAgICBpZiAocmVjZW50Q2hhbmdlcyA9PT0gMCkgcmV0dXJuIDEuMFxyXG4gICAgaWYgKHJlY2VudENoYW5nZXMgPD0gMikgcmV0dXJuIDAuOFxyXG4gICAgaWYgKHJlY2VudENoYW5nZXMgPD0gNSkgcmV0dXJuIDAuNlxyXG4gICAgaWYgKHJlY2VudENoYW5nZXMgPD0gMTApIHJldHVybiAwLjRcclxuICAgIHJldHVybiAwLjJcclxuICB9XHJcblxyXG4gIC8vIOWIpOaWreaYr+WQpuWPr+S7peaJp+ihjOWQjOatpVxyXG4gIHByaXZhdGUgY2FuUGVyZm9ybVN5bmMoaW5mbzogTmV0d29ya0luZm8pOiBib29sZWFuIHtcclxuICAgIGlmICghaW5mby5vbmxpbmUpIHJldHVybiBmYWxzZVxyXG4gICAgXHJcbiAgICAvLyDmoLnmja7nvZHnu5zotKjph4/liKTmlq1cclxuICAgIGNvbnN0IG1pblF1YWxpdHlTY29yZSA9IDAuMyAvLyDmnIDkvY7otKjph4/liIbmlbDopoHmsYJcclxuICAgIHJldHVybiBuZXR3b3JrTW9uaXRvclNlcnZpY2UuZ2V0TmV0d29ya1F1YWxpdHlTY29yZSgpID49IG1pblF1YWxpdHlTY29yZVxyXG4gIH1cclxuXHJcbiAgLy8g5Lyw6K6h5ZCM5q2l5pe26Ze0XHJcbiAgcHJpdmF0ZSBlc3RpbWF0ZVN5bmNUaW1lKGluZm86IE5ldHdvcmtJbmZvKTogbnVtYmVyIHtcclxuICAgIGlmICghaW5mby5vbmxpbmUpIHJldHVybiBJbmZpbml0eVxyXG4gICAgXHJcbiAgICBjb25zdCBiYXNlVGltZSA9IDEwMDAgLy8g5Z+656GA5pe26Ze0IDHnp5JcclxuICAgIFxyXG4gICAgLy8g5qC55o2uUlRU6LCD5pW0XHJcbiAgICBjb25zdCBydHRNdWx0aXBsaWVyID0gaW5mby5ydHQgPyBNYXRoLm1heCgxLCBpbmZvLnJ0dCAvIDEwMCkgOiAxXHJcbiAgICBcclxuICAgIC8vIOagueaNruS4i+ihjOmAn+W6puiwg+aVtFxyXG4gICAgY29uc3QgZG93bmxpbmtNdWx0aXBsaWVyID0gaW5mby5kb3dubGluayA/IE1hdGgubWF4KDAuNSwgNSAvIGluZm8uZG93bmxpbmspIDogMlxyXG4gICAgXHJcbiAgICByZXR1cm4gYmFzZVRpbWUgKiBydHRNdWx0aXBsaWVyICogZG93bmxpbmtNdWx0aXBsaWVyXHJcbiAgfVxyXG5cclxuICAvLyDnvZHnu5znirbmgIHpooTmtYtcclxuICBwcml2YXRlIHByZWRpY3ROZXR3b3JrU3RhYmlsaXR5KHdpbmRvd01pbnV0ZXM6IG51bWJlciA9IDMwKToge1xyXG4gICAgaXNTdGFibGU6IGJvb2xlYW5cclxuICAgIGNvbmZpZGVuY2U6IG51bWJlclxyXG4gICAgcHJlZGljdGVkRG93bnRpbWU6IG51bWJlclxyXG4gICAgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXVxyXG4gIH0ge1xyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxyXG4gICAgY29uc3Qgd2luZG93TXMgPSB3aW5kb3dNaW51dGVzICogNjAgKiAxMDAwXHJcbiAgICBcclxuICAgIC8vIOiOt+WPluWOhuWPsuaVsOaNrlxyXG4gICAgY29uc3QgcmVjZW50SGlzdG9yeSA9IHRoaXMubmV0d29ya0hpc3RvcnkuZmlsdGVyKGV2ZW50ID0+XHJcbiAgICAgIG5vdyAtIGV2ZW50LnRpbWVzdGFtcC5nZXRUaW1lKCkgPD0gd2luZG93TXNcclxuICAgIClcclxuICAgIFxyXG4gICAgaWYgKHJlY2VudEhpc3RvcnkubGVuZ3RoIDwgNSkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzU3RhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZGVuY2U6IDAuMyxcclxuICAgICAgICBwcmVkaWN0ZWREb3dudGltZTogMCxcclxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IFsn5pWw5o2u5LiN6Laz77yM5bu66K6u55uR5o6n572R57uc54q25oCBJ11cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDorqHnrpfnqLPlrprmgKfmjIfmoIdcclxuICAgIGNvbnN0IG9mZmxpbmVFdmVudHMgPSByZWNlbnRIaXN0b3J5LmZpbHRlcihlID0+ICFlLm5ldHdvcmtJbmZvLm9ubGluZSlcclxuICAgIGNvbnN0IHN0YWJpbGl0eVNjb3JlID0gMSAtIChvZmZsaW5lRXZlbnRzLmxlbmd0aCAvIHJlY2VudEhpc3RvcnkubGVuZ3RoKVxyXG4gICAgXHJcbiAgICAvLyDorqHnrpflubPlnYflnKjnur/ml7bpl7RcclxuICAgIGNvbnN0IG9ubGluZUR1cmF0aW9ucyA9IHRoaXMuY2FsY3VsYXRlT25saW5lRHVyYXRpb25zKHJlY2VudEhpc3RvcnkpXHJcbiAgICBjb25zdCBhdmdPbmxpbmVEdXJhdGlvbiA9IG9ubGluZUR1cmF0aW9ucy5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvIG9ubGluZUR1cmF0aW9ucy5sZW5ndGggfHwgMFxyXG4gICAgXHJcbiAgICAvLyDpooTmtYvmnKrmnaXlj6/og73nmoTnprvnur/ml7bpl7RcclxuICAgIGNvbnN0IHByZWRpY3RlZERvd250aW1lID0gdGhpcy5wcmVkaWN0RG93bnRpbWUocmVjZW50SGlzdG9yeSwgd2luZG93TXMpXHJcbiAgICBcclxuICAgIC8vIOeUn+aIkOW7uuiurlxyXG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gdGhpcy5nZW5lcmF0ZU5ldHdvcmtSZWNvbW1lbmRhdGlvbnMoXHJcbiAgICAgIHN0YWJpbGl0eVNjb3JlLFxyXG4gICAgICBhdmdPbmxpbmVEdXJhdGlvbixcclxuICAgICAgcHJlZGljdGVkRG93bnRpbWVcclxuICAgIClcclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNTdGFibGU6IHN0YWJpbGl0eVNjb3JlID49IDAuOCxcclxuICAgICAgY29uZmlkZW5jZTogTWF0aC5taW4oc3RhYmlsaXR5U2NvcmUsIDAuOSksXHJcbiAgICAgIHByZWRpY3RlZERvd250aW1lLFxyXG4gICAgICByZWNvbW1lbmRhdGlvbnNcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlT25saW5lRHVyYXRpb25zKGhpc3Rvcnk6IE5ldHdvcmtFdmVudFtdKTogbnVtYmVyW10ge1xyXG4gICAgY29uc3QgZHVyYXRpb25zOiBudW1iZXJbXSA9IFtdXHJcbiAgICBsZXQgb25saW5lU3RhcnRUaW1lOiBudW1iZXIgfCBudWxsID0gbnVsbFxyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGV2ZW50IG9mIGhpc3RvcnkpIHtcclxuICAgICAgaWYgKGV2ZW50Lm5ldHdvcmtJbmZvLm9ubGluZSAmJiBvbmxpbmVTdGFydFRpbWUgPT09IG51bGwpIHtcclxuICAgICAgICBvbmxpbmVTdGFydFRpbWUgPSBldmVudC50aW1lc3RhbXAuZ2V0VGltZSgpXHJcbiAgICAgIH0gZWxzZSBpZiAoIWV2ZW50Lm5ldHdvcmtJbmZvLm9ubGluZSAmJiBvbmxpbmVTdGFydFRpbWUgIT09IG51bGwpIHtcclxuICAgICAgICBkdXJhdGlvbnMucHVzaChldmVudC50aW1lc3RhbXAuZ2V0VGltZSgpIC0gb25saW5lU3RhcnRUaW1lKVxyXG4gICAgICAgIG9ubGluZVN0YXJ0VGltZSA9IG51bGxcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDlpITnkIblvZPliY3lnKjnur/nirbmgIFcclxuICAgIGlmIChvbmxpbmVTdGFydFRpbWUgIT09IG51bGwpIHtcclxuICAgICAgZHVyYXRpb25zLnB1c2goRGF0ZS5ub3coKSAtIG9ubGluZVN0YXJ0VGltZSlcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGR1cmF0aW9uc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBwcmVkaWN0RG93bnRpbWUoaGlzdG9yeTogTmV0d29ya0V2ZW50W10sIHdpbmRvd01zOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgY29uc3Qgb2ZmbGluZUV2ZW50cyA9IGhpc3RvcnkuZmlsdGVyKGUgPT4gIWUubmV0d29ya0luZm8ub25saW5lKVxyXG4gICAgXHJcbiAgICBpZiAob2ZmbGluZUV2ZW50cy5sZW5ndGggPT09IDApIHJldHVybiAwXHJcbiAgICBcclxuICAgIC8vIOiuoeeul+W5s+Wdh+emu+e6v+aXtumVv1xyXG4gICAgY29uc3Qgb2ZmbGluZUR1cmF0aW9uczogbnVtYmVyW10gPSBbXVxyXG4gICAgbGV0IG9mZmxpbmVTdGFydFRpbWU6IG51bWJlciB8IG51bGwgPSBudWxsXHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgZXZlbnQgb2YgaGlzdG9yeSkge1xyXG4gICAgICBpZiAoIWV2ZW50Lm5ldHdvcmtJbmZvLm9ubGluZSAmJiBvZmZsaW5lU3RhcnRUaW1lID09PSBudWxsKSB7XHJcbiAgICAgICAgb2ZmbGluZVN0YXJ0VGltZSA9IGV2ZW50LnRpbWVzdGFtcC5nZXRUaW1lKClcclxuICAgICAgfSBlbHNlIGlmIChldmVudC5uZXR3b3JrSW5mby5vbmxpbmUgJiYgb2ZmbGluZVN0YXJ0VGltZSAhPT0gbnVsbCkge1xyXG4gICAgICAgIG9mZmxpbmVEdXJhdGlvbnMucHVzaChldmVudC50aW1lc3RhbXAuZ2V0VGltZSgpIC0gb2ZmbGluZVN0YXJ0VGltZSlcclxuICAgICAgICBvZmZsaW5lU3RhcnRUaW1lID0gbnVsbFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChvZmZsaW5lRHVyYXRpb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcclxuICAgIFxyXG4gICAgY29uc3QgYXZnT2ZmbGluZUR1cmF0aW9uID0gb2ZmbGluZUR1cmF0aW9ucy5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvIG9mZmxpbmVEdXJhdGlvbnMubGVuZ3RoXHJcbiAgICBjb25zdCBvZmZsaW5lRnJlcXVlbmN5ID0gb2ZmbGluZUV2ZW50cy5sZW5ndGggLyAod2luZG93TXMgLyAoNjAgKiAxMDAwKSkgLy8g5q+P5YiG6ZKf56a757q/5qyh5pWwXHJcbiAgICBcclxuICAgIHJldHVybiBhdmdPZmZsaW5lRHVyYXRpb24gKiBvZmZsaW5lRnJlcXVlbmN5XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdlbmVyYXRlTmV0d29ya1JlY29tbWVuZGF0aW9ucyhcclxuICAgIHN0YWJpbGl0eVNjb3JlOiBudW1iZXIsXHJcbiAgICBhdmdPbmxpbmVEdXJhdGlvbjogbnVtYmVyLFxyXG4gICAgcHJlZGljdGVkRG93bnRpbWU6IG51bWJlclxyXG4gICk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXVxyXG4gICAgXHJcbiAgICBpZiAoc3RhYmlsaXR5U2NvcmUgPCAwLjYpIHtcclxuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ+e9kee7nOi/nuaOpeS4jeeos+Wumu+8jOW7uuiuruWIh+aNouWIsOabtOeos+WumueahOe9kee7nCcpXHJcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCflu7rorq7lkK/nlKjnprvnur/mqKHlvI8nKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoYXZnT25saW5lRHVyYXRpb24gPCA1ICogNjAgKiAxMDAwKSB7IC8vIOWwkeS6jjXliIbpkp9cclxuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ+e9kee7nOi/nuaOpeaMgee7reaXtumXtOefre+8jOW7uuiuruajgOafpee9kee7nOiuvuWkhycpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChwcmVkaWN0ZWREb3dudGltZSA+IDEwICogNjAgKiAxMDAwKSB7IC8vIOi2hei/hzEw5YiG6ZKfXHJcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCfpooTorqHnvZHnu5zkuK3mlq3ml7bpl7TovoPplb/vvIzlu7rorq7mj5DliY3lrozmiJDph43opoHmk43kvZwnKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoc3RhYmlsaXR5U2NvcmUgPj0gMC45ICYmIGF2Z09ubGluZUR1cmF0aW9uID4gMzAgKiA2MCAqIDEwMDApIHtcclxuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ+e9kee7nOeKtuaAgeiJr+Wlve+8jOmAguWQiOi/m+ihjOWkp+inhOaooeWQjOatpeaTjeS9nCcpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnNcclxuICB9XHJcblxyXG4gIC8vIOajgOafpeeKtuaAgeaYr+WQpuacieaYvuiRl+WPmOWMllxyXG4gIHByaXZhdGUgaGFzU2lnbmlmaWNhbnRDaGFuZ2Uob2xkU3RhdGU6IE5ldHdvcmtTdGF0ZSwgbmV3U3RhdGU6IE5ldHdvcmtTdGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgLy8g5Zyo57q/54q25oCB5Y+Y5YyWXHJcbiAgICBpZiAob2xkU3RhdGUuaXNPbmxpbmUgIT09IG5ld1N0YXRlLmlzT25saW5lKSByZXR1cm4gdHJ1ZVxyXG4gICAgXHJcbiAgICAvLyDlj6/pnaDmgKflj5jljJZcclxuICAgIGlmIChvbGRTdGF0ZS5pc1JlbGlhYmxlICE9PSBuZXdTdGF0ZS5pc1JlbGlhYmxlKSByZXR1cm4gdHJ1ZVxyXG4gICAgXHJcbiAgICAvLyDotKjph4/nrYnnuqflj5jljJZcclxuICAgIGlmIChvbGRTdGF0ZS5xdWFsaXR5ICE9PSBuZXdTdGF0ZS5xdWFsaXR5KSByZXR1cm4gdHJ1ZVxyXG4gICAgXHJcbiAgICAvLyDotKjph4/liIbmlbDmmL7okZflj5jljJbvvIjotoXov4cxMCXvvIlcclxuICAgIGNvbnN0IHF1YWxpdHlDaGFuZ2UgPSBNYXRoLmFicyhvbGRTdGF0ZS5xdWFsaXR5U2NvcmUgLSBuZXdTdGF0ZS5xdWFsaXR5U2NvcmUpXHJcbiAgICBpZiAocXVhbGl0eUNoYW5nZSA+IDAuMSkgcmV0dXJuIHRydWVcclxuICAgIFxyXG4gICAgLy8g5ZCM5q2l6IO95Yqb5Y+Y5YyWXHJcbiAgICBpZiAob2xkU3RhdGUuY2FuU3luYyAhPT0gbmV3U3RhdGUuY2FuU3luYykgcmV0dXJuIHRydWVcclxuICAgIFxyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICAvLyDmo4Dmn6XnrZbnlaXmmK/lkKblj5jljJZcclxuICBwcml2YXRlIGhhc1N0cmF0ZWd5Q2hhbmdlZChvbGRTdHJhdGVneTogU3luY1N0cmF0ZWd5LCBuZXdTdHJhdGVneTogU3luY1N0cmF0ZWd5KTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBvbGRTdHJhdGVneS5iYXRjaFNpemUgIT09IG5ld1N0cmF0ZWd5LmJhdGNoU2l6ZSB8fFxyXG4gICAgICBvbGRTdHJhdGVneS5yZXF1ZXN0VGltZW91dCAhPT0gbmV3U3RyYXRlZ3kucmVxdWVzdFRpbWVvdXQgfHxcclxuICAgICAgb2xkU3RyYXRlZ3kuY29tcHJlc3Npb25FbmFibGVkICE9PSBuZXdTdHJhdGVneS5jb21wcmVzc2lvbkVuYWJsZWQgfHxcclxuICAgICAgb2xkU3RyYXRlZ3kubWF4UmV0cmllcyAhPT0gbmV3U3RyYXRlZ3kubWF4UmV0cmllc1xyXG4gICAgKVxyXG4gIH1cclxuXHJcbiAgLy8g5aSE55CG572R57uc5oGi5aSNXHJcbiAgcHJpdmF0ZSBoYW5kbGVOZXR3b3JrUmVzdG9yZWQoKTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZygnTmV0d29yayByZXN0b3JlZCwgcHJvY2Vzc2luZyBwZW5kaW5nIHJlcXVlc3RzLi4uJylcclxuICAgIFxyXG4gICAgLy8g6YeN572u5omA5pyJ5pat6Lev5ZmoXHJcbiAgICB0aGlzLnJlc2V0QWxsQ2lyY3VpdEJyZWFrZXJzKClcclxuICAgIFxyXG4gICAgLy8g5aSE55CG562J5b6F5Lit55qE6K+35rGCXHJcbiAgICB0aGlzLnByb2Nlc3NQZW5kaW5nUmVxdWVzdHMoKVxyXG4gIH1cclxuXHJcbiAgLy8g5aSE55CG572R57uc5Lii5aSxXHJcbiAgcHJpdmF0ZSBoYW5kbGVOZXR3b3JrTG9zdCgpOiB2b2lkIHtcclxuICAgIGNvbnNvbGUubG9nKCdOZXR3b3JrIGxvc3QsIHBhdXNpbmcgc3luYyBvcGVyYXRpb25zLi4uJylcclxuICAgIFxyXG4gICAgLy8g5riF56m65om55aSE55CG5a6a5pe25ZmoXHJcbiAgICBpZiAodGhpcy5iYXRjaFRpbWVyKSB7XHJcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLmJhdGNoVGltZXIpXHJcbiAgICAgIHRoaXMuYmF0Y2hUaW1lciA9IG51bGxcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIOWkhOeQhui0qOmHj+WPmOWMllxyXG4gIHByaXZhdGUgaGFuZGxlUXVhbGl0eUNoYW5nZShldmVudDogTmV0d29ya0V2ZW50KTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZygnTmV0d29yayBxdWFsaXR5IGNoYW5nZWQ6JywgZXZlbnQuZGV0YWlscylcclxuICAgIFxyXG4gICAgLy8g5pu05paw5ZCM5q2l562W55WlXHJcbiAgICB0aGlzLnVwZGF0ZVN5bmNTdHJhdGVneSgpXHJcbiAgfVxyXG5cclxuICAvLyDlpITnkIbnvZHnu5zplJnor69cclxuICBwcml2YXRlIGhhbmRsZU5ldHdvcmtFcnJvcihldmVudDogTmV0d29ya0V2ZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBlcnJvcjogTmV0d29ya0Vycm9yID0ge1xyXG4gICAgICB0eXBlOiAnbmV0d29ya19zbG93JyxcclxuICAgICAgbWVzc2FnZTogJ05ldHdvcmsgcXVhbGl0eSBkZWdyYWRlZCcsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgZGV0YWlsczogZXZlbnQuZGV0YWlsc1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLm5vdGlmeUVycm9yKGVycm9yLCAncXVhbGl0eV9kZWdyYWRhdGlvbicpXHJcbiAgfVxyXG5cclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgLy8g5pat6Lev5Zmo566h55CGXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuICAvLyDmo4Dmn6Xmlq3ot6/lmajnirbmgIFcclxuICBwcml2YXRlIGNoZWNrQ2lyY3VpdEJyZWFrZXIob3BlcmF0aW9uOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGJyZWFrZXIgPSB0aGlzLmNpcmN1aXRCcmVha2Vycy5nZXQob3BlcmF0aW9uKVxyXG4gICAgaWYgKCFicmVha2VyIHx8ICF0aGlzLnN5bmNTdHJhdGVneS5jaXJjdWl0QnJlYWtlckVuYWJsZWQpIHJldHVybiB0cnVlXHJcbiAgICBcclxuICAgIGNvbnN0IHN0YXR1cyA9IGJyZWFrZXIuc3RhdHVzXHJcbiAgICBcclxuICAgIC8vIOWmguaenOaWrei3r+WZqOW8gOWQr++8jOajgOafpeaYr+WQpuWPr+S7peWwneivleaBouWkjVxyXG4gICAgaWYgKHN0YXR1cy5zdGF0ZSA9PT0gJ29wZW4nKSB7XHJcbiAgICAgIGlmIChEYXRlLm5vdygpID49IChzdGF0dXMubmV4dEF0dGVtcHRUaW1lPy5nZXRUaW1lKCkgfHwgMCkpIHtcclxuICAgICAgICAvLyDliIfmjaLliLDljYrlvIDnirbmgIFcclxuICAgICAgICBzdGF0dXMuc3RhdGUgPSAnaGFsZl9vcGVuJ1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBDaXJjdWl0IGJyZWFrZXIgZm9yICR7b3BlcmF0aW9ufSBtb3ZlZCB0byBoYWxmLW9wZW4gc3RhdGVgKVxyXG4gICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBzdGF0dXMuc3RhdGUgIT09ICdvcGVuJ1xyXG4gIH1cclxuXHJcbiAgLy8g6K6w5b2V5oiQ5YqfXHJcbiAgcHJpdmF0ZSByZWNvcmRTdWNjZXNzKG9wZXJhdGlvbjogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBjb25zdCBicmVha2VyID0gdGhpcy5jaXJjdWl0QnJlYWtlcnMuZ2V0KG9wZXJhdGlvbilcclxuICAgIGlmICghYnJlYWtlcikgcmV0dXJuXHJcbiAgICBcclxuICAgIGNvbnN0IHN0YXR1cyA9IGJyZWFrZXIuc3RhdHVzXHJcbiAgICBcclxuICAgIC8vIOmHjee9ruWksei0peiuoeaVsFxyXG4gICAgc3RhdHVzLmZhaWx1cmVDb3VudCA9IDBcclxuICAgIHN0YXR1cy5zdGF0ZSA9ICdjbG9zZWQnXHJcbiAgICBcclxuICAgIC8vIOa4hemZpOaBouWkjeWumuaXtuWZqFxyXG4gICAgaWYgKGJyZWFrZXIudGltZXIpIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KGJyZWFrZXIudGltZXIpXHJcbiAgICAgIGJyZWFrZXIudGltZXIgPSB1bmRlZmluZWRcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIOiusOW9leWksei0pVxyXG4gIHByaXZhdGUgcmVjb3JkRmFpbHVyZShvcGVyYXRpb246IHN0cmluZywgZXJyb3I6IE5ldHdvcmtFcnJvcik6IHZvaWQge1xyXG4gICAgY29uc3QgYnJlYWtlciA9IHRoaXMuY2lyY3VpdEJyZWFrZXJzLmdldChvcGVyYXRpb24pXHJcbiAgICBpZiAoIWJyZWFrZXIgfHwgIXRoaXMuc3luY1N0cmF0ZWd5LmNpcmN1aXRCcmVha2VyRW5hYmxlZCkgcmV0dXJuXHJcbiAgICBcclxuICAgIGNvbnN0IHN0YXR1cyA9IGJyZWFrZXIuc3RhdHVzXHJcbiAgICBjb25zdCBjb25maWcgPSBzdGF0dXMuY29uZmlnXHJcbiAgICBcclxuICAgIC8vIOajgOafpeaYr+WQpuaYr+mihOacn+W8guW4uFxyXG4gICAgaWYgKGNvbmZpZy5leHBlY3RlZEV4Y2VwdGlvbiAmJiAhY29uZmlnLmV4cGVjdGVkRXhjZXB0aW9uLmluY2x1ZGVzKGVycm9yLnR5cGUpKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDlop7liqDlpLHotKXorqHmlbBcclxuICAgIHN0YXR1cy5mYWlsdXJlQ291bnQrK1xyXG4gICAgc3RhdHVzLmxhc3RGYWlsdXJlVGltZSA9IG5ldyBEYXRlKClcclxuICAgIFxyXG4gICAgLy8g5qOA5p+l5piv5ZCm6L6+5Yiw6ZiI5YC8XHJcbiAgICBpZiAoc3RhdHVzLmZhaWx1cmVDb3VudCA+PSBjb25maWcuZmFpbHVyZVRocmVzaG9sZCkge1xyXG4gICAgICBzdGF0dXMuc3RhdGUgPSAnb3BlbidcclxuICAgICAgc3RhdHVzLm5leHRBdHRlbXB0VGltZSA9IG5ldyBEYXRlKERhdGUubm93KCkgKyBjb25maWcucmVjb3ZlcnlUaW1lb3V0KVxyXG4gICAgICBcclxuICAgICAgdGhpcy5zdGF0cy5jaXJjdWl0QnJlYWtlclRyaXBzKytcclxuICAgICAgY29uc29sZS5sb2coYENpcmN1aXQgYnJlYWtlciBmb3IgJHtvcGVyYXRpb259IHRyaXBwZWQ6ICR7c3RhdHVzLmZhaWx1cmVDb3VudH0gZmFpbHVyZXNgKVxyXG4gICAgICBcclxuICAgICAgLy8g6K6+572u5oGi5aSN5a6a5pe25ZmoXHJcbiAgICAgIGlmIChicmVha2VyLnRpbWVyKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KGJyZWFrZXIudGltZXIpXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGJyZWFrZXIudGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBzdGF0dXMuc3RhdGUgPSAnaGFsZl9vcGVuJ1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBDaXJjdWl0IGJyZWFrZXIgZm9yICR7b3BlcmF0aW9ufSBtb3ZlZCB0byBoYWxmLW9wZW4gc3RhdGVgKVxyXG4gICAgICB9LCBjb25maWcucmVjb3ZlcnlUaW1lb3V0KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8g6YeN572u5pat6Lev5ZmoXHJcbiAgcHJpdmF0ZSByZXNldENpcmN1aXRCcmVha2VyKG9wZXJhdGlvbjogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBjb25zdCBicmVha2VyID0gdGhpcy5jaXJjdWl0QnJlYWtlcnMuZ2V0KG9wZXJhdGlvbilcclxuICAgIGlmICghYnJlYWtlcikgcmV0dXJuXHJcbiAgICBcclxuICAgIGNvbnN0IHN0YXR1cyA9IGJyZWFrZXIuc3RhdHVzXHJcbiAgICBzdGF0dXMuZmFpbHVyZUNvdW50ID0gMFxyXG4gICAgc3RhdHVzLnN0YXRlID0gJ2Nsb3NlZCdcclxuICAgIHN0YXR1cy5sYXN0RmFpbHVyZVRpbWUgPSB1bmRlZmluZWRcclxuICAgIHN0YXR1cy5uZXh0QXR0ZW1wdFRpbWUgPSB1bmRlZmluZWRcclxuICAgIFxyXG4gICAgaWYgKGJyZWFrZXIudGltZXIpIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KGJyZWFrZXIudGltZXIpXHJcbiAgICAgIGJyZWFrZXIudGltZXIgPSB1bmRlZmluZWRcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIOmHjee9ruaJgOacieaWrei3r+WZqFxyXG4gIHByaXZhdGUgcmVzZXRBbGxDaXJjdWl0QnJlYWtlcnMoKTogdm9pZCB7XHJcbiAgICB0aGlzLmNpcmN1aXRCcmVha2Vycy5mb3JFYWNoKChicmVha2VyLCBvcGVyYXRpb24pID0+IHtcclxuICAgICAgdGhpcy5yZXNldENpcmN1aXRCcmVha2VyKG9wZXJhdGlvbilcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgLy8g6K+35rGC5aSE55CGXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuICAvLyDmt7vliqDlkIzmraXor7fmsYJcclxuICBhc3luYyBhZGRTeW5jUmVxdWVzdChyZXF1ZXN0OiBTeW5jUmVxdWVzdCk6IFByb21pc2U8U3luY1Jlc3BvbnNlPiB7XHJcbiAgICB0aGlzLnN0YXRzLnRvdGFsUmVxdWVzdHMrK1xyXG4gICAgXHJcbiAgICAvLyDmo4Dmn6XnvZHnu5znirbmgIFcclxuICAgIGlmICghdGhpcy5jdXJyZW50U3RhdGUuY2FuU3luYykge1xyXG4gICAgICBjb25zdCBlcnJvcjogTmV0d29ya0Vycm9yID0ge1xyXG4gICAgICAgIHR5cGU6ICdjb25uZWN0aW9uX2xvc3QnLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdOZXR3b3JrIG5vdCBhdmFpbGFibGUgZm9yIHN5bmMnLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc3RhdHMuZmFpbGVkUmVxdWVzdHMrK1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3IsIGR1cmF0aW9uOiAwLCByZXRyeUNvdW50OiAwLCBuZXR3b3JrU3RhdGU6IHRoaXMuY3VycmVudFN0YXRlIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g5qOA5p+l5pat6Lev5ZmoXHJcbiAgICBjb25zdCBvcGVyYXRpb24gPSByZXF1ZXN0LnR5cGUgPT09ICdiYXRjaCcgPyAnYmF0Y2gnIDogcmVxdWVzdC50eXBlXHJcbiAgICBpZiAoIXRoaXMuY2hlY2tDaXJjdWl0QnJlYWtlcihvcGVyYXRpb24pKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yOiBOZXR3b3JrRXJyb3IgPSB7XHJcbiAgICAgICAgdHlwZTogJ3JhdGVfbGltaXRlZCcsXHJcbiAgICAgICAgbWVzc2FnZTogJ0NpcmN1aXQgYnJlYWtlciBpcyBvcGVuJyxcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnN0YXRzLmZhaWxlZFJlcXVlc3RzKytcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yLCBkdXJhdGlvbjogMCwgcmV0cnlDb3VudDogMCwgbmV0d29ya1N0YXRlOiB0aGlzLmN1cnJlbnRTdGF0ZSB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIOa3u+WKoOWIsOmYn+WIl1xyXG4gICAgY29uc3QgcXVldWUgPSB0aGlzLnBlbmRpbmdSZXF1ZXN0cy5nZXQocmVxdWVzdC5wcmlvcml0eSkhXHJcbiAgICBxdWV1ZS5wdXNoKHJlcXVlc3QpXHJcbiAgICBcclxuICAgIC8vIOWmguaenOaYr+mrmOS8mOWFiOe6p+aIlumYn+WIl+i+vuWIsOaJueWkhOeQhuWkp+Wwj++8jOeri+WNs+WkhOeQhlxyXG4gICAgaWYgKHJlcXVlc3QucHJpb3JpdHkgPT09ICdjcml0aWNhbCcgfHwgcXVldWUubGVuZ3RoID49IHRoaXMuc3luY1N0cmF0ZWd5LmJhdGNoU2l6ZSkge1xyXG4gICAgICBhd2FpdCB0aGlzLnByb2Nlc3NQcmlvcml0eVF1ZXVlKHJlcXVlc3QucHJpb3JpdHkpXHJcbiAgICB9IGVsc2UgaWYgKCF0aGlzLmJhdGNoVGltZXIpIHtcclxuICAgICAgLy8g6K6+572u5om55aSE55CG5a6a5pe25ZmoXHJcbiAgICAgIHRoaXMuYmF0Y2hUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMucHJvY2Vzc0FsbFF1ZXVlcygpXHJcbiAgICAgIH0sIHRoaXMuc3luY1N0cmF0ZWd5LmJhdGNoRGVsYXkpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGR1cmF0aW9uOiAwLCByZXRyeUNvdW50OiAwLCBuZXR3b3JrU3RhdGU6IHRoaXMuY3VycmVudFN0YXRlIH1cclxuICB9XHJcblxyXG4gIC8vIOWkhOeQhueJueWumuS8mOWFiOe6p+eahOmYn+WIl1xyXG4gIHByaXZhdGUgYXN5bmMgcHJvY2Vzc1ByaW9yaXR5UXVldWUocHJpb3JpdHk6IFN5bmNQcmlvcml0eSk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKHRoaXMuaXNQcm9jZXNzaW5nKSByZXR1cm5cclxuICAgIFxyXG4gICAgdGhpcy5pc1Byb2Nlc3NpbmcgPSB0cnVlXHJcbiAgICBjb25zdCBxdWV1ZSA9IHRoaXMucGVuZGluZ1JlcXVlc3RzLmdldChwcmlvcml0eSkhXHJcbiAgICBcclxuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgdGhpcy5pc1Byb2Nlc3NpbmcgPSBmYWxzZVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgYmF0Y2hTaXplID0gTWF0aC5taW4ocXVldWUubGVuZ3RoLCB0aGlzLnN5bmNTdHJhdGVneS5iYXRjaFNpemUpXHJcbiAgICBjb25zdCByZXF1ZXN0cyA9IHF1ZXVlLnNwbGljZSgwLCBiYXRjaFNpemUpXHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIOaJuemHj+WkhOeQhuivt+axglxyXG4gICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVCYXRjaFJlcXVlc3RzKHJlcXVlc3RzKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHByb2Nlc3MgYmF0Y2ggcmVxdWVzdHM6JywgZXJyb3IpXHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IGZhbHNlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDlpITnkIbmiYDmnInpmJ/liJdcclxuICBwcml2YXRlIGFzeW5jIHByb2Nlc3NBbGxRdWV1ZXMoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBpZiAodGhpcy5pc1Byb2Nlc3NpbmcpIHJldHVyblxyXG4gICAgXHJcbiAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IHRydWVcclxuICAgIHRoaXMuYmF0Y2hUaW1lciA9IG51bGxcclxuICAgIFxyXG4gICAgY29uc3QgcHJpb3JpdGllczogU3luY1ByaW9yaXR5W10gPSBbJ2NyaXRpY2FsJywgJ2hpZ2gnLCAnbm9ybWFsJywgJ2xvdycsICdiYWNrZ3JvdW5kJ11cclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgZm9yIChjb25zdCBwcmlvcml0eSBvZiBwcmlvcml0aWVzKSB7XHJcbiAgICAgICAgY29uc3QgcXVldWUgPSB0aGlzLnBlbmRpbmdSZXF1ZXN0cy5nZXQocHJpb3JpdHkpIVxyXG4gICAgICAgIGlmIChxdWV1ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnByb2Nlc3NQcmlvcml0eVF1ZXVlKHByaW9yaXR5KVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHByb2Nlc3MgcmVxdWVzdCBxdWV1ZXM6JywgZXJyb3IpXHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IGZhbHNlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDlpITnkIbnrYnlvoXkuK3nmoTor7fmsYJcclxuICBwcml2YXRlIGFzeW5jIHByb2Nlc3NQZW5kaW5nUmVxdWVzdHMoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBpZiAodGhpcy5jdXJyZW50U3RhdGUuY2FuU3luYyAmJiAhdGhpcy5pc1Byb2Nlc3NpbmcpIHtcclxuICAgICAgYXdhaXQgdGhpcy5wcm9jZXNzQWxsUXVldWVzKClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIOaJp+ihjOaJuemHj+ivt+axglxyXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZUJhdGNoUmVxdWVzdHMocmVxdWVzdHM6IFN5bmNSZXF1ZXN0W10pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGZvciAoY29uc3QgcmVxdWVzdCBvZiByZXF1ZXN0cykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5leGVjdXRlUmVxdWVzdChyZXF1ZXN0KVxyXG4gICAgICAgIHRoaXMubm90aWZ5U3luY0NvbXBsZXRlZChyZXF1ZXN0LCByZXNwb25zZSlcclxuICAgICAgICBcclxuICAgICAgICBpZiAocmVzcG9uc2Uuc3VjY2Vzcykge1xyXG4gICAgICAgICAgdGhpcy5yZWNvcmRTdWNjZXNzKHJlcXVlc3QudHlwZSlcclxuICAgICAgICAgIHRoaXMuc3RhdHMuc3VjY2Vzc2Z1bFJlcXVlc3RzKytcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5yZWNvcmRGYWlsdXJlKHJlcXVlc3QudHlwZSwgcmVzcG9uc2UuZXJyb3IhKVxyXG4gICAgICAgICAgdGhpcy5zdGF0cy5mYWlsZWRSZXF1ZXN0cysrXHJcbiAgICAgICAgICB0aGlzLnN0YXRzLmxhc3RFcnJvciA9IHJlc3BvbnNlLmVycm9yXHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnN0IGVycm9yUmVzcG9uc2U6IE5ldHdvcmtFcnJvciA9IHtcclxuICAgICAgICAgIHR5cGU6ICdzZXJ2ZXJfZXJyb3InLFxyXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXHJcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5yZWNvcmRGYWlsdXJlKHJlcXVlc3QudHlwZSwgZXJyb3JSZXNwb25zZSlcclxuICAgICAgICB0aGlzLnN0YXRzLmZhaWxlZFJlcXVlc3RzKytcclxuICAgICAgICB0aGlzLnN0YXRzLmxhc3RFcnJvciA9IGVycm9yUmVzcG9uc2VcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLm5vdGlmeVN5bmNDb21wbGV0ZWQocmVxdWVzdCwgeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgICAgIGVycm9yOiBlcnJvclJlc3BvbnNlLCBcclxuICAgICAgICAgIGR1cmF0aW9uOiAwLCBcclxuICAgICAgICAgIHJldHJ5Q291bnQ6IDAsIFxyXG4gICAgICAgICAgbmV0d29ya1N0YXRlOiB0aGlzLmN1cnJlbnRTdGF0ZSBcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDmiafooYzljZXkuKror7fmsYJcclxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVSZXF1ZXN0KHJlcXVlc3Q6IFN5bmNSZXF1ZXN0KTogUHJvbWlzZTxTeW5jUmVzcG9uc2U+IHtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KClcclxuICAgIFxyXG4gICAgLy8g6L+Z6YeM5bqU6K+l5a6e546w5a6e6ZmF55qE6K+35rGC6YC76L6RXHJcbiAgICAvLyDnm67liY3ov5Tlm57mqKHmi5/lk43lupRcclxuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKSAvLyDmqKHmi5/nvZHnu5zlu7bov59cclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgZGF0YTogeyBpZDogcmVxdWVzdC5pZCwgcHJvY2Vzc2VkOiB0cnVlIH0sXHJcbiAgICAgIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lLFxyXG4gICAgICByZXRyeUNvdW50OiByZXF1ZXN0LnJldHJ5Q291bnQsXHJcbiAgICAgIG5ldHdvcmtTdGF0ZTogdGhpcy5jdXJyZW50U3RhdGVcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyDkuovku7bpgJrnn6VcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4gIC8vIOa3u+WKoOebkeWQrOWZqFxyXG4gIGFkZExpc3RlbmVyKGxpc3RlbmVyOiBEYXRhYmFzZU5ldHdvcmtMaXN0ZW5lcik6IHZvaWQge1xyXG4gICAgdGhpcy5saXN0ZW5lcnMuYWRkKGxpc3RlbmVyKVxyXG4gIH1cclxuXHJcbiAgLy8g56e76Zmk55uR5ZCs5ZmoXHJcbiAgcmVtb3ZlTGlzdGVuZXIobGlzdGVuZXI6IERhdGFiYXNlTmV0d29ya0xpc3RlbmVyKTogdm9pZCB7XHJcbiAgICB0aGlzLmxpc3RlbmVycy5kZWxldGUobGlzdGVuZXIpXHJcbiAgfVxyXG5cclxuICAvLyDpgJrnn6XnirbmgIHlj5jljJZcclxuICBwcml2YXRlIG5vdGlmeVN0YXRlQ2hhbmdlZCgpOiB2b2lkIHtcclxuICAgIHRoaXMubGlzdGVuZXJzLmZvckVhY2gobGlzdGVuZXIgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGxpc3RlbmVyLm9uTmV0d29ya1N0YXRlQ2hhbmdlZCh0aGlzLmN1cnJlbnRTdGF0ZSlcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBuZXR3b3JrIHN0YXRlIGxpc3RlbmVyOicsIGVycm9yKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8g6YCa55+l6ZSZ6K+vXHJcbiAgcHJpdmF0ZSBub3RpZnlFcnJvcihlcnJvcjogTmV0d29ya0Vycm9yLCBjb250ZXh0Pzogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0aGlzLmxpc3RlbmVycy5mb3JFYWNoKGxpc3RlbmVyID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBsaXN0ZW5lci5vbk5ldHdvcmtFcnJvcihlcnJvciwgY29udGV4dClcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBuZXR3b3JrIGVycm9yIGxpc3RlbmVyOicsIGVycm9yKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8g6YCa55+l5ZCM5q2l5a6M5oiQXHJcbiAgcHJpdmF0ZSBub3RpZnlTeW5jQ29tcGxldGVkKHJlcXVlc3Q6IFN5bmNSZXF1ZXN0LCByZXNwb25zZTogU3luY1Jlc3BvbnNlKTogdm9pZCB7XHJcbiAgICB0aGlzLmxpc3RlbmVycy5mb3JFYWNoKGxpc3RlbmVyID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBsaXN0ZW5lci5vblN5bmNDb21wbGV0ZWQocmVxdWVzdCwgcmVzcG9uc2UpXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gc3luYyBjb21wbGV0aW9uIGxpc3RlbmVyOicsIGVycm9yKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8g6YCa55+l562W55Wl5Y+Y5YyWXHJcbiAgcHJpdmF0ZSBub3RpZnlTdHJhdGVneUNoYW5nZWQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmxpc3RlbmVycy5mb3JFYWNoKGxpc3RlbmVyID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBsaXN0ZW5lci5vblN5bmNTdHJhdGVneUNoYW5nZWQodGhpcy5zeW5jU3RyYXRlZ3kpXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gc3luYyBzdHJhdGVneSBsaXN0ZW5lcjonLCBlcnJvcilcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyDlhazlhbFBUElcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4gIC8vIOiOt+WPluW9k+WJjee9kee7nOeKtuaAgVxyXG4gIGdldEN1cnJlbnRTdGF0ZSgpOiBOZXR3b3JrU3RhdGUge1xyXG4gICAgcmV0dXJuIHsgLi4udGhpcy5jdXJyZW50U3RhdGUgfVxyXG4gIH1cclxuXHJcbiAgLy8g6I635Y+W5ZCM5q2l562W55WlXHJcbiAgZ2V0U3luY1N0cmF0ZWd5KCk6IFN5bmNTdHJhdGVneSB7XHJcbiAgICByZXR1cm4geyAuLi50aGlzLnN5bmNTdHJhdGVneSB9XHJcbiAgfVxyXG5cclxuICAvLyDojrflj5bmlq3ot6/lmajnirbmgIFcclxuICBnZXRDaXJjdWl0QnJlYWtlclN0YXR1cyhvcGVyYXRpb246IHN0cmluZyk6IENpcmN1aXRCcmVha2VyU3RhdHVzIHwgbnVsbCB7XHJcbiAgICBjb25zdCBicmVha2VyID0gdGhpcy5jaXJjdWl0QnJlYWtlcnMuZ2V0KG9wZXJhdGlvbilcclxuICAgIHJldHVybiBicmVha2VyID8geyAuLi5icmVha2VyLnN0YXR1cyB9IDogbnVsbFxyXG4gIH1cclxuXHJcbiAgLy8g6I635Y+W57uf6K6h5L+h5oGvXHJcbiAgZ2V0U3RhdHMoKSB7XHJcbiAgICByZXR1cm4geyAuLi50aGlzLnN0YXRzIH1cclxuICB9XHJcblxyXG4gIC8vIOW8uuWItuabtOaWsOe9kee7nOeKtuaAgVxyXG4gIGFzeW5jIGZvcmNlVXBkYXRlTmV0d29ya1N0YXRlKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgYXdhaXQgdGhpcy51cGRhdGVOZXR3b3JrU3RhdGUoKVxyXG4gIH1cclxuXHJcbiAgLy8g6YeN572u5omA5pyJ54q25oCBXHJcbiAgcmVzZXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLnJlc2V0QWxsQ2lyY3VpdEJyZWFrZXJzKClcclxuICAgIHRoaXMucGVuZGluZ1JlcXVlc3RzLmZvckVhY2gocXVldWUgPT4gcXVldWUubGVuZ3RoID0gMClcclxuICAgIGlmICh0aGlzLmJhdGNoVGltZXIpIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuYmF0Y2hUaW1lcilcclxuICAgICAgdGhpcy5iYXRjaFRpbWVyID0gbnVsbFxyXG4gICAgfVxyXG4gICAgdGhpcy5zdGF0cyA9IHtcclxuICAgICAgdG90YWxSZXF1ZXN0czogMCxcclxuICAgICAgc3VjY2Vzc2Z1bFJlcXVlc3RzOiAwLFxyXG4gICAgICBmYWlsZWRSZXF1ZXN0czogMCxcclxuICAgICAgYXZlcmFnZVJlc3BvbnNlVGltZTogMCxcclxuICAgICAgbGFzdEVycm9yOiBudWxsLFxyXG4gICAgICBjaXJjdWl0QnJlYWtlclRyaXBzOiAwXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vLyDlr7zlh7rljZXkvovlrp7kvotcclxuZXhwb3J0IGNvbnN0IG5ldHdvcmtTdGF0ZURldGVjdG9yID0gTmV0d29ya1N0YXRlRGV0ZWN0b3IuZ2V0SW5zdGFuY2UoKSJdLCJ2ZXJzaW9uIjozfQ==