3815fe32dd271182ed544c0b00b72ec8
"use strict";
/**
 * 高性能本地操作服务
 * 优化本地数据操作响应时间，实现异步同步机制
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.getPerformanceMetrics = exports.searchCardsLocal = exports.getCardsLocal = exports.deleteCardLocal = exports.updateCardLocal = exports.createCardLocal = exports.localOperationServiceOptimized = exports.LocalOperationServiceOptimized = void 0;
const database_unified_1 = require("./database-unified");
// ============================================================================
// 本地缓存管理器
// ============================================================================
class LocalCacheManager {
    constructor() {
        Object.defineProperty(this, "memoryCache", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Map()
        });
        Object.defineProperty(this, "queryCache", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Map()
        });
        Object.defineProperty(this, "stats", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: {
                hits: 0,
                misses: 0,
                evictions: 0
            }
        });
        Object.defineProperty(this, "DEFAULT_TTL", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 30000
        }); // 30秒
        Object.defineProperty(this, "MAX_CACHE_SIZE", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 1000
        });
    }
    async get(key) {
        const cached = this.memoryCache.get(key);
        if (!cached) {
            this.stats.misses++;
            return null;
        }
        // 检查TTL
        if (Date.now() - cached.timestamp > cached.ttl) {
            this.memoryCache.delete(key);
            this.stats.evictions++;
            this.stats.misses++;
            return null;
        }
        this.stats.hits++;
        return cached.data;
    }
    async set(key, data, ttl = this.DEFAULT_TTL) {
        // 检查缓存大小限制
        if (this.memoryCache.size >= this.MAX_CACHE_SIZE) {
            this.evictLeastRecentlyUsed();
        }
        this.memoryCache.set(key, {
            data,
            timestamp: Date.now(),
            ttl
        });
    }
    async getQueryResult(queryKey) {
        const cached = this.queryCache.get(queryKey);
        if (!cached)
            return null;
        // 查询缓存TTL较短
        if (Date.now() - cached.timestamp > 10000) { // 10秒
            this.queryCache.delete(queryKey);
            return null;
        }
        return cached.result;
    }
    async cacheQueryResult(queryKey, result) {
        this.queryCache.set(queryKey, {
            result,
            timestamp: Date.now()
        });
    }
    invalidate(pattern) {
        const keysToDelete = [];
        for (const key of this.memoryCache.keys()) {
            if (key.includes(pattern)) {
                keysToDelete.push(key);
            }
        }
        for (const key of keysToDelete) {
            this.memoryCache.delete(key);
        }
        // 同时清除相关查询缓存
        for (const key of this.queryCache.keys()) {
            if (key.includes(pattern)) {
                this.queryCache.delete(key);
            }
        }
    }
    clear() {
        this.memoryCache.clear();
        this.queryCache.clear();
    }
    getStats() {
        return {
            ...this.stats,
            cacheSize: this.memoryCache.size,
            queryCacheSize: this.queryCache.size,
            hitRate: this.stats.hits / (this.stats.hits + this.stats.misses) || 0
        };
    }
    evictLeastRecentlyUsed() {
        let oldestKey = '';
        let oldestTime = Infinity;
        for (const [key, value] of this.memoryCache.entries()) {
            if (value.timestamp < oldestTime) {
                oldestTime = value.timestamp;
                oldestKey = key;
            }
        }
        if (oldestKey) {
            this.memoryCache.delete(oldestKey);
            this.stats.evictions++;
        }
    }
}
// ============================================================================
// 性能监控器
// ============================================================================
class PerformanceMonitor {
    constructor() {
        Object.defineProperty(this, "metrics", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Map()
        });
    }
    recordOperation(operation, duration, success) {
        const key = `operation_${operation}`;
        const metric = this.metrics.get(key) || {
            count: 0,
            totalDuration: 0,
            successCount: 0,
            avgDuration: 0,
            minDuration: Infinity,
            maxDuration: 0
        };
        metric.count++;
        metric.totalDuration += duration;
        if (success)
            metric.successCount++;
        metric.avgDuration = metric.totalDuration / metric.count;
        metric.minDuration = Math.min(metric.minDuration, duration);
        metric.maxDuration = Math.max(metric.maxDuration, duration);
        this.metrics.set(key, metric);
    }
    getMetrics() {
        const totalOps = Array.from(this.metrics.values())
            .reduce((sum, m) => sum + m.count, 0);
        const totalDuration = Array.from(this.metrics.values())
            .reduce((sum, m) => sum + m.totalDuration, 0);
        const successCount = Array.from(this.metrics.values())
            .reduce((sum, m) => sum + m.successCount, 0);
        return {
            totalOperations: totalOps,
            averageResponseTime: totalOps > 0 ? totalDuration / totalOps : 0,
            successRate: totalOps > 0 ? successCount / totalOps : 0,
            cacheHitRate: 0, // 将从缓存管理器获取
            queueSize: 0, // 将从队列管理器获取
            lastSyncTime: null
        };
    }
    getDetailedMetrics() {
        return Object.fromEntries(this.metrics);
    }
}
// ============================================================================
// 高性能本地操作服务
// ============================================================================
class LocalOperationServiceOptimized {
    constructor() {
        Object.defineProperty(this, "cacheManager", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new LocalCacheManager()
        });
        Object.defineProperty(this, "performanceMonitor", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new PerformanceMonitor()
        });
        Object.defineProperty(this, "isInitialized", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        this.initialize();
    }
    async initialize() {
        if (this.isInitialized)
            return;
        try {
            await database_unified_1.db.open();
            this.isInitialized = true;
            console.log('LocalOperationServiceOptimized initialized');
        }
        catch (error) {
            console.error('Failed to initialize LocalOperationServiceOptimized:', error);
        }
    }
    // ============================================================================
    // 高性能卡片操作
    // ============================================================================
    /**
     * 快速创建卡片 - 立即响应，异步同步
     */
    async createCard(cardData) {
        const startTime = performance.now();
        const cacheKey = `card_creation_${Date.now()}`;
        try {
            // 生成卡片ID
            const cardId = crypto.randomUUID();
            const now = new Date();
            // 准备数据库记录
            const dbCard = {
                ...cardData,
                syncVersion: 1,
                pendingSync: true,
                updatedAt: now,
                createdAt: now,
                // 生成搜索向量
                searchVector: this.generateSearchVector(cardData)
            };
            // 使用事务确保数据一致性
            await database_unified_1.db.transaction('rw', [database_unified_1.db.cards, database_unified_1.db.syncQueue], async () => {
                // 1. 立即插入到本地数据库
                await database_unified_1.db.cards.add({ ...dbCard, id: cardId });
                // 2. 创建同步操作（异步处理）
                await database_unified_1.db.syncQueue.add({
                    id: crypto.randomUUID(),
                    type: 'create',
                    entity: 'card',
                    entityId: cardId,
                    entityType: 'card',
                    operationType: 'create',
                    data: dbCard,
                    userId: cardData.userId,
                    timestamp: now,
                    retryCount: 0,
                    maxRetries: 5,
                    priority: 'normal',
                    status: 'pending',
                    localVersion: Date.now()
                });
            });
            // 清除相关缓存
            this.cacheManager.invalidate('cards');
            this.cacheManager.invalidate(`folder_${cardData.folderId || 'root'}`);
            const duration = performance.now() - startTime;
            this.performanceMonitor.recordOperation('createCard', duration, true);
            return {
                success: true,
                id: cardId,
                message: 'Card created successfully',
                duration,
                timestamp: now
            };
        }
        catch (error) {
            const duration = performance.now() - startTime;
            this.performanceMonitor.recordOperation('createCard', duration, false);
            return {
                success: false,
                error: error instanceof Error ? error.message : 'Unknown error',
                duration,
                timestamp: new Date()
            };
        }
    }
    /**
     * 快速更新卡片 - 立即响应，异步同步
     */
    async updateCard(cardId, updates) {
        const startTime = performance.now();
        try {
            const now = new Date();
            // 获取当前卡片数据
            const currentCard = await database_unified_1.db.cards.get(cardId);
            if (!currentCard) {
                return {
                    success: false,
                    error: 'Card not found',
                    duration: performance.now() - startTime,
                    timestamp: now
                };
            }
            // 准备更新数据
            const updateData = {
                ...updates,
                syncVersion: currentCard.syncVersion + 1,
                pendingSync: true,
                updatedAt: now
            };
            // 如果内容有更新，重新生成搜索向量
            if (updates.frontContent || updates.backContent) {
                const mergedCard = { ...currentCard, ...updates };
                updateData.searchVector = this.generateSearchVector(mergedCard);
            }
            // 使用事务确保一致性
            await database_unified_1.db.transaction('rw', [database_unified_1.db.cards, database_unified_1.db.syncQueue], async () => {
                // 1. 立即更新本地数据库
                await database_unified_1.db.cards.update(cardId, updateData);
                // 2. 创建同步操作
                await database_unified_1.db.syncQueue.add({
                    id: crypto.randomUUID(),
                    type: 'update',
                    entity: 'card',
                    entityId: cardId,
                    entityType: 'card',
                    operationType: 'update',
                    data: { ...currentCard, ...updateData },
                    previousData: currentCard,
                    userId: currentCard.userId,
                    timestamp: now,
                    retryCount: 0,
                    maxRetries: 5,
                    priority: 'normal',
                    status: 'pending',
                    localVersion: Date.now()
                });
            });
            // 清除相关缓存
            this.cacheManager.invalidate(`card_${cardId}`);
            this.cacheManager.invalidate('cards');
            this.cacheManager.invalidate(`folder_${currentCard.folderId || 'root'}`);
            const duration = performance.now() - startTime;
            this.performanceMonitor.recordOperation('updateCard', duration, true);
            return {
                success: true,
                id: cardId,
                message: 'Card updated successfully',
                duration,
                timestamp: now
            };
        }
        catch (error) {
            const duration = performance.now() - startTime;
            this.performanceMonitor.recordOperation('updateCard', duration, false);
            return {
                success: false,
                error: error instanceof Error ? error.message : 'Unknown error',
                duration,
                timestamp: new Date()
            };
        }
    }
    /**
     * 快速删除卡片 - 立即响应，异步同步
     */
    async deleteCard(cardId) {
        const startTime = performance.now();
        try {
            const now = new Date();
            // 获取卡片信息用于同步
            const card = await database_unified_1.db.cards.get(cardId);
            if (!card) {
                return {
                    success: false,
                    error: 'Card not found',
                    duration: performance.now() - startTime,
                    timestamp: now
                };
            }
            // 使用事务确保一致性
            await database_unified_1.db.transaction('rw', [database_unified_1.db.cards, database_unified_1.db.images, database_unified_1.db.syncQueue], async () => {
                // 1. 删除相关图片
                await database_unified_1.db.images.where('cardId').equals(cardId).delete();
                // 2. 立即删除本地卡片
                await database_unified_1.db.cards.delete(cardId);
                // 3. 创建同步操作
                await database_unified_1.db.syncQueue.add({
                    id: crypto.randomUUID(),
                    type: 'delete',
                    entity: 'card',
                    entityId: cardId,
                    entityType: 'card',
                    operationType: 'delete',
                    data: { userId: card.userId, deletedAt: now },
                    previousData: card,
                    userId: card.userId,
                    timestamp: now,
                    retryCount: 0,
                    maxRetries: 5,
                    priority: 'high', // 删除操作高优先级
                    status: 'pending',
                    localVersion: Date.now()
                });
            });
            // 清除相关缓存
            this.cacheManager.invalidate(`card_${cardId}`);
            this.cacheManager.invalidate('cards');
            this.cacheManager.invalidate(`folder_${card.folderId || 'root'}`);
            const duration = performance.now() - startTime;
            this.performanceMonitor.recordOperation('deleteCard', duration, true);
            return {
                success: true,
                id: cardId,
                message: 'Card deleted successfully',
                duration,
                timestamp: now
            };
        }
        catch (error) {
            const duration = performance.now() - startTime;
            this.performanceMonitor.recordOperation('deleteCard', duration, false);
            return {
                success: false,
                error: error instanceof Error ? error.message : 'Unknown error',
                duration,
                timestamp: new Date()
            };
        }
    }
    // ============================================================================
    // 批量操作
    // ============================================================================
    /**
     * 批量创建卡片 - 高性能批量处理
     */
    async bulkCreateCards(cardsData) {
        const startTime = performance.now();
        const results = [];
        try {
            const now = new Date();
            // 准备批量数据
            const dbCards = cardsData.map(cardData => ({
                ...cardData,
                id: crypto.randomUUID(),
                syncVersion: 1,
                pendingSync: true,
                updatedAt: now,
                createdAt: now,
                searchVector: this.generateSearchVector(cardData)
            }));
            // 准备批量同步操作
            const syncOperations = dbCards.map(card => ({
                id: crypto.randomUUID(),
                type: 'create',
                entity: 'card',
                entityId: card.id,
                entityType: 'card',
                operationType: 'create',
                data: card,
                userId: card.userId,
                timestamp: now,
                retryCount: 0,
                maxRetries: 5,
                priority: 'normal',
                status: 'pending',
                localVersion: Date.now()
            }));
            // 使用事务批量处理
            await database_unified_1.db.transaction('rw', [database_unified_1.db.cards, database_unified_1.db.syncQueue], async () => {
                await database_unified_1.db.cards.bulkAdd(dbCards);
                await database_unified_1.db.syncQueue.bulkAdd(syncOperations);
            });
            // 创建结果
            results.push(...dbCards.map(card => ({
                success: true,
                id: card.id,
                message: 'Card created successfully',
                duration: performance.now() - startTime,
                timestamp: now
            })));
            // 清除相关缓存
            this.cacheManager.invalidate('cards');
            this.performanceMonitor.recordOperation('bulkCreateCards', performance.now() - startTime, true);
            return results;
        }
        catch (error) {
            const duration = performance.now() - startTime;
            this.performanceMonitor.recordOperation('bulkCreateCards', duration, false);
            return cardsData.map(() => ({
                success: false,
                error: error instanceof Error ? error.message : 'Unknown error',
                duration,
                timestamp: new Date()
            }));
        }
    }
    // ============================================================================
    // 查询操作
    // ============================================================================
    /**
     * 获取卡片 - 带缓存的高性能查询
     */
    async getCard(cardId) {
        const cacheKey = `card_${cardId}`;
        // 尝试从缓存获取
        const cached = await this.cacheManager.get(cacheKey);
        if (cached) {
            return cached;
        }
        try {
            const card = await database_unified_1.db.cards.get(cardId);
            if (card) {
                // 缓存结果
                await this.cacheManager.set(cacheKey, card);
            }
            return card || null;
        }
        catch (error) {
            console.error(`Failed to get card ${cardId}:`, error);
            return null;
        }
    }
    /**
     * 获取卡片列表 - 优化的列表查询
     */
    async getCards(options = {}) {
        const { folderId, userId, limit = 50, offset = 0, sortBy = 'updatedAt', sortOrder = 'desc' } = options;
        // 生成查询缓存键
        const queryKey = `cards_list_${folderId || 'all'}_${userId || 'all'}_${limit}_${offset}_${sortBy}_${sortOrder}`;
        // 尝试从查询缓存获取
        const cached = await this.cacheManager.getQueryResult(queryKey);
        if (cached) {
            return cached;
        }
        try {
            let query = database_unified_1.db.cards;
            // 应用过滤条件
            if (folderId && userId) {
                query = query.where('[userId+folderId]').equals([userId, folderId]);
            }
            else if (userId) {
                query = query.where('userId').equals(userId);
            }
            else if (folderId) {
                query = query.where('folderId').equals(folderId);
            }
            // 应用排序
            if (sortBy === 'title') {
                query = query.sortBy('frontContent.title');
            }
            else {
                query = query.orderBy(sortBy);
            }
            if (sortOrder === 'desc') {
                query = query.reverse();
            }
            // 应用分页
            let result = await query.offset(offset).limit(limit).toArray();
            // 缓存查询结果
            await this.cacheManager.cacheQueryResult(queryKey, result);
            return result;
        }
        catch (error) {
            console.error('Failed to get cards:', error);
            return [];
        }
    }
    /**
     * 搜索卡片 - 高性能全文搜索
     */
    async searchCards(query) {
        const { term, userId, folderId, tags, limit = 50 } = query;
        // 生成搜索缓存键
        const searchKey = `search_${term}_${userId || 'all'}_${folderId || 'all'}_${tags?.join(',') || 'none'}_${limit}`;
        // 尝试从搜索缓存获取
        const cached = await this.cacheManager.getQueryResult(searchKey);
        if (cached) {
            return cached;
        }
        try {
            let searchQuery = database_unified_1.db.cards;
            // 基础过滤
            if (userId) {
                searchQuery = searchQuery.where('userId').equals(userId);
            }
            if (folderId) {
                searchQuery = searchQuery.where('folderId').equals(folderId);
            }
            // 执行搜索
            const results = await searchQuery
                .filter(card => {
                // 搜索向量匹配
                const searchTerm = term.toLowerCase();
                const matchesSearch = card.searchVector?.includes(searchTerm) || false;
                // 标签匹配
                let matchesTags = true;
                if (tags && tags.length > 0) {
                    const cardTags = [
                        ...card.frontContent.tags,
                        ...card.backContent.tags
                    ];
                    matchesTags = tags.some(tag => cardTags.includes(tag));
                }
                return matchesSearch && matchesTags;
            })
                .limit(limit)
                .toArray();
            // 缓存搜索结果
            await this.cacheManager.cacheQueryResult(searchKey, results);
            return results;
        }
        catch (error) {
            console.error('Failed to search cards:', error);
            return [];
        }
    }
    // ============================================================================
    // 同步操作管理
    // ============================================================================
    /**
     * 获取待同步操作
     */
    async getPendingSyncOperations() {
        try {
            return await database_unified_1.db.syncQueue
                .where('status')
                .equals('pending')
                .orderBy('priority')
                .reverse()
                .limit(100)
                .toArray();
        }
        catch (error) {
            console.error('Failed to get pending sync operations:', error);
            return [];
        }
    }
    /**
     * 更新操作状态
     */
    async updateOperationStatuses(results) {
        try {
            await database_unified_1.db.transaction('rw', [database_unified_1.db.syncQueue], async () => {
                for (const result of results) {
                    if (result.success) {
                        await database_unified_1.db.syncQueue.update(result.operationId, {
                            status: 'completed'
                        });
                    }
                    else {
                        await database_unified_1.db.syncQueue.update(result.operationId, {
                            status: 'failed',
                            lastError: result.error
                        });
                    }
                }
            });
        }
        catch (error) {
            console.error('Failed to update operation statuses:', error);
        }
    }
    // ============================================================================
    // 性能监控和统计
    // ============================================================================
    /**
     * 获取性能指标
     */
    async getPerformanceMetrics() {
        const baseMetrics = this.performanceMonitor.getMetrics();
        const cacheStats = this.cacheManager.getStats();
        const queueStats = await this.getQueueStats();
        return {
            ...baseMetrics,
            cacheHitRate: cacheStats.hitRate,
            queueSize: queueStats.totalOperations,
            lastSyncTime: queueStats.lastSyncTime
        };
    }
    /**
     * 获取详细统计信息
     */
    async getDetailedStats() {
        return {
            performance: this.performanceMonitor.getDetailedMetrics(),
            cache: this.cacheManager.getStats(),
            queue: await this.getQueueStats()
        };
    }
    /**
     * 获取队列统计
     */
    async getQueueStats() {
        try {
            const total = await database_unified_1.db.syncQueue.count();
            const pending = await database_unified_1.db.syncQueue.where('status').equals('pending').count();
            // 获取最后同步时间
            const lastCompleted = await database_unified_1.db.syncQueue
                .where('status')
                .equals('completed')
                .orderBy('timestamp')
                .reverse()
                .first();
            return {
                totalOperations: total,
                pendingOperations: pending,
                lastSyncTime: lastCompleted?.timestamp || null
            };
        }
        catch (error) {
            console.error('Failed to get queue stats:', error);
            return {
                totalOperations: 0,
                pendingOperations: 0,
                lastSyncTime: null
            };
        }
    }
    // ============================================================================
    // 工具方法
    // ============================================================================
    /**
     * 生成搜索向量
     */
    generateSearchVector(card) {
        const searchableText = [
            card.frontContent.title,
            card.frontContent.text,
            card.backContent.title,
            card.backContent.text,
            ...card.frontContent.tags,
            ...card.backContent.tags
        ].join(' ').toLowerCase();
        return searchableText;
    }
    /**
     * 清除缓存
     */
    clearCache() {
        this.cacheManager.clear();
    }
    /**
     * 销毁服务
     */
    destroy() {
        this.cacheManager.clear();
        this.isInitialized = false;
    }
}
exports.LocalOperationServiceOptimized = LocalOperationServiceOptimized;
// ============================================================================
// 导出单例实例
// ============================================================================
exports.localOperationServiceOptimized = new LocalOperationServiceOptimized();
// ============================================================================
// 兼容性导出 - 保持现有接口
// ============================================================================
// 保持原有方法，内部调用新的优化实现
const createCardLocal = (cardData) => exports.localOperationServiceOptimized.createCard(cardData);
exports.createCardLocal = createCardLocal;
const updateCardLocal = (cardId, updates) => exports.localOperationServiceOptimized.updateCard(cardId, updates);
exports.updateCardLocal = updateCardLocal;
const deleteCardLocal = (cardId) => exports.localOperationServiceOptimized.deleteCard(cardId);
exports.deleteCardLocal = deleteCardLocal;
const getCardsLocal = (options) => exports.localOperationServiceOptimized.getCards(options);
exports.getCardsLocal = getCardsLocal;
const searchCardsLocal = (query) => exports.localOperationServiceOptimized.searchCards(query);
exports.searchCardsLocal = searchCardsLocal;
const getPerformanceMetrics = () => exports.localOperationServiceOptimized.getPerformanceMetrics();
exports.getPerformanceMetrics = getPerformanceMetrics;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXGxvY2FsLW9wZXJhdGlvbi1zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7OztBQUVILHlEQUE2RjtBQXVFN0YsK0VBQStFO0FBQy9FLFVBQVU7QUFDViwrRUFBK0U7QUFFL0UsTUFBTSxpQkFBaUI7SUFBdkI7UUFDVTs7OzttQkFBYyxJQUFJLEdBQUcsRUFBeUQ7V0FBQTtRQUM5RTs7OzttQkFBYSxJQUFJLEdBQUcsRUFBOEM7V0FBQTtRQUNsRTs7OzttQkFBUTtnQkFDZCxJQUFJLEVBQUUsQ0FBQztnQkFDUCxNQUFNLEVBQUUsQ0FBQztnQkFDVCxTQUFTLEVBQUUsQ0FBQzthQUNiO1dBQUE7UUFFZ0I7Ozs7bUJBQWMsS0FBSztXQUFBLENBQUMsTUFBTTtRQUMxQjs7OzttQkFBaUIsSUFBSTtXQUFBO0lBeUd4QyxDQUFDO0lBdkdDLEtBQUssQ0FBQyxHQUFHLENBQUksR0FBVztRQUN0QixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUN4QyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDWixJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFBO1lBQ25CLE9BQU8sSUFBSSxDQUFBO1FBQ2IsQ0FBQztRQUVELFFBQVE7UUFDUixJQUFJLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxNQUFNLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUMvQyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQTtZQUM1QixJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsRUFBRSxDQUFBO1lBQ3RCLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUE7WUFDbkIsT0FBTyxJQUFJLENBQUE7UUFDYixDQUFDO1FBRUQsSUFBSSxDQUFD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RSxFQUFFLENBQ3JELHNDQUE4QixDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUR0QyxRQUFBLGdCQUFnQixvQkFDc0I7QUFFNUMsTUFBTSxxQkFBcUIsR0FBRyxHQUFHLEVBQUUsQ0FDeEMsc0NBQThCLENBQUMscUJBQXFCLEVBQUUsQ0FBQTtBQUQzQyxRQUFBLHFCQUFxQix5QkFDc0IiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXGxvY2FsLW9wZXJhdGlvbi1zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDpq5jmgKfog73mnKzlnLDmk43kvZzmnI3liqFcclxuICog5LyY5YyW5pys5Zyw5pWw5o2u5pON5L2c5ZON5bqU5pe26Ze077yM5a6e546w5byC5q2l5ZCM5q2l5py65Yi2XHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgZGIsIHR5cGUgRGJDYXJkLCB0eXBlIERiRm9sZGVyLCB0eXBlIERiVGFnLCB0eXBlIERiSW1hZ2UgfSBmcm9tICcuL2RhdGFiYXNlLXVuaWZpZWQnXHJcbmltcG9ydCB7IGxvY2FsT3BlcmF0aW9uU2VydmljZSBhcyBiYXNlU2VydmljZSB9IGZyb20gJy4vbG9jYWwtb3BlcmF0aW9uJ1xyXG5pbXBvcnQgdHlwZSB7IExvY2FsU3luY09wZXJhdGlvbiB9IGZyb20gJy4vbG9jYWwtb3BlcmF0aW9uJ1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDnsbvlnovlrprkuYlcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBMb2NhbE9wZXJhdGlvblJlc3VsdCB7XHJcbiAgc3VjY2VzczogYm9vbGVhblxyXG4gIGlkPzogc3RyaW5nXHJcbiAgZXJyb3I/OiBzdHJpbmdcclxuICBtZXNzYWdlPzogc3RyaW5nXHJcbiAgZHVyYXRpb246IG51bWJlclxyXG4gIHRpbWVzdGFtcDogRGF0ZVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENhcmREYXRhIHtcclxuICBmcm9udENvbnRlbnQ6IHtcclxuICAgIHRpdGxlOiBzdHJpbmdcclxuICAgIHRleHQ6IHN0cmluZ1xyXG4gICAgdGFnczogc3RyaW5nW11cclxuICAgIHN0eWxlPzogYW55XHJcbiAgfVxyXG4gIGJhY2tDb250ZW50OiB7XHJcbiAgICB0aXRsZTogc3RyaW5nXHJcbiAgICB0ZXh0OiBzdHJpbmdcclxuICAgIHRhZ3M6IHN0cmluZ1tdXHJcbiAgICBzdHlsZT86IGFueVxyXG4gIH1cclxuICBzdHlsZT86IHtcclxuICAgIHR5cGU6ICdzb2xpZCcgfCAnZ3JhZGllbnQnIHwgJ2dsYXNzJ1xyXG4gICAgY29sb3JzPzogc3RyaW5nW11cclxuICB9XHJcbiAgZm9sZGVySWQ/OiBzdHJpbmdcclxuICB1c2VySWQ/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDYXJkVXBkYXRlIHtcclxuICBmcm9udENvbnRlbnQ/OiBQYXJ0aWFsPENhcmREYXRhWydmcm9udENvbnRlbnQnXT5cclxuICBiYWNrQ29udGVudD86IFBhcnRpYWw8Q2FyZERhdGFbJ2JhY2tDb250ZW50J10+XHJcbiAgc3R5bGU/OiBDYXJkRGF0YVsnc3R5bGUnXVxyXG4gIGZvbGRlcklkPzogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUXVlcnlPcHRpb25zIHtcclxuICBmb2xkZXJJZD86IHN0cmluZ1xyXG4gIHVzZXJJZD86IHN0cmluZ1xyXG4gIGxpbWl0PzogbnVtYmVyXHJcbiAgb2Zmc2V0PzogbnVtYmVyXHJcbiAgc29ydEJ5PzogJ2NyZWF0ZWRBdCcgfCAndXBkYXRlZEF0JyB8ICd0aXRsZSdcclxuICBzb3J0T3JkZXI/OiAnYXNjJyB8ICdkZXNjJ1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNlYXJjaFF1ZXJ5IHtcclxuICB0ZXJtOiBzdHJpbmdcclxuICB1c2VySWQ/OiBzdHJpbmdcclxuICBmb2xkZXJJZD86IHN0cmluZ1xyXG4gIHRhZ3M/OiBzdHJpbmdbXVxyXG4gIGxpbWl0PzogbnVtYmVyXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGVyZm9ybWFuY2VNZXRyaWNzIHtcclxuICB0b3RhbE9wZXJhdGlvbnM6IG51bWJlclxyXG4gIGF2ZXJhZ2VSZXNwb25zZVRpbWU6IG51bWJlclxyXG4gIHN1Y2Nlc3NSYXRlOiBudW1iZXJcclxuICBjYWNoZUhpdFJhdGU6IG51bWJlclxyXG4gIHF1ZXVlU2l6ZTogbnVtYmVyXHJcbiAgbGFzdFN5bmNUaW1lOiBEYXRlIHwgbnVsbFxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIOacrOWcsOe8k+WtmOeuoeeQhuWZqFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5jbGFzcyBMb2NhbENhY2hlTWFuYWdlciB7XHJcbiAgcHJpdmF0ZSBtZW1vcnlDYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCB7IGRhdGE6IGFueTsgdGltZXN0YW1wOiBudW1iZXI7IHR0bDogbnVtYmVyIH0+KClcclxuICBwcml2YXRlIHF1ZXJ5Q2FjaGUgPSBuZXcgTWFwPHN0cmluZywgeyByZXN1bHQ6IGFueTsgdGltZXN0YW1wOiBudW1iZXIgfT4oKVxyXG4gIHByaXZhdGUgc3RhdHMgPSB7XHJcbiAgICBoaXRzOiAwLFxyXG4gICAgbWlzc2VzOiAwLFxyXG4gICAgZXZpY3Rpb25zOiAwXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlYWRvbmx5IERFRkFVTFRfVFRMID0gMzAwMDAgLy8gMzDnp5JcclxuICBwcml2YXRlIHJlYWRvbmx5IE1BWF9DQUNIRV9TSVpFID0gMTAwMFxyXG5cclxuICBhc3luYyBnZXQ8VD4oa2V5OiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XHJcbiAgICBjb25zdCBjYWNoZWQgPSB0aGlzLm1lbW9yeUNhY2hlLmdldChrZXkpXHJcbiAgICBpZiAoIWNhY2hlZCkge1xyXG4gICAgICB0aGlzLnN0YXRzLm1pc3NlcysrXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5qOA5p+lVFRMXHJcbiAgICBpZiAoRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAgPiBjYWNoZWQudHRsKSB7XHJcbiAgICAgIHRoaXMubWVtb3J5Q2FjaGUuZGVsZXRlKGtleSlcclxuICAgICAgdGhpcy5zdGF0cy5ldmljdGlvbnMrK1xyXG4gICAgICB0aGlzLnN0YXRzLm1pc3NlcysrXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5zdGF0cy5oaXRzKytcclxuICAgIHJldHVybiBjYWNoZWQuZGF0YSBhcyBUXHJcbiAgfVxyXG5cclxuICBhc3luYyBzZXQ8VD4oa2V5OiBzdHJpbmcsIGRhdGE6IFQsIHR0bDogbnVtYmVyID0gdGhpcy5ERUZBVUxUX1RUTCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgLy8g5qOA5p+l57yT5a2Y5aSn5bCP6ZmQ5Yi2XHJcbiAgICBpZiAodGhpcy5tZW1vcnlDYWNoZS5zaXplID49IHRoaXMuTUFYX0NBQ0hFX1NJWkUpIHtcclxuICAgICAgdGhpcy5ldmljdExlYXN0UmVjZW50bHlVc2VkKClcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLm1lbW9yeUNhY2hlLnNldChrZXksIHtcclxuICAgICAgZGF0YSxcclxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxyXG4gICAgICB0dGxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRRdWVyeVJlc3VsdChxdWVyeUtleTogc3RyaW5nKTogUHJvbWlzZTxhbnkgfCBudWxsPiB7XHJcbiAgICBjb25zdCBjYWNoZWQgPSB0aGlzLnF1ZXJ5Q2FjaGUuZ2V0KHF1ZXJ5S2V5KVxyXG4gICAgaWYgKCFjYWNoZWQpIHJldHVybiBudWxsXHJcblxyXG4gICAgLy8g5p+l6K+i57yT5a2YVFRM6L6D55+tXHJcbiAgICBpZiAoRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAgPiAxMDAwMCkgeyAvLyAxMOenklxyXG4gICAgICB0aGlzLnF1ZXJ5Q2FjaGUuZGVsZXRlKHF1ZXJ5S2V5KVxyXG4gICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjYWNoZWQucmVzdWx0XHJcbiAgfVxyXG5cclxuICBhc3luYyBjYWNoZVF1ZXJ5UmVzdWx0KHF1ZXJ5S2V5OiBzdHJpbmcsIHJlc3VsdDogYW55KTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0aGlzLnF1ZXJ5Q2FjaGUuc2V0KHF1ZXJ5S2V5LCB7XHJcbiAgICAgIHJlc3VsdCxcclxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgaW52YWxpZGF0ZShwYXR0ZXJuOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNvbnN0IGtleXNUb0RlbGV0ZTogc3RyaW5nW10gPSBbXVxyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IGtleSBvZiB0aGlzLm1lbW9yeUNhY2hlLmtleXMoKSkge1xyXG4gICAgICBpZiAoa2V5LmluY2x1ZGVzKHBhdHRlcm4pKSB7XHJcbiAgICAgICAga2V5c1RvRGVsZXRlLnB1c2goa2V5KVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXNUb0RlbGV0ZSkge1xyXG4gICAgICB0aGlzLm1lbW9yeUNhY2hlLmRlbGV0ZShrZXkpXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5ZCM5pe25riF6Zmk55u45YWz5p+l6K+i57yT5a2YXHJcbiAgICBmb3IgKGNvbnN0IGtleSBvZiB0aGlzLnF1ZXJ5Q2FjaGUua2V5cygpKSB7XHJcbiAgICAgIGlmIChrZXkuaW5jbHVkZXMocGF0dGVybikpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5Q2FjaGUuZGVsZXRlKGtleSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xlYXIoKTogdm9pZCB7XHJcbiAgICB0aGlzLm1lbW9yeUNhY2hlLmNsZWFyKClcclxuICAgIHRoaXMucXVlcnlDYWNoZS5jbGVhcigpXHJcbiAgfVxyXG5cclxuICBnZXRTdGF0cygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIC4uLnRoaXMuc3RhdHMsXHJcbiAgICAgIGNhY2hlU2l6ZTogdGhpcy5tZW1vcnlDYWNoZS5zaXplLFxyXG4gICAgICBxdWVyeUNhY2hlU2l6ZTogdGhpcy5xdWVyeUNhY2hlLnNpemUsXHJcbiAgICAgIGhpdFJhdGU6IHRoaXMuc3RhdHMuaGl0cyAvICh0aGlzLnN0YXRzLmhpdHMgKyB0aGlzLnN0YXRzLm1pc3NlcykgfHwgMFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBldmljdExlYXN0UmVjZW50bHlVc2VkKCk6IHZvaWQge1xyXG4gICAgbGV0IG9sZGVzdEtleSA9ICcnXHJcbiAgICBsZXQgb2xkZXN0VGltZSA9IEluZmluaXR5XHJcblxyXG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgdGhpcy5tZW1vcnlDYWNoZS5lbnRyaWVzKCkpIHtcclxuICAgICAgaWYgKHZhbHVlLnRpbWVzdGFtcCA8IG9sZGVzdFRpbWUpIHtcclxuICAgICAgICBvbGRlc3RUaW1lID0gdmFsdWUudGltZXN0YW1wXHJcbiAgICAgICAgb2xkZXN0S2V5ID0ga2V5XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAob2xkZXN0S2V5KSB7XHJcbiAgICAgIHRoaXMubWVtb3J5Q2FjaGUuZGVsZXRlKG9sZGVzdEtleSlcclxuICAgICAgdGhpcy5zdGF0cy5ldmljdGlvbnMrK1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDmgKfog73nm5HmjqflmahcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuY2xhc3MgUGVyZm9ybWFuY2VNb25pdG9yIHtcclxuICBwcml2YXRlIG1ldHJpY3MgPSBuZXcgTWFwPHN0cmluZywge1xyXG4gICAgY291bnQ6IG51bWJlclxyXG4gICAgdG90YWxEdXJhdGlvbjogbnVtYmVyXHJcbiAgICBzdWNjZXNzQ291bnQ6IG51bWJlclxyXG4gICAgYXZnRHVyYXRpb246IG51bWJlclxyXG4gICAgbWluRHVyYXRpb246IG51bWJlclxyXG4gICAgbWF4RHVyYXRpb246IG51bWJlclxyXG4gIH0+KClcclxuXHJcbiAgcmVjb3JkT3BlcmF0aW9uKG9wZXJhdGlvbjogc3RyaW5nLCBkdXJhdGlvbjogbnVtYmVyLCBzdWNjZXNzOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICBjb25zdCBrZXkgPSBgb3BlcmF0aW9uXyR7b3BlcmF0aW9ufWBcclxuICAgIGNvbnN0IG1ldHJpYyA9IHRoaXMubWV0cmljcy5nZXQoa2V5KSB8fCB7XHJcbiAgICAgIGNvdW50OiAwLFxyXG4gICAgICB0b3RhbER1cmF0aW9uOiAwLFxyXG4gICAgICBzdWNjZXNzQ291bnQ6IDAsXHJcbiAgICAgIGF2Z0R1cmF0aW9uOiAwLFxyXG4gICAgICBtaW5EdXJhdGlvbjogSW5maW5pdHksXHJcbiAgICAgIG1heER1cmF0aW9uOiAwXHJcbiAgICB9XHJcblxyXG4gICAgbWV0cmljLmNvdW50KytcclxuICAgIG1ldHJpYy50b3RhbER1cmF0aW9uICs9IGR1cmF0aW9uXHJcbiAgICBpZiAoc3VjY2VzcykgbWV0cmljLnN1Y2Nlc3NDb3VudCsrXHJcbiAgICBtZXRyaWMuYXZnRHVyYXRpb24gPSBtZXRyaWMudG90YWxEdXJhdGlvbiAvIG1ldHJpYy5jb3VudFxyXG4gICAgbWV0cmljLm1pbkR1cmF0aW9uID0gTWF0aC5taW4obWV0cmljLm1pbkR1cmF0aW9uLCBkdXJhdGlvbilcclxuICAgIG1ldHJpYy5tYXhEdXJhdGlvbiA9IE1hdGgubWF4KG1ldHJpYy5tYXhEdXJhdGlvbiwgZHVyYXRpb24pXHJcblxyXG4gICAgdGhpcy5tZXRyaWNzLnNldChrZXksIG1ldHJpYylcclxuICB9XHJcblxyXG4gIGdldE1ldHJpY3MoKTogUGVyZm9ybWFuY2VNZXRyaWNzIHtcclxuICAgIGNvbnN0IHRvdGFsT3BzID0gQXJyYXkuZnJvbSh0aGlzLm1ldHJpY3MudmFsdWVzKCkpXHJcbiAgICAgIC5yZWR1Y2UoKHN1bSwgbSkgPT4gc3VtICsgbS5jb3VudCwgMClcclxuICAgIFxyXG4gICAgY29uc3QgdG90YWxEdXJhdGlvbiA9IEFycmF5LmZyb20odGhpcy5tZXRyaWNzLnZhbHVlcygpKVxyXG4gICAgICAucmVkdWNlKChzdW0sIG0pID0+IHN1bSArIG0udG90YWxEdXJhdGlvbiwgMClcclxuICAgIFxyXG4gICAgY29uc3Qgc3VjY2Vzc0NvdW50ID0gQXJyYXkuZnJvbSh0aGlzLm1ldHJpY3MudmFsdWVzKCkpXHJcbiAgICAgIC5yZWR1Y2UoKHN1bSwgbSkgPT4gc3VtICsgbS5zdWNjZXNzQ291bnQsIDApXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdG90YWxPcGVyYXRpb25zOiB0b3RhbE9wcyxcclxuICAgICAgYXZlcmFnZVJlc3BvbnNlVGltZTogdG90YWxPcHMgPiAwID8gdG90YWxEdXJhdGlvbiAvIHRvdGFsT3BzIDogMCxcclxuICAgICAgc3VjY2Vzc1JhdGU6IHRvdGFsT3BzID4gMCA/IHN1Y2Nlc3NDb3VudCAvIHRvdGFsT3BzIDogMCxcclxuICAgICAgY2FjaGVIaXRSYXRlOiAwLCAvLyDlsIbku47nvJPlrZjnrqHnkIblmajojrflj5ZcclxuICAgICAgcXVldWVTaXplOiAwLCAgICAvLyDlsIbku47pmJ/liJfnrqHnkIblmajojrflj5ZcclxuICAgICAgbGFzdFN5bmNUaW1lOiBudWxsXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXREZXRhaWxlZE1ldHJpY3MoKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKHRoaXMubWV0cmljcylcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g6auY5oCn6IO95pys5Zyw5pON5L2c5pyN5YqhXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjbGFzcyBMb2NhbE9wZXJhdGlvblNlcnZpY2VPcHRpbWl6ZWQge1xyXG4gIHByaXZhdGUgY2FjaGVNYW5hZ2VyID0gbmV3IExvY2FsQ2FjaGVNYW5hZ2VyKClcclxuICBwcml2YXRlIHBlcmZvcm1hbmNlTW9uaXRvciA9IG5ldyBQZXJmb3JtYW5jZU1vbml0b3IoKVxyXG4gIHByaXZhdGUgaXNJbml0aWFsaXplZCA9IGZhbHNlXHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5pbml0aWFsaXplKClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQpIHJldHVyblxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IGRiLm9wZW4oKVxyXG4gICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlXHJcbiAgICAgIGNvbnNvbGUubG9nKCdMb2NhbE9wZXJhdGlvblNlcnZpY2VPcHRpbWl6ZWQgaW5pdGlhbGl6ZWQnKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgTG9jYWxPcGVyYXRpb25TZXJ2aWNlT3B0aW1pemVkOicsIGVycm9yKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIOmrmOaAp+iDveWNoeeJh+aTjeS9nFxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiAgLyoqXHJcbiAgICog5b+r6YCf5Yib5bu65Y2h54mHIC0g56uL5Y2z5ZON5bqU77yM5byC5q2l5ZCM5q2lXHJcbiAgICovXHJcbiAgYXN5bmMgY3JlYXRlQ2FyZChjYXJkRGF0YTogQ2FyZERhdGEpOiBQcm9taXNlPExvY2FsT3BlcmF0aW9uUmVzdWx0PiB7XHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKVxyXG4gICAgY29uc3QgY2FjaGVLZXkgPSBgY2FyZF9jcmVhdGlvbl8ke0RhdGUubm93KCl9YFxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIOeUn+aIkOWNoeeJh0lEXHJcbiAgICAgIGNvbnN0IGNhcmRJZCA9IGNyeXB0by5yYW5kb21VVUlEKClcclxuICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxyXG5cclxuICAgICAgLy8g5YeG5aSH5pWw5o2u5bqT6K6w5b2VXHJcbiAgICAgIGNvbnN0IGRiQ2FyZDogT21pdDxEYkNhcmQsICdpZCc+ID0ge1xyXG4gICAgICAgIC4uLmNhcmREYXRhLFxyXG4gICAgICAgIHN5bmNWZXJzaW9uOiAxLFxyXG4gICAgICAgIHBlbmRpbmdTeW5jOiB0cnVlLFxyXG4gICAgICAgIHVwZGF0ZWRBdDogbm93LFxyXG4gICAgICAgIGNyZWF0ZWRBdDogbm93LFxyXG4gICAgICAgIC8vIOeUn+aIkOaQnOe0ouWQkemHj1xyXG4gICAgICAgIHNlYXJjaFZlY3RvcjogdGhpcy5nZW5lcmF0ZVNlYXJjaFZlY3RvcihjYXJkRGF0YSlcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g5L2/55So5LqL5Yqh56Gu5L+d5pWw5o2u5LiA6Ie05oCnXHJcbiAgICAgIGF3YWl0IGRiLnRyYW5zYWN0aW9uKCdydycsIFtkYi5jYXJkcywgZGIuc3luY1F1ZXVlXSwgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIC8vIDEuIOeri+WNs+aPkuWFpeWIsOacrOWcsOaVsOaNruW6k1xyXG4gICAgICAgIGF3YWl0IGRiLmNhcmRzLmFkZCh7IC4uLmRiQ2FyZCwgaWQ6IGNhcmRJZCB9KVxyXG5cclxuICAgICAgICAvLyAyLiDliJvlu7rlkIzmraXmk43kvZzvvIjlvILmraXlpITnkIbvvIlcclxuICAgICAgICBhd2FpdCBkYi5zeW5jUXVldWUuYWRkKHtcclxuICAgICAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxyXG4gICAgICAgICAgdHlwZTogJ2NyZWF0ZScsXHJcbiAgICAgICAgICBlbnRpdHk6ICdjYXJkJyxcclxuICAgICAgICAgIGVudGl0eUlkOiBjYXJkSWQsXHJcbiAgICAgICAgICBlbnRpdHlUeXBlOiAnY2FyZCcsXHJcbiAgICAgICAgICBvcGVyYXRpb25UeXBlOiAnY3JlYXRlJyxcclxuICAgICAgICAgIGRhdGE6IGRiQ2FyZCxcclxuICAgICAgICAgIHVzZXJJZDogY2FyZERhdGEudXNlcklkLFxyXG4gICAgICAgICAgdGltZXN0YW1wOiBub3csXHJcbiAgICAgICAgICByZXRyeUNvdW50OiAwLFxyXG4gICAgICAgICAgbWF4UmV0cmllczogNSxcclxuICAgICAgICAgIHByaW9yaXR5OiAnbm9ybWFsJyxcclxuICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxyXG4gICAgICAgICAgbG9jYWxWZXJzaW9uOiBEYXRlLm5vdygpXHJcbiAgICAgICAgfSlcclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vIOa4hemZpOebuOWFs+e8k+WtmFxyXG4gICAgICB0aGlzLmNhY2hlTWFuYWdlci5pbnZhbGlkYXRlKCdjYXJkcycpXHJcbiAgICAgIHRoaXMuY2FjaGVNYW5hZ2VyLmludmFsaWRhdGUoYGZvbGRlcl8ke2NhcmREYXRhLmZvbGRlcklkIHx8ICdyb290J31gKVxyXG5cclxuICAgICAgY29uc3QgZHVyYXRpb24gPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZVxyXG4gICAgICB0aGlzLnBlcmZvcm1hbmNlTW9uaXRvci5yZWNvcmRPcGVyYXRpb24oJ2NyZWF0ZUNhcmQnLCBkdXJhdGlvbiwgdHJ1ZSlcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBpZDogY2FyZElkLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdDYXJkIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5JyxcclxuICAgICAgICBkdXJhdGlvbixcclxuICAgICAgICB0aW1lc3RhbXA6IG5vd1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lXHJcbiAgICAgIHRoaXMucGVyZm9ybWFuY2VNb25pdG9yLnJlY29yZE9wZXJhdGlvbignY3JlYXRlQ2FyZCcsIGR1cmF0aW9uLCBmYWxzZSlcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxyXG4gICAgICAgIGR1cmF0aW9uLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlv6vpgJ/mm7TmlrDljaHniYcgLSDnq4vljbPlk43lupTvvIzlvILmraXlkIzmraVcclxuICAgKi9cclxuICBhc3luYyB1cGRhdGVDYXJkKGNhcmRJZDogc3RyaW5nLCB1cGRhdGVzOiBDYXJkVXBkYXRlKTogUHJvbWlzZTxMb2NhbE9wZXJhdGlvblJlc3VsdD4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KClcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXHJcblxyXG4gICAgICAvLyDojrflj5blvZPliY3ljaHniYfmlbDmja5cclxuICAgICAgY29uc3QgY3VycmVudENhcmQgPSBhd2FpdCBkYi5jYXJkcy5nZXQoY2FyZElkKVxyXG4gICAgICBpZiAoIWN1cnJlbnRDYXJkKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdDYXJkIG5vdCBmb3VuZCcsXHJcbiAgICAgICAgICBkdXJhdGlvbjogcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgICAgICB0aW1lc3RhbXA6IG5vd1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g5YeG5aSH5pu05paw5pWw5o2uXHJcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGE6IFBhcnRpYWw8RGJDYXJkPiA9IHtcclxuICAgICAgICAuLi51cGRhdGVzLFxyXG4gICAgICAgIHN5bmNWZXJzaW9uOiBjdXJyZW50Q2FyZC5zeW5jVmVyc2lvbiArIDEsXHJcbiAgICAgICAgcGVuZGluZ1N5bmM6IHRydWUsXHJcbiAgICAgICAgdXBkYXRlZEF0OiBub3dcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g5aaC5p6c5YaF5a655pyJ5pu05paw77yM6YeN5paw55Sf5oiQ5pCc57Si5ZCR6YePXHJcbiAgICAgIGlmICh1cGRhdGVzLmZyb250Q29udGVudCB8fCB1cGRhdGVzLmJhY2tDb250ZW50KSB7XHJcbiAgICAgICAgY29uc3QgbWVyZ2VkQ2FyZCA9IHsgLi4uY3VycmVudENhcmQsIC4uLnVwZGF0ZXMgfVxyXG4gICAgICAgIHVwZGF0ZURhdGEuc2VhcmNoVmVjdG9yID0gdGhpcy5nZW5lcmF0ZVNlYXJjaFZlY3RvcihtZXJnZWRDYXJkKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDkvb/nlKjkuovliqHnoa7kv53kuIDoh7TmgKdcclxuICAgICAgYXdhaXQgZGIudHJhbnNhY3Rpb24oJ3J3JywgW2RiLmNhcmRzLCBkYi5zeW5jUXVldWVdLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gMS4g56uL5Y2z5pu05paw5pys5Zyw5pWw5o2u5bqTXHJcbiAgICAgICAgYXdhaXQgZGIuY2FyZHMudXBkYXRlKGNhcmRJZCwgdXBkYXRlRGF0YSlcclxuXHJcbiAgICAgICAgLy8gMi4g5Yib5bu65ZCM5q2l5pON5L2cXHJcbiAgICAgICAgYXdhaXQgZGIuc3luY1F1ZXVlLmFkZCh7XHJcbiAgICAgICAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcclxuICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLFxyXG4gICAgICAgICAgZW50aXR5OiAnY2FyZCcsXHJcbiAgICAgICAgICBlbnRpdHlJZDogY2FyZElkLFxyXG4gICAgICAgICAgZW50aXR5VHlwZTogJ2NhcmQnLFxyXG4gICAgICAgICAgb3BlcmF0aW9uVHlwZTogJ3VwZGF0ZScsXHJcbiAgICAgICAgICBkYXRhOiB7IC4uLmN1cnJlbnRDYXJkLCAuLi51cGRhdGVEYXRhIH0sXHJcbiAgICAgICAgICBwcmV2aW91c0RhdGE6IGN1cnJlbnRDYXJkLFxyXG4gICAgICAgICAgdXNlcklkOiBjdXJyZW50Q2FyZC51c2VySWQsXHJcbiAgICAgICAgICB0aW1lc3RhbXA6IG5vdyxcclxuICAgICAgICAgIHJldHJ5Q291bnQ6IDAsXHJcbiAgICAgICAgICBtYXhSZXRyaWVzOiA1LFxyXG4gICAgICAgICAgcHJpb3JpdHk6ICdub3JtYWwnLFxyXG4gICAgICAgICAgc3RhdHVzOiAncGVuZGluZycsXHJcbiAgICAgICAgICBsb2NhbFZlcnNpb246IERhdGUubm93KClcclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLy8g5riF6Zmk55u45YWz57yT5a2YXHJcbiAgICAgIHRoaXMuY2FjaGVNYW5hZ2VyLmludmFsaWRhdGUoYGNhcmRfJHtjYXJkSWR9YClcclxuICAgICAgdGhpcy5jYWNoZU1hbmFnZXIuaW52YWxpZGF0ZSgnY2FyZHMnKVxyXG4gICAgICB0aGlzLmNhY2hlTWFuYWdlci5pbnZhbGlkYXRlKGBmb2xkZXJfJHtjdXJyZW50Q2FyZC5mb2xkZXJJZCB8fCAncm9vdCd9YClcclxuXHJcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWVcclxuICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vbml0b3IucmVjb3JkT3BlcmF0aW9uKCd1cGRhdGVDYXJkJywgZHVyYXRpb24sIHRydWUpXHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgaWQ6IGNhcmRJZCxcclxuICAgICAgICBtZXNzYWdlOiAnQ2FyZCB1cGRhdGVkIHN1Y2Nlc3NmdWxseScsXHJcbiAgICAgICAgZHVyYXRpb24sXHJcbiAgICAgICAgdGltZXN0YW1wOiBub3dcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc3QgZHVyYXRpb24gPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZVxyXG4gICAgICB0aGlzLnBlcmZvcm1hbmNlTW9uaXRvci5yZWNvcmRPcGVyYXRpb24oJ3VwZGF0ZUNhcmQnLCBkdXJhdGlvbiwgZmFsc2UpXHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcclxuICAgICAgICBkdXJhdGlvbixcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5b+r6YCf5Yig6Zmk5Y2h54mHIC0g56uL5Y2z5ZON5bqU77yM5byC5q2l5ZCM5q2lXHJcbiAgICovXHJcbiAgYXN5bmMgZGVsZXRlQ2FyZChjYXJkSWQ6IHN0cmluZyk6IFByb21pc2U8TG9jYWxPcGVyYXRpb25SZXN1bHQ+IHtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxyXG5cclxuICAgICAgLy8g6I635Y+W5Y2h54mH5L+h5oGv55So5LqO5ZCM5q2lXHJcbiAgICAgIGNvbnN0IGNhcmQgPSBhd2FpdCBkYi5jYXJkcy5nZXQoY2FyZElkKVxyXG4gICAgICBpZiAoIWNhcmQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjogJ0NhcmQgbm90IGZvdW5kJyxcclxuICAgICAgICAgIGR1cmF0aW9uOiBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZSxcclxuICAgICAgICAgIHRpbWVzdGFtcDogbm93XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDkvb/nlKjkuovliqHnoa7kv53kuIDoh7TmgKdcclxuICAgICAgYXdhaXQgZGIudHJhbnNhY3Rpb24oJ3J3JywgW2RiLmNhcmRzLCBkYi5pbWFnZXMsIGRiLnN5bmNRdWV1ZV0sIGFzeW5jICgpID0+IHtcclxuICAgICAgICAvLyAxLiDliKDpmaTnm7jlhbPlm77niYdcclxuICAgICAgICBhd2FpdCBkYi5pbWFnZXMud2hlcmUoJ2NhcmRJZCcpLmVxdWFscyhjYXJkSWQpLmRlbGV0ZSgpXHJcblxyXG4gICAgICAgIC8vIDIuIOeri+WNs+WIoOmZpOacrOWcsOWNoeeJh1xyXG4gICAgICAgIGF3YWl0IGRiLmNhcmRzLmRlbGV0ZShjYXJkSWQpXHJcblxyXG4gICAgICAgIC8vIDMuIOWIm+W7uuWQjOatpeaTjeS9nFxyXG4gICAgICAgIGF3YWl0IGRiLnN5bmNRdWV1ZS5hZGQoe1xyXG4gICAgICAgICAgaWQ6IGNyeXB0by5yYW5kb21VVUlEKCksXHJcbiAgICAgICAgICB0eXBlOiAnZGVsZXRlJyxcclxuICAgICAgICAgIGVudGl0eTogJ2NhcmQnLFxyXG4gICAgICAgICAgZW50aXR5SWQ6IGNhcmRJZCxcclxuICAgICAgICAgIGVudGl0eVR5cGU6ICdjYXJkJyxcclxuICAgICAgICAgIG9wZXJhdGlvblR5cGU6ICdkZWxldGUnLFxyXG4gICAgICAgICAgZGF0YTogeyB1c2VySWQ6IGNhcmQudXNlcklkLCBkZWxldGVkQXQ6IG5vdyB9LFxyXG4gICAgICAgICAgcHJldmlvdXNEYXRhOiBjYXJkLFxyXG4gICAgICAgICAgdXNlcklkOiBjYXJkLnVzZXJJZCxcclxuICAgICAgICAgIHRpbWVzdGFtcDogbm93LFxyXG4gICAgICAgICAgcmV0cnlDb3VudDogMCxcclxuICAgICAgICAgIG1heFJldHJpZXM6IDUsXHJcbiAgICAgICAgICBwcmlvcml0eTogJ2hpZ2gnLCAvLyDliKDpmaTmk43kvZzpq5jkvJjlhYjnuqdcclxuICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxyXG4gICAgICAgICAgbG9jYWxWZXJzaW9uOiBEYXRlLm5vdygpXHJcbiAgICAgICAgfSlcclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vIOa4hemZpOebuOWFs+e8k+WtmFxyXG4gICAgICB0aGlzLmNhY2hlTWFuYWdlci5pbnZhbGlkYXRlKGBjYXJkXyR7Y2FyZElkfWApXHJcbiAgICAgIHRoaXMuY2FjaGVNYW5hZ2VyLmludmFsaWRhdGUoJ2NhcmRzJylcclxuICAgICAgdGhpcy5jYWNoZU1hbmFnZXIuaW52YWxpZGF0ZShgZm9sZGVyXyR7Y2FyZC5mb2xkZXJJZCB8fCAncm9vdCd9YClcclxuXHJcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWVcclxuICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vbml0b3IucmVjb3JkT3BlcmF0aW9uKCdkZWxldGVDYXJkJywgZHVyYXRpb24sIHRydWUpXHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgaWQ6IGNhcmRJZCxcclxuICAgICAgICBtZXNzYWdlOiAnQ2FyZCBkZWxldGVkIHN1Y2Nlc3NmdWxseScsXHJcbiAgICAgICAgZHVyYXRpb24sXHJcbiAgICAgICAgdGltZXN0YW1wOiBub3dcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc3QgZHVyYXRpb24gPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZVxyXG4gICAgICB0aGlzLnBlcmZvcm1hbmNlTW9uaXRvci5yZWNvcmRPcGVyYXRpb24oJ2RlbGV0ZUNhcmQnLCBkdXJhdGlvbiwgZmFsc2UpXHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcclxuICAgICAgICBkdXJhdGlvbixcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIOaJuemHj+aTjeS9nFxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiAgLyoqXHJcbiAgICog5om56YeP5Yib5bu65Y2h54mHIC0g6auY5oCn6IO95om56YeP5aSE55CGXHJcbiAgICovXHJcbiAgYXN5bmMgYnVsa0NyZWF0ZUNhcmRzKGNhcmRzRGF0YTogQ2FyZERhdGFbXSk6IFByb21pc2U8TG9jYWxPcGVyYXRpb25SZXN1bHRbXT4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KClcclxuICAgIGNvbnN0IHJlc3VsdHM6IExvY2FsT3BlcmF0aW9uUmVzdWx0W10gPSBbXVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcclxuXHJcbiAgICAgIC8vIOWHhuWkh+aJuemHj+aVsOaNrlxyXG4gICAgICBjb25zdCBkYkNhcmRzID0gY2FyZHNEYXRhLm1hcChjYXJkRGF0YSA9PiAoe1xyXG4gICAgICAgIC4uLmNhcmREYXRhLFxyXG4gICAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxyXG4gICAgICAgIHN5bmNWZXJzaW9uOiAxLFxyXG4gICAgICAgIHBlbmRpbmdTeW5jOiB0cnVlLFxyXG4gICAgICAgIHVwZGF0ZWRBdDogbm93LFxyXG4gICAgICAgIGNyZWF0ZWRBdDogbm93LFxyXG4gICAgICAgIHNlYXJjaFZlY3RvcjogdGhpcy5nZW5lcmF0ZVNlYXJjaFZlY3RvcihjYXJkRGF0YSlcclxuICAgICAgfSkpXHJcblxyXG4gICAgICAvLyDlh4blpIfmibnph4/lkIzmraXmk43kvZxcclxuICAgICAgY29uc3Qgc3luY09wZXJhdGlvbnMgPSBkYkNhcmRzLm1hcChjYXJkID0+ICh7XHJcbiAgICAgICAgaWQ6IGNyeXB0by5yYW5kb21VVUlEKCksXHJcbiAgICAgICAgdHlwZTogJ2NyZWF0ZScgYXMgY29uc3QsXHJcbiAgICAgICAgZW50aXR5OiAnY2FyZCcgYXMgY29uc3QsXHJcbiAgICAgICAgZW50aXR5SWQ6IGNhcmQuaWQsXHJcbiAgICAgICAgZW50aXR5VHlwZTogJ2NhcmQnIGFzIGNvbnN0LFxyXG4gICAgICAgIG9wZXJhdGlvblR5cGU6ICdjcmVhdGUnIGFzIGNvbnN0LFxyXG4gICAgICAgIGRhdGE6IGNhcmQsXHJcbiAgICAgICAgdXNlcklkOiBjYXJkLnVzZXJJZCxcclxuICAgICAgICB0aW1lc3RhbXA6IG5vdyxcclxuICAgICAgICByZXRyeUNvdW50OiAwLFxyXG4gICAgICAgIG1heFJldHJpZXM6IDUsXHJcbiAgICAgICAgcHJpb3JpdHk6ICdub3JtYWwnIGFzIGNvbnN0LFxyXG4gICAgICAgIHN0YXR1czogJ3BlbmRpbmcnIGFzIGNvbnN0LFxyXG4gICAgICAgIGxvY2FsVmVyc2lvbjogRGF0ZS5ub3coKVxyXG4gICAgICB9KSlcclxuXHJcbiAgICAgIC8vIOS9v+eUqOS6i+WKoeaJuemHj+WkhOeQhlxyXG4gICAgICBhd2FpdCBkYi50cmFuc2FjdGlvbigncncnLCBbZGIuY2FyZHMsIGRiLnN5bmNRdWV1ZV0sIGFzeW5jICgpID0+IHtcclxuICAgICAgICBhd2FpdCBkYi5jYXJkcy5idWxrQWRkKGRiQ2FyZHMpXHJcbiAgICAgICAgYXdhaXQgZGIuc3luY1F1ZXVlLmJ1bGtBZGQoc3luY09wZXJhdGlvbnMpXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyDliJvlu7rnu5PmnpxcclxuICAgICAgcmVzdWx0cy5wdXNoKC4uLmRiQ2FyZHMubWFwKGNhcmQgPT4gKHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlIGFzIGNvbnN0LFxyXG4gICAgICAgIGlkOiBjYXJkLmlkLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdDYXJkIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5JyxcclxuICAgICAgICBkdXJhdGlvbjogcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWUsXHJcbiAgICAgICAgdGltZXN0YW1wOiBub3dcclxuICAgICAgfSkpKVxyXG5cclxuICAgICAgLy8g5riF6Zmk55u45YWz57yT5a2YXHJcbiAgICAgIHRoaXMuY2FjaGVNYW5hZ2VyLmludmFsaWRhdGUoJ2NhcmRzJylcclxuXHJcbiAgICAgIHRoaXMucGVyZm9ybWFuY2VNb25pdG9yLnJlY29yZE9wZXJhdGlvbignYnVsa0NyZWF0ZUNhcmRzJywgcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWUsIHRydWUpXHJcbiAgICAgIHJldHVybiByZXN1bHRzXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lXHJcbiAgICAgIHRoaXMucGVyZm9ybWFuY2VNb25pdG9yLnJlY29yZE9wZXJhdGlvbignYnVsa0NyZWF0ZUNhcmRzJywgZHVyYXRpb24sIGZhbHNlKVxyXG5cclxuICAgICAgcmV0dXJuIGNhcmRzRGF0YS5tYXAoKCkgPT4gKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSBhcyBjb25zdCxcclxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXHJcbiAgICAgICAgZHVyYXRpb24sXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICAgIH0pKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIOafpeivouaTjeS9nFxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5Y2h54mHIC0g5bim57yT5a2Y55qE6auY5oCn6IO95p+l6K+iXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0Q2FyZChjYXJkSWQ6IHN0cmluZyk6IFByb21pc2U8RGJDYXJkIHwgbnVsbD4ge1xyXG4gICAgY29uc3QgY2FjaGVLZXkgPSBgY2FyZF8ke2NhcmRJZH1gXHJcbiAgICBcclxuICAgIC8vIOWwneivleS7jue8k+WtmOiOt+WPllxyXG4gICAgY29uc3QgY2FjaGVkID0gYXdhaXQgdGhpcy5jYWNoZU1hbmFnZXIuZ2V0PERiQ2FyZD4oY2FjaGVLZXkpXHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgIHJldHVybiBjYWNoZWRcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjYXJkID0gYXdhaXQgZGIuY2FyZHMuZ2V0KGNhcmRJZClcclxuICAgICAgaWYgKGNhcmQpIHtcclxuICAgICAgICAvLyDnvJPlrZjnu5PmnpxcclxuICAgICAgICBhd2FpdCB0aGlzLmNhY2hlTWFuYWdlci5zZXQoY2FjaGVLZXksIGNhcmQpXHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGNhcmQgfHwgbnVsbFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGdldCBjYXJkICR7Y2FyZElkfTpgLCBlcnJvcilcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluWNoeeJh+WIl+ihqCAtIOS8mOWMlueahOWIl+ihqOafpeivolxyXG4gICAqL1xyXG4gIGFzeW5jIGdldENhcmRzKG9wdGlvbnM6IFF1ZXJ5T3B0aW9ucyA9IHt9KTogUHJvbWlzZTxEYkNhcmRbXT4ge1xyXG4gICAgY29uc3QgeyBmb2xkZXJJZCwgdXNlcklkLCBsaW1pdCA9IDUwLCBvZmZzZXQgPSAwLCBzb3J0QnkgPSAndXBkYXRlZEF0Jywgc29ydE9yZGVyID0gJ2Rlc2MnIH0gPSBvcHRpb25zXHJcbiAgICBcclxuICAgIC8vIOeUn+aIkOafpeivoue8k+WtmOmUrlxyXG4gICAgY29uc3QgcXVlcnlLZXkgPSBgY2FyZHNfbGlzdF8ke2ZvbGRlcklkIHx8ICdhbGwnfV8ke3VzZXJJZCB8fCAnYWxsJ31fJHtsaW1pdH1fJHtvZmZzZXR9XyR7c29ydEJ5fV8ke3NvcnRPcmRlcn1gXHJcbiAgICBcclxuICAgIC8vIOWwneivleS7juafpeivoue8k+WtmOiOt+WPllxyXG4gICAgY29uc3QgY2FjaGVkID0gYXdhaXQgdGhpcy5jYWNoZU1hbmFnZXIuZ2V0UXVlcnlSZXN1bHQocXVlcnlLZXkpXHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgIHJldHVybiBjYWNoZWRcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBsZXQgcXVlcnkgPSBkYi5jYXJkc1xyXG5cclxuICAgICAgLy8g5bqU55So6L+H5ruk5p2h5Lu2XHJcbiAgICAgIGlmIChmb2xkZXJJZCAmJiB1c2VySWQpIHtcclxuICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKCdbdXNlcklkK2ZvbGRlcklkXScpLmVxdWFscyhbdXNlcklkLCBmb2xkZXJJZF0pXHJcbiAgICAgIH0gZWxzZSBpZiAodXNlcklkKSB7XHJcbiAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgndXNlcklkJykuZXF1YWxzKHVzZXJJZClcclxuICAgICAgfSBlbHNlIGlmIChmb2xkZXJJZCkge1xyXG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoJ2ZvbGRlcklkJykuZXF1YWxzKGZvbGRlcklkKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDlupTnlKjmjpLluo9cclxuICAgICAgaWYgKHNvcnRCeSA9PT0gJ3RpdGxlJykge1xyXG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkuc29ydEJ5KCdmcm9udENvbnRlbnQudGl0bGUnKVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkub3JkZXJCeShzb3J0QnkpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChzb3J0T3JkZXIgPT09ICdkZXNjJykge1xyXG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkucmV2ZXJzZSgpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIOW6lOeUqOWIhumhtVxyXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgcXVlcnkub2Zmc2V0KG9mZnNldCkubGltaXQobGltaXQpLnRvQXJyYXkoKVxyXG5cclxuICAgICAgLy8g57yT5a2Y5p+l6K+i57uT5p6cXHJcbiAgICAgIGF3YWl0IHRoaXMuY2FjaGVNYW5hZ2VyLmNhY2hlUXVlcnlSZXN1bHQocXVlcnlLZXksIHJlc3VsdClcclxuXHJcbiAgICAgIHJldHVybiByZXN1bHRcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgY2FyZHM6JywgZXJyb3IpXHJcbiAgICAgIHJldHVybiBbXVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5pCc57Si5Y2h54mHIC0g6auY5oCn6IO95YWo5paH5pCc57SiXHJcbiAgICovXHJcbiAgYXN5bmMgc2VhcmNoQ2FyZHMocXVlcnk6IFNlYXJjaFF1ZXJ5KTogUHJvbWlzZTxEYkNhcmRbXT4ge1xyXG4gICAgY29uc3QgeyB0ZXJtLCB1c2VySWQsIGZvbGRlcklkLCB0YWdzLCBsaW1pdCA9IDUwIH0gPSBxdWVyeVxyXG4gICAgXHJcbiAgICAvLyDnlJ/miJDmkJzntKLnvJPlrZjplK5cclxuICAgIGNvbnN0IHNlYXJjaEtleSA9IGBzZWFyY2hfJHt0ZXJtfV8ke3VzZXJJZCB8fCAnYWxsJ31fJHtmb2xkZXJJZCB8fCAnYWxsJ31fJHt0YWdzPy5qb2luKCcsJykgfHwgJ25vbmUnfV8ke2xpbWl0fWBcclxuICAgIFxyXG4gICAgLy8g5bCd6K+V5LuO5pCc57Si57yT5a2Y6I635Y+WXHJcbiAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCB0aGlzLmNhY2hlTWFuYWdlci5nZXRRdWVyeVJlc3VsdChzZWFyY2hLZXkpXHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgIHJldHVybiBjYWNoZWRcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBsZXQgc2VhcmNoUXVlcnkgPSBkYi5jYXJkc1xyXG5cclxuICAgICAgLy8g5Z+656GA6L+H5rukXHJcbiAgICAgIGlmICh1c2VySWQpIHtcclxuICAgICAgICBzZWFyY2hRdWVyeSA9IHNlYXJjaFF1ZXJ5LndoZXJlKCd1c2VySWQnKS5lcXVhbHModXNlcklkKVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChmb2xkZXJJZCkge1xyXG4gICAgICAgIHNlYXJjaFF1ZXJ5ID0gc2VhcmNoUXVlcnkud2hlcmUoJ2ZvbGRlcklkJykuZXF1YWxzKGZvbGRlcklkKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDmiafooYzmkJzntKJcclxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHNlYXJjaFF1ZXJ5XHJcbiAgICAgICAgLmZpbHRlcihjYXJkID0+IHtcclxuICAgICAgICAgIC8vIOaQnOe0ouWQkemHj+WMuemFjVxyXG4gICAgICAgICAgY29uc3Qgc2VhcmNoVGVybSA9IHRlcm0udG9Mb3dlckNhc2UoKVxyXG4gICAgICAgICAgY29uc3QgbWF0Y2hlc1NlYXJjaCA9IGNhcmQuc2VhcmNoVmVjdG9yPy5pbmNsdWRlcyhzZWFyY2hUZXJtKSB8fCBmYWxzZVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyDmoIfnrb7ljLnphY1cclxuICAgICAgICAgIGxldCBtYXRjaGVzVGFncyA9IHRydWVcclxuICAgICAgICAgIGlmICh0YWdzICYmIHRhZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBjYXJkVGFncyA9IFtcclxuICAgICAgICAgICAgICAuLi5jYXJkLmZyb250Q29udGVudC50YWdzLFxyXG4gICAgICAgICAgICAgIC4uLmNhcmQuYmFja0NvbnRlbnQudGFnc1xyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIG1hdGNoZXNUYWdzID0gdGFncy5zb21lKHRhZyA9PiBjYXJkVGFncy5pbmNsdWRlcyh0YWcpKVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHJldHVybiBtYXRjaGVzU2VhcmNoICYmIG1hdGNoZXNUYWdzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAubGltaXQobGltaXQpXHJcbiAgICAgICAgLnRvQXJyYXkoKVxyXG5cclxuICAgICAgLy8g57yT5a2Y5pCc57Si57uT5p6cXHJcbiAgICAgIGF3YWl0IHRoaXMuY2FjaGVNYW5hZ2VyLmNhY2hlUXVlcnlSZXN1bHQoc2VhcmNoS2V5LCByZXN1bHRzKVxyXG5cclxuICAgICAgcmV0dXJuIHJlc3VsdHNcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzZWFyY2ggY2FyZHM6JywgZXJyb3IpXHJcbiAgICAgIHJldHVybiBbXVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIOWQjOatpeaTjeS9nOeuoeeQhlxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5b6F5ZCM5q2l5pON5L2cXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0UGVuZGluZ1N5bmNPcGVyYXRpb25zKCk6IFByb21pc2U8TG9jYWxTeW5jT3BlcmF0aW9uW10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHJldHVybiBhd2FpdCBkYi5zeW5jUXVldWVcclxuICAgICAgICAud2hlcmUoJ3N0YXR1cycpXHJcbiAgICAgICAgLmVxdWFscygncGVuZGluZycpXHJcbiAgICAgICAgLm9yZGVyQnkoJ3ByaW9yaXR5JylcclxuICAgICAgICAucmV2ZXJzZSgpXHJcbiAgICAgICAgLmxpbWl0KDEwMClcclxuICAgICAgICAudG9BcnJheSgpIGFzIExvY2FsU3luY09wZXJhdGlvbltdXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHBlbmRpbmcgc3luYyBvcGVyYXRpb25zOicsIGVycm9yKVxyXG4gICAgICByZXR1cm4gW11cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOabtOaWsOaTjeS9nOeKtuaAgVxyXG4gICAqL1xyXG4gIGFzeW5jIHVwZGF0ZU9wZXJhdGlvblN0YXR1c2VzKHJlc3VsdHM6IHtcclxuICAgIG9wZXJhdGlvbklkOiBzdHJpbmdcclxuICAgIHN1Y2Nlc3M6IGJvb2xlYW5cclxuICAgIGVycm9yPzogc3RyaW5nXHJcbiAgfVtdKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBkYi50cmFuc2FjdGlvbigncncnLCBbZGIuc3luY1F1ZXVlXSwgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGZvciAoY29uc3QgcmVzdWx0IG9mIHJlc3VsdHMpIHtcclxuICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICBhd2FpdCBkYi5zeW5jUXVldWUudXBkYXRlKHJlc3VsdC5vcGVyYXRpb25JZCwge1xyXG4gICAgICAgICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGRiLnN5bmNRdWV1ZS51cGRhdGUocmVzdWx0Lm9wZXJhdGlvbklkLCB7XHJcbiAgICAgICAgICAgICAgc3RhdHVzOiAnZmFpbGVkJyxcclxuICAgICAgICAgICAgICBsYXN0RXJyb3I6IHJlc3VsdC5lcnJvclxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byB1cGRhdGUgb3BlcmF0aW9uIHN0YXR1c2VzOicsIGVycm9yKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIOaAp+iDveebkeaOp+WSjOe7n+iuoVxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5oCn6IO95oyH5qCHXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0UGVyZm9ybWFuY2VNZXRyaWNzKCk6IFByb21pc2U8UGVyZm9ybWFuY2VNZXRyaWNzPiB7XHJcbiAgICBjb25zdCBiYXNlTWV0cmljcyA9IHRoaXMucGVyZm9ybWFuY2VNb25pdG9yLmdldE1ldHJpY3MoKVxyXG4gICAgY29uc3QgY2FjaGVTdGF0cyA9IHRoaXMuY2FjaGVNYW5hZ2VyLmdldFN0YXRzKClcclxuICAgIGNvbnN0IHF1ZXVlU3RhdHMgPSBhd2FpdCB0aGlzLmdldFF1ZXVlU3RhdHMoKVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIC4uLmJhc2VNZXRyaWNzLFxyXG4gICAgICBjYWNoZUhpdFJhdGU6IGNhY2hlU3RhdHMuaGl0UmF0ZSxcclxuICAgICAgcXVldWVTaXplOiBxdWV1ZVN0YXRzLnRvdGFsT3BlcmF0aW9ucyxcclxuICAgICAgbGFzdFN5bmNUaW1lOiBxdWV1ZVN0YXRzLmxhc3RTeW5jVGltZVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W6K+m57uG57uf6K6h5L+h5oGvXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0RGV0YWlsZWRTdGF0cygpOiBQcm9taXNlPHtcclxuICAgIHBlcmZvcm1hbmNlOiBhbnlcclxuICAgIGNhY2hlOiBhbnlcclxuICAgIHF1ZXVlOiBhbnlcclxuICB9PiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBwZXJmb3JtYW5jZTogdGhpcy5wZXJmb3JtYW5jZU1vbml0b3IuZ2V0RGV0YWlsZWRNZXRyaWNzKCksXHJcbiAgICAgIGNhY2hlOiB0aGlzLmNhY2hlTWFuYWdlci5nZXRTdGF0cygpLFxyXG4gICAgICBxdWV1ZTogYXdhaXQgdGhpcy5nZXRRdWV1ZVN0YXRzKClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPlumYn+WIl+e7n+iuoVxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZ2V0UXVldWVTdGF0cygpOiBQcm9taXNlPHtcclxuICAgIHRvdGFsT3BlcmF0aW9uczogbnVtYmVyXHJcbiAgICBwZW5kaW5nT3BlcmF0aW9uczogbnVtYmVyXHJcbiAgICBsYXN0U3luY1RpbWU6IERhdGUgfCBudWxsXHJcbiAgfT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgdG90YWwgPSBhd2FpdCBkYi5zeW5jUXVldWUuY291bnQoKVxyXG4gICAgICBjb25zdCBwZW5kaW5nID0gYXdhaXQgZGIuc3luY1F1ZXVlLndoZXJlKCdzdGF0dXMnKS5lcXVhbHMoJ3BlbmRpbmcnKS5jb3VudCgpXHJcbiAgICAgIFxyXG4gICAgICAvLyDojrflj5bmnIDlkI7lkIzmraXml7bpl7RcclxuICAgICAgY29uc3QgbGFzdENvbXBsZXRlZCA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxyXG4gICAgICAgIC53aGVyZSgnc3RhdHVzJylcclxuICAgICAgICAuZXF1YWxzKCdjb21wbGV0ZWQnKVxyXG4gICAgICAgIC5vcmRlckJ5KCd0aW1lc3RhbXAnKVxyXG4gICAgICAgIC5yZXZlcnNlKClcclxuICAgICAgICAuZmlyc3QoKVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB0b3RhbE9wZXJhdGlvbnM6IHRvdGFsLFxyXG4gICAgICAgIHBlbmRpbmdPcGVyYXRpb25zOiBwZW5kaW5nLFxyXG4gICAgICAgIGxhc3RTeW5jVGltZTogbGFzdENvbXBsZXRlZD8udGltZXN0YW1wIHx8IG51bGxcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBxdWV1ZSBzdGF0czonLCBlcnJvcilcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB0b3RhbE9wZXJhdGlvbnM6IDAsXHJcbiAgICAgICAgcGVuZGluZ09wZXJhdGlvbnM6IDAsXHJcbiAgICAgICAgbGFzdFN5bmNUaW1lOiBudWxsXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyDlt6Xlhbfmlrnms5VcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4gIC8qKlxyXG4gICAqIOeUn+aIkOaQnOe0ouWQkemHj1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2VuZXJhdGVTZWFyY2hWZWN0b3IoY2FyZDogQ2FyZERhdGEpOiBzdHJpbmcge1xyXG4gICAgY29uc3Qgc2VhcmNoYWJsZVRleHQgPSBbXHJcbiAgICAgIGNhcmQuZnJvbnRDb250ZW50LnRpdGxlLFxyXG4gICAgICBjYXJkLmZyb250Q29udGVudC50ZXh0LFxyXG4gICAgICBjYXJkLmJhY2tDb250ZW50LnRpdGxlLFxyXG4gICAgICBjYXJkLmJhY2tDb250ZW50LnRleHQsXHJcbiAgICAgIC4uLmNhcmQuZnJvbnRDb250ZW50LnRhZ3MsXHJcbiAgICAgIC4uLmNhcmQuYmFja0NvbnRlbnQudGFnc1xyXG4gICAgXS5qb2luKCcgJykudG9Mb3dlckNhc2UoKVxyXG4gICAgXHJcbiAgICByZXR1cm4gc2VhcmNoYWJsZVRleHRcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOa4hemZpOe8k+WtmFxyXG4gICAqL1xyXG4gIGNsZWFyQ2FjaGUoKTogdm9pZCB7XHJcbiAgICB0aGlzLmNhY2hlTWFuYWdlci5jbGVhcigpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDplIDmr4HmnI3liqFcclxuICAgKi9cclxuICBkZXN0cm95KCk6IHZvaWQge1xyXG4gICAgdGhpcy5jYWNoZU1hbmFnZXIuY2xlYXIoKVxyXG4gICAgdGhpcy5pc0luaXRpYWxpemVkID0gZmFsc2VcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g5a+85Ye65Y2V5L6L5a6e5L6LXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjb25zdCBsb2NhbE9wZXJhdGlvblNlcnZpY2VPcHRpbWl6ZWQgPSBuZXcgTG9jYWxPcGVyYXRpb25TZXJ2aWNlT3B0aW1pemVkKClcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g5YW85a655oCn5a+85Ye6IC0g5L+d5oyB546w5pyJ5o6l5Y+jXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vIOS/neaMgeWOn+acieaWueazle+8jOWGhemDqOiwg+eUqOaWsOeahOS8mOWMluWunueOsFxyXG5leHBvcnQgY29uc3QgY3JlYXRlQ2FyZExvY2FsID0gKGNhcmREYXRhOiBDYXJkRGF0YSkgPT4gXHJcbiAgbG9jYWxPcGVyYXRpb25TZXJ2aWNlT3B0aW1pemVkLmNyZWF0ZUNhcmQoY2FyZERhdGEpXHJcblxyXG5leHBvcnQgY29uc3QgdXBkYXRlQ2FyZExvY2FsID0gKGNhcmRJZDogc3RyaW5nLCB1cGRhdGVzOiBDYXJkVXBkYXRlKSA9PiBcclxuICBsb2NhbE9wZXJhdGlvblNlcnZpY2VPcHRpbWl6ZWQudXBkYXRlQ2FyZChjYXJkSWQsIHVwZGF0ZXMpXHJcblxyXG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZExvY2FsID0gKGNhcmRJZDogc3RyaW5nKSA9PiBcclxuICBsb2NhbE9wZXJhdGlvblNlcnZpY2VPcHRpbWl6ZWQuZGVsZXRlQ2FyZChjYXJkSWQpXHJcblxyXG5leHBvcnQgY29uc3QgZ2V0Q2FyZHNMb2NhbCA9IChvcHRpb25zPzogUXVlcnlPcHRpb25zKSA9PiBcclxuICBsb2NhbE9wZXJhdGlvblNlcnZpY2VPcHRpbWl6ZWQuZ2V0Q2FyZHMob3B0aW9ucylcclxuXHJcbmV4cG9ydCBjb25zdCBzZWFyY2hDYXJkc0xvY2FsID0gKHF1ZXJ5OiBTZWFyY2hRdWVyeSkgPT4gXHJcbiAgbG9jYWxPcGVyYXRpb25TZXJ2aWNlT3B0aW1pemVkLnNlYXJjaENhcmRzKHF1ZXJ5KVxyXG5cclxuZXhwb3J0IGNvbnN0IGdldFBlcmZvcm1hbmNlTWV0cmljcyA9ICgpID0+IFxyXG4gIGxvY2FsT3BlcmF0aW9uU2VydmljZU9wdGltaXplZC5nZXRQZXJmb3JtYW5jZU1ldHJpY3MoKSJdLCJ2ZXJzaW9uIjozfQ==