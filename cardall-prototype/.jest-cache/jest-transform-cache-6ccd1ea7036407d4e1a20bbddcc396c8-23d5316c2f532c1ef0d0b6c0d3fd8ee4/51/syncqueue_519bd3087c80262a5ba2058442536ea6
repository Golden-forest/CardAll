0acc8107a64053b9f289da24131058d3
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.retryFailedSyncOperations = exports.cleanupSyncOperations = exports.getSyncOperations = exports.getSyncQueueStats = exports.enqueueSyncBatch = exports.enqueueSyncOperation = exports.syncQueueManager = exports.SyncQueueManager = exports.SyncQueueStatus = void 0;
const database_unified_1 = require("./database-unified");
const conflict_resolution_engine_1 = require("./conflict-resolution-engine");
// ============================================================================
// 同步队列状态枚举
// ============================================================================
var SyncQueueStatus;
(function (SyncQueueStatus) {
    SyncQueueStatus["PENDING"] = "pending";
    SyncQueueStatus["PROCESSING"] = "processing";
    SyncQueueStatus["COMPLETED"] = "completed";
    SyncQueueStatus["FAILED"] = "failed";
    SyncQueueStatus["RETRYING"] = "retrying";
})(SyncQueueStatus || (exports.SyncQueueStatus = SyncQueueStatus = {}));
// ============================================================================
// 同步队列管理器
// ============================================================================
class SyncQueueManager {
    constructor() {
        Object.defineProperty(this, "isProcessing", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "processingInterval", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "retryDelays", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: [1000, 2000, 5000, 10000, 30000]
        }); // 指数退避重试延迟
        Object.defineProperty(this, "batchSize", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 10
        }); // 每批处理的操作数量
        Object.defineProperty(this, "maxConcurrentBatches", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 3
        }); // 最大并发批处理数
        Object.defineProperty(this, "currentBatches", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        // 事件监听器
        Object.defineProperty(this, "listeners", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: {}
        });
        this.initializeQueue();
        this.startQueueProcessor();
    }
    // ============================================================================
    // 核心队列操作
    // ============================================================================
    /**
     * 添加操作到同步队列
     */
    async enqueueOperation(operation) {
        const queueOperation = {
            ...operation,
            id: crypto.randomUUID(),
            status: SyncQueueStatus.PENDING,
            timestamp: new Date()
        };
        try {
            // 检查依赖关系
            if (operation.dependencies && operation.dependencies.length > 0) {
                await this.validateDependencies(operation.dependencies);
            }
            await database_unified_1.db.syncQueue.add({
                id: queueOperation.id,
                type: operation.type,
                entity: operation.entity,
                entityId: operation.entityId,
                userId: operation.userId,
                data: operation.data,
                priority: operation.priority,
                timestamp: queueOperation.timestamp,
                retryCount: operation.retryCount,
                maxRetries: operation.maxRetries,
                error: operation.error
            });
            this.notifyStatusChange();
            // 如果有高优先级操作，立即触发处理
            if (operation.priority === 'high' && !this.isProcessing) {
                this.processNextBatch();
            }
            return queueOperation.id;
        }
        catch (error) {
            console.error('Failed to enqueue operation:', error);
            throw error;
        }
    }
    /**
     * 批量添加操作到同步队列
     */
    async enqueueBatch(operations) {
        const queueOperations = operations.map(op => ({
            ...op,
            id: crypto.randomUUID(),
            status: SyncQueueStatus.PENDING,
            timestamp: new Date()
        }));
        try {
            // 验证所有操作的依赖关系
            const allDependencies = queueOperations
                .filter(op => op.dependencies && op.dependencies.length > 0)
                .flatMap(op => op.dependencies);
            if (allDependencies.length > 0) {
                await this.validateDependencies(allDependencies);
            }
            const syncOperations = queueOperations.map(op => ({
                id: op.id,
                type: op.type,
                entity: op.entity,
                entityId: op.entityId,
                userId: op.userId,
                data: op.data,
                priority: op.priority,
                timestamp: op.timestamp,
                retryCount: op.retryCount,
                maxRetries: op.maxRetries,
                error: op.error
            }));
            await database_unified_1.db.syncQueue.bulkAdd(syncOperations);
            this.notifyStatusChange();
            // 返回操作ID列表
            return queueOperations.map(op => op.id);
        }
        catch (error) {
            console.error('Failed to enqueue batch operations:', error);
            throw error;
        }
    }
    /**
     * 从队列中移除操作
     */
    async dequeueOperation(operationId) {
        try {
            const deleted = await database_unified_1.db.syncQueue.where('id').equals(operationId).delete();
            this.notifyStatusChange();
            return deleted > 0;
        }
        catch (error) {
            console.error('Failed to dequeue operation:', error);
            return false;
        }
    }
    /**
     * 更新操作状态
     */
    async updateOperationStatus(operationId, status, error) {
        try {
            await database_unified_1.db.syncQueue.where('id').equals(operationId).modify({
                status,
                error,
                ...(status === SyncQueueStatus.PROCESSING ? { retryCount: Dexie.currentTransaction?.table('syncQueue').get(operationId).then(op => (op?.retryCount || 0) + 1) } : {})
            });
            this.notifyStatusChange();
            // 通知操作完成
            const operation = await database_unified_1.db.syncQueue.get(operationId);
            if (operation && this.listeners.onOperationComplete) {
                this.listeners.onOperationComplete(this.convertSyncOperationToQueueOperation(operation), status === SyncQueueStatus.COMPLETED);
            }
        }
        catch (error) {
            console.error('Failed to update operation status:', error);
        }
    }
    // ============================================================================
    // 队列处理逻辑
    // ============================================================================
    /**
     * 处理下一批操作
     */
    async processNextBatch() {
        if (this.isProcessing || this.currentBatches >= this.maxConcurrentBatches) {
            return;
        }
        this.isProcessing = true;
        this.currentBatches++;
        try {
            // 获取下一批待处理操作
            const operations = await this.getNextBatch();
            if (operations.length === 0) {
                this.isProcessing = false;
                this.currentBatches--;
                return;
            }
            // 标记操作为处理中
            const operationIds = operations.map(op => op.id);
            await this.markOperationsProcessing(operationIds);
            // 处理批次
            const batchResult = await this.processBatch(operations);
            // 通知批处理完成
            if (this.listeners.onBatchComplete) {
                this.listeners.onBatchComplete(batchResult);
            }
        }
        catch (error) {
            console.error('Error processing batch:', error);
            if (this.listeners.onQueueError) {
                this.listeners.onQueueError(error instanceof Error ? error : new Error(String(error)));
            }
        }
        finally {
            this.isProcessing = false;
            this.currentBatches--;
            // 如果还有待处理操作，继续处理
            setTimeout(() => this.processNextBatch(), 100);
        }
    }
    /**
     * 获取下一批待处理操作
     */
    async getNextBatch() {
        try {
            // 按优先级和时间排序获取操作
            return await database_unified_1.db.syncQueue
                .where('status')
                .equals('pending')
                .orderBy('priority') // 高优先级先处理
                .reverse()
                .offset(0)
                .limit(this.batchSize)
                .toArray();
        }
        catch (error) {
            console.error('Failed to get next batch:', error);
            return [];
        }
    }
    /**
     * 标记操作为处理中
     */
    async markOperationsProcessing(operationIds) {
        await database_unified_1.db.syncQueue
            .where('id')
            .anyOf(operationIds)
            .modify({ status: 'processing' });
    }
    /**
     * 处理一批同步操作
     */
    async processBatch(operations) {
        const batchId = crypto.randomUUID();
        const startTime = performance.now();
        const successful = [];
        const failed = [];
        const errors = [];
        try {
            // 这里应该调用实际的同步服务
            // 为了演示，我们模拟同步过程
            for (const operation of operations) {
                try {
                    const success = await this.executeSyncOperation(operation);
                    if (success) {
                        successful.push(operation.id);
                        await this.updateOperationStatus(operation.id, SyncQueueStatus.COMPLETED);
                    }
                    else {
                        failed.push(operation.id);
                        errors.push(`Sync failed for operation ${operation.id}`);
                        await this.handleOperationFailure(operation, 'Sync execution failed');
                    }
                }
                catch (error) {
                    failed.push(operation.id);
                    const errorMsg = error instanceof Error ? error.message : String(error);
                    errors.push(errorMsg);
                    await this.handleOperationFailure(operation, errorMsg);
                }
            }
            const executionTime = performance.now() - startTime;
            return {
                batchId,
                operations: operations.length,
                successful: successful.length,
                failed: failed.length,
                errors,
                executionTime,
                timestamp: new Date()
            };
        }
        catch (error) {
            const executionTime = performance.now() - startTime;
            const errorMsg = error instanceof Error ? error.message : String(error);
            // 标记所有操作为失败
            for (const operation of operations) {
                await this.handleOperationFailure(operation, errorMsg);
            }
            return {
                batchId,
                operations: operations.length,
                successful: 0,
                failed: operations.length,
                errors: [errorMsg],
                executionTime,
                timestamp: new Date()
            };
        }
    }
    /**
     * 执行单个同步操作 - 增强版，集成冲突解决
     */
    async executeSyncOperation(operation) {
        try {
            // 在执行前进行冲突预测和预防
            const conflictAnalysis = await this.analyzeOperationConflicts(operation);
            if (conflictAnalysis.highRisk > 0) {
                console.warn(`High conflict risk detected for operation ${operation.id}, applying conflict resolution`);
                return await this.executeWithConflictResolution(operation, conflictAnalysis);
            }
            // 正常执行同步操作
            return await this.performSyncOperation(operation);
        }
        catch (error) {
            console.error(`Sync operation failed for ${operation.id}:`, error);
            return false;
        }
    }
    /**
     * 分析操作冲突风险
     */
    async analyzeOperationConflicts(operation) {
        try {
            // 获取同一实体的最近操作
            const recentOperations = await database_unified_1.db.syncQueue
                .where('entityId')
                .equals(operation.entityId)
                .filter(op => {
                const timeDiff = Math.abs(op.timestamp.getTime() - operation.timestamp.getTime());
                return timeDiff < 5 * 60 * 1000 && op.id !== operation.id;
            })
                .toArray();
            let highRisk = 0;
            let mediumRisk = 0;
            let lowRisk = 0;
            const recommendations = [];
            // 分析并发操作风险
            if (recentOperations.length > 2) {
                highRisk++;
                recommendations.push('Multiple concurrent operations on same entity');
            }
            // 分析用户操作频率
            const userRecentOps = await database_unified_1.db.syncQueue
                .where('userId')
                .equals(operation.userId)
                .filter(op => {
                const timeDiff = Date.now() - op.timestamp.getTime();
                return timeDiff < 60 * 1000;
            })
                .toArray();
            if (userRecentOps.length > 10) {
                highRisk++;
                recommendations.push('User operating too frequently');
            }
            // 分析历史失败率
            const failedOps = await database_unified_1.db.syncQueue
                .where('entity')
                .equals(operation.entity)
                .filter(op => op.status === 'failed')
                .toArray();
            const failureRate = failedOps.length / Math.max(1, await database_unified_1.db.syncQueue.count());
            if (failureRate > 0.3) {
                mediumRisk++;
                recommendations.push(`High failure rate (${(failureRate * 100).toFixed(1)}%) for entity type`);
            }
            // 根据操作类型分析风险
            if (operation.type === 'delete') {
                mediumRisk++;
                recommendations.push('Delete operations require extra caution');
            }
            return { highRisk, mediumRisk, lowRisk, recommendations };
        }
        catch (error) {
            console.error('Failed to analyze operation conflicts:', error);
            return { highRisk: 0, mediumRisk: 1, lowRisk: 0, recommendations: ['Unable to analyze conflicts'] };
        }
    }
    /**
     * 带冲突解决的同步操作执行
     */
    async executeWithConflictResolution(operation, conflictAnalysis) {
        try {
            // 构建冲突上下文
            const conflictContext = {
                userId: operation.userId || '',
                timestamp: new Date(),
                networkInfo: { effectiveType: '4g' }, // 简化网络信息
                deviceInfo: { deviceType: 'unknown' },
                userPreferences: {},
                syncHistory: []
            };
            // 获取当前云端数据（模拟）
            const cloudData = await this.fetchCloudData(operation);
            // 获取本地数据
            const localData = await this.fetchLocalData(operation);
            // 使用冲突解决引擎检测和解决冲突
            const conflicts = await conflict_resolution_engine_1.conflictResolutionEngine.detectAllConflicts(localData, cloudData, operation.entity, operation.entityId, conflictContext);
            if (conflicts.length > 0) {
                console.log(`Detected ${conflicts.length} conflicts for operation ${operation.id}`);
                // 尝试自动解决冲突
                const resolvedConflicts = await conflict_resolution_engine_1.conflictResolutionEngine.resolveConflicts(conflicts, conflictContext);
                // 检查是否所有冲突都已解决
                const unresolvedConflicts = resolvedConflicts.filter(c => c.resolution === 'manual');
                if (unresolvedConflicts.length > 0) {
                    console.warn(`Unable to auto-resolve ${unresolvedConflicts.length} conflicts for operation ${operation.id}`);
                    return false;
                }
                // 使用解决后的数据执行同步
                const resolvedData = this.extractResolvedData(resolvedConflicts, localData, cloudData);
                return await this.performSyncOperation({ ...operation, data: resolvedData });
            }
            // 无冲突，正常执行
            return await this.performSyncOperation(operation);
        }
        catch (error) {
            console.error(`Conflict resolution failed for operation ${operation.id}:`, error);
            return false;
        }
    }
    /**
     * 执行实际的同步操作
     */
    async performSyncOperation(operation) {
        // 模拟实际的同步逻辑
        await new Promise(resolve => setTimeout(resolve, Math.random() * 200 + 100));
        // 根据操作类型执行相应的同步逻辑
        switch (operation.type) {
            case 'create':
                return await this.performCreateOperation(operation);
            case 'update':
                return await this.performUpdateOperation(operation);
            case 'delete':
                return await this.performDeleteOperation(operation);
            default:
                console.warn(`Unknown operation type: ${operation.type}`);
                return false;
        }
    }
    /**
     * 获取云端数据
     */
    async fetchCloudData(operation) {
        // 模拟从云端获取数据
        // 在实际实现中，这里会调用Supabase API
        return {
            id: operation.entityId,
            updatedAt: new Date().toISOString(),
            version: Math.floor(Math.random() * 100)
        };
    }
    /**
     * 获取本地数据
     */
    async fetchLocalData(operation) {
        // 模拟从本地数据库获取数据
        return {
            id: operation.entityId,
            updatedAt: new Date().toISOString(),
            version: Math.floor(Math.random() * 100),
            ...operation.data
        };
    }
    /**
     * 提取解决后的数据
     */
    extractResolvedData(conflicts, localData, cloudData) {
        // 简化的数据提取逻辑
        // 在实际实现中，这里会根据冲突解决结果合并数据
        return {
            ...localData,
            resolvedAt: new Date().toISOString(),
            conflictCount: conflicts.length
        };
    }
    /**
     * 执行创建操作
     */
    async performCreateOperation(operation) {
        // 模拟创建操作的成功率
        const successRate = operation.priority === 'high' ? 0.95 : 0.85;
        return Math.random() < successRate;
    }
    /**
     * 执行更新操作
     */
    async performUpdateOperation(operation) {
        // 模拟更新操作的成功率
        const successRate = operation.priority === 'high' ? 0.90 : 0.80;
        return Math.random() < successRate;
    }
    /**
     * 执行删除操作
     */
    async performDeleteOperation(operation) {
        // 删除操作成功率较低，需要更谨慎
        const successRate = operation.priority === 'high' ? 0.85 : 0.75;
        return Math.random() < successRate;
    }
    /**
     * 处理操作失败
     */
    async handleOperationFailure(operation, error) {
        const newRetryCount = operation.retryCount + 1;
        if (newRetryCount >= operation.maxRetries) {
            // 达到最大重试次数，标记为失败
            await this.updateOperationStatus(operation.id, SyncQueueStatus.FAILED, error);
        }
        else {
            // 计算下次重试时间
            const retryDelay = this.retryDelays[Math.min(newRetryCount - 1, this.retryDelays.length - 1)];
            // 标记为重试中，并设置延迟
            await database_unified_1.db.syncQueue.where('id').equals(operation.id).modify({
                retryCount: newRetryCount,
                status: 'retrying',
                error,
                // 可以添加下次重试时间字段
            });
            // 延迟后重新加入队列
            setTimeout(async () => {
                await database_unified_1.db.syncQueue.where('id').equals(operation.id).modify({
                    status: 'pending'
                });
                this.notifyStatusChange();
            }, retryDelay);
        }
    }
    // ============================================================================
    // 依赖关系管理
    // ============================================================================
    /**
     * 验证操作依赖关系
     */
    async validateDependencies(dependencyIds) {
        const pendingDependencies = await database_unified_1.db.syncQueue
            .where('id')
            .anyOf(dependencyIds)
            .and(op => op.status === 'pending' || op.status === 'processing')
            .count();
        if (pendingDependencies > 0) {
            throw new Error(`Cannot enqueue operation: ${pendingDependencies} dependencies are still pending`);
        }
    }
    /**
     * 检查操作是否可以执行（所有依赖已完成）
     */
    async canExecuteOperation(operation) {
        if (!operation.dependencies || operation.dependencies.length === 0) {
            return true;
        }
        const dependencyStatuses = await database_unified_1.db.syncQueue
            .where('id')
            .anyOf(operation.dependencies)
            .toArray();
        return dependencyStatuses.every(dep => dep.status === 'completed');
    }
    // ============================================================================
    // 队列管理和监控
    // ============================================================================
    /**
     * 获取队列统计信息
     */
    async getQueueStats() {
        const allOperations = await database_unified_1.db.syncQueue.toArray();
        const stats = {
            totalOperations: allOperations.length,
            byStatus: {
                [SyncQueueStatus.PENDING]: 0,
                [SyncQueueStatus.PROCESSING]: 0,
                [SyncQueueStatus.COMPLETED]: 0,
                [SyncQueueStatus.FAILED]: 0,
                [SyncQueueStatus.RETRYING]: 0
            },
            byPriority: {
                high: 0,
                normal: 0,
                low: 0
            },
            byEntity: {
                card: 0,
                folder: 0,
                tag: 0,
                image: 0
            },
            averageWaitTime: 0
        };
        // 统计各类别数量
        allOperations.forEach(op => {
            stats.byStatus[op.status]++;
            stats.byPriority[op.priority]++;
            stats.byEntity[op.entity]++;
        });
        // 计算平均等待时间
        const pendingOperations = allOperations.filter(op => op.status === SyncQueueStatus.PENDING || op.status === SyncQueueStatus.RETRYING);
        if (pendingOperations.length > 0) {
            const now = Date.now();
            const totalWaitTime = pendingOperations.reduce((sum, op) => {
                return sum + (now - new Date(op.timestamp).getTime());
            }, 0);
            stats.averageWaitTime = totalWaitTime / pendingOperations.length;
        }
        // 找到最旧的操作
        const oldest = allOperations
            .filter(op => op.status === SyncQueueStatus.PENDING)
            .sort((a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime())[0];
        if (oldest) {
            stats.oldestOperation = new Date(oldest.timestamp);
        }
        return stats;
    }
    /**
     * 清理完成的操作
     */
    async cleanupCompletedOperations(olderThan = 24 * 60 * 60 * 1000) {
        const cutoffDate = new Date(Date.now() - olderThan);
        const deleted = await database_unified_1.db.syncQueue
            .where('status')
            .equals('completed')
            .and(op => new Date(op.timestamp) < cutoffDate)
            .delete();
        this.notifyStatusChange();
        return deleted;
    }
    /**
     * 重试失败的操作
     */
    async retryFailedOperations() {
        const retried = await database_unified_1.db.syncQueue
            .where('status')
            .equals('failed')
            .modify({
            status: 'pending',
            retryCount: 0,
            error: undefined
        });
        this.notifyStatusChange();
        // 触发重新处理
        if (retried > 0) {
            this.processNextBatch();
        }
        return retried;
    }
    /**
     * 获取队列中的操作
     */
    async getOperations(filters) {
        let query = database_unified_1.db.syncQueue.toCollection();
        if (filters?.status) {
            query = query.where('status').equals(filters.status);
        }
        if (filters?.priority) {
            query = query.where('priority').equals(filters.priority);
        }
        if (filters?.entity) {
            query = query.where('entity').equals(filters.entity);
        }
        if (filters?.userId) {
            query = query.where('userId').equals(filters.userId);
        }
        if (filters?.offset) {
            query = query.offset(filters.offset);
        }
        if (filters?.limit) {
            query = query.limit(filters.limit);
        }
        const operations = await query.toArray();
        return operations.map(op => this.convertSyncOperationToQueueOperation(op));
    }
    // ============================================================================
    // 事件监听器管理
    // ============================================================================
    setEventListeners(listeners) {
        this.listeners = { ...this.listeners, ...listeners };
    }
    notifyStatusChange() {
        if (this.listeners.onStatusChange) {
            this.getQueueStats().then(stats => {
                this.listeners.onStatusChange(stats);
            }).catch(console.error);
        }
    }
    // ============================================================================
    // 队列处理器管理
    // ============================================================================
    initializeQueue() {
        // 初始化时检查是否有未完成的重试操作
        this.checkRetryOperations();
    }
    startQueueProcessor() {
        // 定期处理队列
        this.processingInterval = setInterval(() => {
            if (!this.isProcessing) {
                this.processNextBatch();
            }
        }, 5000); // 每5秒检查一次队列
        // 定期优化队列处理策略（每2分钟）
        setInterval(() => {
            this.optimizeQueueProcessing().catch(console.error);
        }, 120000);
        // 网络恢复时立即处理
        window.addEventListener('online', () => {
            if (!this.isProcessing) {
                this.processNextBatch();
            }
        });
    }
    async checkRetryOperations() {
        try {
            const retryingOperations = await database_unified_1.db.syncQueue
                .where('status')
                .equals('retrying')
                .toArray();
            // 将重试中的操作重新设为待处理
            for (const operation of retryingOperations) {
                await database_unified_1.db.syncQueue.where('id').equals(operation.id).modify({
                    status: 'pending'
                });
            }
            if (retryingOperations.length > 0) {
                this.notifyStatusChange();
                this.processNextBatch();
            }
        }
        catch (error) {
            console.error('Failed to check retry operations:', error);
        }
    }
    /**
     * 停止队列处理器
     */
    stop() {
        if (this.processingInterval) {
            clearInterval(this.processingInterval);
            this.processingInterval = undefined;
        }
    }
    /**
     * 暂停队列处理
     */
    pause() {
        this.isProcessing = true;
    }
    /**
     * 恢复队列处理
     */
    resume() {
        this.isProcessing = false;
        this.processNextBatch();
    }
    // ============================================================================
    // 辅助方法
    // ============================================================================
    convertSyncOperationToQueueOperation(syncOp) {
        return {
            id: syncOp.id,
            type: syncOp.type,
            entity: syncOp.entity,
            entityId: syncOp.entityId,
            userId: syncOp.userId,
            data: syncOp.data,
            priority: syncOp.priority,
            timestamp: new Date(syncOp.timestamp),
            retryCount: syncOp.retryCount,
            maxRetries: syncOp.maxRetries,
            status: syncOp.status,
            error: syncOp.error
        };
    }
    // ============================================================================
    // 智能队列管理优化 - Week 2 Day 6-7
    // ============================================================================
    /**
     * 智能队列优化 - 基于网络状态和操作特征动态调整队列策略
     */
    async optimizeQueueProcessing() {
        try {
            const stats = await this.getQueueStats();
            // 根据队列状态动态调整处理策略
            this.adjustProcessingStrategy(stats);
            // 智能批量大小调整
            this.adjustBatchSize(stats);
            // 优先级重新平衡
            await this.rebalancePriorities(stats);
            // 清理过期操作
            await this.cleanupExpiredOperations();
        }
        catch (error) {
            console.error('Failed to optimize queue processing:', error);
        }
    }
    /**
     * 根据队列状态调整处理策略
     */
    adjustProcessingStrategy(stats) {
        const { totalOperations, byStatus, byPriority } = stats;
        // 高负载策略
        if (totalOperations > 1000) {
            this.batchSize = 5; // 减少批量大小
            this.maxConcurrentBatches = 2; // 减少并发数
            console.log('Queue under high load, adjusting strategy: batch=5, concurrent=2');
        }
        // 中负载策略
        else if (totalOperations > 500) {
            this.batchSize = 8;
            this.maxConcurrentBatches = 3;
            console.log('Queue under medium load, adjusting strategy: batch=8, concurrent=3');
        }
        // 低负载策略
        else {
            this.batchSize = 15; // 增加批量大小
            this.maxConcurrentBatches = 5; // 增加并发数
            console.log('Queue under normal load, adjusting strategy: batch=15, concurrent=5');
        }
        // 根据失败率调整重试策略
        const failureRate = byStatus[SyncQueueStatus.FAILED] / totalOperations;
        if (failureRate > 0.3) {
            // 失败率高，增加重试延迟
            this.retryDelays = [2000, 5000, 15000, 30000, 60000];
            console.log('High failure rate detected, increased retry delays');
        }
        else if (failureRate < 0.1) {
            // 失败率低，恢复正常重试延迟
            this.retryDelays = [1000, 2000, 5000, 10000, 30000];
            console.log('Normal failure rate, restored retry delays');
        }
    }
    /**
     * 动态调整批量大小
     */
    adjustBatchSize(stats) {
        const { byPriority, totalOperations } = stats;
        // 高优先级操作比例
        const highPriorityRatio = byPriority.high / totalOperations;
        // 如果高优先级操作多，减少批量大小以确保及时处理
        if (highPriorityRatio > 0.3) {
            this.batchSize = Math.max(3, Math.floor(this.batchSize * 0.7));
            console.log(`High priority ratio (${(highPriorityRatio * 100).toFixed(1)}%), reduced batch size to ${this.batchSize}`);
        }
        // 根据操作类型分布调整
        const cardRatio = byEntity.card / totalOperations;
        if (cardRatio > 0.7) {
            // 卡片操作占比大，可以适当增加批量大小
            this.batchSize = Math.min(20, Math.floor(this.batchSize * 1.2));
            console.log(`Card operation ratio (${(cardRatio * 100).toFixed(1)}%), increased batch size to ${this.batchSize}`);
        }
    }
    /**
     * 优先级重新平衡
     */
    async rebalancePriorities(stats) {
        const { byStatus, byPriority } = stats;
        // 将长时间等待的高优先级操作重新标记为关键
        const oldHighPriorityOps = await database_unified_1.db.syncQueue
            .where('priority')
            .equals('high')
            .filter(op => {
            const waitTime = Date.now() - op.timestamp.getTime();
            return waitTime > 5 * 60 * 1000; // 等待超过5分钟
        })
            .toArray();
        if (oldHighPriorityOps.length > 0) {
            await database_unified_1.db.syncQueue
                .where('id')
                .anyOf(oldHighPriorityOps.map(op => op.id))
                .modify({ priority: 'high' });
            console.log(`Escalated ${oldHighPriorityOps.length} old high-priority operations`);
        }
        // 将长时间等待的普通操作提升优先级
        const oldNormalOps = await database_unified_1.db.syncQueue
            .where('priority')
            .equals('normal')
            .filter(op => {
            const waitTime = Date.now() - op.timestamp.getTime();
            return waitTime > 10 * 60 * 1000; // 等待超过10分钟
        })
            .toArray();
        if (oldNormalOps.length > 0) {
            await database_unified_1.db.syncQueue
                .where('id')
                .anyOf(oldNormalOps.map(op => op.id))
                .modify({ priority: 'high' });
            console.log(`Escalated ${oldNormalOps.length} old normal-priority operations`);
        }
    }
    /**
     * 清理过期操作
     */
    async cleanupExpiredOperations() {
        const expiredTime = Date.now() - 24 * 60 * 60 * 1000; // 24小时前
        const expiredOperations = await database_unified_1.db.syncQueue
            .where('timestamp')
            .below(expiredTime)
            .filter(op => op.status === SyncQueueStatus.FAILED)
            .toArray();
        if (expiredOperations.length > 0) {
            for (const op of expiredOperations) {
                await database_unified_1.db.syncQueue.delete(op.id);
            }
            console.log(`Cleaned up ${expiredOperations.length} expired failed operations`);
        }
    }
    /**
     * 智能冲突预测和预防
     */
    async predictAndPreventConflicts(operations) {
        const safeOperations = [];
        const riskyOperations = [];
        const conflictPrediction = { highRisk: 0, mediumRisk: 0, lowRisk: 0 };
        for (const operation of operations) {
            const risk = await this.assessConflictRisk(operation);
            if (risk === 'high') {
                riskyOperations.push(operation);
                conflictPrediction.highRisk++;
            }
            else if (risk === 'medium') {
                riskyOperations.push(operation);
                conflictPrediction.mediumRisk++;
            }
            else {
                safeOperations.push(operation);
                conflictPrediction.lowRisk++;
            }
        }
        return { safeOperations, riskyOperations, conflictPrediction };
    }
    /**
     * 评估单个操作的冲突风险
     */
    async assessConflictRisk(operation) {
        try {
            // 检查同一实体的最近操作
            const recentOperations = await database_unified_1.db.syncQueue
                .where('entityId')
                .equals(operation.entityId)
                .filter(op => {
                const timeDiff = Math.abs(op.timestamp.getTime() - operation.timestamp.getTime());
                return timeDiff < 5 * 60 * 1000 && // 5分钟内
                    op.id !== operation.id;
            })
                .toArray();
            if (recentOperations.length > 2) {
                return 'high'; // 同一实体有多个并发操作
            }
            // 检查用户操作频率
            const userRecentOps = await database_unified_1.db.syncQueue
                .where('userId')
                .equals(operation.userId)
                .filter(op => {
                const timeDiff = Date.now() - op.timestamp.getTime();
                return timeDiff < 60 * 1000; // 1分钟内
            })
                .toArray();
            if (userRecentOps.length > 10) {
                return 'high'; // 用户操作过于频繁
            }
            // 检查历史失败率
            const failedOps = await database_unified_1.db.syncQueue
                .where('entity')
                .equals(operation.entity)
                .filter(op => op.status === SyncQueueStatus.FAILED)
                .toArray();
            const failureRate = failedOps.length / Math.max(1, await database_unified_1.db.syncQueue.count());
            if (failureRate > 0.3) {
                return 'medium'; // 历史失败率较高
            }
            return 'low';
        }
        catch (error) {
            console.error('Failed to assess conflict risk:', error);
            return 'medium'; // 默认中等风险
        }
    }
    /**
     * 获取队列性能指标 - 增强版
     */
    async getQueuePerformanceMetrics() {
        try {
            const stats = await this.getQueueStats();
            // 计算吞吐量（每分钟处理的操作数）
            const recentCompleted = await database_unified_1.db.syncQueue
                .where('status')
                .equals(SyncQueueStatus.COMPLETED)
                .filter(op => {
                const timeDiff = Date.now() - op.timestamp.getTime();
                return timeDiff < 60 * 1000; // 最近1分钟
            })
                .toArray();
            const throughput = recentCompleted.length;
            // 计算平均处理时间
            const processingTimes = await Promise.all(recentCompleted.map(async (op) => {
                const updatedOp = await database_unified_1.db.syncQueue.get(op.id);
                return updatedOp?.processingTime || 0;
            }));
            const averageProcessingTime = processingTimes.length > 0
                ? processingTimes.reduce((sum, time) => sum + time, 0) / processingTimes.length
                : 0;
            // 计算成功率
            const totalRecent = await database_unified_1.db.syncQueue
                .filter(op => {
                const timeDiff = Date.now() - op.timestamp.getTime();
                return timeDiff < 60 * 1000;
            })
                .toArray();
            const successRate = totalRecent.length > 0
                ? recentCompleted.length / totalRecent.length
                : 1;
            // 计算队列效率（0-1）
            const queueEfficiency = this.calculateQueueEfficiency(stats, throughput);
            // 计算冲突解决率
            const conflictResolutionRate = await this.calculateConflictResolutionRate();
            // 计算资源利用率
            const resourceUtilization = this.calculateResourceUtilization(stats, throughput);
            // 瓶颈分析
            const bottleneckAnalysis = this.analyzeBottlenecks(stats, throughput, averageProcessingTime);
            // 预测性分析
            const predictiveInsights = await this.generatePredictiveInsights(stats, throughput);
            return {
                throughput,
                averageProcessingTime,
                successRate,
                queueEfficiency,
                bottleneckAnalysis,
                conflictResolutionRate,
                resourceUtilization,
                predictiveInsights
            };
        }
        catch (error) {
            console.error('Failed to get queue performance metrics:', error);
            return {
                throughput: 0,
                averageProcessingTime: 0,
                successRate: 0,
                queueEfficiency: 0,
                bottleneckAnalysis: ['Unable to analyze performance'],
                conflictResolutionRate: 0,
                resourceUtilization: 0,
                predictiveInsights: {
                    predictedLoad: 0,
                    recommendedActions: ['Enable performance monitoring'],
                    riskAssessment: 'medium'
                }
            };
        }
    }
    /**
     * 计算冲突解决率
     */
    async calculateConflictResolutionRate() {
        try {
            const recentOperations = await database_unified_1.db.syncQueue
                .filter(op => {
                const timeDiff = Date.now() - op.timestamp.getTime();
                return timeDiff < 30 * 60 * 1000; // 最近30分钟
            })
                .toArray();
            if (recentOperations.length === 0)
                return 1;
            const resolvedCount = recentOperations.filter(op => op.status === 'completed' && op.error === null).length;
            return resolvedCount / recentOperations.length;
        }
        catch (error) {
            console.error('Failed to calculate conflict resolution rate:', error);
            return 0;
        }
    }
    /**
     * 计算资源利用率
     */
    calculateResourceUtilization(stats, throughput) {
        // 基于队列状态和吞吐量计算资源利用率
        let utilization = 0.3; // 基础利用率
        // 根据待处理操作数量增加利用率
        if (stats.totalOperations > 500)
            utilization += 0.4;
        else if (stats.totalOperations > 200)
            utilization += 0.2;
        else if (stats.totalOperations > 50)
            utilization += 0.1;
        // 根据吞吐量调整
        if (throughput > 15)
            utilization += 0.2;
        else if (throughput > 8)
            utilization += 0.1;
        // 根据失败率调整
        const failureRate = stats.byStatus[SyncQueueStatus.FAILED] / Math.max(1, stats.totalOperations);
        if (failureRate > 0.2)
            utilization -= 0.1;
        return Math.max(0, Math.min(1, utilization));
    }
    /**
     * 生成预测性分析
     */
    async generatePredictiveInsights(stats, currentThroughput) {
        const recommendedActions = [];
        let riskAssessment = 'low';
        // 基于历史数据预测负载
        const predictedLoad = await this.predictFutureLoad(stats, currentThroughput);
        // 分析趋势并提供建议
        if (predictedLoad > 1000) {
            recommendedActions.push('Consider increasing batch size and concurrency');
            riskAssessment = 'high';
        }
        else if (predictedLoad > 500) {
            recommendedActions.push('Monitor queue growth closely');
            recommendedActions.push('Consider enabling aggressive cleanup');
            riskAssessment = 'medium';
        }
        // 分析性能趋势
        if (currentThroughput < 5) {
            recommendedActions.push('Investigate low throughput causes');
            recommendedActions.push('Check network connectivity');
        }
        // 分析失败率趋势
        const failureRate = stats.byStatus[SyncQueueStatus.FAILED] / Math.max(1, stats.totalOperations);
        if (failureRate > 0.15) {
            recommendedActions.push('Review and optimize conflict resolution strategies');
            recommendedActions.push('Consider reducing retry delays for failed operations');
        }
        // 分析队列年龄
        if (stats.oldestOperation) {
            const oldestAge = Date.now() - stats.oldestOperation.getTime();
            if (oldestAge > 30 * 60 * 1000) { // 30分钟
                recommendedActions.push('Process aged operations urgently');
                recommendedActions.push('Consider priority escalation');
            }
        }
        return {
            predictedLoad,
            recommendedActions,
            riskAssessment
        };
    }
    /**
     * 预测未来负载
     */
    async predictFutureLoad(stats, currentThroughput) {
        try {
            // 获取最近1小时的操作数据
            const hourAgo = new Date(Date.now() - 60 * 60 * 1000);
            const recentOperations = await database_unified_1.db.syncQueue
                .where('timestamp')
                .above(hourAgo)
                .toArray();
            if (recentOperations.length === 0)
                return currentThroughput * 2;
            // 计算增长率
            const growthRate = this.calculateGrowthRate(recentOperations);
            // 预测未来1小时的负载
            const predictedLoad = stats.totalOperations * (1 + growthRate);
            return Math.max(currentThroughput * 2, predictedLoad);
        }
        catch (error) {
            console.error('Failed to predict future load:', error);
            return currentThroughput * 2;
        }
    }
    /**
     * 计算增长率
     */
    calculateGrowthRate(operations) {
        if (operations.length < 2)
            return 0.1; // 默认10%增长
        // 按时间分组
        const timeGroups = new Map();
        operations.forEach(op => {
            const timeSlot = Math.floor(op.timestamp.getTime() / (10 * 60 * 1000)); // 10分钟间隔
            timeGroups.set(timeSlot, (timeGroups.get(timeSlot) || 0) + 1);
        });
        const timeSlots = Array.from(timeGroups.keys()).sort();
        if (timeSlots.length < 2)
            return 0.1;
        // 计算增长率
        const firstHalf = timeSlots.slice(0, Math.floor(timeSlots.length / 2));
        const secondHalf = timeSlots.slice(Math.floor(timeSlots.length / 2));
        const firstHalfAvg = firstHalf.reduce((sum, slot) => sum + (timeGroups.get(slot) || 0), 0) / firstHalf.length;
        const secondHalfAvg = secondHalf.reduce((sum, slot) => sum + (timeGroups.get(slot) || 0), 0) / secondHalf.length;
        if (firstHalfAvg === 0)
            return 0.1;
        return Math.max(-0.5, Math.min(2, (secondHalfAvg - firstHalfAvg) / firstHalfAvg));
    }
    /**
     * 计算队列效率
     */
    calculateQueueEfficiency(stats, throughput) {
        const { totalOperations, byStatus } = stats;
        // 基础效率分数
        let efficiency = 0.5;
        // 根据待处理操作数量调整
        if (totalOperations < 100)
            efficiency += 0.3;
        else if (totalOperations < 500)
            efficiency += 0.2;
        else if (totalOperations < 1000)
            efficiency += 0.1;
        // 根据失败率调整
        const failureRate = byStatus[SyncQueueStatus.FAILED] / Math.max(1, totalOperations);
        efficiency -= failureRate * 0.5;
        // 根据吞吐量调整
        if (throughput > 20)
            efficiency += 0.2;
        else if (throughput > 10)
            efficiency += 0.1;
        return Math.max(0, Math.min(1, efficiency));
    }
    /**
     * 分析瓶颈
     */
    analyzeBottlenecks(stats, throughput, avgProcessingTime) {
        const bottlenecks = [];
        if (stats.totalOperations > 1000) {
            bottlenecks.push('Queue backlog too large');
        }
        if (throughput < 5) {
            bottlenecks.push('Low throughput detected');
        }
        if (avgProcessingTime > 5000) {
            bottlenecks.push('High processing time');
        }
        const failureRate = stats.byStatus[SyncQueueStatus.FAILED] / Math.max(1, stats.totalOperations);
        if (failureRate > 0.2) {
            bottlenecks.push('High failure rate');
        }
        if (bottlenecks.length === 0) {
            bottlenecks.push('No significant bottlenecks detected');
        }
        return bottlenecks;
    }
}
exports.SyncQueueManager = SyncQueueManager;
// ============================================================================
// 导出单例实例
// ============================================================================
exports.syncQueueManager = new SyncQueueManager();
// ============================================================================
// 便利方法导出
// ============================================================================
const enqueueSyncOperation = (operation) => exports.syncQueueManager.enqueueOperation(operation);
exports.enqueueSyncOperation = enqueueSyncOperation;
const enqueueSyncBatch = (operations) => exports.syncQueueManager.enqueueBatch(operations);
exports.enqueueSyncBatch = enqueueSyncBatch;
const getSyncQueueStats = () => exports.syncQueueManager.getQueueStats();
exports.getSyncQueueStats = getSyncQueueStats;
const getSyncOperations = (filters) => exports.syncQueueManager.getOperations(filters);
exports.getSyncOperations = getSyncOperations;
const cleanupSyncOperations = (olderThan) => exports.syncQueueManager.cleanupCompletedOperations(olderThan);
exports.cleanupSyncOperations = cleanupSyncOperations;
const retryFailedSyncOperations = () => exports.syncQueueManager.retryFailedOperations();
exports.retryFailedSyncOperations = retryFailedSyncOperations;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXHN5bmMtcXVldWUudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQUEseURBQTJEO0FBRTNELDZFQUF1RTtBQUV2RSwrRUFBK0U7QUFDL0UsV0FBVztBQUNYLCtFQUErRTtBQUUvRSxJQUFZLGVBTVg7QUFORCxXQUFZLGVBQWU7SUFDekIsc0NBQW1CLENBQUE7SUFDbkIsNENBQXlCLENBQUE7SUFDekIsMENBQXVCLENBQUE7SUFDdkIsb0NBQWlCLENBQUE7SUFDakIsd0NBQXFCLENBQUE7QUFDdkIsQ0FBQyxFQU5XLGVBQWUsK0JBQWYsZUFBZSxRQU0xQjtBQXlDRCwrRUFBK0U7QUFDL0UsVUFBVTtBQUNWLCtFQUErRTtBQUUvRSxNQUFhLGdCQUFnQjtJQWdCM0I7UUFmUTs7OzttQkFBZSxLQUFLO1dBQUE7UUFDcEI7Ozs7O1dBQW1DO1FBQ25DOzs7O21CQUFjLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQztXQUFBLENBQUMsV0FBVztRQUMxRDs7OzttQkFBWSxFQUFFO1dBQUEsQ0FBQyxZQUFZO1FBQzNCOzs7O21CQUF1QixDQUFDO1dBQUEsQ0FBQyxXQUFXO1FBQ3BDOzs7O21CQUFpQixDQUFDO1dBQUE7UUFFMUIsUUFBUTtRQUNBOzs7O21CQUtKLEVBQUU7V0FBQTtRQUdKLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQTtRQUN0QixJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQTtJQUM1QixDQUFDO0lBRUQsK0VBQStFO0lBQy9FLFNBQVM7SUFDVCwrRUFBK0U7SUFFL0U7O09BRUc7SUFDSCxLQUFLLENBQUMsZ0JBQWdCLENBQUMsU0FBOEQ7UUFDbkYsTUFBTSxjQUFjLEdBQW1CO1lBQ3JDLEdBQUcsU0FBUztZQUNaLEVBQUUsRUFBRSxNQUFNLENBQUMsVUFBVSxFQUFFO1lBQ3ZCLE1BQU0sRUFBRSxlQUFlLENBQUMsT0FBTztZ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QUMsQ0FBQyxDQUFBO1FBQy9ELENBQUMsQ0FBQyxDQUFBO1FBRUYsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtRQUN0RCxJQUFJLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQztZQUFFLE9BQU8sR0FBRyxDQUFBO1FBRXBDLFFBQVE7UUFDUixNQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUN0RSxNQUFNLFVBQVUsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBRXBFLE1BQU0sWUFBWSxHQUFHLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLENBQUE7UUFDN0csTUFBTSxhQUFhLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQTtRQUVoSCxJQUFJLFlBQVksS0FBSyxDQUFDO1lBQUUsT0FBTyxHQUFHLENBQUE7UUFFbEMsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsYUFBYSxHQUFHLFlBQVksQ0FBQyxHQUFH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QkFBZ0IsQ0FBQyxhQUFhLEVBQUUsQ0FBQTtBQUExRCxRQUFBLGlCQUFpQixxQkFBeUM7QUFDaEUsTUFBTSxpQkFBaUIsR0FBRyxDQUFDLE9BQWEsRUFBRSxFQUFFLENBQUMsd0JBQWdCLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFBO0FBQTlFLFFBQUEsaUJBQWlCLHFCQUE2RDtBQUNwRixNQUFNLHFCQUFxQixHQUFHLENBQUMsU0FBa0IsRUFBRSxFQUFFLENBQUMsd0JBQWdCLENBQUMsMEJBQTBCLENBQUMsU0FBUyxDQUFDLENBQUE7QUFBdEcsUUFBQSxxQkFBcUIseUJBQWlGO0FBQzVHLE1BQU0seUJBQXlCLEdBQUcsR0FBRyxFQUFFLENBQUMsd0JBQWdCLENBQUMscUJBQXFCLEVBQUUsQ0FBQTtBQUExRSxRQUFBLHlCQUF5Qiw2QkFBaUQiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXHN5bmMtcXVldWUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGIsIHR5cGUgU3luY09wZXJhdGlvbiB9IGZyb20gJy4vZGF0YWJhc2UtdW5pZmllZCdcbmltcG9ydCB7IGxvY2FsT3BlcmF0aW9uU2VydmljZSB9IGZyb20gJy4vbG9jYWwtb3BlcmF0aW9uJ1xuaW1wb3J0IHsgY29uZmxpY3RSZXNvbHV0aW9uRW5naW5lIH0gZnJvbSAnLi9jb25mbGljdC1yZXNvbHV0aW9uLWVuZ2luZSdcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g5ZCM5q2l6Zif5YiX54q25oCB5p6a5Li+XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBlbnVtIFN5bmNRdWV1ZVN0YXR1cyB7XG4gIFBFTkRJTkcgPSAncGVuZGluZycsXG4gIFBST0NFU1NJTkcgPSAncHJvY2Vzc2luZycsXG4gIENPTVBMRVRFRCA9ICdjb21wbGV0ZWQnLFxuICBGQUlMRUQgPSAnZmFpbGVkJyxcbiAgUkVUUllJTkcgPSAncmV0cnlpbmcnXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOmYn+WIl+aTjeS9nOaOpeWPo1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXVlT3BlcmF0aW9uIHtcbiAgaWQ6IHN0cmluZ1xuICB0eXBlOiAnY3JlYXRlJyB8ICd1cGRhdGUnIHwgJ2RlbGV0ZSdcbiAgZW50aXR5OiAnY2FyZCcgfCAnZm9sZGVyJyB8ICd0YWcnIHwgJ2ltYWdlJ1xuICBlbnRpdHlJZDogc3RyaW5nXG4gIHVzZXJJZD86IHN0cmluZ1xuICBkYXRhOiBhbnlcbiAgcHJpb3JpdHk6ICdoaWdoJyB8ICdub3JtYWwnIHwgJ2xvdydcbiAgdGltZXN0YW1wOiBEYXRlXG4gIHJldHJ5Q291bnQ6IG51bWJlclxuICBtYXhSZXRyaWVzOiBudW1iZXJcbiAgc3RhdHVzOiBTeW5jUXVldWVTdGF0dXNcbiAgZXJyb3I/OiBzdHJpbmdcbiAgZGVwZW5kZW5jaWVzPzogc3RyaW5nW10gLy8g5L6d6LWW55qE5pON5L2cSURcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCYXRjaFN5bmNSZXN1bHQge1xuICBiYXRjaElkOiBzdHJpbmdcbiAgb3BlcmF0aW9uczogbnVtYmVyXG4gIHN1Y2Nlc3NmdWw6IG51bWJlclxuICBmYWlsZWQ6IG51bWJlclxuICBlcnJvcnM6IHN0cmluZ1tdXG4gIGV4ZWN1dGlvblRpbWU6IG51bWJlclxuICB0aW1lc3RhbXA6IERhdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBRdWV1ZVN0YXRzIHtcbiAgdG90YWxPcGVyYXRpb25zOiBudW1iZXJcbiAgYnlTdGF0dXM6IFJlY29yZDxTeW5jUXVldWVTdGF0dXMsIG51bWJlcj5cbiAgYnlQcmlvcml0eTogUmVjb3JkPCdoaWdoJyB8ICdub3JtYWwnIHwgJ2xvdycsIG51bWJlcj5cbiAgYnlFbnRpdHk6IFJlY29yZDwnY2FyZCcgfCAnZm9sZGVyJyB8ICd0YWcnIHwgJ2ltYWdlJywgbnVtYmVyPlxuICBhdmVyYWdlV2FpdFRpbWU6IG51bWJlclxuICBvbGRlc3RPcGVyYXRpb24/OiBEYXRlXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOWQjOatpemYn+WIl+euoeeQhuWZqFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY2xhc3MgU3luY1F1ZXVlTWFuYWdlciB7XG4gIHByaXZhdGUgaXNQcm9jZXNzaW5nID0gZmFsc2VcbiAgcHJpdmF0ZSBwcm9jZXNzaW5nSW50ZXJ2YWw/OiBOb2RlSlMuVGltZW91dFxuICBwcml2YXRlIHJldHJ5RGVsYXlzID0gWzEwMDAsIDIwMDAsIDUwMDAsIDEwMDAwLCAzMDAwMF0gLy8g5oyH5pWw6YCA6YG/6YeN6K+V5bu26L+fXG4gIHByaXZhdGUgYmF0Y2hTaXplID0gMTAgLy8g5q+P5om55aSE55CG55qE5pON5L2c5pWw6YePXG4gIHByaXZhdGUgbWF4Q29uY3VycmVudEJhdGNoZXMgPSAzIC8vIOacgOWkp+W5tuWPkeaJueWkhOeQhuaVsFxuICBwcml2YXRlIGN1cnJlbnRCYXRjaGVzID0gMFxuICBcbiAgLy8g5LqL5Lu255uR5ZCs5ZmoXG4gIHByaXZhdGUgbGlzdGVuZXJzOiB7XG4gICAgb25PcGVyYXRpb25Db21wbGV0ZT86IChvcGVyYXRpb246IFF1ZXVlT3BlcmF0aW9uLCBzdWNjZXNzOiBib29sZWFuKSA9PiB2b2lkXG4gICAgb25CYXRjaENvbXBsZXRlPzogKHJlc3VsdDogQmF0Y2hTeW5jUmVzdWx0KSA9PiB2b2lkXG4gICAgb25RdWV1ZUVycm9yPzogKGVycm9yOiBFcnJvcikgPT4gdm9pZFxuICAgIG9uU3RhdHVzQ2hhbmdlPzogKHN0YXRzOiBRdWV1ZVN0YXRzKSA9PiB2b2lkXG4gIH0gPSB7fVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZVF1ZXVlKClcbiAgICB0aGlzLnN0YXJ0UXVldWVQcm9jZXNzb3IoKVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDmoLjlv4PpmJ/liJfmk43kvZxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDmt7vliqDmk43kvZzliLDlkIzmraXpmJ/liJdcbiAgICovXG4gIGFzeW5jIGVucXVldWVPcGVyYXRpb24ob3BlcmF0aW9uOiBPbWl0PFF1ZXVlT3BlcmF0aW9uLCAnaWQnIHwgJ3N0YXR1cycgfCAndGltZXN0YW1wJz4pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHF1ZXVlT3BlcmF0aW9uOiBRdWV1ZU9wZXJhdGlvbiA9IHtcbiAgICAgIC4uLm9wZXJhdGlvbixcbiAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgICAgc3RhdHVzOiBTeW5jUXVldWVTdGF0dXMuUEVORElORyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyDmo4Dmn6Xkvp3otZblhbPns7tcbiAgICAgIGlmIChvcGVyYXRpb24uZGVwZW5kZW5jaWVzICYmIG9wZXJhdGlvbi5kZXBlbmRlbmNpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBhd2FpdCB0aGlzLnZhbGlkYXRlRGVwZW5kZW5jaWVzKG9wZXJhdGlvbi5kZXBlbmRlbmNpZXMpXG4gICAgICB9XG5cbiAgICAgIGF3YWl0IGRiLnN5bmNRdWV1ZS5hZGQoe1xuICAgICAgICBpZDogcXVldWVPcGVyYXRpb24uaWQsXG4gICAgICAgIHR5cGU6IG9wZXJhdGlvbi50eXBlLFxuICAgICAgICBlbnRpdHk6IG9wZXJhdGlvbi5lbnRpdHksXG4gICAgICAgIGVudGl0eUlkOiBvcGVyYXRpb24uZW50aXR5SWQsXG4gICAgICAgIHVzZXJJZDogb3BlcmF0aW9uLnVzZXJJZCxcbiAgICAgICAgZGF0YTogb3BlcmF0aW9uLmRhdGEsXG4gICAgICAgIHByaW9yaXR5OiBvcGVyYXRpb24ucHJpb3JpdHksXG4gICAgICAgIHRpbWVzdGFtcDogcXVldWVPcGVyYXRpb24udGltZXN0YW1wLFxuICAgICAgICByZXRyeUNvdW50OiBvcGVyYXRpb24ucmV0cnlDb3VudCxcbiAgICAgICAgbWF4UmV0cmllczogb3BlcmF0aW9uLm1heFJldHJpZXMsXG4gICAgICAgIGVycm9yOiBvcGVyYXRpb24uZXJyb3JcbiAgICAgIH0pXG5cbiAgICAgIHRoaXMubm90aWZ5U3RhdHVzQ2hhbmdlKClcbiAgICAgIFxuICAgICAgLy8g5aaC5p6c5pyJ6auY5LyY5YWI57qn5pON5L2c77yM56uL5Y2z6Kem5Y+R5aSE55CGXG4gICAgICBpZiAob3BlcmF0aW9uLnByaW9yaXR5ID09PSAnaGlnaCcgJiYgIXRoaXMuaXNQcm9jZXNzaW5nKSB7XG4gICAgICAgIHRoaXMucHJvY2Vzc05leHRCYXRjaCgpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBxdWV1ZU9wZXJhdGlvbi5pZFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZW5xdWV1ZSBvcGVyYXRpb246JywgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmibnph4/mt7vliqDmk43kvZzliLDlkIzmraXpmJ/liJdcbiAgICovXG4gIGFzeW5jIGVucXVldWVCYXRjaChvcGVyYXRpb25zOiBPbWl0PFF1ZXVlT3BlcmF0aW9uLCAnaWQnIHwgJ3N0YXR1cycgfCAndGltZXN0YW1wJz5bXSk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCBxdWV1ZU9wZXJhdGlvbnMgPSBvcGVyYXRpb25zLm1hcChvcCA9PiAoe1xuICAgICAgLi4ub3AsXG4gICAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcbiAgICAgIHN0YXR1czogU3luY1F1ZXVlU3RhdHVzLlBFTkRJTkcgYXMgU3luY1F1ZXVlU3RhdHVzLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgfSkpXG5cbiAgICB0cnkge1xuICAgICAgLy8g6aqM6K+B5omA5pyJ5pON5L2c55qE5L6d6LWW5YWz57O7XG4gICAgICBjb25zdCBhbGxEZXBlbmRlbmNpZXMgPSBxdWV1ZU9wZXJhdGlvbnNcbiAgICAgICAgLmZpbHRlcihvcCA9PiBvcC5kZXBlbmRlbmNpZXMgJiYgb3AuZGVwZW5kZW5jaWVzLmxlbmd0aCA+IDApXG4gICAgICAgIC5mbGF0TWFwKG9wID0+IG9wLmRlcGVuZGVuY2llcyEpXG4gICAgICBcbiAgICAgIGlmIChhbGxEZXBlbmRlbmNpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBhd2FpdCB0aGlzLnZhbGlkYXRlRGVwZW5kZW5jaWVzKGFsbERlcGVuZGVuY2llcylcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc3luY09wZXJhdGlvbnMgPSBxdWV1ZU9wZXJhdGlvbnMubWFwKG9wID0+ICh7XG4gICAgICAgIGlkOiBvcC5pZCxcbiAgICAgICAgdHlwZTogb3AudHlwZSxcbiAgICAgICAgZW50aXR5OiBvcC5lbnRpdHksXG4gICAgICAgIGVudGl0eUlkOiBvcC5lbnRpdHlJZCxcbiAgICAgICAgdXNlcklkOiBvcC51c2VySWQsXG4gICAgICAgIGRhdGE6IG9wLmRhdGEsXG4gICAgICAgIHByaW9yaXR5OiBvcC5wcmlvcml0eSxcbiAgICAgICAgdGltZXN0YW1wOiBvcC50aW1lc3RhbXAsXG4gICAgICAgIHJldHJ5Q291bnQ6IG9wLnJldHJ5Q291bnQsXG4gICAgICAgIG1heFJldHJpZXM6IG9wLm1heFJldHJpZXMsXG4gICAgICAgIGVycm9yOiBvcC5lcnJvclxuICAgICAgfSkpXG5cbiAgICAgIGF3YWl0IGRiLnN5bmNRdWV1ZS5idWxrQWRkKHN5bmNPcGVyYXRpb25zKVxuICAgICAgdGhpcy5ub3RpZnlTdGF0dXNDaGFuZ2UoKVxuXG4gICAgICAvLyDov5Tlm57mk43kvZxJROWIl+ihqFxuICAgICAgcmV0dXJuIHF1ZXVlT3BlcmF0aW9ucy5tYXAob3AgPT4gb3AuaWQpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBlbnF1ZXVlIGJhdGNoIG9wZXJhdGlvbnM6JywgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDku47pmJ/liJfkuK3np7vpmaTmk43kvZxcbiAgICovXG4gIGFzeW5jIGRlcXVldWVPcGVyYXRpb24ob3BlcmF0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBkZWxldGVkID0gYXdhaXQgZGIuc3luY1F1ZXVlLndoZXJlKCdpZCcpLmVxdWFscyhvcGVyYXRpb25JZCkuZGVsZXRlKClcbiAgICAgIHRoaXMubm90aWZ5U3RhdHVzQ2hhbmdlKClcbiAgICAgIHJldHVybiBkZWxldGVkID4gMFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZGVxdWV1ZSBvcGVyYXRpb246JywgZXJyb3IpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5pON5L2c54q25oCBXG4gICAqL1xuICBhc3luYyB1cGRhdGVPcGVyYXRpb25TdGF0dXMoXG4gICAgb3BlcmF0aW9uSWQ6IHN0cmluZywgXG4gICAgc3RhdHVzOiBTeW5jUXVldWVTdGF0dXMsIFxuICAgIGVycm9yPzogc3RyaW5nXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBkYi5zeW5jUXVldWUud2hlcmUoJ2lkJykuZXF1YWxzKG9wZXJhdGlvbklkKS5tb2RpZnkoe1xuICAgICAgICBzdGF0dXMsXG4gICAgICAgIGVycm9yLFxuICAgICAgICAuLi4oc3RhdHVzID09PSBTeW5jUXVldWVTdGF0dXMuUFJPQ0VTU0lORyA/IHsgcmV0cnlDb3VudDogRGV4aWUuY3VycmVudFRyYW5zYWN0aW9uPy50YWJsZSgnc3luY1F1ZXVlJykuZ2V0KG9wZXJhdGlvbklkKS50aGVuKG9wID0+IChvcD8ucmV0cnlDb3VudCB8fCAwKSArIDEpIH0gOiB7fSlcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHRoaXMubm90aWZ5U3RhdHVzQ2hhbmdlKClcbiAgICAgIFxuICAgICAgLy8g6YCa55+l5pON5L2c5a6M5oiQXG4gICAgICBjb25zdCBvcGVyYXRpb24gPSBhd2FpdCBkYi5zeW5jUXVldWUuZ2V0KG9wZXJhdGlvbklkKVxuICAgICAgaWYgKG9wZXJhdGlvbiAmJiB0aGlzLmxpc3RlbmVycy5vbk9wZXJhdGlvbkNvbXBsZXRlKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzLm9uT3BlcmF0aW9uQ29tcGxldGUoXG4gICAgICAgICAgdGhpcy5jb252ZXJ0U3luY09wZXJhdGlvblRvUXVldWVPcGVyYXRpb24ob3BlcmF0aW9uKSxcbiAgICAgICAgICBzdGF0dXMgPT09IFN5bmNRdWV1ZVN0YXR1cy5DT01QTEVURURcbiAgICAgICAgKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gdXBkYXRlIG9wZXJhdGlvbiBzdGF0dXM6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDpmJ/liJflpITnkIbpgLvovpFcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDlpITnkIbkuIvkuIDmibnmk43kvZxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcHJvY2Vzc05leHRCYXRjaCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5pc1Byb2Nlc3NpbmcgfHwgdGhpcy5jdXJyZW50QmF0Y2hlcyA+PSB0aGlzLm1heENvbmN1cnJlbnRCYXRjaGVzKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IHRydWVcbiAgICB0aGlzLmN1cnJlbnRCYXRjaGVzKytcblxuICAgIHRyeSB7XG4gICAgICAvLyDojrflj5bkuIvkuIDmibnlvoXlpITnkIbmk43kvZxcbiAgICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBhd2FpdCB0aGlzLmdldE5leHRCYXRjaCgpXG4gICAgICBcbiAgICAgIGlmIChvcGVyYXRpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IGZhbHNlXG4gICAgICAgIHRoaXMuY3VycmVudEJhdGNoZXMtLVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgLy8g5qCH6K6w5pON5L2c5Li65aSE55CG5LitXG4gICAgICBjb25zdCBvcGVyYXRpb25JZHMgPSBvcGVyYXRpb25zLm1hcChvcCA9PiBvcC5pZClcbiAgICAgIGF3YWl0IHRoaXMubWFya09wZXJhdGlvbnNQcm9jZXNzaW5nKG9wZXJhdGlvbklkcylcblxuICAgICAgLy8g5aSE55CG5om55qyhXG4gICAgICBjb25zdCBiYXRjaFJlc3VsdCA9IGF3YWl0IHRoaXMucHJvY2Vzc0JhdGNoKG9wZXJhdGlvbnMpXG5cbiAgICAgIC8vIOmAmuefpeaJueWkhOeQhuWujOaIkFxuICAgICAgaWYgKHRoaXMubGlzdGVuZXJzLm9uQmF0Y2hDb21wbGV0ZSkge1xuICAgICAgICB0aGlzLmxpc3RlbmVycy5vbkJhdGNoQ29tcGxldGUoYmF0Y2hSZXN1bHQpXG4gICAgICB9XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBiYXRjaDonLCBlcnJvcilcbiAgICAgIGlmICh0aGlzLmxpc3RlbmVycy5vblF1ZXVlRXJyb3IpIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMub25RdWV1ZUVycm9yKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKSlcbiAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5pc1Byb2Nlc3NpbmcgPSBmYWxzZVxuICAgICAgdGhpcy5jdXJyZW50QmF0Y2hlcy0tXG4gICAgICBcbiAgICAgIC8vIOWmguaenOi/mOacieW+heWkhOeQhuaTjeS9nO+8jOe7p+e7reWkhOeQhlxuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnByb2Nlc3NOZXh0QmF0Y2goKSwgMTAwKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bkuIvkuIDmibnlvoXlpITnkIbmk43kvZxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0TmV4dEJhdGNoKCk6IFByb21pc2U8U3luY09wZXJhdGlvbltdPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOaMieS8mOWFiOe6p+WSjOaXtumXtOaOkuW6j+iOt+WPluaTjeS9nFxuICAgICAgcmV0dXJuIGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgICAud2hlcmUoJ3N0YXR1cycpXG4gICAgICAgIC5lcXVhbHMoJ3BlbmRpbmcnIGFzIGFueSlcbiAgICAgICAgLm9yZGVyQnkoJ3ByaW9yaXR5JykgLy8g6auY5LyY5YWI57qn5YWI5aSE55CGXG4gICAgICAgIC5yZXZlcnNlKClcbiAgICAgICAgLm9mZnNldCgwKVxuICAgICAgICAubGltaXQodGhpcy5iYXRjaFNpemUpXG4gICAgICAgIC50b0FycmF5KClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBuZXh0IGJhdGNoOicsIGVycm9yKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOagh+iusOaTjeS9nOS4uuWkhOeQhuS4rVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBtYXJrT3BlcmF0aW9uc1Byb2Nlc3Npbmcob3BlcmF0aW9uSWRzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgLndoZXJlKCdpZCcpXG4gICAgICAuYW55T2Yob3BlcmF0aW9uSWRzKVxuICAgICAgLm1vZGlmeSh7IHN0YXR1czogJ3Byb2Nlc3NpbmcnIGFzIGFueSB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuS4gOaJueWQjOatpeaTjeS9nFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzQmF0Y2gob3BlcmF0aW9uczogU3luY09wZXJhdGlvbltdKTogUHJvbWlzZTxCYXRjaFN5bmNSZXN1bHQ+IHtcbiAgICBjb25zdCBiYXRjaElkID0gY3J5cHRvLnJhbmRvbVVVSUQoKVxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpXG4gICAgY29uc3Qgc3VjY2Vzc2Z1bDogc3RyaW5nW10gPSBbXVxuICAgIGNvbnN0IGZhaWxlZDogc3RyaW5nW10gPSBbXVxuICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIOi/memHjOW6lOivpeiwg+eUqOWunumZheeahOWQjOatpeacjeWKoVxuICAgICAgLy8g5Li65LqG5ryU56S677yM5oiR5Lus5qih5ouf5ZCM5q2l6L+H56iLXG4gICAgICBmb3IgKGNvbnN0IG9wZXJhdGlvbiBvZiBvcGVyYXRpb25zKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IHRoaXMuZXhlY3V0ZVN5bmNPcGVyYXRpb24ob3BlcmF0aW9uKVxuICAgICAgICAgIFxuICAgICAgICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICAgICAgICBzdWNjZXNzZnVsLnB1c2gob3BlcmF0aW9uLmlkKVxuICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVPcGVyYXRpb25TdGF0dXMob3BlcmF0aW9uLmlkLCBTeW5jUXVldWVTdGF0dXMuQ09NUExFVEVEKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmYWlsZWQucHVzaChvcGVyYXRpb24uaWQpXG4gICAgICAgICAgICBlcnJvcnMucHVzaChgU3luYyBmYWlsZWQgZm9yIG9wZXJhdGlvbiAke29wZXJhdGlvbi5pZH1gKVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVPcGVyYXRpb25GYWlsdXJlKG9wZXJhdGlvbiwgJ1N5bmMgZXhlY3V0aW9uIGZhaWxlZCcpXG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGZhaWxlZC5wdXNoKG9wZXJhdGlvbi5pZClcbiAgICAgICAgICBjb25zdCBlcnJvck1zZyA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKVxuICAgICAgICAgIGVycm9ycy5wdXNoKGVycm9yTXNnKVxuICAgICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlT3BlcmF0aW9uRmFpbHVyZShvcGVyYXRpb24sIGVycm9yTXNnKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGV4ZWN1dGlvblRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBiYXRjaElkLFxuICAgICAgICBvcGVyYXRpb25zOiBvcGVyYXRpb25zLmxlbmd0aCxcbiAgICAgICAgc3VjY2Vzc2Z1bDogc3VjY2Vzc2Z1bC5sZW5ndGgsXG4gICAgICAgIGZhaWxlZDogZmFpbGVkLmxlbmd0aCxcbiAgICAgICAgZXJyb3JzLFxuICAgICAgICBleGVjdXRpb25UaW1lLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZXhlY3V0aW9uVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgICBjb25zdCBlcnJvck1zZyA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKVxuICAgICAgXG4gICAgICAvLyDmoIforrDmiYDmnInmk43kvZzkuLrlpLHotKVcbiAgICAgIGZvciAoY29uc3Qgb3BlcmF0aW9uIG9mIG9wZXJhdGlvbnMpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVPcGVyYXRpb25GYWlsdXJlKG9wZXJhdGlvbiwgZXJyb3JNc2cpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGJhdGNoSWQsXG4gICAgICAgIG9wZXJhdGlvbnM6IG9wZXJhdGlvbnMubGVuZ3RoLFxuICAgICAgICBzdWNjZXNzZnVsOiAwLFxuICAgICAgICBmYWlsZWQ6IG9wZXJhdGlvbnMubGVuZ3RoLFxuICAgICAgICBlcnJvcnM6IFtlcnJvck1zZ10sXG4gICAgICAgIGV4ZWN1dGlvblRpbWUsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmiafooYzljZXkuKrlkIzmraXmk43kvZwgLSDlop7lvLrniYjvvIzpm4bmiJDlhrLnqoHop6PlhrNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVN5bmNPcGVyYXRpb24ob3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOWcqOaJp+ihjOWJjei/m+ihjOWGsueqgemihOa1i+WSjOmihOmYslxuICAgICAgY29uc3QgY29uZmxpY3RBbmFseXNpcyA9IGF3YWl0IHRoaXMuYW5hbHl6ZU9wZXJhdGlvbkNvbmZsaWN0cyhvcGVyYXRpb24pXG4gICAgICBcbiAgICAgIGlmIChjb25mbGljdEFuYWx5c2lzLmhpZ2hSaXNrID4gMCkge1xuICAgICAgICBjb25zb2xlLndhcm4oYEhpZ2ggY29uZmxpY3QgcmlzayBkZXRlY3RlZCBmb3Igb3BlcmF0aW9uICR7b3BlcmF0aW9uLmlkfSwgYXBwbHlpbmcgY29uZmxpY3QgcmVzb2x1dGlvbmApXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmV4ZWN1dGVXaXRoQ29uZmxpY3RSZXNvbHV0aW9uKG9wZXJhdGlvbiwgY29uZmxpY3RBbmFseXNpcylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g5q2j5bi45omn6KGM5ZCM5q2l5pON5L2cXG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5wZXJmb3JtU3luY09wZXJhdGlvbihvcGVyYXRpb24pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFN5bmMgb3BlcmF0aW9uIGZhaWxlZCBmb3IgJHtvcGVyYXRpb24uaWR9OmAsIGVycm9yKVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICog5YiG5p6Q5pON5L2c5Yay56qB6aOO6ZmpXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGFuYWx5emVPcGVyYXRpb25Db25mbGljdHMob3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uKTogUHJvbWlzZTx7XG4gICAgaGlnaFJpc2s6IG51bWJlclxuICAgIG1lZGl1bVJpc2s6IG51bWJlclxuICAgIGxvd1Jpc2s6IG51bWJlclxuICAgIHJlY29tbWVuZGF0aW9uczogc3RyaW5nW11cbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDojrflj5blkIzkuIDlrp7kvZPnmoTmnIDov5Hmk43kvZxcbiAgICAgIGNvbnN0IHJlY2VudE9wZXJhdGlvbnMgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgICAgLndoZXJlKCdlbnRpdHlJZCcpXG4gICAgICAgIC5lcXVhbHMob3BlcmF0aW9uLmVudGl0eUlkKVxuICAgICAgICAuZmlsdGVyKG9wID0+IHtcbiAgICAgICAgICBjb25zdCB0aW1lRGlmZiA9IE1hdGguYWJzKG9wLnRpbWVzdGFtcC5nZXRUaW1lKCkgLSBvcGVyYXRpb24udGltZXN0YW1wLmdldFRpbWUoKSlcbiAgICAgICAgICByZXR1cm4gdGltZURpZmYgPCA1ICogNjAgKiAxMDAwICYmIG9wLmlkICE9PSBvcGVyYXRpb24uaWRcbiAgICAgICAgfSlcbiAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgXG4gICAgICBsZXQgaGlnaFJpc2sgPSAwXG4gICAgICBsZXQgbWVkaXVtUmlzayA9IDBcbiAgICAgIGxldCBsb3dSaXNrID0gMFxuICAgICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdXG4gICAgICBcbiAgICAgIC8vIOWIhuaekOW5tuWPkeaTjeS9nOmjjumZqVxuICAgICAgaWYgKHJlY2VudE9wZXJhdGlvbnMubGVuZ3RoID4gMikge1xuICAgICAgICBoaWdoUmlzaysrXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdNdWx0aXBsZSBjb25jdXJyZW50IG9wZXJhdGlvbnMgb24gc2FtZSBlbnRpdHknKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDliIbmnpDnlKjmiLfmk43kvZzpopHnjodcbiAgICAgIGNvbnN0IHVzZXJSZWNlbnRPcHMgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgICAgLndoZXJlKCd1c2VySWQnKVxuICAgICAgICAuZXF1YWxzKG9wZXJhdGlvbi51c2VySWQpXG4gICAgICAgIC5maWx0ZXIob3AgPT4ge1xuICAgICAgICAgIGNvbnN0IHRpbWVEaWZmID0gRGF0ZS5ub3coKSAtIG9wLnRpbWVzdGFtcC5nZXRUaW1lKClcbiAgICAgICAgICByZXR1cm4gdGltZURpZmYgPCA2MCAqIDEwMDBcbiAgICAgICAgfSlcbiAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgXG4gICAgICBpZiAodXNlclJlY2VudE9wcy5sZW5ndGggPiAxMCkge1xuICAgICAgICBoaWdoUmlzaysrXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdVc2VyIG9wZXJhdGluZyB0b28gZnJlcXVlbnRseScpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOWIhuaekOWOhuWPsuWksei0peeOh1xuICAgICAgY29uc3QgZmFpbGVkT3BzID0gYXdhaXQgZGIuc3luY1F1ZXVlXG4gICAgICAgIC53aGVyZSgnZW50aXR5JylcbiAgICAgICAgLmVxdWFscyhvcGVyYXRpb24uZW50aXR5KVxuICAgICAgICAuZmlsdGVyKG9wID0+IG9wLnN0YXR1cyA9PT0gJ2ZhaWxlZCcgYXMgYW55KVxuICAgICAgICAudG9BcnJheSgpXG4gICAgICBcbiAgICAgIGNvbnN0IGZhaWx1cmVSYXRlID0gZmFpbGVkT3BzLmxlbmd0aCAvIE1hdGgubWF4KDEsIGF3YWl0IGRiLnN5bmNRdWV1ZS5jb3VudCgpKVxuICAgICAgXG4gICAgICBpZiAoZmFpbHVyZVJhdGUgPiAwLjMpIHtcbiAgICAgICAgbWVkaXVtUmlzaysrXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBIaWdoIGZhaWx1cmUgcmF0ZSAoJHsoZmFpbHVyZVJhdGUgKiAxMDApLnRvRml4ZWQoMSl9JSkgZm9yIGVudGl0eSB0eXBlYClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g5qC55o2u5pON5L2c57G75Z6L5YiG5p6Q6aOO6ZmpXG4gICAgICBpZiAob3BlcmF0aW9uLnR5cGUgPT09ICdkZWxldGUnKSB7XG4gICAgICAgIG1lZGl1bVJpc2srK1xuICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnRGVsZXRlIG9wZXJhdGlvbnMgcmVxdWlyZSBleHRyYSBjYXV0aW9uJylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHsgaGlnaFJpc2ssIG1lZGl1bVJpc2ssIGxvd1Jpc2ssIHJlY29tbWVuZGF0aW9ucyB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBhbmFseXplIG9wZXJhdGlvbiBjb25mbGljdHM6JywgZXJyb3IpXG4gICAgICByZXR1cm4geyBoaWdoUmlzazogMCwgbWVkaXVtUmlzazogMSwgbG93UmlzazogMCwgcmVjb21tZW5kYXRpb25zOiBbJ1VuYWJsZSB0byBhbmFseXplIGNvbmZsaWN0cyddIH1cbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDluKblhrLnqoHop6PlhrPnmoTlkIzmraXmk43kvZzmiafooYxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVdpdGhDb25mbGljdFJlc29sdXRpb24oXG4gICAgb3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uLCBcbiAgICBjb25mbGljdEFuYWx5c2lzOiBhbnlcbiAgKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOaehOW7uuWGsueqgeS4iuS4i+aWh1xuICAgICAgY29uc3QgY29uZmxpY3RDb250ZXh0ID0ge1xuICAgICAgICB1c2VySWQ6IG9wZXJhdGlvbi51c2VySWQgfHwgJycsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgbmV0d29ya0luZm86IHsgZWZmZWN0aXZlVHlwZTogJzRnJyB9LCAvLyDnroDljJbnvZHnu5zkv6Hmga9cbiAgICAgICAgZGV2aWNlSW5mbzogeyBkZXZpY2VUeXBlOiAndW5rbm93bicgfSxcbiAgICAgICAgdXNlclByZWZlcmVuY2VzOiB7fSxcbiAgICAgICAgc3luY0hpc3Rvcnk6IFtdXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOiOt+WPluW9k+WJjeS6keerr+aVsOaNru+8iOaooeaLn++8iVxuICAgICAgY29uc3QgY2xvdWREYXRhID0gYXdhaXQgdGhpcy5mZXRjaENsb3VkRGF0YShvcGVyYXRpb24pXG4gICAgICBcbiAgICAgIC8vIOiOt+WPluacrOWcsOaVsOaNrlxuICAgICAgY29uc3QgbG9jYWxEYXRhID0gYXdhaXQgdGhpcy5mZXRjaExvY2FsRGF0YShvcGVyYXRpb24pXG4gICAgICBcbiAgICAgIC8vIOS9v+eUqOWGsueqgeino+WGs+W8leaTjuajgOa1i+WSjOino+WGs+WGsueqgVxuICAgICAgY29uc3QgY29uZmxpY3RzID0gYXdhaXQgY29uZmxpY3RSZXNvbHV0aW9uRW5naW5lLmRldGVjdEFsbENvbmZsaWN0cyhcbiAgICAgICAgbG9jYWxEYXRhLFxuICAgICAgICBjbG91ZERhdGEsXG4gICAgICAgIG9wZXJhdGlvbi5lbnRpdHksXG4gICAgICAgIG9wZXJhdGlvbi5lbnRpdHlJZCxcbiAgICAgICAgY29uZmxpY3RDb250ZXh0XG4gICAgICApXG4gICAgICBcbiAgICAgIGlmIChjb25mbGljdHMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zb2xlLmxvZyhgRGV0ZWN0ZWQgJHtjb25mbGljdHMubGVuZ3RofSBjb25mbGljdHMgZm9yIG9wZXJhdGlvbiAke29wZXJhdGlvbi5pZH1gKVxuICAgICAgICBcbiAgICAgICAgLy8g5bCd6K+V6Ieq5Yqo6Kej5Yaz5Yay56qBXG4gICAgICAgIGNvbnN0IHJlc29sdmVkQ29uZmxpY3RzID0gYXdhaXQgY29uZmxpY3RSZXNvbHV0aW9uRW5naW5lLnJlc29sdmVDb25mbGljdHMoXG4gICAgICAgICAgY29uZmxpY3RzLFxuICAgICAgICAgIGNvbmZsaWN0Q29udGV4dFxuICAgICAgICApXG4gICAgICAgIFxuICAgICAgICAvLyDmo4Dmn6XmmK/lkKbmiYDmnInlhrLnqoHpg73lt7Lop6PlhrNcbiAgICAgICAgY29uc3QgdW5yZXNvbHZlZENvbmZsaWN0cyA9IHJlc29sdmVkQ29uZmxpY3RzLmZpbHRlcihjID0+IGMucmVzb2x1dGlvbiA9PT0gJ21hbnVhbCcpXG4gICAgICAgIFxuICAgICAgICBpZiAodW5yZXNvbHZlZENvbmZsaWN0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGBVbmFibGUgdG8gYXV0by1yZXNvbHZlICR7dW5yZXNvbHZlZENvbmZsaWN0cy5sZW5ndGh9IGNvbmZsaWN0cyBmb3Igb3BlcmF0aW9uICR7b3BlcmF0aW9uLmlkfWApXG4gICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIOS9v+eUqOino+WGs+WQjueahOaVsOaNruaJp+ihjOWQjOatpVxuICAgICAgICBjb25zdCByZXNvbHZlZERhdGEgPSB0aGlzLmV4dHJhY3RSZXNvbHZlZERhdGEocmVzb2x2ZWRDb25mbGljdHMsIGxvY2FsRGF0YSwgY2xvdWREYXRhKVxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5wZXJmb3JtU3luY09wZXJhdGlvbih7IC4uLm9wZXJhdGlvbiwgZGF0YTogcmVzb2x2ZWREYXRhIH0pXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOaXoOWGsueqge+8jOato+W4uOaJp+ihjFxuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucGVyZm9ybVN5bmNPcGVyYXRpb24ob3BlcmF0aW9uKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBDb25mbGljdCByZXNvbHV0aW9uIGZhaWxlZCBmb3Igb3BlcmF0aW9uICR7b3BlcmF0aW9uLmlkfTpgLCBlcnJvcilcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIOaJp+ihjOWunumZheeahOWQjOatpeaTjeS9nFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBwZXJmb3JtU3luY09wZXJhdGlvbihvcGVyYXRpb246IFN5bmNPcGVyYXRpb24pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyDmqKHmi5/lrp7pmYXnmoTlkIzmraXpgLvovpFcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgTWF0aC5yYW5kb20oKSAqIDIwMCArIDEwMCkpXG4gICAgXG4gICAgLy8g5qC55o2u5pON5L2c57G75Z6L5omn6KGM55u45bqU55qE5ZCM5q2l6YC76L6RXG4gICAgc3dpdGNoIChvcGVyYXRpb24udHlwZSkge1xuICAgICAgY2FzZSAnY3JlYXRlJzpcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucGVyZm9ybUNyZWF0ZU9wZXJhdGlvbihvcGVyYXRpb24pXG4gICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5wZXJmb3JtVXBkYXRlT3BlcmF0aW9uKG9wZXJhdGlvbilcbiAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnBlcmZvcm1EZWxldGVPcGVyYXRpb24ob3BlcmF0aW9uKVxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY29uc29sZS53YXJuKGBVbmtub3duIG9wZXJhdGlvbiB0eXBlOiAke29wZXJhdGlvbi50eXBlfWApXG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIOiOt+WPluS6keerr+aVsOaNrlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaENsb3VkRGF0YShvcGVyYXRpb246IFN5bmNPcGVyYXRpb24pOiBQcm9taXNlPGFueT4ge1xuICAgIC8vIOaooeaLn+S7juS6keerr+iOt+WPluaVsOaNrlxuICAgIC8vIOWcqOWunumZheWunueOsOS4re+8jOi/memHjOS8muiwg+eUqFN1cGFiYXNlIEFQSVxuICAgIHJldHVybiB7XG4gICAgICBpZDogb3BlcmF0aW9uLmVudGl0eUlkLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB2ZXJzaW9uOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApXG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICog6I635Y+W5pys5Zyw5pWw5o2uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGZldGNoTG9jYWxEYXRhKG9wZXJhdGlvbjogU3luY09wZXJhdGlvbik6IFByb21pc2U8YW55PiB7XG4gICAgLy8g5qih5ouf5LuO5pys5Zyw5pWw5o2u5bqT6I635Y+W5pWw5o2uXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBvcGVyYXRpb24uZW50aXR5SWQsXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHZlcnNpb246IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCksXG4gICAgICAuLi5vcGVyYXRpb24uZGF0YVxuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIOaPkOWPluino+WGs+WQjueahOaVsOaNrlxuICAgKi9cbiAgcHJpdmF0ZSBleHRyYWN0UmVzb2x2ZWREYXRhKGNvbmZsaWN0czogYW55W10sIGxvY2FsRGF0YTogYW55LCBjbG91ZERhdGE6IGFueSk6IGFueSB7XG4gICAgLy8g566A5YyW55qE5pWw5o2u5o+Q5Y+W6YC76L6RXG4gICAgLy8g5Zyo5a6e6ZmF5a6e546w5Lit77yM6L+Z6YeM5Lya5qC55o2u5Yay56qB6Kej5Yaz57uT5p6c5ZCI5bm25pWw5o2uXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmxvY2FsRGF0YSxcbiAgICAgIHJlc29sdmVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGNvbmZsaWN0Q291bnQ6IGNvbmZsaWN0cy5sZW5ndGhcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDmiafooYzliJvlu7rmk43kvZxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcGVyZm9ybUNyZWF0ZU9wZXJhdGlvbihvcGVyYXRpb246IFN5bmNPcGVyYXRpb24pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyDmqKHmi5/liJvlu7rmk43kvZznmoTmiJDlip/njodcbiAgICBjb25zdCBzdWNjZXNzUmF0ZSA9IG9wZXJhdGlvbi5wcmlvcml0eSA9PT0gJ2hpZ2gnID8gMC45NSA6IDAuODVcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSA8IHN1Y2Nlc3NSYXRlXG4gIH1cbiAgXG4gIC8qKlxuICAgKiDmiafooYzmm7TmlrDmk43kvZxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcGVyZm9ybVVwZGF0ZU9wZXJhdGlvbihvcGVyYXRpb246IFN5bmNPcGVyYXRpb24pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyDmqKHmi5/mm7TmlrDmk43kvZznmoTmiJDlip/njodcbiAgICBjb25zdCBzdWNjZXNzUmF0ZSA9IG9wZXJhdGlvbi5wcmlvcml0eSA9PT0gJ2hpZ2gnID8gMC45MCA6IDAuODBcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSA8IHN1Y2Nlc3NSYXRlXG4gIH1cbiAgXG4gIC8qKlxuICAgKiDmiafooYzliKDpmaTmk43kvZxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcGVyZm9ybURlbGV0ZU9wZXJhdGlvbihvcGVyYXRpb246IFN5bmNPcGVyYXRpb24pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyDliKDpmaTmk43kvZzmiJDlip/njofovoPkvY7vvIzpnIDopoHmm7TosKjmhY5cbiAgICBjb25zdCBzdWNjZXNzUmF0ZSA9IG9wZXJhdGlvbi5wcmlvcml0eSA9PT0gJ2hpZ2gnID8gMC44NSA6IDAuNzVcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSA8IHN1Y2Nlc3NSYXRlXG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5pON5L2c5aSx6LSlXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZU9wZXJhdGlvbkZhaWx1cmUob3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uLCBlcnJvcjogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgbmV3UmV0cnlDb3VudCA9IG9wZXJhdGlvbi5yZXRyeUNvdW50ICsgMVxuICAgIFxuICAgIGlmIChuZXdSZXRyeUNvdW50ID49IG9wZXJhdGlvbi5tYXhSZXRyaWVzKSB7XG4gICAgICAvLyDovr7liLDmnIDlpKfph43or5XmrKHmlbDvvIzmoIforrDkuLrlpLHotKVcbiAgICAgIGF3YWl0IHRoaXMudXBkYXRlT3BlcmF0aW9uU3RhdHVzKG9wZXJhdGlvbi5pZCwgU3luY1F1ZXVlU3RhdHVzLkZBSUxFRCwgZXJyb3IpXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOiuoeeul+S4i+asoemHjeivleaXtumXtFxuICAgICAgY29uc3QgcmV0cnlEZWxheSA9IHRoaXMucmV0cnlEZWxheXNbTWF0aC5taW4obmV3UmV0cnlDb3VudCAtIDEsIHRoaXMucmV0cnlEZWxheXMubGVuZ3RoIC0gMSldXG4gICAgICBcbiAgICAgIC8vIOagh+iusOS4uumHjeivleS4re+8jOW5tuiuvue9ruW7tui/n1xuICAgICAgYXdhaXQgZGIuc3luY1F1ZXVlLndoZXJlKCdpZCcpLmVxdWFscyhvcGVyYXRpb24uaWQpLm1vZGlmeSh7XG4gICAgICAgIHJldHJ5Q291bnQ6IG5ld1JldHJ5Q291bnQsXG4gICAgICAgIHN0YXR1czogJ3JldHJ5aW5nJyBhcyBhbnksXG4gICAgICAgIGVycm9yLFxuICAgICAgICAvLyDlj6/ku6Xmt7vliqDkuIvmrKHph43or5Xml7bpl7TlrZfmrrVcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIC8vIOW7tui/n+WQjumHjeaWsOWKoOWFpemYn+WIl1xuICAgICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IGRiLnN5bmNRdWV1ZS53aGVyZSgnaWQnKS5lcXVhbHMob3BlcmF0aW9uLmlkKS5tb2RpZnkoe1xuICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnIGFzIGFueVxuICAgICAgICB9KVxuICAgICAgICB0aGlzLm5vdGlmeVN0YXR1c0NoYW5nZSgpXG4gICAgICB9LCByZXRyeURlbGF5KVxuICAgIH1cbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g5L6d6LWW5YWz57O7566h55CGXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog6aqM6K+B5pON5L2c5L6d6LWW5YWz57O7XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlRGVwZW5kZW5jaWVzKGRlcGVuZGVuY3lJZHM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcGVuZGluZ0RlcGVuZGVuY2llcyA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgLndoZXJlKCdpZCcpXG4gICAgICAuYW55T2YoZGVwZW5kZW5jeUlkcylcbiAgICAgIC5hbmQob3AgPT4gb3Auc3RhdHVzID09PSAncGVuZGluZycgfHwgb3Auc3RhdHVzID09PSAncHJvY2Vzc2luZycpXG4gICAgICAuY291bnQoKVxuXG4gICAgaWYgKHBlbmRpbmdEZXBlbmRlbmNpZXMgPiAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBlbnF1ZXVlIG9wZXJhdGlvbjogJHtwZW5kaW5nRGVwZW5kZW5jaWVzfSBkZXBlbmRlbmNpZXMgYXJlIHN0aWxsIHBlbmRpbmdgKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmo4Dmn6Xmk43kvZzmmK/lkKblj6/ku6XmiafooYzvvIjmiYDmnInkvp3otZblt7LlrozmiJDvvIlcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY2FuRXhlY3V0ZU9wZXJhdGlvbihvcGVyYXRpb246IFF1ZXVlT3BlcmF0aW9uKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCFvcGVyYXRpb24uZGVwZW5kZW5jaWVzIHx8IG9wZXJhdGlvbi5kZXBlbmRlbmNpZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIGNvbnN0IGRlcGVuZGVuY3lTdGF0dXNlcyA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgLndoZXJlKCdpZCcpXG4gICAgICAuYW55T2Yob3BlcmF0aW9uLmRlcGVuZGVuY2llcylcbiAgICAgIC50b0FycmF5KClcblxuICAgIHJldHVybiBkZXBlbmRlbmN5U3RhdHVzZXMuZXZlcnkoZGVwID0+IGRlcC5zdGF0dXMgPT09ICdjb21wbGV0ZWQnKVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDpmJ/liJfnrqHnkIblkoznm5HmjqdcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDojrflj5bpmJ/liJfnu5/orqHkv6Hmga9cbiAgICovXG4gIGFzeW5jIGdldFF1ZXVlU3RhdHMoKTogUHJvbWlzZTxRdWV1ZVN0YXRzPiB7XG4gICAgY29uc3QgYWxsT3BlcmF0aW9ucyA9IGF3YWl0IGRiLnN5bmNRdWV1ZS50b0FycmF5KClcbiAgICBcbiAgICBjb25zdCBzdGF0czogUXVldWVTdGF0cyA9IHtcbiAgICAgIHRvdGFsT3BlcmF0aW9uczogYWxsT3BlcmF0aW9ucy5sZW5ndGgsXG4gICAgICBieVN0YXR1czoge1xuICAgICAgICBbU3luY1F1ZXVlU3RhdHVzLlBFTkRJTkddOiAwLFxuICAgICAgICBbU3luY1F1ZXVlU3RhdHVzLlBST0NFU1NJTkddOiAwLFxuICAgICAgICBbU3luY1F1ZXVlU3RhdHVzLkNPTVBMRVRFRF06IDAsXG4gICAgICAgIFtTeW5jUXVldWVTdGF0dXMuRkFJTEVEXTogMCxcbiAgICAgICAgW1N5bmNRdWV1ZVN0YXR1cy5SRVRSWUlOR106IDBcbiAgICAgIH0sXG4gICAgICBieVByaW9yaXR5OiB7XG4gICAgICAgIGhpZ2g6IDAsXG4gICAgICAgIG5vcm1hbDogMCxcbiAgICAgICAgbG93OiAwXG4gICAgICB9LFxuICAgICAgYnlFbnRpdHk6IHtcbiAgICAgICAgY2FyZDogMCxcbiAgICAgICAgZm9sZGVyOiAwLFxuICAgICAgICB0YWc6IDAsXG4gICAgICAgIGltYWdlOiAwXG4gICAgICB9LFxuICAgICAgYXZlcmFnZVdhaXRUaW1lOiAwXG4gICAgfVxuXG4gICAgLy8g57uf6K6h5ZCE57G75Yir5pWw6YePXG4gICAgYWxsT3BlcmF0aW9ucy5mb3JFYWNoKG9wID0+IHtcbiAgICAgIHN0YXRzLmJ5U3RhdHVzW29wLnN0YXR1c10rK1xuICAgICAgc3RhdHMuYnlQcmlvcml0eVtvcC5wcmlvcml0eV0rK1xuICAgICAgc3RhdHMuYnlFbnRpdHlbb3AuZW50aXR5XSsrXG4gICAgfSlcblxuICAgIC8vIOiuoeeul+W5s+Wdh+etieW+heaXtumXtFxuICAgIGNvbnN0IHBlbmRpbmdPcGVyYXRpb25zID0gYWxsT3BlcmF0aW9ucy5maWx0ZXIob3AgPT4gXG4gICAgICBvcC5zdGF0dXMgPT09IFN5bmNRdWV1ZVN0YXR1cy5QRU5ESU5HIHx8IG9wLnN0YXR1cyA9PT0gU3luY1F1ZXVlU3RhdHVzLlJFVFJZSU5HXG4gICAgKVxuICAgIFxuICAgIGlmIChwZW5kaW5nT3BlcmF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpXG4gICAgICBjb25zdCB0b3RhbFdhaXRUaW1lID0gcGVuZGluZ09wZXJhdGlvbnMucmVkdWNlKChzdW0sIG9wKSA9PiB7XG4gICAgICAgIHJldHVybiBzdW0gKyAobm93IC0gbmV3IERhdGUob3AudGltZXN0YW1wKS5nZXRUaW1lKCkpXG4gICAgICB9LCAwKVxuICAgICAgc3RhdHMuYXZlcmFnZVdhaXRUaW1lID0gdG90YWxXYWl0VGltZSAvIHBlbmRpbmdPcGVyYXRpb25zLmxlbmd0aFxuICAgIH1cblxuICAgIC8vIOaJvuWIsOacgOaXp+eahOaTjeS9nFxuICAgIGNvbnN0IG9sZGVzdCA9IGFsbE9wZXJhdGlvbnNcbiAgICAgIC5maWx0ZXIob3AgPT4gb3Auc3RhdHVzID09PSBTeW5jUXVldWVTdGF0dXMuUEVORElORylcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShhLnRpbWVzdGFtcCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYi50aW1lc3RhbXApLmdldFRpbWUoKSlbMF1cbiAgICBcbiAgICBpZiAob2xkZXN0KSB7XG4gICAgICBzdGF0cy5vbGRlc3RPcGVyYXRpb24gPSBuZXcgRGF0ZShvbGRlc3QudGltZXN0YW1wKVxuICAgIH1cblxuICAgIHJldHVybiBzdGF0c1xuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhuWujOaIkOeahOaTjeS9nFxuICAgKi9cbiAgYXN5bmMgY2xlYW51cENvbXBsZXRlZE9wZXJhdGlvbnMob2xkZXJUaGFuOiBudW1iZXIgPSAyNCAqIDYwICogNjAgKiAxMDAwKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCBjdXRvZmZEYXRlID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIG9sZGVyVGhhbilcbiAgICBcbiAgICBjb25zdCBkZWxldGVkID0gYXdhaXQgZGIuc3luY1F1ZXVlXG4gICAgICAud2hlcmUoJ3N0YXR1cycpXG4gICAgICAuZXF1YWxzKCdjb21wbGV0ZWQnIGFzIGFueSlcbiAgICAgIC5hbmQob3AgPT4gbmV3IERhdGUob3AudGltZXN0YW1wKSA8IGN1dG9mZkRhdGUpXG4gICAgICAuZGVsZXRlKClcblxuICAgIHRoaXMubm90aWZ5U3RhdHVzQ2hhbmdlKClcbiAgICByZXR1cm4gZGVsZXRlZFxuICB9XG5cbiAgLyoqXG4gICAqIOmHjeivleWksei0peeahOaTjeS9nFxuICAgKi9cbiAgYXN5bmMgcmV0cnlGYWlsZWRPcGVyYXRpb25zKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgY29uc3QgcmV0cmllZCA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgLndoZXJlKCdzdGF0dXMnKVxuICAgICAgLmVxdWFscygnZmFpbGVkJyBhcyBhbnkpXG4gICAgICAubW9kaWZ5KHtcbiAgICAgICAgc3RhdHVzOiAncGVuZGluZycgYXMgYW55LFxuICAgICAgICByZXRyeUNvdW50OiAwLFxuICAgICAgICBlcnJvcjogdW5kZWZpbmVkXG4gICAgICB9KVxuXG4gICAgdGhpcy5ub3RpZnlTdGF0dXNDaGFuZ2UoKVxuICAgIFxuICAgIC8vIOinpuWPkemHjeaWsOWkhOeQhlxuICAgIGlmIChyZXRyaWVkID4gMCkge1xuICAgICAgdGhpcy5wcm9jZXNzTmV4dEJhdGNoKClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJldHJpZWRcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bpmJ/liJfkuK3nmoTmk43kvZxcbiAgICovXG4gIGFzeW5jIGdldE9wZXJhdGlvbnMoZmlsdGVycz86IHtcbiAgICBzdGF0dXM/OiBTeW5jUXVldWVTdGF0dXNcbiAgICBwcmlvcml0eT86ICdoaWdoJyB8ICdub3JtYWwnIHwgJ2xvdydcbiAgICBlbnRpdHk/OiAnY2FyZCcgfCAnZm9sZGVyJyB8ICd0YWcnIHwgJ2ltYWdlJ1xuICAgIHVzZXJJZD86IHN0cmluZ1xuICAgIGxpbWl0PzogbnVtYmVyXG4gICAgb2Zmc2V0PzogbnVtYmVyXG4gIH0pOiBQcm9taXNlPFF1ZXVlT3BlcmF0aW9uW10+IHtcbiAgICBsZXQgcXVlcnkgPSBkYi5zeW5jUXVldWUudG9Db2xsZWN0aW9uKClcblxuICAgIGlmIChmaWx0ZXJzPy5zdGF0dXMpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoJ3N0YXR1cycpLmVxdWFscyhmaWx0ZXJzLnN0YXR1cyBhcyBhbnkpXG4gICAgfVxuXG4gICAgaWYgKGZpbHRlcnM/LnByaW9yaXR5KSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKCdwcmlvcml0eScpLmVxdWFscyhmaWx0ZXJzLnByaW9yaXR5KVxuICAgIH1cblxuICAgIGlmIChmaWx0ZXJzPy5lbnRpdHkpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoJ2VudGl0eScpLmVxdWFscyhmaWx0ZXJzLmVudGl0eSlcbiAgICB9XG5cbiAgICBpZiAoZmlsdGVycz8udXNlcklkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKCd1c2VySWQnKS5lcXVhbHMoZmlsdGVycy51c2VySWQpXG4gICAgfVxuXG4gICAgaWYgKGZpbHRlcnM/Lm9mZnNldCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5vZmZzZXQoZmlsdGVycy5vZmZzZXQpXG4gICAgfVxuXG4gICAgaWYgKGZpbHRlcnM/LmxpbWl0KSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmxpbWl0KGZpbHRlcnMubGltaXQpXG4gICAgfVxuXG4gICAgY29uc3Qgb3BlcmF0aW9ucyA9IGF3YWl0IHF1ZXJ5LnRvQXJyYXkoKVxuICAgIHJldHVybiBvcGVyYXRpb25zLm1hcChvcCA9PiB0aGlzLmNvbnZlcnRTeW5jT3BlcmF0aW9uVG9RdWV1ZU9wZXJhdGlvbihvcCkpXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOS6i+S7tuebkeWQrOWZqOeuoeeQhlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMobGlzdGVuZXJzOiB0eXBlb2YgU3luY1F1ZXVlTWFuYWdlci5wcm90b3R5cGUubGlzdGVuZXJzKTogdm9pZCB7XG4gICAgdGhpcy5saXN0ZW5lcnMgPSB7IC4uLnRoaXMubGlzdGVuZXJzLCAuLi5saXN0ZW5lcnMgfVxuICB9XG5cbiAgcHJpdmF0ZSBub3RpZnlTdGF0dXNDaGFuZ2UoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMubGlzdGVuZXJzLm9uU3RhdHVzQ2hhbmdlKSB7XG4gICAgICB0aGlzLmdldFF1ZXVlU3RhdHMoKS50aGVuKHN0YXRzID0+IHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMub25TdGF0dXNDaGFuZ2UhKHN0YXRzKVxuICAgICAgfSkuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOmYn+WIl+WkhOeQhuWZqOeuoeeQhlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplUXVldWUoKTogdm9pZCB7XG4gICAgLy8g5Yid5aeL5YyW5pe25qOA5p+l5piv5ZCm5pyJ5pyq5a6M5oiQ55qE6YeN6K+V5pON5L2cXG4gICAgdGhpcy5jaGVja1JldHJ5T3BlcmF0aW9ucygpXG4gIH1cblxuICBwcml2YXRlIHN0YXJ0UXVldWVQcm9jZXNzb3IoKTogdm9pZCB7XG4gICAgLy8g5a6a5pyf5aSE55CG6Zif5YiXXG4gICAgdGhpcy5wcm9jZXNzaW5nSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuaXNQcm9jZXNzaW5nKSB7XG4gICAgICAgIHRoaXMucHJvY2Vzc05leHRCYXRjaCgpXG4gICAgICB9XG4gICAgfSwgNTAwMCkgLy8g5q+PNeenkuajgOafpeS4gOasoemYn+WIl1xuICAgIFxuICAgIC8vIOWumuacn+S8mOWMlumYn+WIl+WkhOeQhuetlueVpe+8iOavjzLliIbpkp/vvIlcbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLm9wdGltaXplUXVldWVQcm9jZXNzaW5nKCkuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICB9LCAxMjAwMDApXG5cbiAgICAvLyDnvZHnu5zmgaLlpI3ml7bnq4vljbPlpITnkIZcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb25saW5lJywgKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmlzUHJvY2Vzc2luZykge1xuICAgICAgICB0aGlzLnByb2Nlc3NOZXh0QmF0Y2goKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNoZWNrUmV0cnlPcGVyYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXRyeWluZ09wZXJhdGlvbnMgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgICAgLndoZXJlKCdzdGF0dXMnKVxuICAgICAgICAuZXF1YWxzKCdyZXRyeWluZycgYXMgYW55KVxuICAgICAgICAudG9BcnJheSgpXG5cbiAgICAgIC8vIOWwhumHjeivleS4reeahOaTjeS9nOmHjeaWsOiuvuS4uuW+heWkhOeQhlxuICAgICAgZm9yIChjb25zdCBvcGVyYXRpb24gb2YgcmV0cnlpbmdPcGVyYXRpb25zKSB7XG4gICAgICAgIGF3YWl0IGRiLnN5bmNRdWV1ZS53aGVyZSgnaWQnKS5lcXVhbHMob3BlcmF0aW9uLmlkKS5tb2RpZnkoe1xuICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnIGFzIGFueVxuICAgICAgICB9KVxuICAgICAgfVxuXG4gICAgICBpZiAocmV0cnlpbmdPcGVyYXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5ub3RpZnlTdGF0dXNDaGFuZ2UoKVxuICAgICAgICB0aGlzLnByb2Nlc3NOZXh0QmF0Y2goKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY2hlY2sgcmV0cnkgb3BlcmF0aW9uczonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5YGc5q2i6Zif5YiX5aSE55CG5ZmoXG4gICAqL1xuICBzdG9wKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnByb2Nlc3NpbmdJbnRlcnZhbCkge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnByb2Nlc3NpbmdJbnRlcnZhbClcbiAgICAgIHRoaXMucHJvY2Vzc2luZ0ludGVydmFsID0gdW5kZWZpbmVkXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaaguWBnOmYn+WIl+WkhOeQhlxuICAgKi9cbiAgcGF1c2UoKTogdm9pZCB7XG4gICAgdGhpcy5pc1Byb2Nlc3NpbmcgPSB0cnVlXG4gIH1cblxuICAvKipcbiAgICog5oGi5aSN6Zif5YiX5aSE55CGXG4gICAqL1xuICByZXN1bWUoKTogdm9pZCB7XG4gICAgdGhpcy5pc1Byb2Nlc3NpbmcgPSBmYWxzZVxuICAgIHRoaXMucHJvY2Vzc05leHRCYXRjaCgpXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOi+heWKqeaWueazlVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgcHJpdmF0ZSBjb252ZXJ0U3luY09wZXJhdGlvblRvUXVldWVPcGVyYXRpb24oc3luY09wOiBTeW5jT3BlcmF0aW9uKTogUXVldWVPcGVyYXRpb24ge1xuICAgIHJldHVybiB7XG4gICAgICBpZDogc3luY09wLmlkISxcbiAgICAgIHR5cGU6IHN5bmNPcC50eXBlLFxuICAgICAgZW50aXR5OiBzeW5jT3AuZW50aXR5LFxuICAgICAgZW50aXR5SWQ6IHN5bmNPcC5lbnRpdHlJZCxcbiAgICAgIHVzZXJJZDogc3luY09wLnVzZXJJZCxcbiAgICAgIGRhdGE6IHN5bmNPcC5kYXRhLFxuICAgICAgcHJpb3JpdHk6IHN5bmNPcC5wcmlvcml0eSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoc3luY09wLnRpbWVzdGFtcCksXG4gICAgICByZXRyeUNvdW50OiBzeW5jT3AucmV0cnlDb3VudCxcbiAgICAgIG1heFJldHJpZXM6IHN5bmNPcC5tYXhSZXRyaWVzLFxuICAgICAgc3RhdHVzOiBzeW5jT3Auc3RhdHVzIGFzIFN5bmNRdWV1ZVN0YXR1cyxcbiAgICAgIGVycm9yOiBzeW5jT3AuZXJyb3JcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOaZuuiDvemYn+WIl+euoeeQhuS8mOWMliAtIFdlZWsgMiBEYXkgNi03XG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog5pm66IO96Zif5YiX5LyY5YyWIC0g5Z+65LqO572R57uc54q25oCB5ZKM5pON5L2c54m55b6B5Yqo5oCB6LCD5pW06Zif5YiX562W55WlXG4gICAqL1xuICBhc3luYyBvcHRpbWl6ZVF1ZXVlUHJvY2Vzc2luZygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCB0aGlzLmdldFF1ZXVlU3RhdHMoKVxuICAgICAgXG4gICAgICAvLyDmoLnmja7pmJ/liJfnirbmgIHliqjmgIHosIPmlbTlpITnkIbnrZbnlaVcbiAgICAgIHRoaXMuYWRqdXN0UHJvY2Vzc2luZ1N0cmF0ZWd5KHN0YXRzKVxuICAgICAgXG4gICAgICAvLyDmmbrog73mibnph4/lpKflsI/osIPmlbRcbiAgICAgIHRoaXMuYWRqdXN0QmF0Y2hTaXplKHN0YXRzKVxuICAgICAgXG4gICAgICAvLyDkvJjlhYjnuqfph43mlrDlubPooaFcbiAgICAgIGF3YWl0IHRoaXMucmViYWxhbmNlUHJpb3JpdGllcyhzdGF0cylcbiAgICAgIFxuICAgICAgLy8g5riF55CG6L+H5pyf5pON5L2cXG4gICAgICBhd2FpdCB0aGlzLmNsZWFudXBFeHBpcmVkT3BlcmF0aW9ucygpXG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIG9wdGltaXplIHF1ZXVlIHByb2Nlc3Npbmc6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOagueaNrumYn+WIl+eKtuaAgeiwg+aVtOWkhOeQhuetlueVpVxuICAgKi9cbiAgcHJpdmF0ZSBhZGp1c3RQcm9jZXNzaW5nU3RyYXRlZ3koc3RhdHM6IFF1ZXVlU3RhdHMpOiB2b2lkIHtcbiAgICBjb25zdCB7IHRvdGFsT3BlcmF0aW9ucywgYnlTdGF0dXMsIGJ5UHJpb3JpdHkgfSA9IHN0YXRzXG4gICAgXG4gICAgLy8g6auY6LSf6L29562W55WlXG4gICAgaWYgKHRvdGFsT3BlcmF0aW9ucyA+IDEwMDApIHtcbiAgICAgIHRoaXMuYmF0Y2hTaXplID0gNSAvLyDlh4/lsJHmibnph4/lpKflsI9cbiAgICAgIHRoaXMubWF4Q29uY3VycmVudEJhdGNoZXMgPSAyIC8vIOWHj+WwkeW5tuWPkeaVsFxuICAgICAgY29uc29sZS5sb2coJ1F1ZXVlIHVuZGVyIGhpZ2ggbG9hZCwgYWRqdXN0aW5nIHN0cmF0ZWd5OiBiYXRjaD01LCBjb25jdXJyZW50PTInKVxuICAgIH1cbiAgICAvLyDkuK3otJ/ovb3nrZbnlaVcbiAgICBlbHNlIGlmICh0b3RhbE9wZXJhdGlvbnMgPiA1MDApIHtcbiAgICAgIHRoaXMuYmF0Y2hTaXplID0gOFxuICAgICAgdGhpcy5tYXhDb25jdXJyZW50QmF0Y2hlcyA9IDNcbiAgICAgIGNvbnNvbGUubG9nKCdRdWV1ZSB1bmRlciBtZWRpdW0gbG9hZCwgYWRqdXN0aW5nIHN0cmF0ZWd5OiBiYXRjaD04LCBjb25jdXJyZW50PTMnKVxuICAgIH1cbiAgICAvLyDkvY7otJ/ovb3nrZbnlaVcbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuYmF0Y2hTaXplID0gMTUgLy8g5aKe5Yqg5om56YeP5aSn5bCPXG4gICAgICB0aGlzLm1heENvbmN1cnJlbnRCYXRjaGVzID0gNSAvLyDlop7liqDlubblj5HmlbBcbiAgICAgIGNvbnNvbGUubG9nKCdRdWV1ZSB1bmRlciBub3JtYWwgbG9hZCwgYWRqdXN0aW5nIHN0cmF0ZWd5OiBiYXRjaD0xNSwgY29uY3VycmVudD01JylcbiAgICB9XG4gICAgXG4gICAgLy8g5qC55o2u5aSx6LSl546H6LCD5pW06YeN6K+V562W55WlXG4gICAgY29uc3QgZmFpbHVyZVJhdGUgPSBieVN0YXR1c1tTeW5jUXVldWVTdGF0dXMuRkFJTEVEXSAvIHRvdGFsT3BlcmF0aW9uc1xuICAgIGlmIChmYWlsdXJlUmF0ZSA+IDAuMykge1xuICAgICAgLy8g5aSx6LSl546H6auY77yM5aKe5Yqg6YeN6K+V5bu26L+fXG4gICAgICB0aGlzLnJldHJ5RGVsYXlzID0gWzIwMDAsIDUwMDAsIDE1MDAwLCAzMDAwMCwgNjAwMDBdXG4gICAgICBjb25zb2xlLmxvZygnSGlnaCBmYWlsdXJlIHJhdGUgZGV0ZWN0ZWQsIGluY3JlYXNlZCByZXRyeSBkZWxheXMnKVxuICAgIH0gZWxzZSBpZiAoZmFpbHVyZVJhdGUgPCAwLjEpIHtcbiAgICAgIC8vIOWksei0peeOh+S9ju+8jOaBouWkjeato+W4uOmHjeivleW7tui/n1xuICAgICAgdGhpcy5yZXRyeURlbGF5cyA9IFsxMDAwLCAyMDAwLCA1MDAwLCAxMDAwMCwgMzAwMDBdXG4gICAgICBjb25zb2xlLmxvZygnTm9ybWFsIGZhaWx1cmUgcmF0ZSwgcmVzdG9yZWQgcmV0cnkgZGVsYXlzJylcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yqo5oCB6LCD5pW05om56YeP5aSn5bCPXG4gICAqL1xuICBwcml2YXRlIGFkanVzdEJhdGNoU2l6ZShzdGF0czogUXVldWVTdGF0cyk6IHZvaWQge1xuICAgIGNvbnN0IHsgYnlQcmlvcml0eSwgdG90YWxPcGVyYXRpb25zIH0gPSBzdGF0c1xuICAgIFxuICAgIC8vIOmrmOS8mOWFiOe6p+aTjeS9nOavlOS+i1xuICAgIGNvbnN0IGhpZ2hQcmlvcml0eVJhdGlvID0gYnlQcmlvcml0eS5oaWdoIC8gdG90YWxPcGVyYXRpb25zXG4gICAgXG4gICAgLy8g5aaC5p6c6auY5LyY5YWI57qn5pON5L2c5aSa77yM5YeP5bCR5om56YeP5aSn5bCP5Lul56Gu5L+d5Y+K5pe25aSE55CGXG4gICAgaWYgKGhpZ2hQcmlvcml0eVJhdGlvID4gMC4zKSB7XG4gICAgICB0aGlzLmJhdGNoU2l6ZSA9IE1hdGgubWF4KDMsIE1hdGguZmxvb3IodGhpcy5iYXRjaFNpemUgKiAwLjcpKVxuICAgICAgY29uc29sZS5sb2coYEhpZ2ggcHJpb3JpdHkgcmF0aW8gKCR7KGhpZ2hQcmlvcml0eVJhdGlvICogMTAwKS50b0ZpeGVkKDEpfSUpLCByZWR1Y2VkIGJhdGNoIHNpemUgdG8gJHt0aGlzLmJhdGNoU2l6ZX1gKVxuICAgIH1cbiAgICBcbiAgICAvLyDmoLnmja7mk43kvZznsbvlnovliIbluIPosIPmlbRcbiAgICBjb25zdCBjYXJkUmF0aW8gPSBieUVudGl0eS5jYXJkIC8gdG90YWxPcGVyYXRpb25zXG4gICAgaWYgKGNhcmRSYXRpbyA+IDAuNykge1xuICAgICAgLy8g5Y2h54mH5pON5L2c5Y2g5q+U5aSn77yM5Y+v5Lul6YCC5b2T5aKe5Yqg5om56YeP5aSn5bCPXG4gICAgICB0aGlzLmJhdGNoU2l6ZSA9IE1hdGgubWluKDIwLCBNYXRoLmZsb29yKHRoaXMuYmF0Y2hTaXplICogMS4yKSlcbiAgICAgIGNvbnNvbGUubG9nKGBDYXJkIG9wZXJhdGlvbiByYXRpbyAoJHsoY2FyZFJhdGlvICogMTAwKS50b0ZpeGVkKDEpfSUpLCBpbmNyZWFzZWQgYmF0Y2ggc2l6ZSB0byAke3RoaXMuYmF0Y2hTaXplfWApXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS8mOWFiOe6p+mHjeaWsOW5s+ihoVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZWJhbGFuY2VQcmlvcml0aWVzKHN0YXRzOiBRdWV1ZVN0YXRzKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyBieVN0YXR1cywgYnlQcmlvcml0eSB9ID0gc3RhdHNcbiAgICBcbiAgICAvLyDlsIbplb/ml7bpl7TnrYnlvoXnmoTpq5jkvJjlhYjnuqfmk43kvZzph43mlrDmoIforrDkuLrlhbPplK5cbiAgICBjb25zdCBvbGRIaWdoUHJpb3JpdHlPcHMgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgIC53aGVyZSgncHJpb3JpdHknKVxuICAgICAgLmVxdWFscygnaGlnaCcpXG4gICAgICAuZmlsdGVyKG9wID0+IHtcbiAgICAgICAgY29uc3Qgd2FpdFRpbWUgPSBEYXRlLm5vdygpIC0gb3AudGltZXN0YW1wLmdldFRpbWUoKVxuICAgICAgICByZXR1cm4gd2FpdFRpbWUgPiA1ICogNjAgKiAxMDAwIC8vIOetieW+hei2hei/hzXliIbpkp9cbiAgICAgIH0pXG4gICAgICAudG9BcnJheSgpXG4gICAgXG4gICAgaWYgKG9sZEhpZ2hQcmlvcml0eU9wcy5sZW5ndGggPiAwKSB7XG4gICAgICBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgICAgLndoZXJlKCdpZCcpXG4gICAgICAgIC5hbnlPZihvbGRIaWdoUHJpb3JpdHlPcHMubWFwKG9wID0+IG9wLmlkKSlcbiAgICAgICAgLm1vZGlmeSh7IHByaW9yaXR5OiAnaGlnaCcgYXMgY29uc3QgfSlcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYEVzY2FsYXRlZCAke29sZEhpZ2hQcmlvcml0eU9wcy5sZW5ndGh9IG9sZCBoaWdoLXByaW9yaXR5IG9wZXJhdGlvbnNgKVxuICAgIH1cbiAgICBcbiAgICAvLyDlsIbplb/ml7bpl7TnrYnlvoXnmoTmma7pgJrmk43kvZzmj5DljYfkvJjlhYjnuqdcbiAgICBjb25zdCBvbGROb3JtYWxPcHMgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgIC53aGVyZSgncHJpb3JpdHknKVxuICAgICAgLmVxdWFscygnbm9ybWFsJylcbiAgICAgIC5maWx0ZXIob3AgPT4ge1xuICAgICAgICBjb25zdCB3YWl0VGltZSA9IERhdGUubm93KCkgLSBvcC50aW1lc3RhbXAuZ2V0VGltZSgpXG4gICAgICAgIHJldHVybiB3YWl0VGltZSA+IDEwICogNjAgKiAxMDAwIC8vIOetieW+hei2hei/hzEw5YiG6ZKfXG4gICAgICB9KVxuICAgICAgLnRvQXJyYXkoKVxuICAgIFxuICAgIGlmIChvbGROb3JtYWxPcHMubGVuZ3RoID4gMCkge1xuICAgICAgYXdhaXQgZGIuc3luY1F1ZXVlXG4gICAgICAgIC53aGVyZSgnaWQnKVxuICAgICAgICAuYW55T2Yob2xkTm9ybWFsT3BzLm1hcChvcCA9PiBvcC5pZCkpXG4gICAgICAgIC5tb2RpZnkoeyBwcmlvcml0eTogJ2hpZ2gnIGFzIGNvbnN0IH0pXG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGBFc2NhbGF0ZWQgJHtvbGROb3JtYWxPcHMubGVuZ3RofSBvbGQgbm9ybWFsLXByaW9yaXR5IG9wZXJhdGlvbnNgKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbov4fmnJ/mk43kvZxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY2xlYW51cEV4cGlyZWRPcGVyYXRpb25zKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGV4cGlyZWRUaW1lID0gRGF0ZS5ub3coKSAtIDI0ICogNjAgKiA2MCAqIDEwMDAgLy8gMjTlsI/ml7bliY1cbiAgICBcbiAgICBjb25zdCBleHBpcmVkT3BlcmF0aW9ucyA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgLndoZXJlKCd0aW1lc3RhbXAnKVxuICAgICAgLmJlbG93KGV4cGlyZWRUaW1lKVxuICAgICAgLmZpbHRlcihvcCA9PiBvcC5zdGF0dXMgPT09IFN5bmNRdWV1ZVN0YXR1cy5GQUlMRUQpXG4gICAgICAudG9BcnJheSgpXG4gICAgXG4gICAgaWYgKGV4cGlyZWRPcGVyYXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAoY29uc3Qgb3Agb2YgZXhwaXJlZE9wZXJhdGlvbnMpIHtcbiAgICAgICAgYXdhaXQgZGIuc3luY1F1ZXVlLmRlbGV0ZShvcC5pZClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYENsZWFuZWQgdXAgJHtleHBpcmVkT3BlcmF0aW9ucy5sZW5ndGh9IGV4cGlyZWQgZmFpbGVkIG9wZXJhdGlvbnNgKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmmbrog73lhrLnqoHpooTmtYvlkozpooTpmLJcbiAgICovXG4gIGFzeW5jIHByZWRpY3RBbmRQcmV2ZW50Q29uZmxpY3RzKG9wZXJhdGlvbnM6IFF1ZXVlT3BlcmF0aW9uW10pOiBQcm9taXNlPHtcbiAgICBzYWZlT3BlcmF0aW9uczogUXVldWVPcGVyYXRpb25bXVxuICAgIHJpc2t5T3BlcmF0aW9uczogUXVldWVPcGVyYXRpb25bXVxuICAgIGNvbmZsaWN0UHJlZGljdGlvbjoge1xuICAgICAgaGlnaFJpc2s6IG51bWJlclxuICAgICAgbWVkaXVtUmlzazogbnVtYmVyXG4gICAgICBsb3dSaXNrOiBudW1iZXJcbiAgICB9XG4gIH0+IHtcbiAgICBjb25zdCBzYWZlT3BlcmF0aW9uczogUXVldWVPcGVyYXRpb25bXSA9IFtdXG4gICAgY29uc3Qgcmlza3lPcGVyYXRpb25zOiBRdWV1ZU9wZXJhdGlvbltdID0gW11cbiAgICBjb25zdCBjb25mbGljdFByZWRpY3Rpb24gPSB7IGhpZ2hSaXNrOiAwLCBtZWRpdW1SaXNrOiAwLCBsb3dSaXNrOiAwIH1cbiAgICBcbiAgICBmb3IgKGNvbnN0IG9wZXJhdGlvbiBvZiBvcGVyYXRpb25zKSB7XG4gICAgICBjb25zdCByaXNrID0gYXdhaXQgdGhpcy5hc3Nlc3NDb25mbGljdFJpc2sob3BlcmF0aW9uKVxuICAgICAgXG4gICAgICBpZiAocmlzayA9PT0gJ2hpZ2gnKSB7XG4gICAgICAgIHJpc2t5T3BlcmF0aW9ucy5wdXNoKG9wZXJhdGlvbilcbiAgICAgICAgY29uZmxpY3RQcmVkaWN0aW9uLmhpZ2hSaXNrKytcbiAgICAgIH0gZWxzZSBpZiAocmlzayA9PT0gJ21lZGl1bScpIHtcbiAgICAgICAgcmlza3lPcGVyYXRpb25zLnB1c2gob3BlcmF0aW9uKVxuICAgICAgICBjb25mbGljdFByZWRpY3Rpb24ubWVkaXVtUmlzaysrXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzYWZlT3BlcmF0aW9ucy5wdXNoKG9wZXJhdGlvbilcbiAgICAgICAgY29uZmxpY3RQcmVkaWN0aW9uLmxvd1Jpc2srK1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyBzYWZlT3BlcmF0aW9ucywgcmlza3lPcGVyYXRpb25zLCBjb25mbGljdFByZWRpY3Rpb24gfVxuICB9XG5cbiAgLyoqXG4gICAqIOivhOS8sOWNleS4quaTjeS9nOeahOWGsueqgemjjumZqVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhc3Nlc3NDb25mbGljdFJpc2sob3BlcmF0aW9uOiBRdWV1ZU9wZXJhdGlvbik6IFByb21pc2U8J2hpZ2gnIHwgJ21lZGl1bScgfCAnbG93Jz4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDmo4Dmn6XlkIzkuIDlrp7kvZPnmoTmnIDov5Hmk43kvZxcbiAgICAgIGNvbnN0IHJlY2VudE9wZXJhdGlvbnMgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgICAgLndoZXJlKCdlbnRpdHlJZCcpXG4gICAgICAgIC5lcXVhbHMob3BlcmF0aW9uLmVudGl0eUlkKVxuICAgICAgICAuZmlsdGVyKG9wID0+IHtcbiAgICAgICAgICBjb25zdCB0aW1lRGlmZiA9IE1hdGguYWJzKG9wLnRpbWVzdGFtcC5nZXRUaW1lKCkgLSBvcGVyYXRpb24udGltZXN0YW1wLmdldFRpbWUoKSlcbiAgICAgICAgICByZXR1cm4gdGltZURpZmYgPCA1ICogNjAgKiAxMDAwICYmIC8vIDXliIbpkp/lhoVcbiAgICAgICAgICAgICAgICAgb3AuaWQgIT09IG9wZXJhdGlvbi5pZFxuICAgICAgICB9KVxuICAgICAgICAudG9BcnJheSgpXG4gICAgICBcbiAgICAgIGlmIChyZWNlbnRPcGVyYXRpb25zLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgcmV0dXJuICdoaWdoJyAvLyDlkIzkuIDlrp7kvZPmnInlpJrkuKrlubblj5Hmk43kvZxcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g5qOA5p+l55So5oi35pON5L2c6aKR546HXG4gICAgICBjb25zdCB1c2VyUmVjZW50T3BzID0gYXdhaXQgZGIuc3luY1F1ZXVlXG4gICAgICAgIC53aGVyZSgndXNlcklkJylcbiAgICAgICAgLmVxdWFscyhvcGVyYXRpb24udXNlcklkKVxuICAgICAgICAuZmlsdGVyKG9wID0+IHtcbiAgICAgICAgICBjb25zdCB0aW1lRGlmZiA9IERhdGUubm93KCkgLSBvcC50aW1lc3RhbXAuZ2V0VGltZSgpXG4gICAgICAgICAgcmV0dXJuIHRpbWVEaWZmIDwgNjAgKiAxMDAwIC8vIDHliIbpkp/lhoVcbiAgICAgICAgfSlcbiAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgXG4gICAgICBpZiAodXNlclJlY2VudE9wcy5sZW5ndGggPiAxMCkge1xuICAgICAgICByZXR1cm4gJ2hpZ2gnIC8vIOeUqOaIt+aTjeS9nOi/h+S6jumikee5gVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDmo4Dmn6Xljoblj7LlpLHotKXnjodcbiAgICAgIGNvbnN0IGZhaWxlZE9wcyA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgICAud2hlcmUoJ2VudGl0eScpXG4gICAgICAgIC5lcXVhbHMob3BlcmF0aW9uLmVudGl0eSlcbiAgICAgICAgLmZpbHRlcihvcCA9PiBvcC5zdGF0dXMgPT09IFN5bmNRdWV1ZVN0YXR1cy5GQUlMRUQpXG4gICAgICAgIC50b0FycmF5KClcbiAgICAgIFxuICAgICAgY29uc3QgZmFpbHVyZVJhdGUgPSBmYWlsZWRPcHMubGVuZ3RoIC8gTWF0aC5tYXgoMSwgYXdhaXQgZGIuc3luY1F1ZXVlLmNvdW50KCkpXG4gICAgICBcbiAgICAgIGlmIChmYWlsdXJlUmF0ZSA+IDAuMykge1xuICAgICAgICByZXR1cm4gJ21lZGl1bScgLy8g5Y6G5Y+y5aSx6LSl546H6L6D6auYXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiAnbG93J1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gYXNzZXNzIGNvbmZsaWN0IHJpc2s6JywgZXJyb3IpXG4gICAgICByZXR1cm4gJ21lZGl1bScgLy8g6buY6K6k5Lit562J6aOO6ZmpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlumYn+WIl+aAp+iDveaMh+aghyAtIOWinuW8uueJiFxuICAgKi9cbiAgYXN5bmMgZ2V0UXVldWVQZXJmb3JtYW5jZU1ldHJpY3MoKTogUHJvbWlzZTx7XG4gICAgdGhyb3VnaHB1dDogbnVtYmVyXG4gICAgYXZlcmFnZVByb2Nlc3NpbmdUaW1lOiBudW1iZXJcbiAgICBzdWNjZXNzUmF0ZTogbnVtYmVyXG4gICAgcXVldWVFZmZpY2llbmN5OiBudW1iZXJcbiAgICBib3R0bGVuZWNrQW5hbHlzaXM6IHN0cmluZ1tdXG4gICAgY29uZmxpY3RSZXNvbHV0aW9uUmF0ZTogbnVtYmVyXG4gICAgcmVzb3VyY2VVdGlsaXphdGlvbjogbnVtYmVyXG4gICAgcHJlZGljdGl2ZUluc2lnaHRzOiB7XG4gICAgICBwcmVkaWN0ZWRMb2FkOiBudW1iZXJcbiAgICAgIHJlY29tbWVuZGVkQWN0aW9uczogc3RyaW5nW11cbiAgICAgIHJpc2tBc3Nlc3NtZW50OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnXG4gICAgfVxuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgdGhpcy5nZXRRdWV1ZVN0YXRzKClcbiAgICAgIFxuICAgICAgLy8g6K6h566X5ZCe5ZCQ6YeP77yI5q+P5YiG6ZKf5aSE55CG55qE5pON5L2c5pWw77yJXG4gICAgICBjb25zdCByZWNlbnRDb21wbGV0ZWQgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgICAgLndoZXJlKCdzdGF0dXMnKVxuICAgICAgICAuZXF1YWxzKFN5bmNRdWV1ZVN0YXR1cy5DT01QTEVURUQpXG4gICAgICAgIC5maWx0ZXIob3AgPT4ge1xuICAgICAgICAgIGNvbnN0IHRpbWVEaWZmID0gRGF0ZS5ub3coKSAtIG9wLnRpbWVzdGFtcC5nZXRUaW1lKClcbiAgICAgICAgICByZXR1cm4gdGltZURpZmYgPCA2MCAqIDEwMDAgLy8g5pyA6L+RMeWIhumSn1xuICAgICAgICB9KVxuICAgICAgICAudG9BcnJheSgpXG4gICAgICBcbiAgICAgIGNvbnN0IHRocm91Z2hwdXQgPSByZWNlbnRDb21wbGV0ZWQubGVuZ3RoXG4gICAgICBcbiAgICAgIC8vIOiuoeeul+W5s+Wdh+WkhOeQhuaXtumXtFxuICAgICAgY29uc3QgcHJvY2Vzc2luZ1RpbWVzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgIHJlY2VudENvbXBsZXRlZC5tYXAoYXN5bmMgb3AgPT4ge1xuICAgICAgICAgIGNvbnN0IHVwZGF0ZWRPcCA9IGF3YWl0IGRiLnN5bmNRdWV1ZS5nZXQob3AuaWQpXG4gICAgICAgICAgcmV0dXJuIHVwZGF0ZWRPcD8ucHJvY2Vzc2luZ1RpbWUgfHwgMFxuICAgICAgICB9KVxuICAgICAgKVxuICAgICAgXG4gICAgICBjb25zdCBhdmVyYWdlUHJvY2Vzc2luZ1RpbWUgPSBwcm9jZXNzaW5nVGltZXMubGVuZ3RoID4gMCBcbiAgICAgICAgPyBwcm9jZXNzaW5nVGltZXMucmVkdWNlKChzdW0sIHRpbWUpID0+IHN1bSArIHRpbWUsIDApIC8gcHJvY2Vzc2luZ1RpbWVzLmxlbmd0aCBcbiAgICAgICAgOiAwXG4gICAgICBcbiAgICAgIC8vIOiuoeeul+aIkOWKn+eOh1xuICAgICAgY29uc3QgdG90YWxSZWNlbnQgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgICAgLmZpbHRlcihvcCA9PiB7XG4gICAgICAgICAgY29uc3QgdGltZURpZmYgPSBEYXRlLm5vdygpIC0gb3AudGltZXN0YW1wLmdldFRpbWUoKVxuICAgICAgICAgIHJldHVybiB0aW1lRGlmZiA8IDYwICogMTAwMFxuICAgICAgICB9KVxuICAgICAgICAudG9BcnJheSgpXG4gICAgICBcbiAgICAgIGNvbnN0IHN1Y2Nlc3NSYXRlID0gdG90YWxSZWNlbnQubGVuZ3RoID4gMCBcbiAgICAgICAgPyByZWNlbnRDb21wbGV0ZWQubGVuZ3RoIC8gdG90YWxSZWNlbnQubGVuZ3RoIFxuICAgICAgICA6IDFcbiAgICAgIFxuICAgICAgLy8g6K6h566X6Zif5YiX5pWI546H77yIMC0x77yJXG4gICAgICBjb25zdCBxdWV1ZUVmZmljaWVuY3kgPSB0aGlzLmNhbGN1bGF0ZVF1ZXVlRWZmaWNpZW5jeShzdGF0cywgdGhyb3VnaHB1dClcbiAgICAgIFxuICAgICAgLy8g6K6h566X5Yay56qB6Kej5Yaz546HXG4gICAgICBjb25zdCBjb25mbGljdFJlc29sdXRpb25SYXRlID0gYXdhaXQgdGhpcy5jYWxjdWxhdGVDb25mbGljdFJlc29sdXRpb25SYXRlKClcbiAgICAgIFxuICAgICAgLy8g6K6h566X6LWE5rqQ5Yip55So546HXG4gICAgICBjb25zdCByZXNvdXJjZVV0aWxpemF0aW9uID0gdGhpcy5jYWxjdWxhdGVSZXNvdXJjZVV0aWxpemF0aW9uKHN0YXRzLCB0aHJvdWdocHV0KVxuICAgICAgXG4gICAgICAvLyDnk7bpoojliIbmnpBcbiAgICAgIGNvbnN0IGJvdHRsZW5lY2tBbmFseXNpcyA9IHRoaXMuYW5hbHl6ZUJvdHRsZW5lY2tzKHN0YXRzLCB0aHJvdWdocHV0LCBhdmVyYWdlUHJvY2Vzc2luZ1RpbWUpXG4gICAgICBcbiAgICAgIC8vIOmihOa1i+aAp+WIhuaekFxuICAgICAgY29uc3QgcHJlZGljdGl2ZUluc2lnaHRzID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVByZWRpY3RpdmVJbnNpZ2h0cyhzdGF0cywgdGhyb3VnaHB1dClcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGhyb3VnaHB1dCxcbiAgICAgICAgYXZlcmFnZVByb2Nlc3NpbmdUaW1lLFxuICAgICAgICBzdWNjZXNzUmF0ZSxcbiAgICAgICAgcXVldWVFZmZpY2llbmN5LFxuICAgICAgICBib3R0bGVuZWNrQW5hbHlzaXMsXG4gICAgICAgIGNvbmZsaWN0UmVzb2x1dGlvblJhdGUsXG4gICAgICAgIHJlc291cmNlVXRpbGl6YXRpb24sXG4gICAgICAgIHByZWRpY3RpdmVJbnNpZ2h0c1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHF1ZXVlIHBlcmZvcm1hbmNlIG1ldHJpY3M6JywgZXJyb3IpXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aHJvdWdocHV0OiAwLFxuICAgICAgICBhdmVyYWdlUHJvY2Vzc2luZ1RpbWU6IDAsXG4gICAgICAgIHN1Y2Nlc3NSYXRlOiAwLFxuICAgICAgICBxdWV1ZUVmZmljaWVuY3k6IDAsXG4gICAgICAgIGJvdHRsZW5lY2tBbmFseXNpczogWydVbmFibGUgdG8gYW5hbHl6ZSBwZXJmb3JtYW5jZSddLFxuICAgICAgICBjb25mbGljdFJlc29sdXRpb25SYXRlOiAwLFxuICAgICAgICByZXNvdXJjZVV0aWxpemF0aW9uOiAwLFxuICAgICAgICBwcmVkaWN0aXZlSW5zaWdodHM6IHtcbiAgICAgICAgICBwcmVkaWN0ZWRMb2FkOiAwLFxuICAgICAgICAgIHJlY29tbWVuZGVkQWN0aW9uczogWydFbmFibGUgcGVyZm9ybWFuY2UgbW9uaXRvcmluZyddLFxuICAgICAgICAgIHJpc2tBc3Nlc3NtZW50OiAnbWVkaXVtJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICog6K6h566X5Yay56qB6Kej5Yaz546HXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNhbGN1bGF0ZUNvbmZsaWN0UmVzb2x1dGlvblJhdGUoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVjZW50T3BlcmF0aW9ucyA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgICAuZmlsdGVyKG9wID0+IHtcbiAgICAgICAgICBjb25zdCB0aW1lRGlmZiA9IERhdGUubm93KCkgLSBvcC50aW1lc3RhbXAuZ2V0VGltZSgpXG4gICAgICAgICAgcmV0dXJuIHRpbWVEaWZmIDwgMzAgKiA2MCAqIDEwMDAgLy8g5pyA6L+RMzDliIbpkp9cbiAgICAgICAgfSlcbiAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgXG4gICAgICBpZiAocmVjZW50T3BlcmF0aW9ucy5sZW5ndGggPT09IDApIHJldHVybiAxXG4gICAgICBcbiAgICAgIGNvbnN0IHJlc29sdmVkQ291bnQgPSByZWNlbnRPcGVyYXRpb25zLmZpbHRlcihvcCA9PiBcbiAgICAgICAgb3Auc3RhdHVzID09PSAnY29tcGxldGVkJyAmJiBvcC5lcnJvciA9PT0gbnVsbFxuICAgICAgKS5sZW5ndGhcbiAgICAgIFxuICAgICAgcmV0dXJuIHJlc29sdmVkQ291bnQgLyByZWNlbnRPcGVyYXRpb25zLmxlbmd0aFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY2FsY3VsYXRlIGNvbmZsaWN0IHJlc29sdXRpb24gcmF0ZTonLCBlcnJvcilcbiAgICAgIHJldHVybiAwXG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICog6K6h566X6LWE5rqQ5Yip55So546HXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZVJlc291cmNlVXRpbGl6YXRpb24oc3RhdHM6IFF1ZXVlU3RhdHMsIHRocm91Z2hwdXQ6IG51bWJlcik6IG51bWJlciB7XG4gICAgLy8g5Z+65LqO6Zif5YiX54q25oCB5ZKM5ZCe5ZCQ6YeP6K6h566X6LWE5rqQ5Yip55So546HXG4gICAgbGV0IHV0aWxpemF0aW9uID0gMC4zIC8vIOWfuuehgOWIqeeUqOeOh1xuICAgIFxuICAgIC8vIOagueaNruW+heWkhOeQhuaTjeS9nOaVsOmHj+WinuWKoOWIqeeUqOeOh1xuICAgIGlmIChzdGF0cy50b3RhbE9wZXJhdGlvbnMgPiA1MDApIHV0aWxpemF0aW9uICs9IDAuNFxuICAgIGVsc2UgaWYgKHN0YXRzLnRvdGFsT3BlcmF0aW9ucyA+IDIwMCkgdXRpbGl6YXRpb24gKz0gMC4yXG4gICAgZWxzZSBpZiAoc3RhdHMudG90YWxPcGVyYXRpb25zID4gNTApIHV0aWxpemF0aW9uICs9IDAuMVxuICAgIFxuICAgIC8vIOagueaNruWQnuWQkOmHj+iwg+aVtFxuICAgIGlmICh0aHJvdWdocHV0ID4gMTUpIHV0aWxpemF0aW9uICs9IDAuMlxuICAgIGVsc2UgaWYgKHRocm91Z2hwdXQgPiA4KSB1dGlsaXphdGlvbiArPSAwLjFcbiAgICBcbiAgICAvLyDmoLnmja7lpLHotKXnjofosIPmlbRcbiAgICBjb25zdCBmYWlsdXJlUmF0ZSA9IHN0YXRzLmJ5U3RhdHVzW1N5bmNRdWV1ZVN0YXR1cy5GQUlMRURdIC8gTWF0aC5tYXgoMSwgc3RhdHMudG90YWxPcGVyYXRpb25zKVxuICAgIGlmIChmYWlsdXJlUmF0ZSA+IDAuMikgdXRpbGl6YXRpb24gLT0gMC4xXG4gICAgXG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHV0aWxpemF0aW9uKSlcbiAgfVxuICBcbiAgLyoqXG4gICAqIOeUn+aIkOmihOa1i+aAp+WIhuaekFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVByZWRpY3RpdmVJbnNpZ2h0cyhzdGF0czogUXVldWVTdGF0cywgY3VycmVudFRocm91Z2hwdXQ6IG51bWJlcik6IFByb21pc2U8e1xuICAgIHByZWRpY3RlZExvYWQ6IG51bWJlclxuICAgIHJlY29tbWVuZGVkQWN0aW9uczogc3RyaW5nW11cbiAgICByaXNrQXNzZXNzbWVudDogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJ1xuICB9PiB7XG4gICAgY29uc3QgcmVjb21tZW5kZWRBY3Rpb25zOiBzdHJpbmdbXSA9IFtdXG4gICAgbGV0IHJpc2tBc3Nlc3NtZW50OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnID0gJ2xvdydcbiAgICBcbiAgICAvLyDln7rkuo7ljoblj7LmlbDmja7pooTmtYvotJ/ovb1cbiAgICBjb25zdCBwcmVkaWN0ZWRMb2FkID0gYXdhaXQgdGhpcy5wcmVkaWN0RnV0dXJlTG9hZChzdGF0cywgY3VycmVudFRocm91Z2hwdXQpXG4gICAgXG4gICAgLy8g5YiG5p6Q6LaL5Yq/5bm25o+Q5L6b5bu66K6uXG4gICAgaWYgKHByZWRpY3RlZExvYWQgPiAxMDAwKSB7XG4gICAgICByZWNvbW1lbmRlZEFjdGlvbnMucHVzaCgnQ29uc2lkZXIgaW5jcmVhc2luZyBiYXRjaCBzaXplIGFuZCBjb25jdXJyZW5jeScpXG4gICAgICByaXNrQXNzZXNzbWVudCA9ICdoaWdoJ1xuICAgIH0gZWxzZSBpZiAocHJlZGljdGVkTG9hZCA+IDUwMCkge1xuICAgICAgcmVjb21tZW5kZWRBY3Rpb25zLnB1c2goJ01vbml0b3IgcXVldWUgZ3Jvd3RoIGNsb3NlbHknKVxuICAgICAgcmVjb21tZW5kZWRBY3Rpb25zLnB1c2goJ0NvbnNpZGVyIGVuYWJsaW5nIGFnZ3Jlc3NpdmUgY2xlYW51cCcpXG4gICAgICByaXNrQXNzZXNzbWVudCA9ICdtZWRpdW0nXG4gICAgfVxuICAgIFxuICAgIC8vIOWIhuaekOaAp+iDvei2i+WKv1xuICAgIGlmIChjdXJyZW50VGhyb3VnaHB1dCA8IDUpIHtcbiAgICAgIHJlY29tbWVuZGVkQWN0aW9ucy5wdXNoKCdJbnZlc3RpZ2F0ZSBsb3cgdGhyb3VnaHB1dCBjYXVzZXMnKVxuICAgICAgcmVjb21tZW5kZWRBY3Rpb25zLnB1c2goJ0NoZWNrIG5ldHdvcmsgY29ubmVjdGl2aXR5JylcbiAgICB9XG4gICAgXG4gICAgLy8g5YiG5p6Q5aSx6LSl546H6LaL5Yq/XG4gICAgY29uc3QgZmFpbHVyZVJhdGUgPSBzdGF0cy5ieVN0YXR1c1tTeW5jUXVldWVTdGF0dXMuRkFJTEVEXSAvIE1hdGgubWF4KDEsIHN0YXRzLnRvdGFsT3BlcmF0aW9ucylcbiAgICBpZiAoZmFpbHVyZVJhdGUgPiAwLjE1KSB7XG4gICAgICByZWNvbW1lbmRlZEFjdGlvbnMucHVzaCgnUmV2aWV3IGFuZCBvcHRpbWl6ZSBjb25mbGljdCByZXNvbHV0aW9uIHN0cmF0ZWdpZXMnKVxuICAgICAgcmVjb21tZW5kZWRBY3Rpb25zLnB1c2goJ0NvbnNpZGVyIHJlZHVjaW5nIHJldHJ5IGRlbGF5cyBmb3IgZmFpbGVkIG9wZXJhdGlvbnMnKVxuICAgIH1cbiAgICBcbiAgICAvLyDliIbmnpDpmJ/liJflubTpvoRcbiAgICBpZiAoc3RhdHMub2xkZXN0T3BlcmF0aW9uKSB7XG4gICAgICBjb25zdCBvbGRlc3RBZ2UgPSBEYXRlLm5vdygpIC0gc3RhdHMub2xkZXN0T3BlcmF0aW9uLmdldFRpbWUoKVxuICAgICAgaWYgKG9sZGVzdEFnZSA+IDMwICogNjAgKiAxMDAwKSB7IC8vIDMw5YiG6ZKfXG4gICAgICAgIHJlY29tbWVuZGVkQWN0aW9ucy5wdXNoKCdQcm9jZXNzIGFnZWQgb3BlcmF0aW9ucyB1cmdlbnRseScpXG4gICAgICAgIHJlY29tbWVuZGVkQWN0aW9ucy5wdXNoKCdDb25zaWRlciBwcmlvcml0eSBlc2NhbGF0aW9uJylcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHByZWRpY3RlZExvYWQsXG4gICAgICByZWNvbW1lbmRlZEFjdGlvbnMsXG4gICAgICByaXNrQXNzZXNzbWVudFxuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIOmihOa1i+acquadpei0n+i9vVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBwcmVkaWN0RnV0dXJlTG9hZChzdGF0czogUXVldWVTdGF0cywgY3VycmVudFRocm91Z2hwdXQ6IG51bWJlcik6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOiOt+WPluacgOi/kTHlsI/ml7bnmoTmk43kvZzmlbDmja5cbiAgICAgIGNvbnN0IGhvdXJBZ28gPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gNjAgKiA2MCAqIDEwMDApXG4gICAgICBjb25zdCByZWNlbnRPcGVyYXRpb25zID0gYXdhaXQgZGIuc3luY1F1ZXVlXG4gICAgICAgIC53aGVyZSgndGltZXN0YW1wJylcbiAgICAgICAgLmFib3ZlKGhvdXJBZ28pXG4gICAgICAgIC50b0FycmF5KClcbiAgICAgIFxuICAgICAgaWYgKHJlY2VudE9wZXJhdGlvbnMubGVuZ3RoID09PSAwKSByZXR1cm4gY3VycmVudFRocm91Z2hwdXQgKiAyXG4gICAgICBcbiAgICAgIC8vIOiuoeeul+WinumVv+eOh1xuICAgICAgY29uc3QgZ3Jvd3RoUmF0ZSA9IHRoaXMuY2FsY3VsYXRlR3Jvd3RoUmF0ZShyZWNlbnRPcGVyYXRpb25zKVxuICAgICAgXG4gICAgICAvLyDpooTmtYvmnKrmnaUx5bCP5pe255qE6LSf6L29XG4gICAgICBjb25zdCBwcmVkaWN0ZWRMb2FkID0gc3RhdHMudG90YWxPcGVyYXRpb25zICogKDEgKyBncm93dGhSYXRlKVxuICAgICAgXG4gICAgICByZXR1cm4gTWF0aC5tYXgoY3VycmVudFRocm91Z2hwdXQgKiAyLCBwcmVkaWN0ZWRMb2FkKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcHJlZGljdCBmdXR1cmUgbG9hZDonLCBlcnJvcilcbiAgICAgIHJldHVybiBjdXJyZW50VGhyb3VnaHB1dCAqIDJcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDorqHnrpflop7plb/njodcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlR3Jvd3RoUmF0ZShvcGVyYXRpb25zOiBTeW5jT3BlcmF0aW9uW10pOiBudW1iZXIge1xuICAgIGlmIChvcGVyYXRpb25zLmxlbmd0aCA8IDIpIHJldHVybiAwLjEgLy8g6buY6K6kMTAl5aKe6ZW/XG4gICAgXG4gICAgLy8g5oyJ5pe26Ze05YiG57uEXG4gICAgY29uc3QgdGltZUdyb3VwcyA9IG5ldyBNYXA8bnVtYmVyLCBudW1iZXI+KClcbiAgICBvcGVyYXRpb25zLmZvckVhY2gob3AgPT4ge1xuICAgICAgY29uc3QgdGltZVNsb3QgPSBNYXRoLmZsb29yKG9wLnRpbWVzdGFtcC5nZXRUaW1lKCkgLyAoMTAgKiA2MCAqIDEwMDApKSAvLyAxMOWIhumSn+mXtOmalFxuICAgICAgdGltZUdyb3Vwcy5zZXQodGltZVNsb3QsICh0aW1lR3JvdXBzLmdldCh0aW1lU2xvdCkgfHwgMCkgKyAxKVxuICAgIH0pXG4gICAgXG4gICAgY29uc3QgdGltZVNsb3RzID0gQXJyYXkuZnJvbSh0aW1lR3JvdXBzLmtleXMoKSkuc29ydCgpXG4gICAgaWYgKHRpbWVTbG90cy5sZW5ndGggPCAyKSByZXR1cm4gMC4xXG4gICAgXG4gICAgLy8g6K6h566X5aKe6ZW/546HXG4gICAgY29uc3QgZmlyc3RIYWxmID0gdGltZVNsb3RzLnNsaWNlKDAsIE1hdGguZmxvb3IodGltZVNsb3RzLmxlbmd0aCAvIDIpKVxuICAgIGNvbnN0IHNlY29uZEhhbGYgPSB0aW1lU2xvdHMuc2xpY2UoTWF0aC5mbG9vcih0aW1lU2xvdHMubGVuZ3RoIC8gMikpXG4gICAgXG4gICAgY29uc3QgZmlyc3RIYWxmQXZnID0gZmlyc3RIYWxmLnJlZHVjZSgoc3VtLCBzbG90KSA9PiBzdW0gKyAodGltZUdyb3Vwcy5nZXQoc2xvdCkgfHwgMCksIDApIC8gZmlyc3RIYWxmLmxlbmd0aFxuICAgIGNvbnN0IHNlY29uZEhhbGZBdmcgPSBzZWNvbmRIYWxmLnJlZHVjZSgoc3VtLCBzbG90KSA9PiBzdW0gKyAodGltZUdyb3Vwcy5nZXQoc2xvdCkgfHwgMCksIDApIC8gc2Vjb25kSGFsZi5sZW5ndGhcbiAgICBcbiAgICBpZiAoZmlyc3RIYWxmQXZnID09PSAwKSByZXR1cm4gMC4xXG4gICAgXG4gICAgcmV0dXJuIE1hdGgubWF4KC0wLjUsIE1hdGgubWluKDIsIChzZWNvbmRIYWxmQXZnIC0gZmlyc3RIYWxmQXZnKSAvIGZpcnN0SGFsZkF2ZykpXG4gIH1cblxuICAvKipcbiAgICog6K6h566X6Zif5YiX5pWI546HXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZVF1ZXVlRWZmaWNpZW5jeShzdGF0czogUXVldWVTdGF0cywgdGhyb3VnaHB1dDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBjb25zdCB7IHRvdGFsT3BlcmF0aW9ucywgYnlTdGF0dXMgfSA9IHN0YXRzXG4gICAgXG4gICAgLy8g5Z+656GA5pWI546H5YiG5pWwXG4gICAgbGV0IGVmZmljaWVuY3kgPSAwLjVcbiAgICBcbiAgICAvLyDmoLnmja7lvoXlpITnkIbmk43kvZzmlbDph4/osIPmlbRcbiAgICBpZiAodG90YWxPcGVyYXRpb25zIDwgMTAwKSBlZmZpY2llbmN5ICs9IDAuM1xuICAgIGVsc2UgaWYgKHRvdGFsT3BlcmF0aW9ucyA8IDUwMCkgZWZmaWNpZW5jeSArPSAwLjJcbiAgICBlbHNlIGlmICh0b3RhbE9wZXJhdGlvbnMgPCAxMDAwKSBlZmZpY2llbmN5ICs9IDAuMVxuICAgIFxuICAgIC8vIOagueaNruWksei0peeOh+iwg+aVtFxuICAgIGNvbnN0IGZhaWx1cmVSYXRlID0gYnlTdGF0dXNbU3luY1F1ZXVlU3RhdHVzLkZBSUxFRF0gLyBNYXRoLm1heCgxLCB0b3RhbE9wZXJhdGlvbnMpXG4gICAgZWZmaWNpZW5jeSAtPSBmYWlsdXJlUmF0ZSAqIDAuNVxuICAgIFxuICAgIC8vIOagueaNruWQnuWQkOmHj+iwg+aVtFxuICAgIGlmICh0aHJvdWdocHV0ID4gMjApIGVmZmljaWVuY3kgKz0gMC4yXG4gICAgZWxzZSBpZiAodGhyb3VnaHB1dCA+IDEwKSBlZmZpY2llbmN5ICs9IDAuMVxuICAgIFxuICAgIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBlZmZpY2llbmN5KSlcbiAgfVxuXG4gIC8qKlxuICAgKiDliIbmnpDnk7bpoohcbiAgICovXG4gIHByaXZhdGUgYW5hbHl6ZUJvdHRsZW5lY2tzKHN0YXRzOiBRdWV1ZVN0YXRzLCB0aHJvdWdocHV0OiBudW1iZXIsIGF2Z1Byb2Nlc3NpbmdUaW1lOiBudW1iZXIpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgYm90dGxlbmVja3M6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICBpZiAoc3RhdHMudG90YWxPcGVyYXRpb25zID4gMTAwMCkge1xuICAgICAgYm90dGxlbmVja3MucHVzaCgnUXVldWUgYmFja2xvZyB0b28gbGFyZ2UnKVxuICAgIH1cbiAgICBcbiAgICBpZiAodGhyb3VnaHB1dCA8IDUpIHtcbiAgICAgIGJvdHRsZW5lY2tzLnB1c2goJ0xvdyB0aHJvdWdocHV0IGRldGVjdGVkJylcbiAgICB9XG4gICAgXG4gICAgaWYgKGF2Z1Byb2Nlc3NpbmdUaW1lID4gNTAwMCkge1xuICAgICAgYm90dGxlbmVja3MucHVzaCgnSGlnaCBwcm9jZXNzaW5nIHRpbWUnKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBmYWlsdXJlUmF0ZSA9IHN0YXRzLmJ5U3RhdHVzW1N5bmNRdWV1ZVN0YXR1cy5GQUlMRURdIC8gTWF0aC5tYXgoMSwgc3RhdHMudG90YWxPcGVyYXRpb25zKVxuICAgIGlmIChmYWlsdXJlUmF0ZSA+IDAuMikge1xuICAgICAgYm90dGxlbmVja3MucHVzaCgnSGlnaCBmYWlsdXJlIHJhdGUnKVxuICAgIH1cbiAgICBcbiAgICBpZiAoYm90dGxlbmVja3MubGVuZ3RoID09PSAwKSB7XG4gICAgICBib3R0bGVuZWNrcy5wdXNoKCdObyBzaWduaWZpY2FudCBib3R0bGVuZWNrcyBkZXRlY3RlZCcpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBib3R0bGVuZWNrc1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOWvvOWHuuWNleS+i+WunuS+i1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3Qgc3luY1F1ZXVlTWFuYWdlciA9IG5ldyBTeW5jUXVldWVNYW5hZ2VyKClcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g5L6/5Yip5pa55rOV5a+85Ye6XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjb25zdCBlbnF1ZXVlU3luY09wZXJhdGlvbiA9IChvcGVyYXRpb246IE9taXQ8UXVldWVPcGVyYXRpb24sICdpZCcgfCAnc3RhdHVzJyB8ICd0aW1lc3RhbXAnPikgPT4gXG4gIHN5bmNRdWV1ZU1hbmFnZXIuZW5xdWV1ZU9wZXJhdGlvbihvcGVyYXRpb24pXG5cbmV4cG9ydCBjb25zdCBlbnF1ZXVlU3luY0JhdGNoID0gKG9wZXJhdGlvbnM6IE9taXQ8UXVldWVPcGVyYXRpb24sICdpZCcgfCAnc3RhdHVzJyB8ICd0aW1lc3RhbXAnPltdKSA9PiBcbiAgc3luY1F1ZXVlTWFuYWdlci5lbnF1ZXVlQmF0Y2gob3BlcmF0aW9ucylcblxuZXhwb3J0IGNvbnN0IGdldFN5bmNRdWV1ZVN0YXRzID0gKCkgPT4gc3luY1F1ZXVlTWFuYWdlci5nZXRRdWV1ZVN0YXRzKClcbmV4cG9ydCBjb25zdCBnZXRTeW5jT3BlcmF0aW9ucyA9IChmaWx0ZXJzPzogYW55KSA9PiBzeW5jUXVldWVNYW5hZ2VyLmdldE9wZXJhdGlvbnMoZmlsdGVycylcbmV4cG9ydCBjb25zdCBjbGVhbnVwU3luY09wZXJhdGlvbnMgPSAob2xkZXJUaGFuPzogbnVtYmVyKSA9PiBzeW5jUXVldWVNYW5hZ2VyLmNsZWFudXBDb21wbGV0ZWRPcGVyYXRpb25zKG9sZGVyVGhhbilcbmV4cG9ydCBjb25zdCByZXRyeUZhaWxlZFN5bmNPcGVyYXRpb25zID0gKCkgPT4gc3luY1F1ZXVlTWFuYWdlci5yZXRyeUZhaWxlZE9wZXJhdGlvbnMoKSJdLCJ2ZXJzaW9uIjozfQ==