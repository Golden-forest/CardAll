bdc6f8588339869a8425c7b725c5bbe9
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useConflicts = useConflicts;
const react_1 = require("react");
const conflict_resolution_1 = require("@/utils/conflict-resolution");
const unified_sync_service_1 = require("@/services/core/sync/unified-sync.service");
function useConflicts() {
    const [conflicts, setConflicts] = (0, react_1.useState)([]);
    const [selectedConflict, setSelectedConflict] = (0, react_1.useState)(null);
    const [isResolving, setIsResolving] = (0, react_1.useState)(false);
    const [isLoading, setIsLoading] = (0, react_1.useState)(false);
    const [error, setError] = (0, react_1.useState)(null);
    const [metrics, setMetrics] = (0, react_1.useState)(null);
    const [syncStatus, setSyncStatus] = (0, react_1.useState)(null);
    const statsRef = (0, react_1.useRef)({
        totalConflicts: 0,
        resolvedConflicts: 0,
        pendingConflicts: 0,
        conflictsByType: {},
        conflictsBySeverity: {},
        averageResolutionTime: 0
    });
    // 计算冲突统计
    (0, react_1.useEffect)(() => {
        const newStats = {
            totalConflicts: conflicts.length,
            resolvedConflicts: conflicts.filter(c => c.status === 'resolved').length,
            pendingConflicts: conflicts.filter(c => c.status === 'pending').length,
            conflictsByType: {},
            conflictsBySeverity: {},
            averageResolutionTime: calculateAverageResolutionTime()
        };
        // 按类型统计
        conflicts.forEach(conflict => {
            newStats.conflictsByType[conflict.type] = (newStats.conflictsByType[conflict.type] || 0) + 1;
            newStats.conflictsBySeverity[conflict.severity] = (newStats.conflictsBySeverity[conflict.severity] || 0) + 1;
        });
        statsRef.current = newStats;
    }, [conflicts]);
    // 初始化冲突管理
    (0, react_1.useEffect)(() => {
        initializeConflictManagement();
        // 监听同步状态变化
        const syncInterval = setInterval(() => {
            updateSyncStatus();
        }, 5000); // 每5秒更新同步状态
        return () => {
            clearInterval(syncInterval);
        };
    }, []);
    // 初始化冲突管理
    const initializeConflictManagement = async () => {
        setIsLoading(true);
        try {
            // 从统一同步服务获取冲突
            await loadConflictsFromService();
            await updateSyncStatus();
            setError(null);
        }
        catch (err) {
            console.error('Failed to initialize conflict management:', err);
            setError(err instanceof Error ? err.message : 'Unknown error');
        }
        finally {
            setIsLoading(false);
        }
    };
    // 从服务加载冲突
    const loadConflictsFromService = async () => {
        try {
            // 获取统一同步服务的冲突
            const syncConflicts = unified_sync_service_1.unifiedSyncService.getConflicts();
            // 转换为前端冲突格式
            const convertedConflicts = convertSyncConflictsToUIConflicts(syncConflicts);
            setConflicts(convertedConflicts);
            return convertedConflicts;
        }
        catch (err) {
            console.error('Failed to load conflicts from service:', err);
            // 如果服务失败，返回空数组而不是错误
            return [];
        }
    };
    // 转换同步服务冲突到UI冲突格式
    const convertSyncConflictsToUIConflicts = (syncConflicts) => {
        return syncConflicts.map(syncConflict => {
            const baseConflict = {
                id: syncConflict.id,
                type: mapConflictType(syncConflict.conflictType),
                entityType: syncConflict.entityType,
                entityId: syncConflict.entityId,
                timestamp: syncConflict.detectedAt || new Date(),
                sourceDevice: syncConflict.sourceDevice || 'Unknown',
                severity: syncConflict.severity,
                status: mapConflictStatus(syncConflict.status),
                createdAt: syncConflict.detectedAt || new Date(),
                resolvedAt: syncConflict.resolvedAt,
                resolvedBy: syncConflict.resolvedBy,
                resolution: syncConflict.resolution ? mapConflictResolution(syncConflict.resolution) : undefined
            };
            switch (syncConflict.entityType) {
                case 'card':
                    return {
                        ...baseConflict,
                        type: 'card_content',
                        localVersion: syncConflict.localData,
                        remoteVersion: syncConflict.cloudData,
                        conflictFields: syncConflict.conflictFields || [],
                        suggestions: syncConflict.suggestions?.map((s) => ({
                            type: s.type,
                            confidence: s.confidence,
                            reason: s.reasoning || s.reason,
                            preview: s.preview
                        }))
                    };
                case 'folder':
                    return {
                        ...baseConflict,
                        type: 'folder_name',
                        localVersion: syncConflict.localData,
                        remoteVersion: syncConflict.cloudData,
                        affectedCards: syncConflict.conflictDetails?.affectedEntities || []
                    };
                case 'tag':
                    return {
                        ...baseConflict,
                        type: 'tag_rename',
                        localVersion: syncConflict.localData,
                        remoteVersion: syncConflict.cloudData,
                        affectedCards: syncConflict.conflictDetails?.affectedEntities || []
                    };
                default:
                    throw new Error(`Unknown entity type: ${syncConflict.entityType}`);
            }
        });
    };
    // 映射冲突类型
    const mapConflictType = (syncType) => {
        const typeMap = {
            'content': 'card_content',
            'version': 'card_content',
            'structure': 'folder_structure',
            'delete': 'tag_delete',
            'field': 'card_content'
        };
        return typeMap[syncType] || 'card_content';
    };
    // 映射冲突状态
    const mapConflictStatus = (syncStatus) => {
        const statusMap = {
            'pending': 'pending',
            'resolving': 'reviewing',
            'resolved': 'resolved',
            'manual_required': 'pending'
        };
        return statusMap[syncStatus] || 'pending';
    };
    // 映射冲突解决方式
    const mapConflictResolution = (syncResolution) => {
        return {
            type: syncResolution.type,
            mergedData: syncResolution.mergedData,
            reason: syncResolution.reasoning,
            manualChanges: syncResolution.manualChanges
        };
    };
    // 计算平均解决时间
    const calculateAverageResolutionTime = () => {
        const resolvedConflicts = conflicts.filter(c => c.status === 'resolved' && c.resolvedAt);
        if (resolvedConflicts.length === 0)
            return 0;
        const totalTime = resolvedConflicts.reduce((sum, conflict) => {
            return sum + (conflict.resolvedAt.getTime() - conflict.createdAt.getTime());
        }, 0);
        return totalTime / resolvedConflicts.length;
    };
    // 更新同步状态
    const updateSyncStatus = async () => {
        try {
            const status = unified_sync_service_1.unifiedSyncService.getStatus();
            setSyncStatus(status);
            // 自动检测新冲突
            if (status.isSyncing === false && status.networkStatus?.online) {
                await detectNewConflicts();
            }
        }
        catch (err) {
            console.error('Failed to update sync status:', err);
        }
    };
    // 检测新冲突
    const detectNewConflicts = async () => {
        try {
            const currentConflicts = await loadConflictsFromService();
            const newConflicts = currentConflicts.filter(c => c.status === 'pending');
            // 如果有新的冲突，触发事件或更新UI
            if (newConflicts.length > conflicts.filter(c => c.status === 'pending').length) {
                setConflicts(currentConflicts);
                // 这里可以触发通知
            }
        }
        catch (err) {
            console.error('Failed to detect new conflicts:', err);
        }
    };
    // 获取冲突详情
    const getConflictById = (0, react_1.useCallback)((id) => {
        return conflicts.find(c => c.id === id);
    }, [conflicts]);
    // 获取待解决的冲突
    const getPendingConflicts = (0, react_1.useCallback)(() => {
        return conflicts.filter(c => c.status === 'pending');
    }, [conflicts]);
    // 获取高优先级冲突
    const getHighPriorityConflicts = (0, react_1.useCallback)(() => {
        return conflicts.filter(c => c.severity === 'high' || c.severity === 'critical');
    }, [conflicts]);
    // 获取统计信息
    const getStats = (0, react_1.useCallback)(() => {
        return { ...statsRef.current };
    }, []);
    // 解决冲突
    const resolveConflict = (0, react_1.useCallback)(async (conflictId, resolution) => {
        setIsResolving(true);
        setError(null);
        try {
            // 调用统一同步服务解决冲突
            const success = await unified_sync_service_1.unifiedSyncService.resolveConflict(conflictId, resolution.type, resolution.mergedData);
            if (success) {
                // 更新本地状态
                setConflicts(prev => prev.map(conflict => conflict.id === conflictId
                    ? {
                        ...conflict,
                        status: 'resolved',
                        resolvedAt: new Date(),
                        resolvedBy: 'user',
                        resolution
                    }
                    : conflict));
                setSelectedConflict(null);
                // 刷新同步状态
                await updateSyncStatus();
                return true;
            }
            else {
                throw new Error('Failed to resolve conflict via sync service');
            }
        }
        catch (err) {
            console.error('Failed to resolve conflict:', err);
            setError(err instanceof Error ? err.message : 'Unknown error');
            return false;
        }
        finally {
            setIsResolving(false);
        }
    }, []);
    // 忽略冲突
    const ignoreConflict = (0, react_1.useCallback)(async (conflictId) => {
        try {
            // 在同步服务中标记为忽略
            const conflict = conflicts.find(c => c.id === conflictId);
            if (!conflict)
                return;
            // 这里可以调用服务API来忽略冲突
            // 目前先更新本地状态
            setConflicts(prev => prev.map(conflict => conflict.id === conflictId
                ? { ...conflict, status: 'ignored' }
                : conflict));
            setSelectedConflict(null);
        }
        catch (err) {
            console.error('Failed to ignore conflict:', err);
            setError(err instanceof Error ? err.message : 'Unknown error');
        }
    }, [conflicts]);
    // 批量解决冲突
    const batchResolveConflicts = (0, react_1.useCallback)(async (conflictIds, resolution) => {
        setIsResolving(true);
        setError(null);
        try {
            // 批量解决冲突
            const results = await Promise.allSettled(conflictIds.map(conflictId => unified_sync_service_1.unifiedSyncService.resolveConflict(conflictId, resolution.type, resolution.mergedData)));
            const successfulResolves = results.filter(r => r.status === 'fulfilled').length;
            const failedResolves = results.filter(r => r.status === 'rejected').length;
            if (successfulResolves > 0) {
                // 更新本地状态
                setConflicts(prev => prev.map(conflict => conflictIds.includes(conflict.id)
                    ? {
                        ...conflict,
                        status: 'resolved',
                        resolvedAt: new Date(),
                        resolvedBy: 'user',
                        resolution
                    }
                    : conflict));
            }
            if (failedResolves > 0) {
                throw new Error(`${failedResolves} conflicts failed to resolve`);
            }
            // 刷新同步状态
            await updateSyncStatus();
            return true;
        }
        catch (err) {
            console.error('Failed to batch resolve conflicts:', err);
            setError(err instanceof Error ? err.message : 'Unknown error');
            return false;
        }
        finally {
            setIsResolving(false);
        }
    }, []);
    // 获取冲突解决建议
    const getSuggestions = (0, react_1.useCallback)((conflictId) => {
        const conflict = getConflictById(conflictId);
        if (!conflict)
            return [];
        // 使用智能冲突解决引擎生成建议
        const engineSuggestions = conflict_resolution_1.ConflictResolutionEngine.generateSuggestions(conflict);
        // 添加基于同步服务的建议
        const syncSuggestions = unified_sync_service_1.unifiedSyncService.getConflict(conflictId)?.suggestions || [];
        // 合并并去重建议
        const allSuggestions = [...engineSuggestions, ...syncSuggestions.map((s) => ({
                type: s.type,
                confidence: s.confidence,
                reason: s.reasoning || s.reason,
                preview: s.preview
            }))];
        // 按置信度排序
        return allSuggestions.sort((a, b) => b.confidence - a.confidence);
    }, [getConflictById]);
    // 检测新冲突
    const detectConflicts = (0, react_1.useCallback)(async () => {
        setIsLoading(true);
        try {
            // 执行同步以检测新冲突
            const syncResult = await unified_sync_service_1.unifiedSyncService.sync({
                type: 'incremental',
                direction: 'bidirectional'
            });
            // 加载更新后的冲突
            const updatedConflicts = await loadConflictsFromService();
            const newConflicts = updatedConflicts.filter(c => c.status === 'pending');
            setConflicts(updatedConflicts);
            return newConflicts;
        }
        catch (err) {
            console.error('Failed to detect conflicts:', err);
            setError(err instanceof Error ? err.message : 'Unknown error');
            return [];
        }
        finally {
            setIsLoading(false);
        }
    }, []);
    // 自动解决冲突
    const autoResolveConflicts = (0, react_1.useCallback)(async () => {
        setIsResolving(true);
        try {
            const resolvedCount = await unified_sync_service_1.unifiedSyncService.autoResolveConflicts();
            // 刷新冲突列表
            await loadConflictsFromService();
            await updateSyncStatus();
            return resolvedCount;
        }
        catch (err) {
            console.error('Failed to auto-resolve conflicts:', err);
            setError(err instanceof Error ? err.message : 'Unknown error');
            return 0;
        }
        finally {
            setIsResolving(false);
        }
    }, []);
    // 获取冲突详情（完整信息）
    const getConflictDetails = (0, react_1.useCallback)(async (conflictId) => {
        try {
            const conflict = getConflictById(conflictId);
            if (!conflict)
                return null;
            // 获取同步服务中的详细信息
            const syncConflict = unified_sync_service_1.unifiedSyncService.getConflict(conflictId);
            return {
                ...conflict,
                syncDetails: syncConflict,
                suggestions: getSuggestions(conflictId)
            };
        }
        catch (err) {
            console.error('Failed to get conflict details:', err);
            return null;
        }
    }, [getConflictById, getSuggestions]);
    // 刷新冲突列表
    const refreshConflicts = (0, react_1.useCallback)(async () => {
        setIsLoading(true);
        try {
            await loadConflictsFromService();
            await updateSyncStatus();
            setError(null);
        }
        catch (err) {
            console.error('Failed to refresh conflicts:', err);
            setError(err instanceof Error ? err.message : 'Unknown error');
        }
        finally {
            setIsLoading(false);
        }
    }, []);
    // 清除错误
    const clearError = (0, react_1.useCallback)(() => {
        setError(null);
    }, []);
    return {
        // 状态
        conflicts,
        selectedConflict,
        setSelectedConflict,
        isResolving,
        isLoading,
        error,
        syncStatus,
        metrics,
        // 方法
        getConflictById,
        getPendingConflicts,
        getHighPriorityConflicts,
        getStats,
        resolveConflict,
        ignoreConflict,
        batchResolveConflicts,
        getSuggestions,
        detectConflicts,
        autoResolveConflicts,
        getConflictDetails,
        refreshConflicts,
        clearError
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcaG9va3NcXHVzZS1jb25mbGljdHMudHMiLCJtYXBwaW5ncyI6Ijs7QUFvQkEsb0NBOGVDO0FBbGdCRCxpQ0FBZ0U7QUFZaEUscUVBQXNFO0FBQ3RFLG9GQUE4RTtBQU85RSxTQUFnQixZQUFZO0lBQzFCLE1BQU0sQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFrRCxFQUFFLENBQUMsQ0FBQTtJQUMvRixNQUFNLENBQUMsZ0JBQWdCLEVBQUUsbUJBQW1CLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQWdCLElBQUksQ0FBQyxDQUFBO0lBQzdFLE1BQU0sQ0FBQyxXQUFXLEVBQUUsY0FBYyxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFBO0lBQ3JELE1BQU0sQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFBO0lBQ2pELE1BQU0sQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFnQixJQUFJLENBQUMsQ0FBQTtJQUN2RCxNQUFNLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBK0IsSUFBSSxDQUFDLENBQUE7SUFDMUUsTUFBTSxDQUFDLFVBQVUsRUFBRSxhQUFhLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQU0sSUFBSSxDQUFDLENBQUE7SUFFdkQsTUFBTSxRQUFRLEdBQUcsSUFBQSxjQUFNLEVBQWdCO1FBQ3JDLGNBQWMsRUFBRSxDQUFDO1FBQ2pCLGlCQUFpQixFQUFFLENBQUM7UUFDcEIsZ0JBQWdCLEVBQUUsQ0FBQztRQUNuQixlQUFlLEVBQUUsRUFBUztRQUMxQixtQkFBbUIsRUFBRSxFQUFTO1FBQzlCLHFCQUFxQixFQUFFLENBQUM7S0FDekIsQ0FBQyxDQUFBO0lBRUYsU0FBUztJQUNULElBQUEsaUJBQVMsRUFB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Q1YsT0FBTztRQUVQLEtBQUs7UUFDTCxlQUFlO1FBQ2YsbUJBQW1CO1FBQ25CLHdCQUF3QjtRQUN4QixRQUFRO1FBQ1IsZUFBZTtRQUNmLGNBQWM7UUFDZCxxQkFBcUI7UUFDckIsY0FBYztRQUNkLGVBQWU7UUFDZixvQkFBb0I7UUFDcEIsa0JBQWtCO1FBQ2xCLGdCQUFnQjtRQUNoQixVQUFVO0tBQ1gsQ0FBQTtBQUNILENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcaG9va3NcXHVzZS1jb25mbGljdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2ssIHVzZVJlZiB9IGZyb20gJ3JlYWN0J1xyXG5pbXBvcnQge1xyXG4gIENvbmZsaWN0QmFzZSxcclxuICBDYXJkQ29uZmxpY3QsXHJcbiAgRm9sZGVyQ29uZmxpY3QsXHJcbiAgVGFnQ29uZmxpY3QsXHJcbiAgQ29uZmxpY3RSZXNvbHV0aW9uLFxyXG4gIENvbmZsaWN0U3VnZ2VzdGlvbixcclxuICBDb25mbGljdFN0YXRzLFxyXG4gIENvbmZsaWN0U3RhdHVzLFxyXG4gIENvbmZsaWN0U2V2ZXJpdHlcclxufSBmcm9tICdAL3R5cGVzL2NvbmZsaWN0J1xyXG5pbXBvcnQgeyBDb25mbGljdFJlc29sdXRpb25FbmdpbmUgfSBmcm9tICdAL3V0aWxzL2NvbmZsaWN0LXJlc29sdXRpb24nXHJcbmltcG9ydCB7IHVuaWZpZWRTeW5jU2VydmljZSB9IGZyb20gJ0Avc2VydmljZXMvY29yZS9zeW5jL3VuaWZpZWQtc3luYy5zZXJ2aWNlJ1xyXG5pbXBvcnQgdHlwZSB7XHJcbiAgVW5pZmllZENvbmZsaWN0LFxyXG4gIENvbmZsaWN0UmVzb2x1dGlvbiBhcyBVbmlmaWVkQ29uZmxpY3RSZXNvbHV0aW9uLFxyXG4gIENvbmZsaWN0RW5naW5lTWV0cmljc1xyXG59IGZyb20gJ0Avc2VydmljZXMvc3luYy9jb25mbGljdC1yZXNvbHV0aW9uLWVuZ2luZS91bmlmaWVkLWNvbmZsaWN0LXJlc29sdXRpb24tZW5naW5lJ1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVzZUNvbmZsaWN0cygpIHtcclxuICBjb25zdCBbY29uZmxpY3RzLCBzZXRDb25mbGljdHNdID0gdXNlU3RhdGU8KENhcmRDb25mbGljdCB8IEZvbGRlckNvbmZsaWN0IHwgVGFnQ29uZmxpY3QpW10+KFtdKVxyXG4gIGNvbnN0IFtzZWxlY3RlZENvbmZsaWN0LCBzZXRTZWxlY3RlZENvbmZsaWN0XSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpXHJcbiAgY29uc3QgW2lzUmVzb2x2aW5nLCBzZXRJc1Jlc29sdmluZ10gPSB1c2VTdGF0ZShmYWxzZSlcclxuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpXHJcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKVxyXG4gIGNvbnN0IFttZXRyaWNzLCBzZXRNZXRyaWNzXSA9IHVzZVN0YXRlPENvbmZsaWN0RW5naW5lTWV0cmljcyB8IG51bGw+KG51bGwpXHJcbiAgY29uc3QgW3N5bmNTdGF0dXMsIHNldFN5bmNTdGF0dXNdID0gdXNlU3RhdGU8YW55PihudWxsKVxyXG5cclxuICBjb25zdCBzdGF0c1JlZiA9IHVzZVJlZjxDb25mbGljdFN0YXRzPih7XHJcbiAgICB0b3RhbENvbmZsaWN0czogMCxcclxuICAgIHJlc29sdmVkQ29uZmxpY3RzOiAwLFxyXG4gICAgcGVuZGluZ0NvbmZsaWN0czogMCxcclxuICAgIGNvbmZsaWN0c0J5VHlwZToge30gYXMgYW55LFxyXG4gICAgY29uZmxpY3RzQnlTZXZlcml0eToge30gYXMgYW55LFxyXG4gICAgYXZlcmFnZVJlc29sdXRpb25UaW1lOiAwXHJcbiAgfSlcclxuXHJcbiAgLy8g6K6h566X5Yay56qB57uf6K6hXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGNvbnN0IG5ld1N0YXRzOiBDb25mbGljdFN0YXRzID0ge1xyXG4gICAgICB0b3RhbENvbmZsaWN0czogY29uZmxpY3RzLmxlbmd0aCxcclxuICAgICAgcmVzb2x2ZWRDb25mbGljdHM6IGNvbmZsaWN0cy5maWx0ZXIoYyA9PiBjLnN0YXR1cyA9PT0gJ3Jlc29sdmVkJykubGVuZ3RoLFxyXG4gICAgICBwZW5kaW5nQ29uZmxpY3RzOiBjb25mbGljdHMuZmlsdGVyKGMgPT4gYy5zdGF0dXMgPT09ICdwZW5kaW5nJykubGVuZ3RoLFxyXG4gICAgICBjb25mbGljdHNCeVR5cGU6IHt9IGFzIGFueSxcclxuICAgICAgY29uZmxpY3RzQnlTZXZlcml0eToge30gYXMgYW55LFxyXG4gICAgICBhdmVyYWdlUmVzb2x1dGlvblRpbWU6IGNhbGN1bGF0ZUF2ZXJhZ2VSZXNvbHV0aW9uVGltZSgpXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5oyJ57G75Z6L57uf6K6hXHJcbiAgICBjb25mbGljdHMuZm9yRWFjaChjb25mbGljdCA9PiB7XHJcbiAgICAgIG5ld1N0YXRzLmNvbmZsaWN0c0J5VHlwZVtjb25mbGljdC50eXBlXSA9IChuZXdTdGF0cy5jb25mbGljdHNCeVR5cGVbY29uZmxpY3QudHlwZV0gfHwgMCkgKyAxXHJcbiAgICAgIG5ld1N0YXRzLmNvbmZsaWN0c0J5U2V2ZXJpdHlbY29uZmxpY3Quc2V2ZXJpdHldID0gKG5ld1N0YXRzLmNvbmZsaWN0c0J5U2V2ZXJpdHlbY29uZmxpY3Quc2V2ZXJpdHldIHx8IDApICsgMVxyXG4gICAgfSlcclxuXHJcbiAgICBzdGF0c1JlZi5jdXJyZW50ID0gbmV3U3RhdHNcclxuICB9LCBbY29uZmxpY3RzXSlcclxuXHJcbiAgLy8g5Yid5aeL5YyW5Yay56qB566h55CGXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGluaXRpYWxpemVDb25mbGljdE1hbmFnZW1lbnQoKVxyXG5cclxuICAgIC8vIOebkeWQrOWQjOatpeeKtuaAgeWPmOWMllxyXG4gICAgY29uc3Qgc3luY0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICB1cGRhdGVTeW5jU3RhdHVzKClcclxuICAgIH0sIDUwMDApIC8vIOavjzXnp5Lmm7TmlrDlkIzmraXnirbmgIFcclxuXHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICBjbGVhckludGVydmFsKHN5bmNJbnRlcnZhbClcclxuICAgIH1cclxuICB9LCBbXSlcclxuXHJcbiAgLy8g5Yid5aeL5YyW5Yay56qB566h55CGXHJcbiAgY29uc3QgaW5pdGlhbGl6ZUNvbmZsaWN0TWFuYWdlbWVudCA9IGFzeW5jICgpID0+IHtcclxuICAgIHNldElzTG9hZGluZyh0cnVlKVxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g5LuO57uf5LiA5ZCM5q2l5pyN5Yqh6I635Y+W5Yay56qBXHJcbiAgICAgIGF3YWl0IGxvYWRDb25mbGljdHNGcm9tU2VydmljZSgpXHJcbiAgICAgIGF3YWl0IHVwZGF0ZVN5bmNTdGF0dXMoKVxyXG4gICAgICBzZXRFcnJvcihudWxsKVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIGNvbmZsaWN0IG1hbmFnZW1lbnQ6JywgZXJyKVxyXG4gICAgICBzZXRFcnJvcihlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InKVxyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8g5LuO5pyN5Yqh5Yqg6L295Yay56qBXHJcbiAgY29uc3QgbG9hZENvbmZsaWN0c0Zyb21TZXJ2aWNlID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g6I635Y+W57uf5LiA5ZCM5q2l5pyN5Yqh55qE5Yay56qBXHJcbiAgICAgIGNvbnN0IHN5bmNDb25mbGljdHMgPSB1bmlmaWVkU3luY1NlcnZpY2UuZ2V0Q29uZmxpY3RzKClcclxuXHJcbiAgICAgIC8vIOi9rOaNouS4uuWJjeerr+WGsueqgeagvOW8j1xyXG4gICAgICBjb25zdCBjb252ZXJ0ZWRDb25mbGljdHMgPSBjb252ZXJ0U3luY0NvbmZsaWN0c1RvVUlDb25mbGljdHMoc3luY0NvbmZsaWN0cylcclxuXHJcbiAgICAgIHNldENvbmZsaWN0cyhjb252ZXJ0ZWRDb25mbGljdHMpXHJcbiAgICAgIHJldHVybiBjb252ZXJ0ZWRDb25mbGljdHNcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBjb25mbGljdHMgZnJvbSBzZXJ2aWNlOicsIGVycilcclxuICAgICAgLy8g5aaC5p6c5pyN5Yqh5aSx6LSl77yM6L+U5Zue56m65pWw57uE6ICM5LiN5piv6ZSZ6K+vXHJcbiAgICAgIHJldHVybiBbXVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8g6L2s5o2i5ZCM5q2l5pyN5Yqh5Yay56qB5YiwVUnlhrLnqoHmoLzlvI9cclxuICBjb25zdCBjb252ZXJ0U3luY0NvbmZsaWN0c1RvVUlDb25mbGljdHMgPSAoc3luY0NvbmZsaWN0czogYW55W10pOiAoQ2FyZENvbmZsaWN0IHwgRm9sZGVyQ29uZmxpY3QgfCBUYWdDb25mbGljdClbXSA9PiB7XHJcbiAgICByZXR1cm4gc3luY0NvbmZsaWN0cy5tYXAoc3luY0NvbmZsaWN0ID0+IHtcclxuICAgICAgY29uc3QgYmFzZUNvbmZsaWN0OiBDb25mbGljdEJhc2UgPSB7XHJcbiAgICAgICAgaWQ6IHN5bmNDb25mbGljdC5pZCxcclxuICAgICAgICB0eXBlOiBtYXBDb25mbGljdFR5cGUoc3luY0NvbmZsaWN0LmNvbmZsaWN0VHlwZSksXHJcbiAgICAgICAgZW50aXR5VHlwZTogc3luY0NvbmZsaWN0LmVudGl0eVR5cGUsXHJcbiAgICAgICAgZW50aXR5SWQ6IHN5bmNDb25mbGljdC5lbnRpdHlJZCxcclxuICAgICAgICB0aW1lc3RhbXA6IHN5bmNDb25mbGljdC5kZXRlY3RlZEF0IHx8IG5ldyBEYXRlKCksXHJcbiAgICAgICAgc291cmNlRGV2aWNlOiBzeW5jQ29uZmxpY3Quc291cmNlRGV2aWNlIHx8ICdVbmtub3duJyxcclxuICAgICAgICBzZXZlcml0eTogc3luY0NvbmZsaWN0LnNldmVyaXR5LFxyXG4gICAgICAgIHN0YXR1czogbWFwQ29uZmxpY3RTdGF0dXMoc3luY0NvbmZsaWN0LnN0YXR1cyksXHJcbiAgICAgICAgY3JlYXRlZEF0OiBzeW5jQ29uZmxpY3QuZGV0ZWN0ZWRBdCB8fCBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIHJlc29sdmVkQXQ6IHN5bmNDb25mbGljdC5yZXNvbHZlZEF0LFxyXG4gICAgICAgIHJlc29sdmVkQnk6IHN5bmNDb25mbGljdC5yZXNvbHZlZEJ5LFxyXG4gICAgICAgIHJlc29sdXRpb246IHN5bmNDb25mbGljdC5yZXNvbHV0aW9uID8gbWFwQ29uZmxpY3RSZXNvbHV0aW9uKHN5bmNDb25mbGljdC5yZXNvbHV0aW9uKSA6IHVuZGVmaW5lZFxyXG4gICAgICB9XHJcblxyXG4gICAgICBzd2l0Y2ggKHN5bmNDb25mbGljdC5lbnRpdHlUeXBlKSB7XHJcbiAgICAgICAgY2FzZSAnY2FyZCc6XHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAuLi5iYXNlQ29uZmxpY3QsXHJcbiAgICAgICAgICAgIHR5cGU6ICdjYXJkX2NvbnRlbnQnLFxyXG4gICAgICAgICAgICBsb2NhbFZlcnNpb246IHN5bmNDb25mbGljdC5sb2NhbERhdGEsXHJcbiAgICAgICAgICAgIHJlbW90ZVZlcnNpb246IHN5bmNDb25mbGljdC5jbG91ZERhdGEsXHJcbiAgICAgICAgICAgIGNvbmZsaWN0RmllbGRzOiBzeW5jQ29uZmxpY3QuY29uZmxpY3RGaWVsZHMgfHwgW10sXHJcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zOiBzeW5jQ29uZmxpY3Quc3VnZ2VzdGlvbnM/Lm1hcCgoczogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgIHR5cGU6IHMudHlwZSxcclxuICAgICAgICAgICAgICBjb25maWRlbmNlOiBzLmNvbmZpZGVuY2UsXHJcbiAgICAgICAgICAgICAgcmVhc29uOiBzLnJlYXNvbmluZyB8fCBzLnJlYXNvbixcclxuICAgICAgICAgICAgICBwcmV2aWV3OiBzLnByZXZpZXdcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICB9IGFzIENhcmRDb25mbGljdFxyXG5cclxuICAgICAgICBjYXNlICdmb2xkZXInOlxyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgLi4uYmFzZUNvbmZsaWN0LFxyXG4gICAgICAgICAgICB0eXBlOiAnZm9sZGVyX25hbWUnLFxyXG4gICAgICAgICAgICBsb2NhbFZlcnNpb246IHN5bmNDb25mbGljdC5sb2NhbERhdGEsXHJcbiAgICAgICAgICAgIHJlbW90ZVZlcnNpb246IHN5bmNDb25mbGljdC5jbG91ZERhdGEsXHJcbiAgICAgICAgICAgIGFmZmVjdGVkQ2FyZHM6IHN5bmNDb25mbGljdC5jb25mbGljdERldGFpbHM/LmFmZmVjdGVkRW50aXRpZXMgfHwgW11cclxuICAgICAgICAgIH0gYXMgRm9sZGVyQ29uZmxpY3RcclxuXHJcbiAgICAgICAgY2FzZSAndGFnJzpcclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIC4uLmJhc2VDb25mbGljdCxcclxuICAgICAgICAgICAgdHlwZTogJ3RhZ19yZW5hbWUnLFxyXG4gICAgICAgICAgICBsb2NhbFZlcnNpb246IHN5bmNDb25mbGljdC5sb2NhbERhdGEsXHJcbiAgICAgICAgICAgIHJlbW90ZVZlcnNpb246IHN5bmNDb25mbGljdC5jbG91ZERhdGEsXHJcbiAgICAgICAgICAgIGFmZmVjdGVkQ2FyZHM6IHN5bmNDb25mbGljdC5jb25mbGljdERldGFpbHM/LmFmZmVjdGVkRW50aXRpZXMgfHwgW11cclxuICAgICAgICAgIH0gYXMgVGFnQ29uZmxpY3RcclxuXHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBlbnRpdHkgdHlwZTogJHtzeW5jQ29uZmxpY3QuZW50aXR5VHlwZX1gKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8g5pig5bCE5Yay56qB57G75Z6LXHJcbiAgY29uc3QgbWFwQ29uZmxpY3RUeXBlID0gKHN5bmNUeXBlOiBzdHJpbmcpID0+IHtcclxuICAgIGNvbnN0IHR5cGVNYXA6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7XHJcbiAgICAgICdjb250ZW50JzogJ2NhcmRfY29udGVudCcsXHJcbiAgICAgICd2ZXJzaW9uJzogJ2NhcmRfY29udGVudCcsXHJcbiAgICAgICdzdHJ1Y3R1cmUnOiAnZm9sZGVyX3N0cnVjdHVyZScsXHJcbiAgICAgICdkZWxldGUnOiAndGFnX2RlbGV0ZScsXHJcbiAgICAgICdmaWVsZCc6ICdjYXJkX2NvbnRlbnQnXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHlwZU1hcFtzeW5jVHlwZV0gfHwgJ2NhcmRfY29udGVudCdcclxuICB9XHJcblxyXG4gIC8vIOaYoOWwhOWGsueqgeeKtuaAgVxyXG4gIGNvbnN0IG1hcENvbmZsaWN0U3RhdHVzID0gKHN5bmNTdGF0dXM6IHN0cmluZyk6IENvbmZsaWN0U3RhdHVzID0+IHtcclxuICAgIGNvbnN0IHN0YXR1c01hcDogUmVjb3JkPHN0cmluZywgQ29uZmxpY3RTdGF0dXM+ID0ge1xyXG4gICAgICAncGVuZGluZyc6ICdwZW5kaW5nJyxcclxuICAgICAgJ3Jlc29sdmluZyc6ICdyZXZpZXdpbmcnLFxyXG4gICAgICAncmVzb2x2ZWQnOiAncmVzb2x2ZWQnLFxyXG4gICAgICAnbWFudWFsX3JlcXVpcmVkJzogJ3BlbmRpbmcnXHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RhdHVzTWFwW3N5bmNTdGF0dXNdIHx8ICdwZW5kaW5nJ1xyXG4gIH1cclxuXHJcbiAgLy8g5pig5bCE5Yay56qB6Kej5Yaz5pa55byPXHJcbiAgY29uc3QgbWFwQ29uZmxpY3RSZXNvbHV0aW9uID0gKHN5bmNSZXNvbHV0aW9uOiBhbnkpOiBDb25mbGljdFJlc29sdXRpb24gPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdHlwZTogc3luY1Jlc29sdXRpb24udHlwZSxcclxuICAgICAgbWVyZ2VkRGF0YTogc3luY1Jlc29sdXRpb24ubWVyZ2VkRGF0YSxcclxuICAgICAgcmVhc29uOiBzeW5jUmVzb2x1dGlvbi5yZWFzb25pbmcsXHJcbiAgICAgIG1hbnVhbENoYW5nZXM6IHN5bmNSZXNvbHV0aW9uLm1hbnVhbENoYW5nZXNcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIOiuoeeul+W5s+Wdh+ino+WGs+aXtumXtFxyXG4gIGNvbnN0IGNhbGN1bGF0ZUF2ZXJhZ2VSZXNvbHV0aW9uVGltZSA9ICgpOiBudW1iZXIgPT4ge1xyXG4gICAgY29uc3QgcmVzb2x2ZWRDb25mbGljdHMgPSBjb25mbGljdHMuZmlsdGVyKGMgPT4gYy5zdGF0dXMgPT09ICdyZXNvbHZlZCcgJiYgYy5yZXNvbHZlZEF0KVxyXG4gICAgaWYgKHJlc29sdmVkQ29uZmxpY3RzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcclxuXHJcbiAgICBjb25zdCB0b3RhbFRpbWUgPSByZXNvbHZlZENvbmZsaWN0cy5yZWR1Y2UoKHN1bSwgY29uZmxpY3QpID0+IHtcclxuICAgICAgcmV0dXJuIHN1bSArIChjb25mbGljdC5yZXNvbHZlZEF0IS5nZXRUaW1lKCkgLSBjb25mbGljdC5jcmVhdGVkQXQuZ2V0VGltZSgpKVxyXG4gICAgfSwgMClcclxuXHJcbiAgICByZXR1cm4gdG90YWxUaW1lIC8gcmVzb2x2ZWRDb25mbGljdHMubGVuZ3RoXHJcbiAgfVxyXG5cclxuICAvLyDmm7TmlrDlkIzmraXnirbmgIFcclxuICBjb25zdCB1cGRhdGVTeW5jU3RhdHVzID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3Qgc3RhdHVzID0gdW5pZmllZFN5bmNTZXJ2aWNlLmdldFN0YXR1cygpXHJcbiAgICAgIHNldFN5bmNTdGF0dXMoc3RhdHVzKVxyXG5cclxuICAgICAgLy8g6Ieq5Yqo5qOA5rWL5paw5Yay56qBXHJcbiAgICAgIGlmIChzdGF0dXMuaXNTeW5jaW5nID09PSBmYWxzZSAmJiBzdGF0dXMubmV0d29ya1N0YXR1cz8ub25saW5lKSB7XHJcbiAgICAgICAgYXdhaXQgZGV0ZWN0TmV3Q29uZmxpY3RzKClcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byB1cGRhdGUgc3luYyBzdGF0dXM6JywgZXJyKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8g5qOA5rWL5paw5Yay56qBXHJcbiAgY29uc3QgZGV0ZWN0TmV3Q29uZmxpY3RzID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY3VycmVudENvbmZsaWN0cyA9IGF3YWl0IGxvYWRDb25mbGljdHNGcm9tU2VydmljZSgpXHJcbiAgICAgIGNvbnN0IG5ld0NvbmZsaWN0cyA9IGN1cnJlbnRDb25mbGljdHMuZmlsdGVyKGMgPT4gYy5zdGF0dXMgPT09ICdwZW5kaW5nJylcclxuXHJcbiAgICAgIC8vIOWmguaenOacieaWsOeahOWGsueqge+8jOinpuWPkeS6i+S7tuaIluabtOaWsFVJXHJcbiAgICAgIGlmIChuZXdDb25mbGljdHMubGVuZ3RoID4gY29uZmxpY3RzLmZpbHRlcihjID0+IGMuc3RhdHVzID09PSAncGVuZGluZycpLmxlbmd0aCkge1xyXG4gICAgICAgIHNldENvbmZsaWN0cyhjdXJyZW50Q29uZmxpY3RzKVxyXG4gICAgICAgIC8vIOi/memHjOWPr+S7peinpuWPkemAmuefpVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGRldGVjdCBuZXcgY29uZmxpY3RzOicsIGVycilcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIOiOt+WPluWGsueqgeivpuaDhVxyXG4gIGNvbnN0IGdldENvbmZsaWN0QnlJZCA9IHVzZUNhbGxiYWNrKChpZDogc3RyaW5nKSA9PiB7XHJcbiAgICByZXR1cm4gY29uZmxpY3RzLmZpbmQoYyA9PiBjLmlkID09PSBpZClcclxuICB9LCBbY29uZmxpY3RzXSlcclxuXHJcbiAgLy8g6I635Y+W5b6F6Kej5Yaz55qE5Yay56qBXHJcbiAgY29uc3QgZ2V0UGVuZGluZ0NvbmZsaWN0cyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcclxuICAgIHJldHVybiBjb25mbGljdHMuZmlsdGVyKGMgPT4gYy5zdGF0dXMgPT09ICdwZW5kaW5nJylcclxuICB9LCBbY29uZmxpY3RzXSlcclxuXHJcbiAgLy8g6I635Y+W6auY5LyY5YWI57qn5Yay56qBXHJcbiAgY29uc3QgZ2V0SGlnaFByaW9yaXR5Q29uZmxpY3RzID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgcmV0dXJuIGNvbmZsaWN0cy5maWx0ZXIoYyA9PiBjLnNldmVyaXR5ID09PSAnaGlnaCcgfHwgYy5zZXZlcml0eSA9PT0gJ2NyaXRpY2FsJylcclxuICB9LCBbY29uZmxpY3RzXSlcclxuXHJcbiAgLy8g6I635Y+W57uf6K6h5L+h5oGvXHJcbiAgY29uc3QgZ2V0U3RhdHMgPSB1c2VDYWxsYmFjaygoKSA9PiB7XHJcbiAgICByZXR1cm4geyAuLi5zdGF0c1JlZi5jdXJyZW50IH1cclxuICB9LCBbXSlcclxuXHJcbiAgLy8g6Kej5Yaz5Yay56qBXHJcbiAgY29uc3QgcmVzb2x2ZUNvbmZsaWN0ID0gdXNlQ2FsbGJhY2soYXN5bmMgKGNvbmZsaWN0SWQ6IHN0cmluZywgcmVzb2x1dGlvbjogQ29uZmxpY3RSZXNvbHV0aW9uKSA9PiB7XHJcbiAgICBzZXRJc1Jlc29sdmluZyh0cnVlKVxyXG4gICAgc2V0RXJyb3IobnVsbClcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyDosIPnlKjnu5/kuIDlkIzmraXmnI3liqHop6PlhrPlhrLnqoFcclxuICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IHVuaWZpZWRTeW5jU2VydmljZS5yZXNvbHZlQ29uZmxpY3QoXHJcbiAgICAgICAgY29uZmxpY3RJZCxcclxuICAgICAgICByZXNvbHV0aW9uLnR5cGUgYXMgJ2xvY2FsJyB8ICdjbG91ZCcgfCAnbWVyZ2UnLFxyXG4gICAgICAgIHJlc29sdXRpb24ubWVyZ2VkRGF0YVxyXG4gICAgICApXHJcblxyXG4gICAgICBpZiAoc3VjY2Vzcykge1xyXG4gICAgICAgIC8vIOabtOaWsOacrOWcsOeKtuaAgVxyXG4gICAgICAgIHNldENvbmZsaWN0cyhwcmV2ID0+IHByZXYubWFwKGNvbmZsaWN0ID0+XHJcbiAgICAgICAgICBjb25mbGljdC5pZCA9PT0gY29uZmxpY3RJZFxyXG4gICAgICAgICAgICA/IHtcclxuICAgICAgICAgICAgICAgIC4uLmNvbmZsaWN0LFxyXG4gICAgICAgICAgICAgICAgc3RhdHVzOiAncmVzb2x2ZWQnIGFzIENvbmZsaWN0U3RhdHVzLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmVkQnk6ICd1c2VyJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdXRpb25cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIDogY29uZmxpY3RcclxuICAgICAgICApKVxyXG5cclxuICAgICAgICBzZXRTZWxlY3RlZENvbmZsaWN0KG51bGwpXHJcblxyXG4gICAgICAgIC8vIOWIt+aWsOWQjOatpeeKtuaAgVxyXG4gICAgICAgIGF3YWl0IHVwZGF0ZVN5bmNTdGF0dXMoKVxyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHJlc29sdmUgY29uZmxpY3QgdmlhIHN5bmMgc2VydmljZScpXHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVzb2x2ZSBjb25mbGljdDonLCBlcnIpXHJcbiAgICAgIHNldEVycm9yKGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicpXHJcbiAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0SXNSZXNvbHZpbmcoZmFsc2UpXHJcbiAgICB9XHJcbiAgfSwgW10pXHJcblxyXG4gIC8vIOW/veeVpeWGsueqgVxyXG4gIGNvbnN0IGlnbm9yZUNvbmZsaWN0ID0gdXNlQ2FsbGJhY2soYXN5bmMgKGNvbmZsaWN0SWQ6IHN0cmluZykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g5Zyo5ZCM5q2l5pyN5Yqh5Lit5qCH6K6w5Li65b+955WlXHJcbiAgICAgIGNvbnN0IGNvbmZsaWN0ID0gY29uZmxpY3RzLmZpbmQoYyA9PiBjLmlkID09PSBjb25mbGljdElkKVxyXG4gICAgICBpZiAoIWNvbmZsaWN0KSByZXR1cm5cclxuXHJcbiAgICAgIC8vIOi/memHjOWPr+S7peiwg+eUqOacjeWKoUFQSeadpeW/veeVpeWGsueqgVxyXG4gICAgICAvLyDnm67liY3lhYjmm7TmlrDmnKzlnLDnirbmgIFcclxuICAgICAgc2V0Q29uZmxpY3RzKHByZXYgPT4gcHJldi5tYXAoY29uZmxpY3QgPT5cclxuICAgICAgICBjb25mbGljdC5pZCA9PT0gY29uZmxpY3RJZFxyXG4gICAgICAgICAgPyB7IC4uLmNvbmZsaWN0LCBzdGF0dXM6ICdpZ25vcmVkJyBhcyBDb25mbGljdFN0YXR1cyB9XHJcbiAgICAgICAgICA6IGNvbmZsaWN0XHJcbiAgICAgICkpXHJcblxyXG4gICAgICBzZXRTZWxlY3RlZENvbmZsaWN0KG51bGwpXHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGlnbm9yZSBjb25mbGljdDonLCBlcnIpXHJcbiAgICAgIHNldEVycm9yKGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicpXHJcbiAgICB9XHJcbiAgfSwgW2NvbmZsaWN0c10pXHJcblxyXG4gIC8vIOaJuemHj+ino+WGs+WGsueqgVxyXG4gIGNvbnN0IGJhdGNoUmVzb2x2ZUNvbmZsaWN0cyA9IHVzZUNhbGxiYWNrKGFzeW5jIChjb25mbGljdElkczogc3RyaW5nW10sIHJlc29sdXRpb246IENvbmZsaWN0UmVzb2x1dGlvbikgPT4ge1xyXG4gICAgc2V0SXNSZXNvbHZpbmcodHJ1ZSlcclxuICAgIHNldEVycm9yKG51bGwpXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g5om56YeP6Kej5Yaz5Yay56qBXHJcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoXHJcbiAgICAgICAgY29uZmxpY3RJZHMubWFwKGNvbmZsaWN0SWQgPT5cclxuICAgICAgICAgIHVuaWZpZWRTeW5jU2VydmljZS5yZXNvbHZlQ29uZmxpY3QoXHJcbiAgICAgICAgICAgIGNvbmZsaWN0SWQsXHJcbiAgICAgICAgICAgIHJlc29sdXRpb24udHlwZSBhcyAnbG9jYWwnIHwgJ2Nsb3VkJyB8ICdtZXJnZScsXHJcbiAgICAgICAgICAgIHJlc29sdXRpb24ubWVyZ2VkRGF0YVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgIClcclxuICAgICAgKVxyXG5cclxuICAgICAgY29uc3Qgc3VjY2Vzc2Z1bFJlc29sdmVzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcpLmxlbmd0aFxyXG4gICAgICBjb25zdCBmYWlsZWRSZXNvbHZlcyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5zdGF0dXMgPT09ICdyZWplY3RlZCcpLmxlbmd0aFxyXG5cclxuICAgICAgaWYgKHN1Y2Nlc3NmdWxSZXNvbHZlcyA+IDApIHtcclxuICAgICAgICAvLyDmm7TmlrDmnKzlnLDnirbmgIFcclxuICAgICAgICBzZXRDb25mbGljdHMocHJldiA9PiBwcmV2Lm1hcChjb25mbGljdCA9PlxyXG4gICAgICAgICAgY29uZmxpY3RJZHMuaW5jbHVkZXMoY29uZmxpY3QuaWQpXHJcbiAgICAgICAgICAgID8ge1xyXG4gICAgICAgICAgICAgICAgLi4uY29uZmxpY3QsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdyZXNvbHZlZCcgYXMgQ29uZmxpY3RTdGF0dXMsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZWRCeTogJ3VzZXInLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x1dGlvblxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgOiBjb25mbGljdFxyXG4gICAgICAgICkpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChmYWlsZWRSZXNvbHZlcyA+IDApIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZmFpbGVkUmVzb2x2ZXN9IGNvbmZsaWN0cyBmYWlsZWQgdG8gcmVzb2x2ZWApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIOWIt+aWsOWQjOatpeeKtuaAgVxyXG4gICAgICBhd2FpdCB1cGRhdGVTeW5jU3RhdHVzKClcclxuXHJcbiAgICAgIHJldHVybiB0cnVlXHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGJhdGNoIHJlc29sdmUgY29uZmxpY3RzOicsIGVycilcclxuICAgICAgc2V0RXJyb3IoZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJylcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRJc1Jlc29sdmluZyhmYWxzZSlcclxuICAgIH1cclxuICB9LCBbXSlcclxuXHJcbiAgLy8g6I635Y+W5Yay56qB6Kej5Yaz5bu66K6uXHJcbiAgY29uc3QgZ2V0U3VnZ2VzdGlvbnMgPSB1c2VDYWxsYmFjaygoY29uZmxpY3RJZDogc3RyaW5nKTogQ29uZmxpY3RTdWdnZXN0aW9uW10gPT4ge1xyXG4gICAgY29uc3QgY29uZmxpY3QgPSBnZXRDb25mbGljdEJ5SWQoY29uZmxpY3RJZClcclxuICAgIGlmICghY29uZmxpY3QpIHJldHVybiBbXVxyXG5cclxuICAgIC8vIOS9v+eUqOaZuuiDveWGsueqgeino+WGs+W8leaTjueUn+aIkOW7uuiurlxyXG4gICAgY29uc3QgZW5naW5lU3VnZ2VzdGlvbnMgPSBDb25mbGljdFJlc29sdXRpb25FbmdpbmUuZ2VuZXJhdGVTdWdnZXN0aW9ucyhjb25mbGljdClcclxuXHJcbiAgICAvLyDmt7vliqDln7rkuo7lkIzmraXmnI3liqHnmoTlu7rorq5cclxuICAgIGNvbnN0IHN5bmNTdWdnZXN0aW9ucyA9IHVuaWZpZWRTeW5jU2VydmljZS5nZXRDb25mbGljdChjb25mbGljdElkKT8uc3VnZ2VzdGlvbnMgfHwgW11cclxuXHJcbiAgICAvLyDlkIjlubblubbljrvph43lu7rorq5cclxuICAgIGNvbnN0IGFsbFN1Z2dlc3Rpb25zID0gWy4uLmVuZ2luZVN1Z2dlc3Rpb25zLCAuLi5zeW5jU3VnZ2VzdGlvbnMubWFwKChzOiBhbnkpID0+ICh7XHJcbiAgICAgIHR5cGU6IHMudHlwZSxcclxuICAgICAgY29uZmlkZW5jZTogcy5jb25maWRlbmNlLFxyXG4gICAgICByZWFzb246IHMucmVhc29uaW5nIHx8IHMucmVhc29uLFxyXG4gICAgICBwcmV2aWV3OiBzLnByZXZpZXdcclxuICAgIH0pKV1cclxuXHJcbiAgICAvLyDmjInnva7kv6HluqbmjpLluo9cclxuICAgIHJldHVybiBhbGxTdWdnZXN0aW9ucy5zb3J0KChhLCBiKSA9PiBiLmNvbmZpZGVuY2UgLSBhLmNvbmZpZGVuY2UpXHJcbiAgfSwgW2dldENvbmZsaWN0QnlJZF0pXHJcblxyXG4gIC8vIOajgOa1i+aWsOWGsueqgVxyXG4gIGNvbnN0IGRldGVjdENvbmZsaWN0cyA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcclxuICAgIHNldElzTG9hZGluZyh0cnVlKVxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g5omn6KGM5ZCM5q2l5Lul5qOA5rWL5paw5Yay56qBXHJcbiAgICAgIGNvbnN0IHN5bmNSZXN1bHQgPSBhd2FpdCB1bmlmaWVkU3luY1NlcnZpY2Uuc3luYyh7XHJcbiAgICAgICAgdHlwZTogJ2luY3JlbWVudGFsJyxcclxuICAgICAgICBkaXJlY3Rpb246ICdiaWRpcmVjdGlvbmFsJ1xyXG4gICAgICB9KVxyXG5cclxuICAgICAgLy8g5Yqg6L295pu05paw5ZCO55qE5Yay56qBXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWRDb25mbGljdHMgPSBhd2FpdCBsb2FkQ29uZmxpY3RzRnJvbVNlcnZpY2UoKVxyXG4gICAgICBjb25zdCBuZXdDb25mbGljdHMgPSB1cGRhdGVkQ29uZmxpY3RzLmZpbHRlcihjID0+IGMuc3RhdHVzID09PSAncGVuZGluZycpXHJcblxyXG4gICAgICBzZXRDb25mbGljdHModXBkYXRlZENvbmZsaWN0cylcclxuXHJcbiAgICAgIHJldHVybiBuZXdDb25mbGljdHNcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZGV0ZWN0IGNvbmZsaWN0czonLCBlcnIpXHJcbiAgICAgIHNldEVycm9yKGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicpXHJcbiAgICAgIHJldHVybiBbXVxyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKVxyXG4gICAgfVxyXG4gIH0sIFtdKVxyXG5cclxuICAvLyDoh6rliqjop6PlhrPlhrLnqoFcclxuICBjb25zdCBhdXRvUmVzb2x2ZUNvbmZsaWN0cyA9IHVzZUNhbGxiYWNrKGFzeW5jICgpOiBQcm9taXNlPG51bWJlcj4gPT4ge1xyXG4gICAgc2V0SXNSZXNvbHZpbmcodHJ1ZSlcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc29sdmVkQ291bnQgPSBhd2FpdCB1bmlmaWVkU3luY1NlcnZpY2UuYXV0b1Jlc29sdmVDb25mbGljdHMoKVxyXG5cclxuICAgICAgLy8g5Yi35paw5Yay56qB5YiX6KGoXHJcbiAgICAgIGF3YWl0IGxvYWRDb25mbGljdHNGcm9tU2VydmljZSgpXHJcbiAgICAgIGF3YWl0IHVwZGF0ZVN5bmNTdGF0dXMoKVxyXG5cclxuICAgICAgcmV0dXJuIHJlc29sdmVkQ291bnRcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gYXV0by1yZXNvbHZlIGNvbmZsaWN0czonLCBlcnIpXHJcbiAgICAgIHNldEVycm9yKGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicpXHJcbiAgICAgIHJldHVybiAwXHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRJc1Jlc29sdmluZyhmYWxzZSlcclxuICAgIH1cclxuICB9LCBbXSlcclxuXHJcbiAgLy8g6I635Y+W5Yay56qB6K+m5oOF77yI5a6M5pW05L+h5oGv77yJXHJcbiAgY29uc3QgZ2V0Q29uZmxpY3REZXRhaWxzID0gdXNlQ2FsbGJhY2soYXN5bmMgKGNvbmZsaWN0SWQ6IHN0cmluZykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY29uZmxpY3QgPSBnZXRDb25mbGljdEJ5SWQoY29uZmxpY3RJZClcclxuICAgICAgaWYgKCFjb25mbGljdCkgcmV0dXJuIG51bGxcclxuXHJcbiAgICAgIC8vIOiOt+WPluWQjOatpeacjeWKoeS4reeahOivpue7huS/oeaBr1xyXG4gICAgICBjb25zdCBzeW5jQ29uZmxpY3QgPSB1bmlmaWVkU3luY1NlcnZpY2UuZ2V0Q29uZmxpY3QoY29uZmxpY3RJZClcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgLi4uY29uZmxpY3QsXHJcbiAgICAgICAgc3luY0RldGFpbHM6IHN5bmNDb25mbGljdCxcclxuICAgICAgICBzdWdnZXN0aW9uczogZ2V0U3VnZ2VzdGlvbnMoY29uZmxpY3RJZClcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgY29uZmxpY3QgZGV0YWlsczonLCBlcnIpXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcbiAgfSwgW2dldENvbmZsaWN0QnlJZCwgZ2V0U3VnZ2VzdGlvbnNdKVxyXG5cclxuICAvLyDliLfmlrDlhrLnqoHliJfooahcclxuICBjb25zdCByZWZyZXNoQ29uZmxpY3RzID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgc2V0SXNMb2FkaW5nKHRydWUpXHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBsb2FkQ29uZmxpY3RzRnJvbVNlcnZpY2UoKVxyXG4gICAgICBhd2FpdCB1cGRhdGVTeW5jU3RhdHVzKClcclxuICAgICAgc2V0RXJyb3IobnVsbClcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVmcmVzaCBjb25mbGljdHM6JywgZXJyKVxyXG4gICAgICBzZXRFcnJvcihlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InKVxyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKVxyXG4gICAgfVxyXG4gIH0sIFtdKVxyXG5cclxuICAvLyDmuIXpmaTplJnor69cclxuICBjb25zdCBjbGVhckVycm9yID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgc2V0RXJyb3IobnVsbClcclxuICB9LCBbXSlcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIC8vIOeKtuaAgVxyXG4gICAgY29uZmxpY3RzLFxyXG4gICAgc2VsZWN0ZWRDb25mbGljdCxcclxuICAgIHNldFNlbGVjdGVkQ29uZmxpY3QsXHJcbiAgICBpc1Jlc29sdmluZyxcclxuICAgIGlzTG9hZGluZyxcclxuICAgIGVycm9yLFxyXG4gICAgc3luY1N0YXR1cyxcclxuICAgIG1ldHJpY3MsXHJcblxyXG4gICAgLy8g5pa55rOVXHJcbiAgICBnZXRDb25mbGljdEJ5SWQsXHJcbiAgICBnZXRQZW5kaW5nQ29uZmxpY3RzLFxyXG4gICAgZ2V0SGlnaFByaW9yaXR5Q29uZmxpY3RzLFxyXG4gICAgZ2V0U3RhdHMsXHJcbiAgICByZXNvbHZlQ29uZmxpY3QsXHJcbiAgICBpZ25vcmVDb25mbGljdCxcclxuICAgIGJhdGNoUmVzb2x2ZUNvbmZsaWN0cyxcclxuICAgIGdldFN1Z2dlc3Rpb25zLFxyXG4gICAgZGV0ZWN0Q29uZmxpY3RzLFxyXG4gICAgYXV0b1Jlc29sdmVDb25mbGljdHMsXHJcbiAgICBnZXRDb25mbGljdERldGFpbHMsXHJcbiAgICByZWZyZXNoQ29uZmxpY3RzLFxyXG4gICAgY2xlYXJFcnJvclxyXG4gIH1cclxufSJdLCJ2ZXJzaW9uIjozfQ==