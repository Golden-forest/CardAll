6d0e93965949b468f05fbce7c891cf71
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.retryFailedOperations = exports.getNetworkStatus = exports.getOfflineStats = exports.executeBatchOfflineOperations = exports.executeOfflineOperation = exports.offlineManager = exports.OfflineManager = exports.OfflineOperationType = exports.NetworkStatus = void 0;
const database_unified_1 = require("./database-unified");
const local_operation_1 = require("./local-operation");
// ============================================================================
// 网络状态类型
// ============================================================================
var NetworkStatus;
(function (NetworkStatus) {
    NetworkStatus["ONLINE"] = "online";
    NetworkStatus["OFFLINE"] = "offline";
    NetworkStatus["UNSTABLE"] = "unstable";
    NetworkStatus["UNKNOWN"] = "unknown";
})(NetworkStatus || (exports.NetworkStatus = NetworkStatus = {}));
// ============================================================================
// 离线操作类型
// ============================================================================
var OfflineOperationType;
(function (OfflineOperationType) {
    OfflineOperationType["CREATE"] = "create";
    OfflineOperationType["UPDATE"] = "update";
    OfflineOperationType["DELETE"] = "delete";
    OfflineOperationType["BATCH"] = "batch";
})(OfflineOperationType || (exports.OfflineOperationType = OfflineOperationType = {}));
// ============================================================================
// 信号量实现（用于并发控制）
// ============================================================================
class Semaphore {
    constructor(count) {
        Object.defineProperty(this, "available", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "waiting", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        this.available = count;
    }
    async acquire() {
        if (this.available > 0) {
            this.available--;
            return;
        }
        return new Promise((resolve) => {
            this.waiting.push(resolve);
        });
    }
    release() {
        this.available++;
        if (this.waiting.length > 0 && this.available > 0) {
            const next = this.waiting.shift();
            if (next) {
                this.available--;
                next();
            }
        }
    }
}
// ============================================================================
// 离线管理器主类
// ============================================================================
class OfflineManager {
    constructor() {
        Object.defineProperty(this, "isOffline", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: !navigator.onLine
        });
        Object.defineProperty(this, "networkInfo", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: {
                status: navigator.onLine ? NetworkStatus.ONLINE : NetworkStatus.OFFLINE,
                lastChanged: new Date()
            }
        });
        Object.defineProperty(this, "offlineOperations", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        Object.defineProperty(this, "conflicts", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        Object.defineProperty(this, "offlineStartTime", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "syncTimer", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "reconnectAttempts", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "maxReconnectAttempts", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 10
        });
        // 事件监听器
        Object.defineProperty(this, "listeners", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: {}
        });
        this.initializeOfflineManager();
    }
    // ============================================================================
    // 离线状态检测和管理
    // ============================================================================
    /**
     * 获取当前网络状态
     */
    getNetworkStatus() {
        return { ...this.networkInfo };
    }
    /**
     * 检查是否离线
     */
    isCurrentlyOffline() {
        return this.isOffline;
    }
    /**
     * 获取离线统计信息
     */
    async getOfflineStats() {
        const pendingOps = await this.getPendingOfflineOperations();
        const completedOps = await this.getCompletedOfflineOperations();
        const failedOps = await this.getFailedOfflineOperations();
        return {
            isOffline: this.isOffline,
            offlineDuration: this.calculateOfflineDuration(),
            pendingOperations: pendingOps.length,
            completedOfflineOperations: completedOps.length,
            failedOperations: failedOps.length,
            averageResponseTime: this.calculateAverageResponseTime(),
            dataSyncedOnResume: this.calculateDataSyncedOnResume(),
            lastSyncTime: await this.getLastSyncTime(),
            estimatedBandwidthSaved: this.calculateEstimatedBandwidthSaved(pendingOps)
        };
    }
    // ============================================================================
    // 离线操作管理
    // ============================================================================
    /**
     * 执行离线操作
     */
    async executeOfflineOperation(operation) {
        const offlineOperation = {
            ...operation,
            id: crypto.randomUUID(),
            timestamp: new Date(),
            retryCount: 0
        };
        try {
            // 检查依赖关系
            if (operation.dependencies && operation.dependencies.length > 0) {
                await this.validateDependencies(operation.dependencies);
            }
            // 执行本地操作
            const result = await this.performLocalOperation(offlineOperation);
            // 存储离线操作记录
            await this.storeOfflineOperation(offlineOperation);
            // 通知监听器
            if (this.listeners.onOfflineOperation) {
                this.listeners.onOfflineOperation(offlineOperation);
            }
            return {
                success: true,
                data: result,
                operationId: offlineOperation.id
            };
        }
        catch (error) {
            console.error('Offline operation failed:', error);
            // 存储失败的操作
            offlineOperation.priority = 'high'; // 失败的操作提升优先级
            await this.storeOfflineOperation(offlineOperation);
            return {
                success: false,
                error: error instanceof Error ? error.message : String(error),
                operationId: offlineOperation.id
            };
        }
    }
    /**
     * 批量执行离线操作
     */
    async executeBatchOfflineOperations(operations) {
        const batchId = crypto.randomUUID();
        const results = [];
        try {
            // 验证所有操作的依赖关系
            const allDependencies = operations
                .filter(op => op.dependencies && op.dependencies.length > 0)
                .flatMap(op => op.dependencies);
            if (allDependencies.length > 0) {
                await this.validateDependencies(allDependencies);
            }
            // 按优先级排序
            const sortedOperations = this.sortOperationsByPriority(operations);
            // 执行操作
            for (const operation of sortedOperations) {
                const result = await this.executeOfflineOperation(operation);
                results.push(result);
            }
            return {
                success: results.every(r => r.success),
                results,
                batchId
            };
        }
        catch (error) {
            console.error('Batch offline operations failed:', error);
            return {
                success: false,
                results: results.map(result => ({
                    ...result,
                    success: false,
                    error: error instanceof Error ? error.message : String(error)
                })),
                batchId
            };
        }
    }
    /**
     * 获取待处理的离线操作
     */
    async getPendingOfflineOperations() {
        return await database_unified_1.db.transaction('r', [database_unified_1.db.syncQueue], async () => {
            const syncOps = await database_unified_1.db.syncQueue
                .where('status')
                .equals('pending')
                .toArray();
            return syncOps.map(op => this.convertSyncOperationToOfflineOperation(op));
        });
    }
    /**
     * 重试失败的离线操作
     */
    async retryFailedOperations() {
        const failedOps = await this.getFailedOfflineOperations();
        let retriedCount = 0;
        for (const operation of failedOps) {
            try {
                await this.retryOperation(operation);
                retriedCount++;
            }
            catch (error) {
                console.warn(`Failed to retry operation ${operation.id}:`, error);
            }
        }
        return retriedCount;
    }
    // ============================================================================
    // 网络恢复处理
    // ============================================================================
    /**
     * 处理网络恢复
     */
    async handleNetworkRecovery() {
        console.log('Network recovered, analyzing sync strategy...');
        const startTime = performance.now();
        const stats = await this.getOfflineStats();
        try {
            // 网络质量评估
            const networkQuality = await this.assessNetworkQuality();
            // 智能同步策略选择
            const syncStrategy = await this.determineSyncStrategy(stats, networkQuality);
            console.log(`Using sync strategy: ${syncStrategy.strategy}`);
            // 通知同步开始
            this.notifySyncProgress(0, stats.pendingOperations);
            // 根据策略执行同步
            const syncResult = await this.executeSmartSync(syncStrategy, stats);
            // 处理冲突
            if (syncResult.conflicts.length > 0) {
                await this.handleConflicts(syncResult.conflicts);
            }
            // 执行后同步优化
            await this.performPostSyncOptimizations(syncResult, networkQuality);
            // 更新统计信息
            const finalStats = await this.getOfflineStats();
            this.notifySyncComplete(finalStats);
            console.log(`Smart offline sync completed in ${(performance.now() - startTime).toFixed(2)}ms`);
            console.log(`Sync results: ${syncResult.syncedOperations} operations, ${syncResult.conflicts.length} conflicts`);
        }
        catch (error) {
            console.error('Smart offline sync failed:', error);
            // 智能错误恢复
            await this.handleSyncError(error, stats);
            if (this.listeners.onError) {
                this.listeners.onError(error instanceof Error ? error : new Error(String(error)));
            }
        }
    }
    /**
     * 评估网络质量 - 增强版本
     */
    async assessNetworkQuality() {
        const connection = navigator.connection;
        const assessment = {
            isStable: true,
            bandwidth: 'good',
            latency: 'low',
            reliability: 0.9,
            recommendedStrategy: 'immediate'
        };
        if (connection) {
            // 增强的带宽评估
            if (connection.downlink) {
                if (connection.downlink >= 20) {
                    assessment.bandwidth = 'excellent';
                    assessment.recommendedStrategy = 'immediate';
                }
                else if (connection.downlink >= 10) {
                    assessment.bandwidth = 'good';
                    assessment.recommendedStrategy = 'immediate';
                }
                else if (connection.downlink >= 3) {
                    assessment.bandwidth = 'fair';
                    assessment.recommendedStrategy = 'batched';
                }
                else if (connection.downlink >= 1) {
                    assessment.bandwidth = 'poor';
                    assessment.recommendedStrategy = 'conservative';
                }
                else {
                    assessment.bandwidth = 'poor';
                    assessment.recommendedStrategy = 'prioritized';
                }
            }
            // 增强的延迟评估
            if (connection.rtt) {
                if (connection.rtt <= 50) {
                    assessment.latency = 'low';
                }
                else if (connection.rtt <= 150) {
                    assessment.latency = 'medium';
                    assessment.recommendedStrategy = 'batched';
                }
                else if (connection.rtt <= 500) {
                    assessment.latency = 'high';
                    assessment.recommendedStrategy = 'conservative';
                }
                else {
                    assessment.latency = 'high';
                    assessment.recommendedStrategy = 'prioritized';
                }
            }
            // 增强的连接类型评估
            if (connection.type === 'cellular') {
                assessment.reliability = 0.7;
                if (connection.effectiveType === 'slow-2g' || connection.effectiveType === '2g') {
                    assessment.recommendedStrategy = 'conservative';
                }
            }
            else if (connection.type === 'wifi') {
                assessment.reliability = 0.9;
            }
            else if (connection.type === 'ethernet') {
                assessment.reliability = 0.95;
            }
        }
        // 增强的连接稳定性测试
        const stabilityTest = await this.testConnectionStability();
        assessment.isStable = stabilityTest.isStable;
        assessment.reliability *= stabilityTest.stabilityFactor;
        // 如果连接不稳定，调整推荐策略
        if (!assessment.isStable) {
            assessment.recommendedStrategy = 'conservative';
        }
        // 基于历史数据调整可靠性
        const historicalReliability = await this.calculateHistoricalReliability();
        assessment.reliability *= historicalReliability;
        return assessment;
    }
    /**
     * 测试连接稳定性
     */
    async testConnectionStability() {
        const testUrls = [
            'https://www.google.com/favicon.ico',
            'https://www.cloudflare.com/favicon.ico'
        ];
        const results = await Promise.allSettled(testUrls.map(url => fetch(url, { method: 'HEAD', mode: 'no-cors' })));
        const successfulTests = results.filter(result => result.status === 'fulfilled').length;
        const stabilityFactor = successfulTests / testUrls.length;
        const isStable = stabilityFactor >= 0.8;
        return { isStable, stabilityFactor };
    }
    /**
     * 确定推荐策略
     */
    determineRecommendedStrategy(assessment) {
        if (assessment.isStable && assessment.bandwidth === 'excellent' && assessment.latency === 'low') {
            return 'immediate';
        }
        else if (assessment.reliability >= 0.8 && assessment.bandwidth !== 'poor') {
            return 'batched';
        }
        else if (assessment.reliability >= 0.6) {
            return 'prioritized';
        }
        else {
            return 'conservative';
        }
    }
    /**
     * 确定同步策略
     */
    async determineSyncStrategy(stats, networkQuality) {
        const strategy = {
            strategy: networkQuality.recommendedStrategy,
            batchSize: this.calculateOptimalBatchSize(stats, networkQuality),
            delayBetweenBatches: this.calculateBatchDelay(networkQuality),
            priorityFilter: this.determinePriorityFilter(stats, networkQuality),
            maxConcurrentOperations: this.calculateMaxConcurrent(networkQuality),
            timeout: this.calculateOperationTimeout(networkQuality),
            retryStrategy: this.determineRetryStrategy(networkQuality)
        };
        return strategy;
    }
    /**
     * 计算最优批处理大小
     */
    calculateOptimalBatchSize(stats, networkQuality) {
        let baseSize = 10;
        // 根据带宽调整
        switch (networkQuality.bandwidth) {
            case 'excellent':
                baseSize = 50;
                break;
            case 'good':
                baseSize = 30;
                break;
            case 'fair':
                baseSize = 15;
                break;
            case 'poor':
                baseSize = 5;
                break;
        }
        // 根据数据量调整
        if (stats.pendingOperations > 100) {
            baseSize = Math.min(baseSize, 20);
        }
        return baseSize;
    }
    /**
     * 计算批处理延迟
     */
    calculateBatchDelay(networkQuality) {
        switch (networkQuality.bandwidth) {
            case 'excellent':
                return 100;
            case 'good':
                return 300;
            case 'fair':
                return 500;
            case 'poor':
                return 1000;
            default:
                return 500;
        }
    }
    /**
     * 确定优先级过滤器
     */
    determinePriorityFilter(stats, networkQuality) {
        if (networkQuality.reliability < 0.7) {
            return ['critical', 'high']; // 只同步高优先级操作
        }
        else if (stats.pendingOperations > 50) {
            return ['critical', 'high', 'normal']; // 排除低优先级
        }
        else {
            return ['critical', 'high', 'normal', 'low']; // 全部同步
        }
    }
    /**
     * 计算最大并发操作数
     */
    calculateMaxConcurrent(networkQuality) {
        switch (networkQuality.latency) {
            case 'low':
                return networkQuality.bandwidth === 'excellent' ? 5 : 3;
            case 'medium':
                return 2;
            case 'high':
                return 1;
            default:
                return 2;
        }
    }
    /**
     * 计算操作超时时间
     */
    calculateOperationTimeout(networkQuality) {
        let baseTimeout = 10000; // 10秒基础超时
        switch (networkQuality.latency) {
            case 'high':
                baseTimeout *= 2;
                break;
            case 'medium':
                baseTimeout *= 1.5;
                break;
        }
        switch (networkQuality.bandwidth) {
            case 'poor':
                baseTimeout *= 1.5;
                break;
            case 'fair':
                baseTimeout *= 1.2;
                break;
        }
        return baseTimeout;
    }
    /**
     * 确定重试策略
     */
    determineRetryStrategy(networkQuality) {
        if (networkQuality.isStable && networkQuality.reliability >= 0.8) {
            return {
                maxRetries: 3,
                initialDelay: 1000,
                maxDelay: 5000,
                backoffMultiplier: 2
            };
        }
        else {
            return {
                maxRetries: 5,
                initialDelay: 2000,
                maxDelay: 15000,
                backoffMultiplier: 2.5
            };
        }
    }
    /**
     * 执行智能同步
     */
    async executeSmartSync(strategy, stats) {
        const pendingOps = await this.getPendingOfflineOperations();
        // 过滤优先级
        const filteredOps = pendingOps.filter(op => strategy.priorityFilter.includes(op.priority));
        // 分批处理
        const batches = this.createOptimalBatches(filteredOps, strategy.batchSize);
        const results = {
            success: true,
            syncedOperations: 0,
            conflicts: [],
            errors: []
        };
        // 并发执行批次
        const semaphore = new Semaphore(strategy.maxConcurrentOperations);
        const batchPromises = batches.map(async (batch, index) => {
            await semaphore.acquire();
            try {
                // 批次间延迟
                if (index > 0) {
                    await new Promise(resolve => setTimeout(resolve, strategy.delayBetweenBatches));
                }
                const batchResult = await this.executeBatchWithRetry(batch, strategy.retryStrategy, strategy.timeout);
                results.syncedOperations += batchResult.syncedCount;
                results.conflicts.push(...batchResult.conflicts);
                results.errors.push(...batchResult.errors);
                this.notifySyncProgress(results.syncedOperations, filteredOps.length);
            }
            catch (error) {
                results.errors.push(`Batch ${index} failed: ${error}`);
            }
            finally {
                semaphore.release();
            }
        });
        await Promise.all(batchPromises);
        results.success = results.errors.length === 0;
        return results;
    }
    /**
     * 创建最优批次
     */
    createOptimalBatches(operations, batchSize) {
        const batches = [];
        // 按优先级排序
        const priorityOrder = { critical: 4, high: 3, normal: 2, low: 1 };
        const sortedOps = [...operations].sort((a, b) => priorityOrder[b.priority] - priorityOrder[a.priority]);
        // 分批
        for (let i = 0; i < sortedOps.length; i += batchSize) {
            batches.push(sortedOps.slice(i, i + batchSize));
        }
        return batches;
    }
    /**
     * 执行批次重试
     */
    async executeBatchWithRetry(batch, retryStrategy, timeout) {
        let lastError = null;
        for (let attempt = 1; attempt <= retryStrategy.maxRetries; attempt++) {
            try {
                const result = await this.executeBatchWithTimeout(batch, timeout);
                return result;
            }
            catch (error) {
                lastError = error instanceof Error ? error : new Error(String(error));
                if (attempt === retryStrategy.maxRetries) {
                    break;
                }
                // 计算延迟时间
                const delay = Math.min(retryStrategy.initialDelay * Math.pow(retryStrategy.backoffMultiplier, attempt - 1), retryStrategy.maxDelay);
                console.log(`Retry ${attempt}/${retryStrategy.maxRetries} after ${delay}ms`);
                await new Promise(resolve => setTimeout(resolve, delay));
            }
        }
        return {
            syncedCount: 0,
            conflicts: [],
            errors: [lastError?.message || 'Batch execution failed after all retries']
        };
    }
    /**
     * 带超时的批次执行
     */
    async executeBatchWithTimeout(batch, timeout) {
        const timeoutPromise = new Promise((_, reject) => {
            setTimeout(() => reject(new Error('Operation timeout')), timeout);
        });
        const executionPromise = this.executeBatchOperations(batch);
        try {
            return await Promise.race([executionPromise, timeoutPromise]);
        }
        catch (error) {
            if (error instanceof Error && error.message === 'Operation timeout') {
                throw new Error(`Batch operation timed out after ${timeout}ms`);
            }
            throw error;
        }
    }
    /**
     * 执行批次操作
     */
    async executeBatchOperations(batch) {
        let syncedCount = 0;
        const conflicts = [];
        const errors = [];
        for (const operation of batch) {
            try {
                const result = await this.syncOperation(operation);
                if (result.success) {
                    syncedCount++;
                }
                else if (result.conflict) {
                    conflicts.push(result.conflict);
                }
                else {
                    errors.push(result.error || `Operation ${operation.id} failed`);
                }
            }
            catch (error) {
                errors.push(`Operation ${operation.id} error: ${error}`);
            }
        }
        return { syncedCount, conflicts, errors };
    }
    /**
     * 执行后同步优化
     */
    async performPostSyncOptimizations(syncResult, networkQuality) {
        // 如果同步完全成功，清理旧状态
        if (syncResult.success && syncResult.errors.length === 0) {
            await this.cleanupOldSyncState();
        }
        // 如果网络质量好，预加载可能需要的远程数据
        if (networkQuality.bandwidth === 'excellent' && networkQuality.isStable) {
            await this.preloadRemoteData();
        }
        // 更新网络状态历史记录
        await this.updateNetworkHistory(networkQuality);
    }
    /**
     * 处理同步错误
     */
    async handleSyncError(error, stats) {
        console.error('Sync error occurred, attempting recovery...', error);
        // 根据错误类型制定恢复策略
        if (error.message?.includes('timeout')) {
            // 超时错误：降低同步强度
            await this.scheduleReducedSync();
        }
        else if (error.message?.includes('network')) {
            // 网络错误：等待网络稳定
            await this.scheduleDelayedSync();
        }
        else {
            // 其他错误：记录并重试
            await this.scheduleRetrySync();
        }
    }
    /**
     * 调度降级同步
     */
    async scheduleReducedSync() {
        setTimeout(async () => {
            const stats = await this.getOfflineStats();
            if (stats.pendingOperations > 0) {
                console.log('Executing reduced sync...');
                // 只同步关键操作
                await this.syncCriticalOperationsOnly();
            }
        }, 5000); // 5秒后重试
    }
    /**
     * 调度延迟同步
     */
    async scheduleDelayedSync() {
        setTimeout(async () => {
            const stats = await this.getOfflineStats();
            if (stats.pendingOperations > 0) {
                console.log('Executing delayed sync...');
                await this.handleNetworkRecovery();
            }
        }, 30000); // 30秒后重试
    }
    /**
     * 调度重试同步
     */
    async scheduleRetrySync() {
        setTimeout(async () => {
            const stats = await this.getOfflineStats();
            if (stats.pendingOperations > 0) {
                console.log('Retrying sync...');
                await this.handleNetworkRecovery();
            }
        }, 10000); // 10秒后重试
    }
    /**
     * 仅同步关键操作
     */
    async syncCriticalOperationsOnly() {
        const pendingOps = await this.getPendingOfflineOperations();
        const criticalOps = pendingOps.filter(op => op.priority === 'critical');
        if (criticalOps.length > 0) {
            const result = await this.executeBatchOperations(criticalOps);
            console.log(`Critical sync completed: ${result.syncedCount}/${criticalOps.length}`);
        }
    }
    /**
     * 清理旧同步状态
     */
    async cleanupOldSyncState() {
        try {
            // 清理过期的备份
            const backupKeys = Object.keys(localStorage)
                .filter(key => key.startsWith('offlineBackup_'))
                .sort();
            // 保留最近3个备份
            if (backupKeys.length > 3) {
                const toDelete = backupKeys.slice(0, backupKeys.length - 3);
                toDelete.forEach(key => localStorage.removeItem(key));
            }
            // 清理 IndexedDB 中的旧状态记录
            if (database_unified_1.db.offlineState) {
                const oldStates = await database_unified_1.db.offlineState
                    .orderBy('timestamp')
                    .reverse()
                    .offset(5) // 保留最近5个状态
                    .toArray();
                for (const state of oldStates) {
                    await database_unified_1.db.offlineState.delete(state.id);
                }
            }
        }
        catch (error) {
            console.warn('Failed to cleanup old sync state:', error);
        }
    }
    /**
     * 预加载远程数据
     */
    async preloadRemoteData() {
        try {
            // 这里可以实现预加载逻辑
            // 例如：预加载用户可能访问的卡片数据
            console.log('Preloading remote data...');
        }
        catch (error) {
            console.warn('Failed to preload remote data:', error);
        }
    }
    /**
     * 更新网络历史记录
     */
    async updateNetworkHistory(networkQuality) {
        // 更新网络质量历史，用于未来的预测和优化
        try {
            const historyKey = 'networkQualityHistory';
            const history = JSON.parse(localStorage.getItem(historyKey) || '[]');
            history.push({
                timestamp: new Date().toISOString(),
                ...networkQuality
            });
            // 保留最近100条记录
            if (history.length > 100) {
                history.splice(0, history.length - 100);
            }
            localStorage.setItem(historyKey, JSON.stringify(history));
        }
        catch (error) {
            console.warn('Failed to update network history:', error);
        }
    }
    /**
     * 执行离线同步
     */
    async performOfflineSync() {
        const pendingOps = await this.getPendingOfflineOperations();
        const syncedOperations = [];
        const conflicts = [];
        const errors = [];
        // 按优先级分组处理
        const criticalOps = pendingOps.filter(op => op.priority === 'critical');
        const highOps = pendingOps.filter(op => op.priority === 'high');
        const normalOps = pendingOps.filter(op => op.priority === 'normal');
        const lowOps = pendingOps.filter(op => op.priority === 'low');
        const allOps = [...criticalOps, ...highOps, ...normalOps, ...lowOps];
        for (let i = 0; i < allOps.length; i++) {
            const operation = allOps[i];
            try {
                // 检查网络连接
                if (!navigator.onLine) {
                    throw new Error('Network lost during sync');
                }
                // 执行同步
                const result = await this.syncOperation(operation);
                if (result.success) {
                    syncedOperations.push(operation.id);
                }
                else if (result.conflict) {
                    conflicts.push(result.conflict);
                }
                else {
                    errors.push(result.error || `Sync failed for operation ${operation.id}`);
                }
                // 通知进度
                this.notifySyncProgress(i + 1, allOps.length);
                // 小延迟避免网络过载
                if (i % 10 === 0) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
            }
            catch (error) {
                const errorMsg = error instanceof Error ? error.message : String(error);
                errors.push(`Operation ${operation.id} failed: ${errorMsg}`);
                // 如果是网络错误，暂停同步
                if (errorMsg.includes('network') || errorMsg.includes('Network')) {
                    console.warn('Network error during sync, pausing...');
                    break;
                }
            }
        }
        return {
            success: errors.length === 0,
            syncedOperations: syncedOperations.length,
            conflicts,
            errors
        };
    }
    // ============================================================================
    // 冲突检测和解决
    // ============================================================================
    /**
     * 检测数据冲突
     */
    async detectConflicts(localOperation, remoteData) {
        if (!remoteData)
            return null;
        // 获取本地数据
        const localData = await this.getLocalDataForEntity(localOperation.entity, localOperation.entityId);
        if (!localData)
            return null;
        // 比较时间戳和数据版本
        const localTimestamp = new Date(localOperation.timestamp);
        const remoteTimestamp = new Date(remoteData.updatedAt || remoteData.createdAt);
        // 如果本地操作时间晚于远程数据时间，认为是冲突
        if (localTimestamp > remoteTimestamp) {
            return {
                id: crypto.randomUUID(),
                entityType: localOperation.entity,
                entityId: localOperation.entityId || '',
                localData,
                remoteData,
                conflictType: this.determineConflictType(localOperation, localData, remoteData),
                timestamp: new Date(),
                resolution: 'pending'
            };
        }
        return null;
    }
    /**
     * 处理检测到的冲突
     */
    async handleConflicts(conflicts) {
        for (const conflict of conflicts) {
            try {
                // 根据冲突类型尝试自动解决
                const resolution = await this.resolveConflict(conflict);
                if (resolution === 'manual') {
                    // 需要用户手动解决的冲突
                    this.conflicts.push(conflict);
                    if (this.listeners.onConflict) {
                        this.listeners.onConflict(conflict);
                    }
                }
                else {
                    // 应用自动解决的冲突
                    await this.applyConflictResolution(conflict, resolution);
                }
            }
            catch (error) {
                console.error(`Failed to resolve conflict ${conflict.id}:`, error);
                conflict.resolution = 'manual';
                this.conflicts.push(conflict);
            }
        }
    }
    /**
     * 解决冲突
     */
    async resolveConflict(conflict) {
        switch (conflict.conflictType) {
            case 'simultaneous_edit':
                // 尝试智能合并
                return await this.attemptSmartMerge(conflict);
            case 'delete_conflict':
                // 删除冲突通常需要手动解决
                return 'manual';
            case 'structure_conflict':
                // 结构冲突尝试本地优先
                return 'local';
            default:
                return 'manual';
        }
    }
    /**
     * 尝试智能合并
     */
    async attemptSmartMerge(conflict) {
        // 简化的合并策略，实际项目中需要更复杂的逻辑
        const localContent = this.extractContentForMerge(conflict.localData);
        const remoteContent = this.extractContentForMerge(conflict.remoteData);
        // 如果内容相似，使用较新的版本
        if (this.calculateContentSimilarity(localContent, remoteContent) > 0.8) {
            const localTimestamp = new Date(conflict.localData.updatedAt || conflict.localData.createdAt);
            const remoteTimestamp = new Date(conflict.remoteData.updatedAt || conflict.remoteData.createdAt);
            return localTimestamp > remoteTimestamp ? 'local' : 'remote';
        }
        // 如果内容差异很大，需要手动合并
        return 'manual';
    }
    // ============================================================================
    // 事件监听器管理
    // ============================================================================
    setEventListeners(listeners) {
        this.listeners = { ...this.listeners, ...listeners };
    }
    notifyNetworkChange(info) {
        if (this.listeners.onNetworkChange) {
            this.listeners.onNetworkChange(info);
        }
    }
    notifySyncProgress(completed, total) {
        if (this.listeners.onSyncProgress) {
            this.listeners.onSyncProgress({ completed, total });
        }
    }
    notifySyncComplete(stats) {
        if (this.listeners.onSyncComplete) {
            this.listeners.onSyncComplete(stats);
        }
    }
    // ============================================================================
    // 初始化和清理
    // ============================================================================
    initializeOfflineManager() {
        this.setupNetworkListeners();
        this.setupConnectionMonitoring();
        this.loadOfflineState();
        this.startPeriodicSync();
    }
    setupNetworkListeners() {
        // 监听网络状态变化
        window.addEventListener('online', () => {
            this.handleNetworkChange(true);
        });
        window.addEventListener('offline', () => {
            this.handleNetworkChange(false);
        });
    }
    setupConnectionMonitoring() {
        // 监控连接质量（如果支持）
        if ('connection' in navigator) {
            const connection = navigator.connection;
            connection.addEventListener('change', () => {
                this.updateConnectionInfo(connection);
            });
            this.updateConnectionInfo(connection);
        }
    }
    startPeriodicSync() {
        // 定期检查同步状态
        this.syncTimer = setInterval(async () => {
            if (navigator.onLine) {
                const stats = await this.getOfflineStats();
                if (stats.pendingOperations > 0) {
                    await this.handleNetworkRecovery();
                }
            }
        }, 30 * 1000); // 每30秒检查一次
    }
    /**
     * 清理离线管理器
     */
    cleanup() {
        if (this.syncTimer) {
            clearInterval(this.syncTimer);
        }
        // 移除事件监听器
        window.removeEventListener('online', this.handleNetworkChange);
        window.removeEventListener('offline', this.handleNetworkChange);
    }
    // ============================================================================
    // 私有辅助方法
    // ============================================================================
    async handleNetworkChange(isOnline) {
        const previousStatus = this.networkInfo.status;
        const newStatus = isOnline ? NetworkStatus.ONLINE : NetworkStatus.OFFLINE;
        this.isOffline = !isOnline;
        this.networkInfo = {
            ...this.networkInfo,
            status: newStatus,
            lastChanged: new Date()
        };
        if (previousStatus === NetworkStatus.OFFLINE && newStatus === NetworkStatus.ONLINE) {
            // 从离线恢复
            this.reconnectAttempts = 0;
            await this.handleNetworkRecovery();
        }
        else if (previousStatus === NetworkStatus.ONLINE && newStatus === NetworkStatus.OFFLINE) {
            // 进入离线状态
            this.offlineStartTime = new Date();
        }
        this.notifyNetworkChange(this.networkInfo);
    }
    updateConnectionInfo(connection) {
        this.networkInfo = {
            ...this.networkInfo,
            effectiveType: connection.effectiveType,
            downlink: connection.downlink,
            rtt: connection.rtt,
            saveData: connection.saveData,
            connectionType: this.determineConnectionType(connection)
        };
    }
    determineConnectionType(connection) {
        if (connection.type) {
            switch (connection.type) {
                case 'wifi': return 'wifi';
                case 'cellular': return 'cellular';
                case 'ethernet': return 'ethernet';
                default: return 'unknown';
            }
        }
        // 基于有效类型推断
        if (connection.effectiveType) {
            if (['4g', '5g'].includes(connection.effectiveType)) {
                return connection.effectiveType === '5g' ? 'wifi' : 'cellular';
            }
        }
        return 'unknown';
    }
    async validateDependencies(dependencyIds) {
        const pendingOps = await this.getPendingOfflineOperations();
        const pendingIds = pendingOps.map(op => op.id);
        const unresolvedDependencies = dependencyIds.filter(id => !pendingIds.includes(id));
        if (unresolvedDependencies.length > 0) {
            throw new Error(`Dependencies not found: ${unresolvedDependencies.join(', ')}`);
        }
    }
    async performLocalOperation(operation) {
        switch (operation.type) {
            case OfflineOperationType.CREATE:
                return local_operation_1.localOperationService.createCard(operation.data, operation.userId);
            case OfflineOperationType.UPDATE:
                return local_operation_1.localOperationService.updateCard(operation.entityId, operation.data, operation.userId);
            case OfflineOperationType.DELETE:
                return local_operation_1.localOperationService.deleteCard(operation.entityId, operation.userId);
            default:
                throw new Error(`Unsupported operation type: ${operation.type}`);
        }
    }
    async storeOfflineOperation(operation) {
        try {
            await database_unified_1.db.syncQueue.add({
                id: operation.id,
                type: operation.type,
                entity: operation.entity,
                entityId: operation.entityId,
                userId: operation.userId,
                data: operation.data,
                priority: operation.priority,
                timestamp: operation.timestamp,
                retryCount: operation.retryCount,
                maxRetries: operation.maxRetries,
                error: undefined
            });
        }
        catch (error) {
            console.error('Failed to store offline operation:', error);
            throw error;
        }
    }
    async syncOperation(operation) {
        try {
            // 这里应该调用实际的同步服务
            // 为了演示，我们模拟同步过程
            // 检查是否有冲突
            const remoteData = await this.fetchRemoteData(operation.entity, operation.entityId);
            const conflict = await this.detectConflicts(operation, remoteData);
            if (conflict) {
                return { success: false, conflict };
            }
            // 模拟同步成功
            await new Promise(resolve => setTimeout(resolve, 100));
            // 标记操作为已完成
            await database_unified_1.db.syncQueue.where('id').equals(operation.id).modify({
                status: 'completed'
            });
            return { success: true };
        }
        catch (error) {
            return {
                success: false,
                error: error instanceof Error ? error.message : String(error)
            };
        }
    }
    async fetchRemoteData(entity, entityId) {
        // 这里应该调用实际的API获取远程数据
        // 为了演示，返回null表示没有远程数据
        return null;
    }
    async getLocalDataForEntity(entity, entityId) {
        switch (entity) {
            case 'card':
                return entityId ? database_unified_1.db.cards.get(entityId) : null;
            case 'folder':
                return entityId ? database_unified_1.db.folders.get(entityId) : null;
            case 'tag':
                return entityId ? database_unified_1.db.tags.get(entityId) : null;
            default:
                return null;
        }
    }
    determineConflictType(operation, localData, remoteData) {
        if (operation.type === OfflineOperationType.DELETE) {
            return 'delete_conflict';
        }
        // 检查数据结构是否发生变化
        if (this.hasStructureChanged(localData, remoteData)) {
            return 'structure_conflict';
        }
        return 'simultaneous_edit';
    }
    hasStructureChanged(localData, remoteData) {
        // 检查数据结构是否发生重大变化
        const localKeys = new Set(Object.keys(localData));
        const remoteKeys = new Set(Object.keys(remoteData));
        return localKeys.size !== remoteKeys.size ||
            ![...localKeys].every(key => remoteKeys.has(key));
    }
    extractContentForMerge(data) {
        // 提取用于合并的内容
        if (data.frontContent && data.backContent) {
            return JSON.stringify({
                front: data.frontContent,
                back: data.backContent
            });
        }
        return JSON.stringify(data);
    }
    calculateContentSimilarity(content1, content2) {
        // 简单的内容相似度计算
        const distance = this.calculateLevenshteinDistance(content1, content2);
        const maxLength = Math.max(content1.length, content2.length);
        return maxLength > 0 ? 1 - (distance / maxLength) : 1;
    }
    calculateLevenshteinDistance(str1, str2) {
        const matrix = Array(str2.length + 1).fill(null).map(() => Array(str1.length + 1).fill(null));
        for (let i = 0; i <= str1.length; i++)
            matrix[0][i] = i;
        for (let j = 0; j <= str2.length; j++)
            matrix[j][0] = j;
        for (let j = 1; j <= str2.length; j++) {
            for (let i = 1; i <= str1.length; i++) {
                const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1;
                matrix[j][i] = Math.min(matrix[j][i - 1] + 1, matrix[j - 1][i] + 1, matrix[j - 1][i - 1] + indicator);
            }
        }
        return matrix[str2.length][str1.length];
    }
    async applyConflictResolution(conflict, resolution) {
        // 应用冲突解决方案
        conflict.resolution = resolution;
        // 这里应该根据解决方案更新数据
        // 实际实现取决于业务逻辑
    }
    async loadOfflineState() {
        // 从持久化存储加载离线状态
        try {
            // 尝试从 IndexedDB 加载（主要存储）
            const indexedDbState = await this.loadFromIndexedDB();
            if (indexedDbState) {
                await this.restoreOfflineState(indexedDbState);
                return;
            }
            // 回退到 localStorage
            const savedState = localStorage.getItem('offlineManagerState');
            if (savedState) {
                const state = JSON.parse(savedState);
                await this.restoreOfflineState(state);
                // 迁移到 IndexedDB
                await this.saveToIndexedDB(state);
                localStorage.removeItem('offlineManagerState');
            }
        }
        catch (error) {
            console.warn('Failed to load offline state:', error);
        }
    }
    async saveOfflineState() {
        try {
            const state = await this.createOfflineStateSnapshot();
            // 保存到 IndexedDB
            await this.saveToIndexedDB(state);
            // 同时保存到 localStorage 作为备份
            await this.saveToLocalStorage(state);
            // 创建增量备份
            await this.createIncrementalBackup(state);
        }
        catch (error) {
            console.warn('Failed to save offline state:', error);
            // 如果 IndexedDB 失败，回退到 localStorage
            await this.saveToLocalStorageFallback();
        }
    }
    async createOfflineStateSnapshot() {
        const pendingOps = await this.getPendingOfflineOperations();
        const conflicts = this.conflicts;
        const stats = await this.getOfflineStats();
        return {
            version: this.getCurrentStateVersion(),
            timestamp: new Date().toISOString(),
            offlineStartTime: this.offlineStartTime?.toISOString(),
            reconnectAttempts: this.reconnectAttempts,
            networkInfo: this.networkInfo,
            pendingOperations: pendingOps.map(op => this.serializeOfflineOperation(op)),
            conflicts: conflicts.map(conflict => this.serializeConflict(conflict)),
            stats: this.serializeStats(stats),
            checksum: await this.calculateStateChecksum(pendingOps, conflicts)
        };
    }
    async saveToIndexedDB(state) {
        try {
            // 使用 Dexie.js 的 transaction API
            await database_unified_1.db.transaction('rw', [database_unified_1.db.syncQueue], async () => {
                // 检查是否存在状态表，如果不存在则创建
                if (!database_unified_1.db.offlineState) {
                    // 动态创建状态表
                    await database_unified_1.db.version(database_unified_1.db.ver + 1).stores({
                        offlineState: '++id,version,timestamp,checksum'
                    });
                }
                // 删除旧的状态记录
                await database_unified_1.db.offlineState?.clear();
                // 保存新的状态记录
                await database_unified_1.db.offlineState?.add({
                    version: state.version,
                    timestamp: new Date(state.timestamp),
                    data: JSON.stringify(state),
                    checksum: state.checksum,
                    compressed: true
                });
            });
        }
        catch (error) {
            console.warn('Failed to save to IndexedDB:', error);
            throw error;
        }
    }
    async loadFromIndexedDB() {
        try {
            if (!database_unified_1.db.offlineState)
                return null;
            const latestState = await database_unified_1.db.offlineState
                .orderBy('timestamp')
                .reverse()
                .first();
            if (!latestState)
                return null;
            // 验证数据完整性
            if (latestState.compressed) {
                const decompressed = this.decompressData(latestState.data);
                const state = JSON.parse(decompressed);
                // 验证校验和
                if (await this.verifyStateChecksum(state)) {
                    return state;
                }
            }
            return null;
        }
        catch (error) {
            console.warn('Failed to load from IndexedDB:', error);
            return null;
        }
    }
    async saveToLocalStorage(state) {
        try {
            const compressed = this.compressData(JSON.stringify(state));
            localStorage.setItem('offlineManagerState', compressed);
        }
        catch (error) {
            console.warn('Failed to save to localStorage:', error);
        }
    }
    async saveToLocalStorageFallback() {
        try {
            const state = {
                offlineStartTime: this.offlineStartTime?.toISOString(),
                reconnectAttempts: this.reconnectAttempts,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('offlineManagerState', JSON.stringify(state));
        }
        catch (error) {
            console.warn('Fallback save failed:', error);
        }
    }
    async createIncrementalBackup(state) {
        try {
            const backupKey = `offlineBackup_${Date.now()}`;
            const backupData = {
                timestamp: state.timestamp,
                version: state.version,
                pendingCount: state.pendingOperations.length,
                conflictsCount: state.conflicts.length,
                compressed: true
            };
            // 限制备份数量，保留最近10个
            const existingBackups = Object.keys(localStorage)
                .filter(key => key.startsWith('offlineBackup_'))
                .sort();
            if (existingBackups.length >= 10) {
                const toDelete = existingBackups.slice(0, existingBackups.length - 9);
                toDelete.forEach(key => localStorage.removeItem(key));
            }
            localStorage.setItem(backupKey, JSON.stringify(backupData));
        }
        catch (error) {
            console.warn('Failed to create incremental backup:', error);
        }
    }
    compressData(data) {
        try {
            // 简单的压缩实现（实际项目中可以使用更复杂的压缩算法）
            return btoa(encodeURIComponent(data));
        }
        catch (error) {
            return data; // 如果压缩失败，返回原始数据
        }
    }
    decompressData(compressed) {
        try {
            return decodeURIComponent(atob(compressed));
        }
        catch (error) {
            return compressed; // 如果解压失败，返回原始数据
        }
    }
    getCurrentStateVersion() {
        return `1.0.${Date.now()}`;
    }
    async calculateStateChecksum(operations, conflicts) {
        const data = JSON.stringify({
            operations: operations.length,
            conflicts: conflicts.length,
            timestamp: Date.now()
        });
        // 简单的校验和计算
        let hash = 0;
        for (let i = 0; i < data.length; i++) {
            const char = data.charCodeAt(i);
            hash = ((hash << 5) - hash) + char;
            hash = hash & hash; // 转换为32位整数
        }
        return Math.abs(hash).toString(16);
    }
    async verifyStateChecksum(state) {
        try {
            const operations = state.pendingOperations.map(op => this.deserializeOfflineOperation(op));
            const conflicts = state.conflicts.map(conflict => this.deserializeConflict(conflict));
            const calculatedChecksum = await this.calculateStateChecksum(operations, conflicts);
            return calculatedChecksum === state.checksum;
        }
        catch (error) {
            return false;
        }
    }
    async restoreOfflineState(state) {
        this.offlineStartTime = state.offlineStartTime ? new Date(state.offlineStartTime) : undefined;
        this.reconnectAttempts = state.reconnectAttempts || 0;
        if (state.networkInfo) {
            this.networkInfo = {
                ...this.networkInfo,
                ...state.networkInfo,
                lastChanged: new Date(state.networkInfo.lastChanged || Date.now())
            };
        }
        if (state.pendingOperations) {
            try {
                const operations = state.pendingOperations.map((op) => this.deserializeOfflineOperation(op));
                // 验证并恢复离线操作
                await this.validateAndRestoreOperations(operations);
            }
            catch (error) {
                console.warn('Failed to restore pending operations:', error);
            }
        }
        if (state.conflicts) {
            this.conflicts = state.conflicts.map((conflict) => this.deserializeConflict(conflict));
        }
    }
    serializeOfflineOperation(op) {
        return {
            ...op,
            timestamp: op.timestamp.toISOString()
        };
    }
    deserializeOfflineOperation(op) {
        return {
            ...op,
            timestamp: new Date(op.timestamp)
        };
    }
    serializeConflict(conflict) {
        return {
            ...conflict,
            timestamp: conflict.timestamp.toISOString()
        };
    }
    deserializeConflict(conflict) {
        return {
            ...conflict,
            timestamp: new Date(conflict.timestamp)
        };
    }
    serializeStats(stats) {
        return {
            ...stats,
            lastSyncTime: stats.lastSyncTime?.toISOString()
        };
    }
    async validateAndRestoreOperations(operations) {
        const validOperations = operations.filter(op => {
            // 验证操作的有效性
            return op.id && op.type && op.entity && op.timestamp;
        });
        // 恢复到同步队列
        for (const operation of validOperations) {
            try {
                await this.storeOfflineOperation(operation);
            }
            catch (error) {
                console.warn(`Failed to restore operation ${operation.id}:`, error);
            }
        }
    }
    calculateOfflineDuration() {
        if (!this.offlineStartTime)
            return 0;
        return Date.now() - this.offlineStartTime.getTime();
    }
    calculateAverageResponseTime() {
        // 简化的平均响应时间计算
        return 50; // 毫秒
    }
    calculateDataSyncedOnResume() {
        // 估算同步的数据量
        return 0; // 字节
    }
    calculateEstimatedBandwidthSaved(operations) {
        // 估算节省的带宽
        return operations.length * 1024; // 假设每个操作节省1KB
    }
    async getLastSyncTime() {
        try {
            const latestSync = await database_unified_1.db.syncQueue
                .where('status')
                .equals('completed')
                .orderBy('timestamp')
                .reverse()
                .first();
            return latestSync ? new Date(latestSync.timestamp) : undefined;
        }
        catch {
            return undefined;
        }
    }
    async getCompletedOfflineOperations() {
        try {
            const completedOps = await database_unified_1.db.syncQueue
                .where('status')
                .equals('completed')
                .toArray();
            return completedOps.map(op => this.convertSyncOperationToOfflineOperation(op));
        }
        catch {
            return [];
        }
    }
    async getFailedOfflineOperations() {
        try {
            const failedOps = await database_unified_1.db.syncQueue
                .where('status')
                .equals('failed')
                .toArray();
            return failedOps.map(op => this.convertSyncOperationToOfflineOperation(op));
        }
        catch {
            return [];
        }
    }
    convertSyncOperationToOfflineOperation(syncOp) {
        return {
            id: syncOp.id,
            type: syncOp.type,
            entity: syncOp.entity,
            entityId: syncOp.entityId,
            userId: syncOp.userId,
            data: syncOp.data,
            priority: syncOp.priority,
            timestamp: new Date(syncOp.timestamp),
            retryCount: syncOp.retryCount,
            maxRetries: syncOp.maxRetries,
            status: syncOp.status
        };
    }
    sortOperationsByPriority(operations) {
        const priorityOrder = { critical: 4, high: 3, normal: 2, low: 1 };
        return [...operations].sort((a, b) => priorityOrder[b.priority] - priorityOrder[a.priority]);
    }
    async retryOperation(operation) {
        // 重试操作逻辑
        await database_unified_1.db.syncQueue.where('id').equals(operation.id).modify({
            status: 'pending',
            retryCount: operation.retryCount + 1
        });
    }
    // ============================================================================
    // 新增增强功能方法
    // ============================================================================
    /**
     * 计算历史可靠性
     */
    async calculateHistoricalReliability() {
        try {
            const oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);
            const recentOperations = await database_unified_1.db.syncQueue
                .where('timestamp')
                .above(oneHourAgo)
                .toArray();
            if (recentOperations.length === 0)
                return 1.0;
            const successfulOps = recentOperations.filter(op => op.status === 'completed').length;
            return successfulOps / recentOperations.length;
        }
        catch {
            return 0.9; // 默认可靠性
        }
    }
    /**
     * 智能冲突预测和预防
     */
    async predictAndPreventConflicts(operations) {
        const conflicts = [];
        for (const operation of operations) {
            if (operation.entityId) {
                // 检查是否有可能的冲突
                const potentialConflict = await this.checkPotentialConflict(operation);
                if (potentialConflict) {
                    conflicts.push(potentialConflict);
                }
            }
        }
        return conflicts;
    }
    /**
     * 检查潜在冲突
     */
    async checkPotentialConflict(operation) {
        try {
            // 检查同一实体的最近操作
            const recentOps = await database_unified_1.db.syncQueue
                .where('entity')
                .equals(operation.entity)
                .and(op => op.entityId === operation.entityId)
                .reverse()
                .limit(5)
                .toArray();
            if (recentOps.length === 0)
                return null;
            // 检查时间重叠（假设5分钟内的操作可能冲突）
            const fiveMinutesAgo = new Date(Date.now() - 5 * 60 * 1000);
            const conflictingOps = recentOps.filter(op => new Date(op.timestamp) > fiveMinutesAgo &&
                op.id !== operation.id);
            if (conflictingOps.length > 0) {
                return {
                    id: crypto.randomUUID(),
                    entityType: operation.entity,
                    entityId: operation.entityId,
                    localData: operation.data,
                    remoteData: conflictingOps[0].data, // 简化的远程数据
                    conflictType: 'simultaneous_edit',
                    timestamp: new Date(),
                    resolution: 'pending'
                };
            }
            return null;
        }
        catch {
            return null;
        }
    }
    /**
     * 性能监控和优化建议
     */
    async generatePerformanceOptimization() {
        const stats = await this.getOfflineStats();
        const recommendations = [];
        const predictedImprovements = [];
        // 基于统计信息提供建议
        if (stats.averageResponseTime > 100) {
            recommendations.push('建议启用操作批处理以减少响应时间');
            predictedImprovements.push(0.3); // 预计提升30%
        }
        if (stats.pendingOperations > 50) {
            recommendations.push('建议增加同步频率或优化队列管理');
            predictedImprovements.push(0.4); // 预计提升40%
        }
        if (stats.failedOperations > stats.completedOfflineOperations * 0.1) {
            recommendations.push('建议检查网络连接并优化重试策略');
            predictedImprovements.push(0.5); // 预计提升50%
        }
        return { recommendations, predictedImprovements };
    }
    /**
     * 智能离线数据压缩
     */
    async compressOfflineData(operations) {
        const compressed = [];
        let originalSize = 0;
        let compressedSize = 0;
        for (const operation of operations) {
            originalSize += JSON.stringify(operation.data).length;
            // 对大数据进行压缩
            if (JSON.stringify(operation.data).length > 1024) {
                const compressedOp = {
                    ...operation,
                    data: await this.compressData(operation.data)
                };
                compressed.push(compressedOp);
                compressedSize += JSON.stringify(compressedOp.data).length;
            }
            else {
                compressed.push(operation);
                compressedSize += JSON.stringify(operation.data).length;
            }
        }
        return {
            compressed,
            compressionRatio: originalSize > 0 ? compressedSize / originalSize : 1
        };
    }
}
exports.OfflineManager = OfflineManager;
// ============================================================================
// 导出单例实例
// ============================================================================
exports.offlineManager = new OfflineManager();
// ============================================================================
// 便利方法导出
// ============================================================================
const executeOfflineOperation = (operation) => exports.offlineManager.executeOfflineOperation(operation);
exports.executeOfflineOperation = executeOfflineOperation;
const executeBatchOfflineOperations = (operations) => exports.offlineManager.executeBatchOfflineOperations(operations);
exports.executeBatchOfflineOperations = executeBatchOfflineOperations;
const getOfflineStats = () => exports.offlineManager.getOfflineStats();
exports.getOfflineStats = getOfflineStats;
const getNetworkStatus = () => exports.offlineManager.getNetworkStatus();
exports.getNetworkStatus = getNetworkStatus;
const retryFailedOperations = () => exports.offlineManager.retryFailedOperations();
exports.retryFailedOperations = retryFailedOperations;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXG9mZmxpbmUtbWFuYWdlci50cyIsIm1hcHBpbmdzIjoiOzs7QUFBQSx5REFBdUM7QUFFdkMsdURBQXlEO0FBR3pELCtFQUErRTtBQUMvRSxTQUFTO0FBQ1QsK0VBQStFO0FBRS9FLElBQVksYUFLWDtBQUxELFdBQVksYUFBYTtJQUN2QixrQ0FBaUIsQ0FBQTtJQUNqQixvQ0FBbUIsQ0FBQTtJQUNuQixzQ0FBcUIsQ0FBQTtJQUNyQixvQ0FBbUIsQ0FBQTtBQUNyQixDQUFDLEVBTFcsYUFBYSw2QkFBYixhQUFhLFFBS3hCO0FBRUQsK0VBQStFO0FBQy9FLFNBQVM7QUFDVCwrRUFBK0U7QUFFL0UsSUFBWSxvQkFLWDtBQUxELFdBQVksb0JBQW9CO0lBQzlCLHlDQUFpQixDQUFBO0lBQ2pCLHlDQUFpQixDQUFBO0lBQ2pCLHlDQUFpQixDQUFBO0lBQ2pCLHVDQUFlLENBQUE7QUFDakIsQ0FBQyxFQUxXLG9CQUFvQixvQ0FBcEIsb0JBQW9CLFFBSy9CO0FBMkhELCtFQUErRTtBQUMvRSxnQkFBZ0I7QUFDaEIsK0VBQStFO0FBRS9FLE1BQU0sU0FBUztJQUliLFlBQVksS0FBYTtRQUhqQjs7Ozs7V0FBaUI7UUFDakI7Ozs7bUJBQTBCLEVBQUU7V0FBQTtRQUdsQyxJQUFJLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQTtJQUN4QixDQUFDO0lBRUQsS0FBSyxDQUFDLE9BQU87UUFDWCxJQUFJLElBQUksQ0FBQyxTQUFTLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDdkIsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFBO1lBQ2hCLE9BQU07UUFDUixDQUFDO1FBRUQsT0FBTyxJQUFJLE9BQU8sQ0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFO1lBQ25DLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFBO1FBQzVCLENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUVE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SUFBSSxjQUFjLEVBQUUsQ0FBQTtBQUVsRCwrRUFBK0U7QUFDL0UsU0FBUztBQUNULCtFQUErRTtBQUV4RSxNQUFNLHVCQUF1QixHQUFHLENBQUMsU0FBYyxFQUFFLEVBQUUsQ0FDeEQsc0JBQWMsQ0FBQyx1QkFBdUIsQ0FBQyxTQUFTLENBQUMsQ0FBQTtBQUR0QyxRQUFBLHVCQUF1QiwyQkFDZTtBQUU1QyxNQUFNLDZCQUE2QixHQUFHLENBQUMsVUFBaUIsRUFBRSxFQUFFLENBQ2pFLHNCQUFjLENBQUMsNkJBQTZCLENBQUMsVUFBVSxDQUFDLENBQUE7QUFEN0MsUUFBQSw2QkFBNkIsaUNBQ2dCO0FBRW5ELE1BQU0sZUFBZSxHQUFHLEdBQUcsRUFBRSxDQUFDLHNCQUFjLENBQUMsZUFBZSxFQUFFLENBQUE7QUFBeEQsUUFBQSxlQUFlLG1CQUF5QztBQUM5RCxNQUFNLGdCQUFnQixHQUFHLEdBQUcsRUFBRSxDQUFDLHNCQUFjLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQTtBQUExRCxRQUFBLGdCQUFnQixvQkFBMEM7QUFDaEUsTUFBTSxxQkFBcUIsR0FBRyxHQUFHLEVBQUUsQ0FBQyxzQkFBYyxDQUFDLHFCQUFxQixFQUFFLENBQUE7QUFBcEUsUUFBQSxxQkFBcUIseUJBQStDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkQ6XFxQcm9qZWN0c1xcQ2FyZEV2ZXJ5dGhpbmdcXGNhcmRhbGwtcHJvdG90eXBlXFxzcmNcXHNlcnZpY2VzXFxvZmZsaW5lLW1hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGIgfSBmcm9tICcuL2RhdGFiYXNlLXVuaWZpZWQnXG5pbXBvcnQgeyBzeW5jUXVldWVNYW5hZ2VyIH0gZnJvbSAnLi9zeW5jLXF1ZXVlJ1xuaW1wb3J0IHsgbG9jYWxPcGVyYXRpb25TZXJ2aWNlIH0gZnJvbSAnLi9sb2NhbC1vcGVyYXRpb24nXG5pbXBvcnQgeyBhZHZhbmNlZENhY2hlTWFuYWdlciB9IGZyb20gJy4vYWR2YW5jZWQtY2FjaGUnXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOe9kee7nOeKtuaAgeexu+Wei1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZW51bSBOZXR3b3JrU3RhdHVzIHtcbiAgT05MSU5FID0gJ29ubGluZScsXG4gIE9GRkxJTkUgPSAnb2ZmbGluZScsXG4gIFVOU1RBQkxFID0gJ3Vuc3RhYmxlJyxcbiAgVU5LTk9XTiA9ICd1bmtub3duJ1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnprvnur/mk43kvZznsbvlnotcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGVudW0gT2ZmbGluZU9wZXJhdGlvblR5cGUge1xuICBDUkVBVEUgPSAnY3JlYXRlJyxcbiAgVVBEQVRFID0gJ3VwZGF0ZScsXG4gIERFTEVURSA9ICdkZWxldGUnLFxuICBCQVRDSCA9ICdiYXRjaCdcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g56a757q/5pON5L2c5o6l5Y+jXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2ZmbGluZU9wZXJhdGlvbiB7XG4gIGlkOiBzdHJpbmdcbiAgdHlwZTogT2ZmbGluZU9wZXJhdGlvblR5cGVcbiAgZW50aXR5OiAnY2FyZCcgfCAnZm9sZGVyJyB8ICd0YWcnIHwgJ2ltYWdlJ1xuICBlbnRpdHlJZD86IHN0cmluZ1xuICBkYXRhOiBhbnlcbiAgdXNlcklkPzogc3RyaW5nXG4gIHRpbWVzdGFtcDogRGF0ZVxuICBwcmlvcml0eTogJ2NyaXRpY2FsJyB8ICdoaWdoJyB8ICdub3JtYWwnIHwgJ2xvdydcbiAgcmV0cnlDb3VudDogbnVtYmVyXG4gIG1heFJldHJpZXM6IG51bWJlclxuICBkZXBlbmRlbmNpZXM/OiBzdHJpbmdbXVxuICBtZXRhZGF0YT86IHtcbiAgICBlc3RpbWF0ZWRTaXplPzogbnVtYmVyXG4gICAgY29uZmxpY3RSZXNvbHV0aW9uPzogJ2xvY2FsJyB8ICdyZW1vdGUnIHwgJ21lcmdlJyB8ICdtYW51YWwnXG4gICAgc3luY09uUmVzdW1lPzogYm9vbGVhblxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOe9kee7nOebkeaOp+S/oeaBr1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIE5ldHdvcmtJbmZvIHtcbiAgc3RhdHVzOiBOZXR3b3JrU3RhdHVzXG4gIGVmZmVjdGl2ZVR5cGU/OiBzdHJpbmdcbiAgZG93bmxpbms/OiBudW1iZXJcbiAgcnR0PzogbnVtYmVyXG4gIHNhdmVEYXRhPzogYm9vbGVhblxuICBsYXN0Q2hhbmdlZDogRGF0ZVxuICBjb25uZWN0aW9uVHlwZT86ICd3aWZpJyB8ICdjZWxsdWxhcicgfCAnZXRoZXJuZXQnIHwgJ3Vua25vd24nXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOemu+e6v+e7n+iuoeS/oeaBr1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIE9mZmxpbmVTdGF0cyB7XG4gIGlzT2ZmbGluZTogYm9vbGVhblxuICBvZmZsaW5lRHVyYXRpb246IG51bWJlclxuICBwZW5kaW5nT3BlcmF0aW9uczogbnVtYmVyXG4gIGNvbXBsZXRlZE9mZmxpbmVPcGVyYXRpb25zOiBudW1iZXJcbiAgZmFpbGVkT3BlcmF0aW9uczogbnVtYmVyXG4gIGF2ZXJhZ2VSZXNwb25zZVRpbWU6IG51bWJlclxuICBkYXRhU3luY2VkT25SZXN1bWU6IG51bWJlclxuICBsYXN0U3luY1RpbWU/OiBEYXRlXG4gIGVzdGltYXRlZEJhbmR3aWR0aFNhdmVkOiBudW1iZXJcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g5Yay56qB5qOA5rWL5o6l5Y+jXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmxpY3RJbmZvIHtcbiAgaWQ6IHN0cmluZ1xuICBlbnRpdHlUeXBlOiBzdHJpbmdcbiAgZW50aXR5SWQ6IHN0cmluZ1xuICBsb2NhbERhdGE6IGFueVxuICByZW1vdGVEYXRhOiBhbnlcbiAgY29uZmxpY3RUeXBlOiAnc2ltdWx0YW5lb3VzX2VkaXQnIHwgJ2RlbGV0ZV9jb25mbGljdCcgfCAnc3RydWN0dXJlX2NvbmZsaWN0J1xuICB0aW1lc3RhbXA6IERhdGVcbiAgcmVzb2x1dGlvbj86ICdsb2NhbCcgfCAncmVtb3RlJyB8ICdtZXJnZScgfCAnbWFudWFsJyB8ICdwZW5kaW5nJ1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnprvnur/nirbmgIHlv6vnhafmjqXlj6Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBPZmZsaW5lU3RhdGVTbmFwc2hvdCB7XG4gIHZlcnNpb246IHN0cmluZ1xuICB0aW1lc3RhbXA6IHN0cmluZ1xuICBvZmZsaW5lU3RhcnRUaW1lPzogc3RyaW5nXG4gIHJlY29ubmVjdEF0dGVtcHRzOiBudW1iZXJcbiAgbmV0d29ya0luZm86IE5ldHdvcmtJbmZvXG4gIHBlbmRpbmdPcGVyYXRpb25zOiBhbnlbXVxuICBjb25mbGljdHM6IGFueVtdXG4gIHN0YXRzOiBhbnlcbiAgY2hlY2tzdW06IHN0cmluZ1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnvZHnu5zotKjph4/or4TkvLDmjqXlj6Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBOZXR3b3JrUXVhbGl0eUFzc2Vzc21lbnQge1xuICBpc1N0YWJsZTogYm9vbGVhblxuICBiYW5kd2lkdGg6ICdleGNlbGxlbnQnIHwgJ2dvb2QnIHwgJ2ZhaXInIHwgJ3Bvb3InXG4gIGxhdGVuY3k6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCdcbiAgcmVsaWFiaWxpdHk6IG51bWJlclxuICByZWNvbW1lbmRlZFN0cmF0ZWd5OiBTeW5jU3RyYXRlZ3lUeXBlXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOWQjOatpeetlueVpeexu+Wei1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgdHlwZSBTeW5jU3RyYXRlZ3lUeXBlID0gJ2ltbWVkaWF0ZScgfCAnYmF0Y2hlZCcgfCAncHJpb3JpdGl6ZWQnIHwgJ2NvbnNlcnZhdGl2ZSdcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g5pm66IO95ZCM5q2l562W55Wl5o6l5Y+jXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgU21hcnRTeW5jU3RyYXRlZ3kge1xuICBzdHJhdGVneTogU3luY1N0cmF0ZWd5VHlwZVxuICBiYXRjaFNpemU6IG51bWJlclxuICBkZWxheUJldHdlZW5CYXRjaGVzOiBudW1iZXJcbiAgcHJpb3JpdHlGaWx0ZXI6ICgnY3JpdGljYWwnIHwgJ2hpZ2gnIHwgJ25vcm1hbCcgfCAnbG93JylbXVxuICBtYXhDb25jdXJyZW50T3BlcmF0aW9uczogbnVtYmVyXG4gIHRpbWVvdXQ6IG51bWJlclxuICByZXRyeVN0cmF0ZWd5OiB7XG4gICAgbWF4UmV0cmllczogbnVtYmVyXG4gICAgaW5pdGlhbERlbGF5OiBudW1iZXJcbiAgICBtYXhEZWxheTogbnVtYmVyXG4gICAgYmFja29mZk11bHRpcGxpZXI6IG51bWJlclxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOS/oeWPt+mHj+WunueOsO+8iOeUqOS6juW5tuWPkeaOp+WItu+8iVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jbGFzcyBTZW1hcGhvcmUge1xuICBwcml2YXRlIGF2YWlsYWJsZTogbnVtYmVyXG4gIHByaXZhdGUgd2FpdGluZzogKCgpID0+IHZvaWQpW10gPSBbXVxuXG4gIGNvbnN0cnVjdG9yKGNvdW50OiBudW1iZXIpIHtcbiAgICB0aGlzLmF2YWlsYWJsZSA9IGNvdW50XG4gIH1cblxuICBhc3luYyBhY3F1aXJlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLmF2YWlsYWJsZSA+IDApIHtcbiAgICAgIHRoaXMuYXZhaWxhYmxlLS1cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSkgPT4ge1xuICAgICAgdGhpcy53YWl0aW5nLnB1c2gocmVzb2x2ZSlcbiAgICB9KVxuICB9XG5cbiAgcmVsZWFzZSgpOiB2b2lkIHtcbiAgICB0aGlzLmF2YWlsYWJsZSsrXG4gICAgXG4gICAgaWYgKHRoaXMud2FpdGluZy5sZW5ndGggPiAwICYmIHRoaXMuYXZhaWxhYmxlID4gMCkge1xuICAgICAgY29uc3QgbmV4dCA9IHRoaXMud2FpdGluZy5zaGlmdCgpXG4gICAgICBpZiAobmV4dCkge1xuICAgICAgICB0aGlzLmF2YWlsYWJsZS0tXG4gICAgICAgIG5leHQoKVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnprvnur/nrqHnkIblmajkuLvnsbtcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNsYXNzIE9mZmxpbmVNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBpc09mZmxpbmUgPSAhbmF2aWdhdG9yLm9uTGluZVxuICBwcml2YXRlIG5ldHdvcmtJbmZvOiBOZXR3b3JrSW5mbyA9IHtcbiAgICBzdGF0dXM6IG5hdmlnYXRvci5vbkxpbmUgPyBOZXR3b3JrU3RhdHVzLk9OTElORSA6IE5ldHdvcmtTdGF0dXMuT0ZGTElORSxcbiAgICBsYXN0Q2hhbmdlZDogbmV3IERhdGUoKVxuICB9XG4gIHByaXZhdGUgb2ZmbGluZU9wZXJhdGlvbnM6IE9mZmxpbmVPcGVyYXRpb25bXSA9IFtdXG4gIHByaXZhdGUgY29uZmxpY3RzOiBDb25mbGljdEluZm9bXSA9IFtdXG4gIHByaXZhdGUgb2ZmbGluZVN0YXJ0VGltZT86IERhdGVcbiAgcHJpdmF0ZSBzeW5jVGltZXI/OiBOb2RlSlMuVGltZW91dFxuICBwcml2YXRlIHJlY29ubmVjdEF0dGVtcHRzID0gMFxuICBwcml2YXRlIG1heFJlY29ubmVjdEF0dGVtcHRzID0gMTBcbiAgXG4gIC8vIOS6i+S7tuebkeWQrOWZqFxuICBwcml2YXRlIGxpc3RlbmVyczoge1xuICAgIG9uTmV0d29ya0NoYW5nZT86IChpbmZvOiBOZXR3b3JrSW5mbykgPT4gdm9pZFxuICAgIG9uT2ZmbGluZU9wZXJhdGlvbj86IChvcGVyYXRpb246IE9mZmxpbmVPcGVyYXRpb24pID0+IHZvaWRcbiAgICBvblN5bmNQcm9ncmVzcz86IChwcm9ncmVzczogeyBjb21wbGV0ZWQ6IG51bWJlcjsgdG90YWw6IG51bWJlciB9KSA9PiB2b2lkXG4gICAgb25Db25mbGljdD86IChjb25mbGljdDogQ29uZmxpY3RJbmZvKSA9PiB2b2lkXG4gICAgb25TeW5jQ29tcGxldGU/OiAoc3RhdHM6IE9mZmxpbmVTdGF0cykgPT4gdm9pZFxuICAgIG9uRXJyb3I/OiAoZXJyb3I6IEVycm9yKSA9PiB2b2lkXG4gIH0gPSB7fVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZU9mZmxpbmVNYW5hZ2VyKClcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g56a757q/54q25oCB5qOA5rWL5ZKM566h55CGXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog6I635Y+W5b2T5YmN572R57uc54q25oCBXG4gICAqL1xuICBnZXROZXR3b3JrU3RhdHVzKCk6IE5ldHdvcmtJbmZvIHtcbiAgICByZXR1cm4geyAuLi50aGlzLm5ldHdvcmtJbmZvIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmo4Dmn6XmmK/lkKbnprvnur9cbiAgICovXG4gIGlzQ3VycmVudGx5T2ZmbGluZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pc09mZmxpbmVcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bnprvnur/nu5/orqHkv6Hmga9cbiAgICovXG4gIGFzeW5jIGdldE9mZmxpbmVTdGF0cygpOiBQcm9taXNlPE9mZmxpbmVTdGF0cz4ge1xuICAgIGNvbnN0IHBlbmRpbmdPcHMgPSBhd2FpdCB0aGlzLmdldFBlbmRpbmdPZmZsaW5lT3BlcmF0aW9ucygpXG4gICAgY29uc3QgY29tcGxldGVkT3BzID0gYXdhaXQgdGhpcy5nZXRDb21wbGV0ZWRPZmZsaW5lT3BlcmF0aW9ucygpXG4gICAgY29uc3QgZmFpbGVkT3BzID0gYXdhaXQgdGhpcy5nZXRGYWlsZWRPZmZsaW5lT3BlcmF0aW9ucygpXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGlzT2ZmbGluZTogdGhpcy5pc09mZmxpbmUsXG4gICAgICBvZmZsaW5lRHVyYXRpb246IHRoaXMuY2FsY3VsYXRlT2ZmbGluZUR1cmF0aW9uKCksXG4gICAgICBwZW5kaW5nT3BlcmF0aW9uczogcGVuZGluZ09wcy5sZW5ndGgsXG4gICAgICBjb21wbGV0ZWRPZmZsaW5lT3BlcmF0aW9uczogY29tcGxldGVkT3BzLmxlbmd0aCxcbiAgICAgIGZhaWxlZE9wZXJhdGlvbnM6IGZhaWxlZE9wcy5sZW5ndGgsXG4gICAgICBhdmVyYWdlUmVzcG9uc2VUaW1lOiB0aGlzLmNhbGN1bGF0ZUF2ZXJhZ2VSZXNwb25zZVRpbWUoKSxcbiAgICAgIGRhdGFTeW5jZWRPblJlc3VtZTogdGhpcy5jYWxjdWxhdGVEYXRhU3luY2VkT25SZXN1bWUoKSxcbiAgICAgIGxhc3RTeW5jVGltZTogYXdhaXQgdGhpcy5nZXRMYXN0U3luY1RpbWUoKSxcbiAgICAgIGVzdGltYXRlZEJhbmR3aWR0aFNhdmVkOiB0aGlzLmNhbGN1bGF0ZUVzdGltYXRlZEJhbmR3aWR0aFNhdmVkKHBlbmRpbmdPcHMpXG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDnprvnur/mk43kvZznrqHnkIZcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDmiafooYznprvnur/mk43kvZxcbiAgICovXG4gIGFzeW5jIGV4ZWN1dGVPZmZsaW5lT3BlcmF0aW9uPFQgPSBhbnk+KFxuICAgIG9wZXJhdGlvbjogT21pdDxPZmZsaW5lT3BlcmF0aW9uLCAnaWQnIHwgJ3RpbWVzdGFtcCcgfCAncmV0cnlDb3VudCc+XG4gICk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBkYXRhPzogVDsgZXJyb3I/OiBzdHJpbmc7IG9wZXJhdGlvbklkOiBzdHJpbmcgfT4ge1xuICAgIGNvbnN0IG9mZmxpbmVPcGVyYXRpb246IE9mZmxpbmVPcGVyYXRpb24gPSB7XG4gICAgICAuLi5vcGVyYXRpb24sXG4gICAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIHJldHJ5Q291bnQ6IDBcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgLy8g5qOA5p+l5L6d6LWW5YWz57O7XG4gICAgICBpZiAob3BlcmF0aW9uLmRlcGVuZGVuY2llcyAmJiBvcGVyYXRpb24uZGVwZW5kZW5jaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgYXdhaXQgdGhpcy52YWxpZGF0ZURlcGVuZGVuY2llcyhvcGVyYXRpb24uZGVwZW5kZW5jaWVzKVxuICAgICAgfVxuXG4gICAgICAvLyDmiafooYzmnKzlnLDmk43kvZxcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGVyZm9ybUxvY2FsT3BlcmF0aW9uKG9mZmxpbmVPcGVyYXRpb24pXG4gICAgICBcbiAgICAgIC8vIOWtmOWCqOemu+e6v+aTjeS9nOiusOW9lVxuICAgICAgYXdhaXQgdGhpcy5zdG9yZU9mZmxpbmVPcGVyYXRpb24ob2ZmbGluZU9wZXJhdGlvbilcbiAgICAgIFxuICAgICAgLy8g6YCa55+l55uR5ZCs5ZmoXG4gICAgICBpZiAodGhpcy5saXN0ZW5lcnMub25PZmZsaW5lT3BlcmF0aW9uKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzLm9uT2ZmbGluZU9wZXJhdGlvbihvZmZsaW5lT3BlcmF0aW9uKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgIG9wZXJhdGlvbklkOiBvZmZsaW5lT3BlcmF0aW9uLmlkXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ09mZmxpbmUgb3BlcmF0aW9uIGZhaWxlZDonLCBlcnJvcilcbiAgICAgIFxuICAgICAgLy8g5a2Y5YKo5aSx6LSl55qE5pON5L2cXG4gICAgICBvZmZsaW5lT3BlcmF0aW9uLnByaW9yaXR5ID0gJ2hpZ2gnIC8vIOWksei0peeahOaTjeS9nOaPkOWNh+S8mOWFiOe6p1xuICAgICAgYXdhaXQgdGhpcy5zdG9yZU9mZmxpbmVPcGVyYXRpb24ob2ZmbGluZU9wZXJhdGlvbilcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvciksXG4gICAgICAgIG9wZXJhdGlvbklkOiBvZmZsaW5lT3BlcmF0aW9uLmlkXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaJuemHj+aJp+ihjOemu+e6v+aTjeS9nFxuICAgKi9cbiAgYXN5bmMgZXhlY3V0ZUJhdGNoT2ZmbGluZU9wZXJhdGlvbnMoXG4gICAgb3BlcmF0aW9uczogT21pdDxPZmZsaW5lT3BlcmF0aW9uLCAnaWQnIHwgJ3RpbWVzdGFtcCcgfCAncmV0cnlDb3VudCc+W11cbiAgKTogUHJvbWlzZTx7IFxuICAgIHN1Y2Nlc3M6IGJvb2xlYW47IFxuICAgIHJlc3VsdHM6IEFycmF5PHsgc3VjY2VzczogYm9vbGVhbjsgZGF0YT86IGFueTsgZXJyb3I/OiBzdHJpbmc7IG9wZXJhdGlvbklkOiBzdHJpbmcgfT47XG4gICAgYmF0Y2hJZDogc3RyaW5nIFxuICB9PiB7XG4gICAgY29uc3QgYmF0Y2hJZCA9IGNyeXB0by5yYW5kb21VVUlEKClcbiAgICBjb25zdCByZXN1bHRzOiBBcnJheTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGRhdGE/OiBhbnk7IGVycm9yPzogc3RyaW5nOyBvcGVyYXRpb25JZDogc3RyaW5nIH0+ID0gW11cbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8g6aqM6K+B5omA5pyJ5pON5L2c55qE5L6d6LWW5YWz57O7XG4gICAgICBjb25zdCBhbGxEZXBlbmRlbmNpZXMgPSBvcGVyYXRpb25zXG4gICAgICAgIC5maWx0ZXIob3AgPT4gb3AuZGVwZW5kZW5jaWVzICYmIG9wLmRlcGVuZGVuY2llcy5sZW5ndGggPiAwKVxuICAgICAgICAuZmxhdE1hcChvcCA9PiBvcC5kZXBlbmRlbmNpZXMhKVxuICAgICAgXG4gICAgICBpZiAoYWxsRGVwZW5kZW5jaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgYXdhaXQgdGhpcy52YWxpZGF0ZURlcGVuZGVuY2llcyhhbGxEZXBlbmRlbmNpZXMpXG4gICAgICB9XG5cbiAgICAgIC8vIOaMieS8mOWFiOe6p+aOkuW6j1xuICAgICAgY29uc3Qgc29ydGVkT3BlcmF0aW9ucyA9IHRoaXMuc29ydE9wZXJhdGlvbnNCeVByaW9yaXR5KG9wZXJhdGlvbnMpXG4gICAgICBcbiAgICAgIC8vIOaJp+ihjOaTjeS9nFxuICAgICAgZm9yIChjb25zdCBvcGVyYXRpb24gb2Ygc29ydGVkT3BlcmF0aW9ucykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVPZmZsaW5lT3BlcmF0aW9uKG9wZXJhdGlvbilcbiAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdClcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogcmVzdWx0cy5ldmVyeShyID0+IHIuc3VjY2VzcyksXG4gICAgICAgIHJlc3VsdHMsXG4gICAgICAgIGJhdGNoSWRcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignQmF0Y2ggb2ZmbGluZSBvcGVyYXRpb25zIGZhaWxlZDonLCBlcnJvcilcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICByZXN1bHRzOiByZXN1bHRzLm1hcChyZXN1bHQgPT4gKHtcbiAgICAgICAgICAuLi5yZXN1bHQsXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKVxuICAgICAgICB9KSksXG4gICAgICAgIGJhdGNoSWRcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5b6F5aSE55CG55qE56a757q/5pON5L2cXG4gICAqL1xuICBhc3luYyBnZXRQZW5kaW5nT2ZmbGluZU9wZXJhdGlvbnMoKTogUHJvbWlzZTxPZmZsaW5lT3BlcmF0aW9uW10+IHtcbiAgICByZXR1cm4gYXdhaXQgZGIudHJhbnNhY3Rpb24oJ3InLCBbZGIuc3luY1F1ZXVlXSwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3luY09wcyA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgICAud2hlcmUoJ3N0YXR1cycpXG4gICAgICAgIC5lcXVhbHMoJ3BlbmRpbmcnIGFzIGFueSlcbiAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgXG4gICAgICByZXR1cm4gc3luY09wcy5tYXAob3AgPT4gdGhpcy5jb252ZXJ0U3luY09wZXJhdGlvblRvT2ZmbGluZU9wZXJhdGlvbihvcCkpXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDph43or5XlpLHotKXnmoTnprvnur/mk43kvZxcbiAgICovXG4gIGFzeW5jIHJldHJ5RmFpbGVkT3BlcmF0aW9ucygpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGNvbnN0IGZhaWxlZE9wcyA9IGF3YWl0IHRoaXMuZ2V0RmFpbGVkT2ZmbGluZU9wZXJhdGlvbnMoKVxuICAgIGxldCByZXRyaWVkQ291bnQgPSAwXG4gICAgXG4gICAgZm9yIChjb25zdCBvcGVyYXRpb24gb2YgZmFpbGVkT3BzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLnJldHJ5T3BlcmF0aW9uKG9wZXJhdGlvbilcbiAgICAgICAgcmV0cmllZENvdW50KytcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIHJldHJ5IG9wZXJhdGlvbiAke29wZXJhdGlvbi5pZH06YCwgZXJyb3IpXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiByZXRyaWVkQ291bnRcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g572R57uc5oGi5aSN5aSE55CGXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog5aSE55CG572R57uc5oGi5aSNXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZU5ldHdvcmtSZWNvdmVyeSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnTmV0d29yayByZWNvdmVyZWQsIGFuYWx5emluZyBzeW5jIHN0cmF0ZWd5Li4uJylcbiAgICBcbiAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKVxuICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgdGhpcy5nZXRPZmZsaW5lU3RhdHMoKVxuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyDnvZHnu5zotKjph4/or4TkvLBcbiAgICAgIGNvbnN0IG5ldHdvcmtRdWFsaXR5ID0gYXdhaXQgdGhpcy5hc3Nlc3NOZXR3b3JrUXVhbGl0eSgpXG4gICAgICBcbiAgICAgIC8vIOaZuuiDveWQjOatpeetlueVpemAieaLqVxuICAgICAgY29uc3Qgc3luY1N0cmF0ZWd5ID0gYXdhaXQgdGhpcy5kZXRlcm1pbmVTeW5jU3RyYXRlZ3koc3RhdHMsIG5ldHdvcmtRdWFsaXR5KVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhgVXNpbmcgc3luYyBzdHJhdGVneTogJHtzeW5jU3RyYXRlZ3kuc3RyYXRlZ3l9YClcbiAgICAgIFxuICAgICAgLy8g6YCa55+l5ZCM5q2l5byA5aeLXG4gICAgICB0aGlzLm5vdGlmeVN5bmNQcm9ncmVzcygwLCBzdGF0cy5wZW5kaW5nT3BlcmF0aW9ucylcbiAgICAgIFxuICAgICAgLy8g5qC55o2u562W55Wl5omn6KGM5ZCM5q2lXG4gICAgICBjb25zdCBzeW5jUmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlU21hcnRTeW5jKHN5bmNTdHJhdGVneSwgc3RhdHMpXG4gICAgICBcbiAgICAgIC8vIOWkhOeQhuWGsueqgVxuICAgICAgaWYgKHN5bmNSZXN1bHQuY29uZmxpY3RzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVDb25mbGljdHMoc3luY1Jlc3VsdC5jb25mbGljdHMpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOaJp+ihjOWQjuWQjOatpeS8mOWMllxuICAgICAgYXdhaXQgdGhpcy5wZXJmb3JtUG9zdFN5bmNPcHRpbWl6YXRpb25zKHN5bmNSZXN1bHQsIG5ldHdvcmtRdWFsaXR5KVxuICAgICAgXG4gICAgICAvLyDmm7TmlrDnu5/orqHkv6Hmga9cbiAgICAgIGNvbnN0IGZpbmFsU3RhdHMgPSBhd2FpdCB0aGlzLmdldE9mZmxpbmVTdGF0cygpXG4gICAgICB0aGlzLm5vdGlmeVN5bmNDb21wbGV0ZShmaW5hbFN0YXRzKVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhgU21hcnQgb2ZmbGluZSBzeW5jIGNvbXBsZXRlZCBpbiAkeyhwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZSkudG9GaXhlZCgyKX1tc2ApXG4gICAgICBjb25zb2xlLmxvZyhgU3luYyByZXN1bHRzOiAke3N5bmNSZXN1bHQuc3luY2VkT3BlcmF0aW9uc30gb3BlcmF0aW9ucywgJHtzeW5jUmVzdWx0LmNvbmZsaWN0cy5sZW5ndGh9IGNvbmZsaWN0c2ApXG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignU21hcnQgb2ZmbGluZSBzeW5jIGZhaWxlZDonLCBlcnJvcilcbiAgICAgIFxuICAgICAgLy8g5pm66IO96ZSZ6K+v5oGi5aSNXG4gICAgICBhd2FpdCB0aGlzLmhhbmRsZVN5bmNFcnJvcihlcnJvciwgc3RhdHMpXG4gICAgICBcbiAgICAgIGlmICh0aGlzLmxpc3RlbmVycy5vbkVycm9yKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzLm9uRXJyb3IoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDor4TkvLDnvZHnu5zotKjph48gLSDlop7lvLrniYjmnKxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgYXNzZXNzTmV0d29ya1F1YWxpdHkoKTogUHJvbWlzZTxOZXR3b3JrUXVhbGl0eUFzc2Vzc21lbnQ+IHtcbiAgICBjb25zdCBjb25uZWN0aW9uID0gKG5hdmlnYXRvciBhcyBhbnkpLmNvbm5lY3Rpb25cbiAgICBjb25zdCBhc3Nlc3NtZW50OiBOZXR3b3JrUXVhbGl0eUFzc2Vzc21lbnQgPSB7XG4gICAgICBpc1N0YWJsZTogdHJ1ZSxcbiAgICAgIGJhbmR3aWR0aDogJ2dvb2QnLFxuICAgICAgbGF0ZW5jeTogJ2xvdycsXG4gICAgICByZWxpYWJpbGl0eTogMC45LFxuICAgICAgcmVjb21tZW5kZWRTdHJhdGVneTogJ2ltbWVkaWF0ZSdcbiAgICB9XG4gICAgXG4gICAgaWYgKGNvbm5lY3Rpb24pIHtcbiAgICAgIC8vIOWinuW8uueahOW4puWuveivhOS8sFxuICAgICAgaWYgKGNvbm5lY3Rpb24uZG93bmxpbmspIHtcbiAgICAgICAgaWYgKGNvbm5lY3Rpb24uZG93bmxpbmsgPj0gMjApIHtcbiAgICAgICAgICBhc3Nlc3NtZW50LmJhbmR3aWR0aCA9ICdleGNlbGxlbnQnXG4gICAgICAgICAgYXNzZXNzbWVudC5yZWNvbW1lbmRlZFN0cmF0ZWd5ID0gJ2ltbWVkaWF0ZSdcbiAgICAgICAgfSBlbHNlIGlmIChjb25uZWN0aW9uLmRvd25saW5rID49IDEwKSB7XG4gICAgICAgICAgYXNzZXNzbWVudC5iYW5kd2lkdGggPSAnZ29vZCdcbiAgICAgICAgICBhc3Nlc3NtZW50LnJlY29tbWVuZGVkU3RyYXRlZ3kgPSAnaW1tZWRpYXRlJ1xuICAgICAgICB9IGVsc2UgaWYgKGNvbm5lY3Rpb24uZG93bmxpbmsgPj0gMykge1xuICAgICAgICAgIGFzc2Vzc21lbnQuYmFuZHdpZHRoID0gJ2ZhaXInXG4gICAgICAgICAgYXNzZXNzbWVudC5yZWNvbW1lbmRlZFN0cmF0ZWd5ID0gJ2JhdGNoZWQnXG4gICAgICAgIH0gZWxzZSBpZiAoY29ubmVjdGlvbi5kb3dubGluayA+PSAxKSB7XG4gICAgICAgICAgYXNzZXNzbWVudC5iYW5kd2lkdGggPSAncG9vcidcbiAgICAgICAgICBhc3Nlc3NtZW50LnJlY29tbWVuZGVkU3RyYXRlZ3kgPSAnY29uc2VydmF0aXZlJ1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFzc2Vzc21lbnQuYmFuZHdpZHRoID0gJ3Bvb3InXG4gICAgICAgICAgYXNzZXNzbWVudC5yZWNvbW1lbmRlZFN0cmF0ZWd5ID0gJ3ByaW9yaXRpemVkJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOWinuW8uueahOW7tui/n+ivhOS8sFxuICAgICAgaWYgKGNvbm5lY3Rpb24ucnR0KSB7XG4gICAgICAgIGlmIChjb25uZWN0aW9uLnJ0dCA8PSA1MCkge1xuICAgICAgICAgIGFzc2Vzc21lbnQubGF0ZW5jeSA9ICdsb3cnXG4gICAgICAgIH0gZWxzZSBpZiAoY29ubmVjdGlvbi5ydHQgPD0gMTUwKSB7XG4gICAgICAgICAgYXNzZXNzbWVudC5sYXRlbmN5ID0gJ21lZGl1bSdcbiAgICAgICAgICBhc3Nlc3NtZW50LnJlY29tbWVuZGVkU3RyYXRlZ3kgPSAnYmF0Y2hlZCdcbiAgICAgICAgfSBlbHNlIGlmIChjb25uZWN0aW9uLnJ0dCA8PSA1MDApIHtcbiAgICAgICAgICBhc3Nlc3NtZW50LmxhdGVuY3kgPSAnaGlnaCdcbiAgICAgICAgICBhc3Nlc3NtZW50LnJlY29tbWVuZGVkU3RyYXRlZ3kgPSAnY29uc2VydmF0aXZlJ1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFzc2Vzc21lbnQubGF0ZW5jeSA9ICdoaWdoJ1xuICAgICAgICAgIGFzc2Vzc21lbnQucmVjb21tZW5kZWRTdHJhdGVneSA9ICdwcmlvcml0aXplZCdcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDlop7lvLrnmoTov57mjqXnsbvlnovor4TkvLBcbiAgICAgIGlmIChjb25uZWN0aW9uLnR5cGUgPT09ICdjZWxsdWxhcicpIHtcbiAgICAgICAgYXNzZXNzbWVudC5yZWxpYWJpbGl0eSA9IDAuN1xuICAgICAgICBpZiAoY29ubmVjdGlvbi5lZmZlY3RpdmVUeXBlID09PSAnc2xvdy0yZycgfHwgY29ubmVjdGlvbi5lZmZlY3RpdmVUeXBlID09PSAnMmcnKSB7XG4gICAgICAgICAgYXNzZXNzbWVudC5yZWNvbW1lbmRlZFN0cmF0ZWd5ID0gJ2NvbnNlcnZhdGl2ZSdcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjb25uZWN0aW9uLnR5cGUgPT09ICd3aWZpJykge1xuICAgICAgICBhc3Nlc3NtZW50LnJlbGlhYmlsaXR5ID0gMC45XG4gICAgICB9IGVsc2UgaWYgKGNvbm5lY3Rpb24udHlwZSA9PT0gJ2V0aGVybmV0Jykge1xuICAgICAgICBhc3Nlc3NtZW50LnJlbGlhYmlsaXR5ID0gMC45NVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyDlop7lvLrnmoTov57mjqXnqLPlrprmgKfmtYvor5VcbiAgICBjb25zdCBzdGFiaWxpdHlUZXN0ID0gYXdhaXQgdGhpcy50ZXN0Q29ubmVjdGlvblN0YWJpbGl0eSgpXG4gICAgYXNzZXNzbWVudC5pc1N0YWJsZSA9IHN0YWJpbGl0eVRlc3QuaXNTdGFibGVcbiAgICBhc3Nlc3NtZW50LnJlbGlhYmlsaXR5ICo9IHN0YWJpbGl0eVRlc3Quc3RhYmlsaXR5RmFjdG9yXG4gICAgXG4gICAgLy8g5aaC5p6c6L+e5o6l5LiN56iz5a6a77yM6LCD5pW05o6o6I2Q562W55WlXG4gICAgaWYgKCFhc3Nlc3NtZW50LmlzU3RhYmxlKSB7XG4gICAgICBhc3Nlc3NtZW50LnJlY29tbWVuZGVkU3RyYXRlZ3kgPSAnY29uc2VydmF0aXZlJ1xuICAgIH1cbiAgICBcbiAgICAvLyDln7rkuo7ljoblj7LmlbDmja7osIPmlbTlj6/pnaDmgKdcbiAgICBjb25zdCBoaXN0b3JpY2FsUmVsaWFiaWxpdHkgPSBhd2FpdCB0aGlzLmNhbGN1bGF0ZUhpc3RvcmljYWxSZWxpYWJpbGl0eSgpXG4gICAgYXNzZXNzbWVudC5yZWxpYWJpbGl0eSAqPSBoaXN0b3JpY2FsUmVsaWFiaWxpdHlcbiAgICBcbiAgICByZXR1cm4gYXNzZXNzbWVudFxuICB9XG5cbiAgLyoqXG4gICAqIOa1i+ivlei/nuaOpeeos+WumuaAp1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyB0ZXN0Q29ubmVjdGlvblN0YWJpbGl0eSgpOiBQcm9taXNlPHsgaXNTdGFibGU6IGJvb2xlYW47IHN0YWJpbGl0eUZhY3RvcjogbnVtYmVyIH0+IHtcbiAgICBjb25zdCB0ZXN0VXJscyA9IFtcbiAgICAgICdodHRwczovL3d3dy5nb29nbGUuY29tL2Zhdmljb24uaWNvJyxcbiAgICAgICdodHRwczovL3d3dy5jbG91ZGZsYXJlLmNvbS9mYXZpY29uLmljbydcbiAgICBdXG4gICAgXG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChcbiAgICAgIHRlc3RVcmxzLm1hcCh1cmwgPT4gZmV0Y2godXJsLCB7IG1ldGhvZDogJ0hFQUQnLCBtb2RlOiAnbm8tY29ycycgfSkpXG4gICAgKVxuICAgIFxuICAgIGNvbnN0IHN1Y2Nlc3NmdWxUZXN0cyA9IHJlc3VsdHMuZmlsdGVyKHJlc3VsdCA9PiBcbiAgICAgIHJlc3VsdC5zdGF0dXMgPT09ICdmdWxmaWxsZWQnXG4gICAgKS5sZW5ndGhcbiAgICBcbiAgICBjb25zdCBzdGFiaWxpdHlGYWN0b3IgPSBzdWNjZXNzZnVsVGVzdHMgLyB0ZXN0VXJscy5sZW5ndGhcbiAgICBjb25zdCBpc1N0YWJsZSA9IHN0YWJpbGl0eUZhY3RvciA+PSAwLjhcbiAgICBcbiAgICByZXR1cm4geyBpc1N0YWJsZSwgc3RhYmlsaXR5RmFjdG9yIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDnoa7lrprmjqjojZDnrZbnlaVcbiAgICovXG4gIHByaXZhdGUgZGV0ZXJtaW5lUmVjb21tZW5kZWRTdHJhdGVneShhc3Nlc3NtZW50OiBOZXR3b3JrUXVhbGl0eUFzc2Vzc21lbnQpOiBTeW5jU3RyYXRlZ3lUeXBlIHtcbiAgICBpZiAoYXNzZXNzbWVudC5pc1N0YWJsZSAmJiBhc3Nlc3NtZW50LmJhbmR3aWR0aCA9PT0gJ2V4Y2VsbGVudCcgJiYgYXNzZXNzbWVudC5sYXRlbmN5ID09PSAnbG93Jykge1xuICAgICAgcmV0dXJuICdpbW1lZGlhdGUnXG4gICAgfSBlbHNlIGlmIChhc3Nlc3NtZW50LnJlbGlhYmlsaXR5ID49IDAuOCAmJiBhc3Nlc3NtZW50LmJhbmR3aWR0aCAhPT0gJ3Bvb3InKSB7XG4gICAgICByZXR1cm4gJ2JhdGNoZWQnXG4gICAgfSBlbHNlIGlmIChhc3Nlc3NtZW50LnJlbGlhYmlsaXR5ID49IDAuNikge1xuICAgICAgcmV0dXJuICdwcmlvcml0aXplZCdcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICdjb25zZXJ2YXRpdmUnXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOehruWumuWQjOatpeetlueVpVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBkZXRlcm1pbmVTeW5jU3RyYXRlZ3koXG4gICAgc3RhdHM6IE9mZmxpbmVTdGF0cywgXG4gICAgbmV0d29ya1F1YWxpdHk6IE5ldHdvcmtRdWFsaXR5QXNzZXNzbWVudFxuICApOiBQcm9taXNlPFNtYXJ0U3luY1N0cmF0ZWd5PiB7XG4gICAgY29uc3Qgc3RyYXRlZ3k6IFNtYXJ0U3luY1N0cmF0ZWd5ID0ge1xuICAgICAgc3RyYXRlZ3k6IG5ldHdvcmtRdWFsaXR5LnJlY29tbWVuZGVkU3RyYXRlZ3ksXG4gICAgICBiYXRjaFNpemU6IHRoaXMuY2FsY3VsYXRlT3B0aW1hbEJhdGNoU2l6ZShzdGF0cywgbmV0d29ya1F1YWxpdHkpLFxuICAgICAgZGVsYXlCZXR3ZWVuQmF0Y2hlczogdGhpcy5jYWxjdWxhdGVCYXRjaERlbGF5KG5ldHdvcmtRdWFsaXR5KSxcbiAgICAgIHByaW9yaXR5RmlsdGVyOiB0aGlzLmRldGVybWluZVByaW9yaXR5RmlsdGVyKHN0YXRzLCBuZXR3b3JrUXVhbGl0eSksXG4gICAgICBtYXhDb25jdXJyZW50T3BlcmF0aW9uczogdGhpcy5jYWxjdWxhdGVNYXhDb25jdXJyZW50KG5ldHdvcmtRdWFsaXR5KSxcbiAgICAgIHRpbWVvdXQ6IHRoaXMuY2FsY3VsYXRlT3BlcmF0aW9uVGltZW91dChuZXR3b3JrUXVhbGl0eSksXG4gICAgICByZXRyeVN0cmF0ZWd5OiB0aGlzLmRldGVybWluZVJldHJ5U3RyYXRlZ3kobmV0d29ya1F1YWxpdHkpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBzdHJhdGVneVxuICB9XG5cbiAgLyoqXG4gICAqIOiuoeeul+acgOS8mOaJueWkhOeQhuWkp+Wwj1xuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVPcHRpbWFsQmF0Y2hTaXplKFxuICAgIHN0YXRzOiBPZmZsaW5lU3RhdHMsIFxuICAgIG5ldHdvcmtRdWFsaXR5OiBOZXR3b3JrUXVhbGl0eUFzc2Vzc21lbnRcbiAgKTogbnVtYmVyIHtcbiAgICBsZXQgYmFzZVNpemUgPSAxMFxuICAgIFxuICAgIC8vIOagueaNruW4puWuveiwg+aVtFxuICAgIHN3aXRjaCAobmV0d29ya1F1YWxpdHkuYmFuZHdpZHRoKSB7XG4gICAgICBjYXNlICdleGNlbGxlbnQnOlxuICAgICAgICBiYXNlU2l6ZSA9IDUwXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdnb29kJzpcbiAgICAgICAgYmFzZVNpemUgPSAzMFxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnZmFpcic6XG4gICAgICAgIGJhc2VTaXplID0gMTVcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ3Bvb3InOlxuICAgICAgICBiYXNlU2l6ZSA9IDVcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gICAgXG4gICAgLy8g5qC55o2u5pWw5o2u6YeP6LCD5pW0XG4gICAgaWYgKHN0YXRzLnBlbmRpbmdPcGVyYXRpb25zID4gMTAwKSB7XG4gICAgICBiYXNlU2l6ZSA9IE1hdGgubWluKGJhc2VTaXplLCAyMClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGJhc2VTaXplXG4gIH1cblxuICAvKipcbiAgICog6K6h566X5om55aSE55CG5bu26L+fXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZUJhdGNoRGVsYXkobmV0d29ya1F1YWxpdHk6IE5ldHdvcmtRdWFsaXR5QXNzZXNzbWVudCk6IG51bWJlciB7XG4gICAgc3dpdGNoIChuZXR3b3JrUXVhbGl0eS5iYW5kd2lkdGgpIHtcbiAgICAgIGNhc2UgJ2V4Y2VsbGVudCc6XG4gICAgICAgIHJldHVybiAxMDBcbiAgICAgIGNhc2UgJ2dvb2QnOlxuICAgICAgICByZXR1cm4gMzAwXG4gICAgICBjYXNlICdmYWlyJzpcbiAgICAgICAgcmV0dXJuIDUwMFxuICAgICAgY2FzZSAncG9vcic6XG4gICAgICAgIHJldHVybiAxMDAwXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gNTAwXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOehruWumuS8mOWFiOe6p+i/h+a7pOWZqFxuICAgKi9cbiAgcHJpdmF0ZSBkZXRlcm1pbmVQcmlvcml0eUZpbHRlcihcbiAgICBzdGF0czogT2ZmbGluZVN0YXRzLCBcbiAgICBuZXR3b3JrUXVhbGl0eTogTmV0d29ya1F1YWxpdHlBc3Nlc3NtZW50XG4gICk6ICgnY3JpdGljYWwnIHwgJ2hpZ2gnIHwgJ25vcm1hbCcgfCAnbG93JylbXSB7XG4gICAgaWYgKG5ldHdvcmtRdWFsaXR5LnJlbGlhYmlsaXR5IDwgMC43KSB7XG4gICAgICByZXR1cm4gWydjcml0aWNhbCcsICdoaWdoJ10gLy8g5Y+q5ZCM5q2l6auY5LyY5YWI57qn5pON5L2cXG4gICAgfSBlbHNlIGlmIChzdGF0cy5wZW5kaW5nT3BlcmF0aW9ucyA+IDUwKSB7XG4gICAgICByZXR1cm4gWydjcml0aWNhbCcsICdoaWdoJywgJ25vcm1hbCddIC8vIOaOkumZpOS9juS8mOWFiOe6p1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gWydjcml0aWNhbCcsICdoaWdoJywgJ25vcm1hbCcsICdsb3cnXSAvLyDlhajpg6jlkIzmraVcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6K6h566X5pyA5aSn5bm25Y+R5pON5L2c5pWwXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZU1heENvbmN1cnJlbnQobmV0d29ya1F1YWxpdHk6IE5ldHdvcmtRdWFsaXR5QXNzZXNzbWVudCk6IG51bWJlciB7XG4gICAgc3dpdGNoIChuZXR3b3JrUXVhbGl0eS5sYXRlbmN5KSB7XG4gICAgICBjYXNlICdsb3cnOlxuICAgICAgICByZXR1cm4gbmV0d29ya1F1YWxpdHkuYmFuZHdpZHRoID09PSAnZXhjZWxsZW50JyA/IDUgOiAzXG4gICAgICBjYXNlICdtZWRpdW0nOlxuICAgICAgICByZXR1cm4gMlxuICAgICAgY2FzZSAnaGlnaCc6XG4gICAgICAgIHJldHVybiAxXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gMlxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDorqHnrpfmk43kvZzotoXml7bml7bpl7RcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlT3BlcmF0aW9uVGltZW91dChuZXR3b3JrUXVhbGl0eTogTmV0d29ya1F1YWxpdHlBc3Nlc3NtZW50KTogbnVtYmVyIHtcbiAgICBsZXQgYmFzZVRpbWVvdXQgPSAxMDAwMCAvLyAxMOenkuWfuuehgOi2heaXtlxuICAgIFxuICAgIHN3aXRjaCAobmV0d29ya1F1YWxpdHkubGF0ZW5jeSkge1xuICAgICAgY2FzZSAnaGlnaCc6XG4gICAgICAgIGJhc2VUaW1lb3V0ICo9IDJcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ21lZGl1bSc6XG4gICAgICAgIGJhc2VUaW1lb3V0ICo9IDEuNVxuICAgICAgICBicmVha1xuICAgIH1cbiAgICBcbiAgICBzd2l0Y2ggKG5ldHdvcmtRdWFsaXR5LmJhbmR3aWR0aCkge1xuICAgICAgY2FzZSAncG9vcic6XG4gICAgICAgIGJhc2VUaW1lb3V0ICo9IDEuNVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnZmFpcic6XG4gICAgICAgIGJhc2VUaW1lb3V0ICo9IDEuMlxuICAgICAgICBicmVha1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gYmFzZVRpbWVvdXRcbiAgfVxuXG4gIC8qKlxuICAgKiDnoa7lrprph43or5XnrZbnlaVcbiAgICovXG4gIHByaXZhdGUgZGV0ZXJtaW5lUmV0cnlTdHJhdGVneShuZXR3b3JrUXVhbGl0eTogTmV0d29ya1F1YWxpdHlBc3Nlc3NtZW50KToge1xuICAgIG1heFJldHJpZXM6IG51bWJlclxuICAgIGluaXRpYWxEZWxheTogbnVtYmVyXG4gICAgbWF4RGVsYXk6IG51bWJlclxuICAgIGJhY2tvZmZNdWx0aXBsaWVyOiBudW1iZXJcbiAgfSB7XG4gICAgaWYgKG5ldHdvcmtRdWFsaXR5LmlzU3RhYmxlICYmIG5ldHdvcmtRdWFsaXR5LnJlbGlhYmlsaXR5ID49IDAuOCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWF4UmV0cmllczogMyxcbiAgICAgICAgaW5pdGlhbERlbGF5OiAxMDAwLFxuICAgICAgICBtYXhEZWxheTogNTAwMCxcbiAgICAgICAgYmFja29mZk11bHRpcGxpZXI6IDJcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWF4UmV0cmllczogNSxcbiAgICAgICAgaW5pdGlhbERlbGF5OiAyMDAwLFxuICAgICAgICBtYXhEZWxheTogMTUwMDAsXG4gICAgICAgIGJhY2tvZmZNdWx0aXBsaWVyOiAyLjVcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5omn6KGM5pm66IO95ZCM5q2lXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVTbWFydFN5bmMoXG4gICAgc3RyYXRlZ3k6IFNtYXJ0U3luY1N0cmF0ZWd5LCBcbiAgICBzdGF0czogT2ZmbGluZVN0YXRzXG4gICk6IFByb21pc2U8e1xuICAgIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgICBzeW5jZWRPcGVyYXRpb25zOiBudW1iZXJcbiAgICBjb25mbGljdHM6IENvbmZsaWN0SW5mb1tdXG4gICAgZXJyb3JzOiBzdHJpbmdbXVxuICB9PiB7XG4gICAgY29uc3QgcGVuZGluZ09wcyA9IGF3YWl0IHRoaXMuZ2V0UGVuZGluZ09mZmxpbmVPcGVyYXRpb25zKClcbiAgICBcbiAgICAvLyDov4fmu6TkvJjlhYjnuqdcbiAgICBjb25zdCBmaWx0ZXJlZE9wcyA9IHBlbmRpbmdPcHMuZmlsdGVyKG9wID0+IFxuICAgICAgc3RyYXRlZ3kucHJpb3JpdHlGaWx0ZXIuaW5jbHVkZXMob3AucHJpb3JpdHkpXG4gICAgKVxuICAgIFxuICAgIC8vIOWIhuaJueWkhOeQhlxuICAgIGNvbnN0IGJhdGNoZXMgPSB0aGlzLmNyZWF0ZU9wdGltYWxCYXRjaGVzKGZpbHRlcmVkT3BzLCBzdHJhdGVneS5iYXRjaFNpemUpXG4gICAgXG4gICAgY29uc3QgcmVzdWx0cyA9IHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBzeW5jZWRPcGVyYXRpb25zOiAwLFxuICAgICAgY29uZmxpY3RzOiBbXSBhcyBDb25mbGljdEluZm9bXSxcbiAgICAgIGVycm9yczogW10gYXMgc3RyaW5nW11cbiAgICB9XG4gICAgXG4gICAgLy8g5bm25Y+R5omn6KGM5om55qyhXG4gICAgY29uc3Qgc2VtYXBob3JlID0gbmV3IFNlbWFwaG9yZShzdHJhdGVneS5tYXhDb25jdXJyZW50T3BlcmF0aW9ucylcbiAgICBcbiAgICBjb25zdCBiYXRjaFByb21pc2VzID0gYmF0Y2hlcy5tYXAoYXN5bmMgKGJhdGNoLCBpbmRleCkgPT4ge1xuICAgICAgYXdhaXQgc2VtYXBob3JlLmFjcXVpcmUoKVxuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICAvLyDmibnmrKHpl7Tlu7bov59cbiAgICAgICAgaWYgKGluZGV4ID4gMCkge1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBzdHJhdGVneS5kZWxheUJldHdlZW5CYXRjaGVzKSlcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgYmF0Y2hSZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVCYXRjaFdpdGhSZXRyeShcbiAgICAgICAgICBiYXRjaCwgXG4gICAgICAgICAgc3RyYXRlZ3kucmV0cnlTdHJhdGVneSwgXG4gICAgICAgICAgc3RyYXRlZ3kudGltZW91dFxuICAgICAgICApXG4gICAgICAgIFxuICAgICAgICByZXN1bHRzLnN5bmNlZE9wZXJhdGlvbnMgKz0gYmF0Y2hSZXN1bHQuc3luY2VkQ291bnRcbiAgICAgICAgcmVzdWx0cy5jb25mbGljdHMucHVzaCguLi5iYXRjaFJlc3VsdC5jb25mbGljdHMpXG4gICAgICAgIHJlc3VsdHMuZXJyb3JzLnB1c2goLi4uYmF0Y2hSZXN1bHQuZXJyb3JzKVxuICAgICAgICBcbiAgICAgICAgdGhpcy5ub3RpZnlTeW5jUHJvZ3Jlc3MoXG4gICAgICAgICAgcmVzdWx0cy5zeW5jZWRPcGVyYXRpb25zLCBcbiAgICAgICAgICBmaWx0ZXJlZE9wcy5sZW5ndGhcbiAgICAgICAgKVxuICAgICAgICBcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlc3VsdHMuZXJyb3JzLnB1c2goYEJhdGNoICR7aW5kZXh9IGZhaWxlZDogJHtlcnJvcn1gKVxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgc2VtYXBob3JlLnJlbGVhc2UoKVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoYmF0Y2hQcm9taXNlcylcbiAgICBcbiAgICByZXN1bHRzLnN1Y2Nlc3MgPSByZXN1bHRzLmVycm9ycy5sZW5ndGggPT09IDBcbiAgICByZXR1cm4gcmVzdWx0c1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuacgOS8mOaJueasoVxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVPcHRpbWFsQmF0Y2hlcyhcbiAgICBvcGVyYXRpb25zOiBPZmZsaW5lT3BlcmF0aW9uW10sIFxuICAgIGJhdGNoU2l6ZTogbnVtYmVyXG4gICk6IE9mZmxpbmVPcGVyYXRpb25bXVtdIHtcbiAgICBjb25zdCBiYXRjaGVzOiBPZmZsaW5lT3BlcmF0aW9uW11bXSA9IFtdXG4gICAgXG4gICAgLy8g5oyJ5LyY5YWI57qn5o6S5bqPXG4gICAgY29uc3QgcHJpb3JpdHlPcmRlciA9IHsgY3JpdGljYWw6IDQsIGhpZ2g6IDMsIG5vcm1hbDogMiwgbG93OiAxIH1cbiAgICBjb25zdCBzb3J0ZWRPcHMgPSBbLi4ub3BlcmF0aW9uc10uc29ydCgoYSwgYikgPT4gXG4gICAgICBwcmlvcml0eU9yZGVyW2IucHJpb3JpdHldIC0gcHJpb3JpdHlPcmRlclthLnByaW9yaXR5XVxuICAgIClcbiAgICBcbiAgICAvLyDliIbmiblcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvcnRlZE9wcy5sZW5ndGg7IGkgKz0gYmF0Y2hTaXplKSB7XG4gICAgICBiYXRjaGVzLnB1c2goc29ydGVkT3BzLnNsaWNlKGksIGkgKyBiYXRjaFNpemUpKVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gYmF0Y2hlc1xuICB9XG5cbiAgLyoqXG4gICAqIOaJp+ihjOaJueasoemHjeivlVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBleGVjdXRlQmF0Y2hXaXRoUmV0cnkoXG4gICAgYmF0Y2g6IE9mZmxpbmVPcGVyYXRpb25bXSxcbiAgICByZXRyeVN0cmF0ZWd5OiB7IG1heFJldHJpZXM6IG51bWJlcjsgaW5pdGlhbERlbGF5OiBudW1iZXI7IG1heERlbGF5OiBudW1iZXI7IGJhY2tvZmZNdWx0aXBsaWVyOiBudW1iZXIgfSxcbiAgICB0aW1lb3V0OiBudW1iZXJcbiAgKTogUHJvbWlzZTx7XG4gICAgc3luY2VkQ291bnQ6IG51bWJlclxuICAgIGNvbmZsaWN0czogQ29uZmxpY3RJbmZvW11cbiAgICBlcnJvcnM6IHN0cmluZ1tdXG4gIH0+IHtcbiAgICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsXG4gICAgXG4gICAgZm9yIChsZXQgYXR0ZW1wdCA9IDE7IGF0dGVtcHQgPD0gcmV0cnlTdHJhdGVneS5tYXhSZXRyaWVzOyBhdHRlbXB0KyspIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZUJhdGNoV2l0aFRpbWVvdXQoYmF0Y2gsIHRpbWVvdXQpXG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxhc3RFcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKVxuICAgICAgICBcbiAgICAgICAgaWYgKGF0dGVtcHQgPT09IHJldHJ5U3RyYXRlZ3kubWF4UmV0cmllcykge1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIOiuoeeul+W7tui/n+aXtumXtFxuICAgICAgICBjb25zdCBkZWxheSA9IE1hdGgubWluKFxuICAgICAgICAgIHJldHJ5U3RyYXRlZ3kuaW5pdGlhbERlbGF5ICogTWF0aC5wb3cocmV0cnlTdHJhdGVneS5iYWNrb2ZmTXVsdGlwbGllciwgYXR0ZW1wdCAtIDEpLFxuICAgICAgICAgIHJldHJ5U3RyYXRlZ3kubWF4RGVsYXlcbiAgICAgICAgKVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYFJldHJ5ICR7YXR0ZW1wdH0vJHtyZXRyeVN0cmF0ZWd5Lm1heFJldHJpZXN9IGFmdGVyICR7ZGVsYXl9bXNgKVxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgc3luY2VkQ291bnQ6IDAsXG4gICAgICBjb25mbGljdHM6IFtdLFxuICAgICAgZXJyb3JzOiBbbGFzdEVycm9yPy5tZXNzYWdlIHx8ICdCYXRjaCBleGVjdXRpb24gZmFpbGVkIGFmdGVyIGFsbCByZXRyaWVzJ11cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5bim6LaF5pe255qE5om55qyh5omn6KGMXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVCYXRjaFdpdGhUaW1lb3V0KFxuICAgIGJhdGNoOiBPZmZsaW5lT3BlcmF0aW9uW10sXG4gICAgdGltZW91dDogbnVtYmVyXG4gICk6IFByb21pc2U8e1xuICAgIHN5bmNlZENvdW50OiBudW1iZXJcbiAgICBjb25mbGljdHM6IENvbmZsaWN0SW5mb1tdXG4gICAgZXJyb3JzOiBzdHJpbmdbXVxuICB9PiB7XG4gICAgY29uc3QgdGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZSgoXywgcmVqZWN0KSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoJ09wZXJhdGlvbiB0aW1lb3V0JykpLCB0aW1lb3V0KVxuICAgIH0pXG4gICAgXG4gICAgY29uc3QgZXhlY3V0aW9uUHJvbWlzZSA9IHRoaXMuZXhlY3V0ZUJhdGNoT3BlcmF0aW9ucyhiYXRjaClcbiAgICBcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmFjZShbZXhlY3V0aW9uUHJvbWlzZSwgdGltZW91dFByb21pc2VdKSBhcyBhbnlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZSA9PT0gJ09wZXJhdGlvbiB0aW1lb3V0Jykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEJhdGNoIG9wZXJhdGlvbiB0aW1lZCBvdXQgYWZ0ZXIgJHt0aW1lb3V0fW1zYClcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaJp+ihjOaJueasoeaTjeS9nFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBleGVjdXRlQmF0Y2hPcGVyYXRpb25zKFxuICAgIGJhdGNoOiBPZmZsaW5lT3BlcmF0aW9uW11cbiAgKTogUHJvbWlzZTx7XG4gICAgc3luY2VkQ291bnQ6IG51bWJlclxuICAgIGNvbmZsaWN0czogQ29uZmxpY3RJbmZvW11cbiAgICBlcnJvcnM6IHN0cmluZ1tdXG4gIH0+IHtcbiAgICBsZXQgc3luY2VkQ291bnQgPSAwXG4gICAgY29uc3QgY29uZmxpY3RzOiBDb25mbGljdEluZm9bXSA9IFtdXG4gICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdXG4gICAgXG4gICAgZm9yIChjb25zdCBvcGVyYXRpb24gb2YgYmF0Y2gpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuc3luY09wZXJhdGlvbihvcGVyYXRpb24pXG4gICAgICAgIFxuICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICBzeW5jZWRDb3VudCsrXG4gICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LmNvbmZsaWN0KSB7XG4gICAgICAgICAgY29uZmxpY3RzLnB1c2gocmVzdWx0LmNvbmZsaWN0KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVycm9ycy5wdXNoKHJlc3VsdC5lcnJvciB8fCBgT3BlcmF0aW9uICR7b3BlcmF0aW9uLmlkfSBmYWlsZWRgKVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBlcnJvcnMucHVzaChgT3BlcmF0aW9uICR7b3BlcmF0aW9uLmlkfSBlcnJvcjogJHtlcnJvcn1gKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyBzeW5jZWRDb3VudCwgY29uZmxpY3RzLCBlcnJvcnMgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaJp+ihjOWQjuWQjOatpeS8mOWMllxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBwZXJmb3JtUG9zdFN5bmNPcHRpbWl6YXRpb25zKFxuICAgIHN5bmNSZXN1bHQ6IGFueSxcbiAgICBuZXR3b3JrUXVhbGl0eTogTmV0d29ya1F1YWxpdHlBc3Nlc3NtZW50XG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIOWmguaenOWQjOatpeWujOWFqOaIkOWKn++8jOa4heeQhuaXp+eKtuaAgVxuICAgIGlmIChzeW5jUmVzdWx0LnN1Y2Nlc3MgJiYgc3luY1Jlc3VsdC5lcnJvcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICBhd2FpdCB0aGlzLmNsZWFudXBPbGRTeW5jU3RhdGUoKVxuICAgIH1cbiAgICBcbiAgICAvLyDlpoLmnpznvZHnu5zotKjph4/lpb3vvIzpooTliqDovb3lj6/og73pnIDopoHnmoTov5znqIvmlbDmja5cbiAgICBpZiAobmV0d29ya1F1YWxpdHkuYmFuZHdpZHRoID09PSAnZXhjZWxsZW50JyAmJiBuZXR3b3JrUXVhbGl0eS5pc1N0YWJsZSkge1xuICAgICAgYXdhaXQgdGhpcy5wcmVsb2FkUmVtb3RlRGF0YSgpXG4gICAgfVxuICAgIFxuICAgIC8vIOabtOaWsOe9kee7nOeKtuaAgeWOhuWPsuiusOW9lVxuICAgIGF3YWl0IHRoaXMudXBkYXRlTmV0d29ya0hpc3RvcnkobmV0d29ya1F1YWxpdHkpXG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5ZCM5q2l6ZSZ6K+vXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZVN5bmNFcnJvcihlcnJvcjogYW55LCBzdGF0czogT2ZmbGluZVN0YXRzKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5lcnJvcignU3luYyBlcnJvciBvY2N1cnJlZCwgYXR0ZW1wdGluZyByZWNvdmVyeS4uLicsIGVycm9yKVxuICAgIFxuICAgIC8vIOagueaNrumUmeivr+exu+Wei+WItuWumuaBouWkjeetlueVpVxuICAgIGlmIChlcnJvci5tZXNzYWdlPy5pbmNsdWRlcygndGltZW91dCcpKSB7XG4gICAgICAvLyDotoXml7bplJnor6/vvJrpmY3kvY7lkIzmraXlvLrluqZcbiAgICAgIGF3YWl0IHRoaXMuc2NoZWR1bGVSZWR1Y2VkU3luYygpXG4gICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlPy5pbmNsdWRlcygnbmV0d29yaycpKSB7XG4gICAgICAvLyDnvZHnu5zplJnor6/vvJrnrYnlvoXnvZHnu5znqLPlrppcbiAgICAgIGF3YWl0IHRoaXMuc2NoZWR1bGVEZWxheWVkU3luYygpXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOWFtuS7lumUmeivr++8muiusOW9leW5tumHjeivlVxuICAgICAgYXdhaXQgdGhpcy5zY2hlZHVsZVJldHJ5U3luYygpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiwg+W6pumZjee6p+WQjOatpVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzY2hlZHVsZVJlZHVjZWRTeW5jKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCB0aGlzLmdldE9mZmxpbmVTdGF0cygpXG4gICAgICBpZiAoc3RhdHMucGVuZGluZ09wZXJhdGlvbnMgPiAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdFeGVjdXRpbmcgcmVkdWNlZCBzeW5jLi4uJylcbiAgICAgICAgLy8g5Y+q5ZCM5q2l5YWz6ZSu5pON5L2cXG4gICAgICAgIGF3YWl0IHRoaXMuc3luY0NyaXRpY2FsT3BlcmF0aW9uc09ubHkoKVxuICAgICAgfVxuICAgIH0sIDUwMDApIC8vIDXnp5LlkI7ph43or5VcbiAgfVxuXG4gIC8qKlxuICAgKiDosIPluqblu7bov5/lkIzmraVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc2NoZWR1bGVEZWxheWVkU3luYygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgdGhpcy5nZXRPZmZsaW5lU3RhdHMoKVxuICAgICAgaWYgKHN0YXRzLnBlbmRpbmdPcGVyYXRpb25zID4gMCkge1xuICAgICAgICBjb25zb2xlLmxvZygnRXhlY3V0aW5nIGRlbGF5ZWQgc3luYy4uLicpXG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlTmV0d29ya1JlY292ZXJ5KClcbiAgICAgIH1cbiAgICB9LCAzMDAwMCkgLy8gMzDnp5LlkI7ph43or5VcbiAgfVxuXG4gIC8qKlxuICAgKiDosIPluqbph43or5XlkIzmraVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc2NoZWR1bGVSZXRyeVN5bmMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHRoaXMuZ2V0T2ZmbGluZVN0YXRzKClcbiAgICAgIGlmIChzdGF0cy5wZW5kaW5nT3BlcmF0aW9ucyA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1JldHJ5aW5nIHN5bmMuLi4nKVxuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZU5ldHdvcmtSZWNvdmVyeSgpXG4gICAgICB9XG4gICAgfSwgMTAwMDApIC8vIDEw56eS5ZCO6YeN6K+VXG4gIH1cblxuICAvKipcbiAgICog5LuF5ZCM5q2l5YWz6ZSu5pON5L2cXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHN5bmNDcml0aWNhbE9wZXJhdGlvbnNPbmx5KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBlbmRpbmdPcHMgPSBhd2FpdCB0aGlzLmdldFBlbmRpbmdPZmZsaW5lT3BlcmF0aW9ucygpXG4gICAgY29uc3QgY3JpdGljYWxPcHMgPSBwZW5kaW5nT3BzLmZpbHRlcihvcCA9PiBvcC5wcmlvcml0eSA9PT0gJ2NyaXRpY2FsJylcbiAgICBcbiAgICBpZiAoY3JpdGljYWxPcHMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlQmF0Y2hPcGVyYXRpb25zKGNyaXRpY2FsT3BzKVxuICAgICAgY29uc29sZS5sb2coYENyaXRpY2FsIHN5bmMgY29tcGxldGVkOiAke3Jlc3VsdC5zeW5jZWRDb3VudH0vJHtjcml0aWNhbE9wcy5sZW5ndGh9YClcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5riF55CG5pen5ZCM5q2l54q25oCBXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNsZWFudXBPbGRTeW5jU3RhdGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIOa4heeQhui/h+acn+eahOWkh+S7vVxuICAgICAgY29uc3QgYmFja3VwS2V5cyA9IE9iamVjdC5rZXlzKGxvY2FsU3RvcmFnZSlcbiAgICAgICAgLmZpbHRlcihrZXkgPT4ga2V5LnN0YXJ0c1dpdGgoJ29mZmxpbmVCYWNrdXBfJykpXG4gICAgICAgIC5zb3J0KClcbiAgICAgIFxuICAgICAgLy8g5L+d55WZ5pyA6L+RM+S4quWkh+S7vVxuICAgICAgaWYgKGJhY2t1cEtleXMubGVuZ3RoID4gMykge1xuICAgICAgICBjb25zdCB0b0RlbGV0ZSA9IGJhY2t1cEtleXMuc2xpY2UoMCwgYmFja3VwS2V5cy5sZW5ndGggLSAzKVxuICAgICAgICB0b0RlbGV0ZS5mb3JFYWNoKGtleSA9PiBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDmuIXnkIYgSW5kZXhlZERCIOS4reeahOaXp+eKtuaAgeiusOW9lVxuICAgICAgaWYgKGRiLm9mZmxpbmVTdGF0ZSkge1xuICAgICAgICBjb25zdCBvbGRTdGF0ZXMgPSBhd2FpdCBkYi5vZmZsaW5lU3RhdGVcbiAgICAgICAgICAub3JkZXJCeSgndGltZXN0YW1wJylcbiAgICAgICAgICAucmV2ZXJzZSgpXG4gICAgICAgICAgLm9mZnNldCg1KSAvLyDkv53nlZnmnIDov5E15Liq54q25oCBXG4gICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBzdGF0ZSBvZiBvbGRTdGF0ZXMpIHtcbiAgICAgICAgICBhd2FpdCBkYi5vZmZsaW5lU3RhdGUuZGVsZXRlKHN0YXRlLmlkKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY2xlYW51cCBvbGQgc3luYyBzdGF0ZTonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6aKE5Yqg6L296L+c56iL5pWw5o2uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHByZWxvYWRSZW1vdGVEYXRhKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDov5nph4zlj6/ku6Xlrp7njrDpooTliqDovb3pgLvovpFcbiAgICAgIC8vIOS+i+Wmgu+8mumihOWKoOi9veeUqOaIt+WPr+iDveiuv+mXrueahOWNoeeJh+aVsOaNrlxuICAgICAgY29uc29sZS5sb2coJ1ByZWxvYWRpbmcgcmVtb3RlIGRhdGEuLi4nKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBwcmVsb2FkIHJlbW90ZSBkYXRhOicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDnvZHnu5zljoblj7LorrDlvZVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgdXBkYXRlTmV0d29ya0hpc3RvcnkobmV0d29ya1F1YWxpdHk6IE5ldHdvcmtRdWFsaXR5QXNzZXNzbWVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIOabtOaWsOe9kee7nOi0qOmHj+WOhuWPsu+8jOeUqOS6juacquadpeeahOmihOa1i+WSjOS8mOWMllxuICAgIHRyeSB7XG4gICAgICBjb25zdCBoaXN0b3J5S2V5ID0gJ25ldHdvcmtRdWFsaXR5SGlzdG9yeSdcbiAgICAgIGNvbnN0IGhpc3RvcnkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGhpc3RvcnlLZXkpIHx8ICdbXScpXG4gICAgICBcbiAgICAgIGhpc3RvcnkucHVzaCh7XG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAuLi5uZXR3b3JrUXVhbGl0eVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgLy8g5L+d55WZ5pyA6L+RMTAw5p2h6K6w5b2VXG4gICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPiAxMDApIHtcbiAgICAgICAgaGlzdG9yeS5zcGxpY2UoMCwgaGlzdG9yeS5sZW5ndGggLSAxMDApXG4gICAgICB9XG4gICAgICBcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGhpc3RvcnlLZXksIEpTT04uc3RyaW5naWZ5KGhpc3RvcnkpKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byB1cGRhdGUgbmV0d29yayBoaXN0b3J5OicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmiafooYznprvnur/lkIzmraVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcGVyZm9ybU9mZmxpbmVTeW5jKCk6IFByb21pc2U8e1xuICAgIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgICBzeW5jZWRPcGVyYXRpb25zOiBudW1iZXJcbiAgICBjb25mbGljdHM6IENvbmZsaWN0SW5mb1tdXG4gICAgZXJyb3JzOiBzdHJpbmdbXVxuICB9PiB7XG4gICAgY29uc3QgcGVuZGluZ09wcyA9IGF3YWl0IHRoaXMuZ2V0UGVuZGluZ09mZmxpbmVPcGVyYXRpb25zKClcbiAgICBjb25zdCBzeW5jZWRPcGVyYXRpb25zOiBzdHJpbmdbXSA9IFtdXG4gICAgY29uc3QgY29uZmxpY3RzOiBDb25mbGljdEluZm9bXSA9IFtdXG4gICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdXG4gICAgXG4gICAgLy8g5oyJ5LyY5YWI57qn5YiG57uE5aSE55CGXG4gICAgY29uc3QgY3JpdGljYWxPcHMgPSBwZW5kaW5nT3BzLmZpbHRlcihvcCA9PiBvcC5wcmlvcml0eSA9PT0gJ2NyaXRpY2FsJylcbiAgICBjb25zdCBoaWdoT3BzID0gcGVuZGluZ09wcy5maWx0ZXIob3AgPT4gb3AucHJpb3JpdHkgPT09ICdoaWdoJylcbiAgICBjb25zdCBub3JtYWxPcHMgPSBwZW5kaW5nT3BzLmZpbHRlcihvcCA9PiBvcC5wcmlvcml0eSA9PT0gJ25vcm1hbCcpXG4gICAgY29uc3QgbG93T3BzID0gcGVuZGluZ09wcy5maWx0ZXIob3AgPT4gb3AucHJpb3JpdHkgPT09ICdsb3cnKVxuICAgIFxuICAgIGNvbnN0IGFsbE9wcyA9IFsuLi5jcml0aWNhbE9wcywgLi4uaGlnaE9wcywgLi4ubm9ybWFsT3BzLCAuLi5sb3dPcHNdXG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxPcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IG9wZXJhdGlvbiA9IGFsbE9wc1tpXVxuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICAvLyDmo4Dmn6XnvZHnu5zov57mjqVcbiAgICAgICAgaWYgKCFuYXZpZ2F0b3Iub25MaW5lKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOZXR3b3JrIGxvc3QgZHVyaW5nIHN5bmMnKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyDmiafooYzlkIzmraVcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5zeW5jT3BlcmF0aW9uKG9wZXJhdGlvbilcbiAgICAgICAgXG4gICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgIHN5bmNlZE9wZXJhdGlvbnMucHVzaChvcGVyYXRpb24uaWQpXG4gICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LmNvbmZsaWN0KSB7XG4gICAgICAgICAgY29uZmxpY3RzLnB1c2gocmVzdWx0LmNvbmZsaWN0KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVycm9ycy5wdXNoKHJlc3VsdC5lcnJvciB8fCBgU3luYyBmYWlsZWQgZm9yIG9wZXJhdGlvbiAke29wZXJhdGlvbi5pZH1gKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyDpgJrnn6Xov5vluqZcbiAgICAgICAgdGhpcy5ub3RpZnlTeW5jUHJvZ3Jlc3MoaSArIDEsIGFsbE9wcy5sZW5ndGgpXG4gICAgICAgIFxuICAgICAgICAvLyDlsI/lu7bov5/pgb/lhY3nvZHnu5zov4fovb1cbiAgICAgICAgaWYgKGkgJSAxMCA9PT0gMCkge1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zdCBlcnJvck1zZyA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKVxuICAgICAgICBlcnJvcnMucHVzaChgT3BlcmF0aW9uICR7b3BlcmF0aW9uLmlkfSBmYWlsZWQ6ICR7ZXJyb3JNc2d9YClcbiAgICAgICAgXG4gICAgICAgIC8vIOWmguaenOaYr+e9kee7nOmUmeivr++8jOaaguWBnOWQjOatpVxuICAgICAgICBpZiAoZXJyb3JNc2cuaW5jbHVkZXMoJ25ldHdvcmsnKSB8fCBlcnJvck1zZy5pbmNsdWRlcygnTmV0d29yaycpKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdOZXR3b3JrIGVycm9yIGR1cmluZyBzeW5jLCBwYXVzaW5nLi4uJylcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgc3luY2VkT3BlcmF0aW9uczogc3luY2VkT3BlcmF0aW9ucy5sZW5ndGgsXG4gICAgICBjb25mbGljdHMsXG4gICAgICBlcnJvcnNcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOWGsueqgeajgOa1i+WSjOino+WGs1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLyoqXG4gICAqIOajgOa1i+aVsOaNruWGsueqgVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBkZXRlY3RDb25mbGljdHMoXG4gICAgbG9jYWxPcGVyYXRpb246IE9mZmxpbmVPcGVyYXRpb24sXG4gICAgcmVtb3RlRGF0YT86IGFueVxuICApOiBQcm9taXNlPENvbmZsaWN0SW5mbyB8IG51bGw+IHtcbiAgICBpZiAoIXJlbW90ZURhdGEpIHJldHVybiBudWxsXG4gICAgXG4gICAgLy8g6I635Y+W5pys5Zyw5pWw5o2uXG4gICAgY29uc3QgbG9jYWxEYXRhID0gYXdhaXQgdGhpcy5nZXRMb2NhbERhdGFGb3JFbnRpdHkobG9jYWxPcGVyYXRpb24uZW50aXR5LCBsb2NhbE9wZXJhdGlvbi5lbnRpdHlJZClcbiAgICBpZiAoIWxvY2FsRGF0YSkgcmV0dXJuIG51bGxcbiAgICBcbiAgICAvLyDmr5TovoPml7bpl7TmiLPlkozmlbDmja7niYjmnKxcbiAgICBjb25zdCBsb2NhbFRpbWVzdGFtcCA9IG5ldyBEYXRlKGxvY2FsT3BlcmF0aW9uLnRpbWVzdGFtcClcbiAgICBjb25zdCByZW1vdGVUaW1lc3RhbXAgPSBuZXcgRGF0ZShyZW1vdGVEYXRhLnVwZGF0ZWRBdCB8fCByZW1vdGVEYXRhLmNyZWF0ZWRBdClcbiAgICBcbiAgICAvLyDlpoLmnpzmnKzlnLDmk43kvZzml7bpl7TmmZrkuo7ov5znqIvmlbDmja7ml7bpl7TvvIzorqTkuLrmmK/lhrLnqoFcbiAgICBpZiAobG9jYWxUaW1lc3RhbXAgPiByZW1vdGVUaW1lc3RhbXApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgICAgICBlbnRpdHlUeXBlOiBsb2NhbE9wZXJhdGlvbi5lbnRpdHksXG4gICAgICAgIGVudGl0eUlkOiBsb2NhbE9wZXJhdGlvbi5lbnRpdHlJZCB8fCAnJyxcbiAgICAgICAgbG9jYWxEYXRhLFxuICAgICAgICByZW1vdGVEYXRhLFxuICAgICAgICBjb25mbGljdFR5cGU6IHRoaXMuZGV0ZXJtaW5lQ29uZmxpY3RUeXBlKGxvY2FsT3BlcmF0aW9uLCBsb2NhbERhdGEsIHJlbW90ZURhdGEpLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHJlc29sdXRpb246ICdwZW5kaW5nJ1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuajgOa1i+WIsOeahOWGsueqgVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVDb25mbGljdHMoY29uZmxpY3RzOiBDb25mbGljdEluZm9bXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGZvciAoY29uc3QgY29uZmxpY3Qgb2YgY29uZmxpY3RzKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyDmoLnmja7lhrLnqoHnsbvlnovlsJ3or5Xoh6rliqjop6PlhrNcbiAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IGF3YWl0IHRoaXMucmVzb2x2ZUNvbmZsaWN0KGNvbmZsaWN0KVxuICAgICAgICBcbiAgICAgICAgaWYgKHJlc29sdXRpb24gPT09ICdtYW51YWwnKSB7XG4gICAgICAgICAgLy8g6ZyA6KaB55So5oi35omL5Yqo6Kej5Yaz55qE5Yay56qBXG4gICAgICAgICAgdGhpcy5jb25mbGljdHMucHVzaChjb25mbGljdClcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAodGhpcy5saXN0ZW5lcnMub25Db25mbGljdCkge1xuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnMub25Db25mbGljdChjb25mbGljdClcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8g5bqU55So6Ieq5Yqo6Kej5Yaz55qE5Yay56qBXG4gICAgICAgICAgYXdhaXQgdGhpcy5hcHBseUNvbmZsaWN0UmVzb2x1dGlvbihjb25mbGljdCwgcmVzb2x1dGlvbilcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIHJlc29sdmUgY29uZmxpY3QgJHtjb25mbGljdC5pZH06YCwgZXJyb3IpXG4gICAgICAgIGNvbmZsaWN0LnJlc29sdXRpb24gPSAnbWFudWFsJ1xuICAgICAgICB0aGlzLmNvbmZsaWN0cy5wdXNoKGNvbmZsaWN0KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDop6PlhrPlhrLnqoFcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVzb2x2ZUNvbmZsaWN0KGNvbmZsaWN0OiBDb25mbGljdEluZm8pOiBQcm9taXNlPCdsb2NhbCcgfCAncmVtb3RlJyB8ICdtZXJnZScgfCAnbWFudWFsJz4ge1xuICAgIHN3aXRjaCAoY29uZmxpY3QuY29uZmxpY3RUeXBlKSB7XG4gICAgICBjYXNlICdzaW11bHRhbmVvdXNfZWRpdCc6XG4gICAgICAgIC8vIOWwneivleaZuuiDveWQiOW5tlxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5hdHRlbXB0U21hcnRNZXJnZShjb25mbGljdClcbiAgICAgICAgXG4gICAgICBjYXNlICdkZWxldGVfY29uZmxpY3QnOlxuICAgICAgICAvLyDliKDpmaTlhrLnqoHpgJrluLjpnIDopoHmiYvliqjop6PlhrNcbiAgICAgICAgcmV0dXJuICdtYW51YWwnXG4gICAgICAgIFxuICAgICAgY2FzZSAnc3RydWN0dXJlX2NvbmZsaWN0JzpcbiAgICAgICAgLy8g57uT5p6E5Yay56qB5bCd6K+V5pys5Zyw5LyY5YWIXG4gICAgICAgIHJldHVybiAnbG9jYWwnXG4gICAgICAgIFxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuICdtYW51YWwnXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWwneivleaZuuiDveWQiOW5tlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhdHRlbXB0U21hcnRNZXJnZShjb25mbGljdDogQ29uZmxpY3RJbmZvKTogUHJvbWlzZTwnbG9jYWwnIHwgJ3JlbW90ZScgfCAnbWVyZ2UnIHwgJ21hbnVhbCc+IHtcbiAgICAvLyDnroDljJbnmoTlkIjlubbnrZbnlaXvvIzlrp7pmYXpobnnm67kuK3pnIDopoHmm7TlpI3mnYLnmoTpgLvovpFcbiAgICBjb25zdCBsb2NhbENvbnRlbnQgPSB0aGlzLmV4dHJhY3RDb250ZW50Rm9yTWVyZ2UoY29uZmxpY3QubG9jYWxEYXRhKVxuICAgIGNvbnN0IHJlbW90ZUNvbnRlbnQgPSB0aGlzLmV4dHJhY3RDb250ZW50Rm9yTWVyZ2UoY29uZmxpY3QucmVtb3RlRGF0YSlcbiAgICBcbiAgICAvLyDlpoLmnpzlhoXlrrnnm7jkvLzvvIzkvb/nlKjovoPmlrDnmoTniYjmnKxcbiAgICBpZiAodGhpcy5jYWxjdWxhdGVDb250ZW50U2ltaWxhcml0eShsb2NhbENvbnRlbnQsIHJlbW90ZUNvbnRlbnQpID4gMC44KSB7XG4gICAgICBjb25zdCBsb2NhbFRpbWVzdGFtcCA9IG5ldyBEYXRlKGNvbmZsaWN0LmxvY2FsRGF0YS51cGRhdGVkQXQgfHwgY29uZmxpY3QubG9jYWxEYXRhLmNyZWF0ZWRBdClcbiAgICAgIGNvbnN0IHJlbW90ZVRpbWVzdGFtcCA9IG5ldyBEYXRlKGNvbmZsaWN0LnJlbW90ZURhdGEudXBkYXRlZEF0IHx8IGNvbmZsaWN0LnJlbW90ZURhdGEuY3JlYXRlZEF0KVxuICAgICAgXG4gICAgICByZXR1cm4gbG9jYWxUaW1lc3RhbXAgPiByZW1vdGVUaW1lc3RhbXAgPyAnbG9jYWwnIDogJ3JlbW90ZSdcbiAgICB9XG4gICAgXG4gICAgLy8g5aaC5p6c5YaF5a655beu5byC5b6I5aSn77yM6ZyA6KaB5omL5Yqo5ZCI5bm2XG4gICAgcmV0dXJuICdtYW51YWwnXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOS6i+S7tuebkeWQrOWZqOeuoeeQhlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMobGlzdGVuZXJzOiB0eXBlb2YgT2ZmbGluZU1hbmFnZXIucHJvdG90eXBlLmxpc3RlbmVycyk6IHZvaWQge1xuICAgIHRoaXMubGlzdGVuZXJzID0geyAuLi50aGlzLmxpc3RlbmVycywgLi4ubGlzdGVuZXJzIH1cbiAgfVxuXG4gIHByaXZhdGUgbm90aWZ5TmV0d29ya0NoYW5nZShpbmZvOiBOZXR3b3JrSW5mbyk6IHZvaWQge1xuICAgIGlmICh0aGlzLmxpc3RlbmVycy5vbk5ldHdvcmtDaGFuZ2UpIHtcbiAgICAgIHRoaXMubGlzdGVuZXJzLm9uTmV0d29ya0NoYW5nZShpbmZvKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgbm90aWZ5U3luY1Byb2dyZXNzKGNvbXBsZXRlZDogbnVtYmVyLCB0b3RhbDogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKHRoaXMubGlzdGVuZXJzLm9uU3luY1Byb2dyZXNzKSB7XG4gICAgICB0aGlzLmxpc3RlbmVycy5vblN5bmNQcm9ncmVzcyh7IGNvbXBsZXRlZCwgdG90YWwgfSlcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIG5vdGlmeVN5bmNDb21wbGV0ZShzdGF0czogT2ZmbGluZVN0YXRzKTogdm9pZCB7XG4gICAgaWYgKHRoaXMubGlzdGVuZXJzLm9uU3luY0NvbXBsZXRlKSB7XG4gICAgICB0aGlzLmxpc3RlbmVycy5vblN5bmNDb21wbGV0ZShzdGF0cylcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOWIneWni+WMluWSjOa4heeQhlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplT2ZmbGluZU1hbmFnZXIoKTogdm9pZCB7XG4gICAgdGhpcy5zZXR1cE5ldHdvcmtMaXN0ZW5lcnMoKVxuICAgIHRoaXMuc2V0dXBDb25uZWN0aW9uTW9uaXRvcmluZygpXG4gICAgdGhpcy5sb2FkT2ZmbGluZVN0YXRlKClcbiAgICB0aGlzLnN0YXJ0UGVyaW9kaWNTeW5jKClcbiAgfVxuXG4gIHByaXZhdGUgc2V0dXBOZXR3b3JrTGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIC8vIOebkeWQrOe9kee7nOeKtuaAgeWPmOWMllxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvbmxpbmUnLCAoKSA9PiB7XG4gICAgICB0aGlzLmhhbmRsZU5ldHdvcmtDaGFuZ2UodHJ1ZSlcbiAgICB9KVxuICAgIFxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvZmZsaW5lJywgKCkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVOZXR3b3JrQ2hhbmdlKGZhbHNlKVxuICAgIH0pXG4gIH1cblxuICBwcml2YXRlIHNldHVwQ29ubmVjdGlvbk1vbml0b3JpbmcoKTogdm9pZCB7XG4gICAgLy8g55uR5o6n6L+e5o6l6LSo6YeP77yI5aaC5p6c5pSv5oyB77yJXG4gICAgaWYgKCdjb25uZWN0aW9uJyBpbiBuYXZpZ2F0b3IpIHtcbiAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSAobmF2aWdhdG9yIGFzIGFueSkuY29ubmVjdGlvblxuICAgICAgXG4gICAgICBjb25uZWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgdGhpcy51cGRhdGVDb25uZWN0aW9uSW5mbyhjb25uZWN0aW9uKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgdGhpcy51cGRhdGVDb25uZWN0aW9uSW5mbyhjb25uZWN0aW9uKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc3RhcnRQZXJpb2RpY1N5bmMoKTogdm9pZCB7XG4gICAgLy8g5a6a5pyf5qOA5p+l5ZCM5q2l54q25oCBXG4gICAgdGhpcy5zeW5jVGltZXIgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgICBpZiAobmF2aWdhdG9yLm9uTGluZSkge1xuICAgICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHRoaXMuZ2V0T2ZmbGluZVN0YXRzKClcbiAgICAgICAgaWYgKHN0YXRzLnBlbmRpbmdPcGVyYXRpb25zID4gMCkge1xuICAgICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlTmV0d29ya1JlY292ZXJ5KClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIDMwICogMTAwMCkgLy8g5q+PMzDnp5Lmo4Dmn6XkuIDmrKFcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbnprvnur/nrqHnkIblmahcbiAgICovXG4gIGNsZWFudXAoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuc3luY1RpbWVyKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuc3luY1RpbWVyKVxuICAgIH1cbiAgICBcbiAgICAvLyDnp7vpmaTkuovku7bnm5HlkKzlmahcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignb25saW5lJywgdGhpcy5oYW5kbGVOZXR3b3JrQ2hhbmdlKVxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdvZmZsaW5lJywgdGhpcy5oYW5kbGVOZXR3b3JrQ2hhbmdlKVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDnp4HmnInovoXliqnmlrnms5VcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlTmV0d29ya0NoYW5nZShpc09ubGluZTogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHByZXZpb3VzU3RhdHVzID0gdGhpcy5uZXR3b3JrSW5mby5zdGF0dXNcbiAgICBjb25zdCBuZXdTdGF0dXMgPSBpc09ubGluZSA/IE5ldHdvcmtTdGF0dXMuT05MSU5FIDogTmV0d29ya1N0YXR1cy5PRkZMSU5FXG4gICAgXG4gICAgdGhpcy5pc09mZmxpbmUgPSAhaXNPbmxpbmVcbiAgICB0aGlzLm5ldHdvcmtJbmZvID0ge1xuICAgICAgLi4udGhpcy5uZXR3b3JrSW5mbyxcbiAgICAgIHN0YXR1czogbmV3U3RhdHVzLFxuICAgICAgbGFzdENoYW5nZWQ6IG5ldyBEYXRlKClcbiAgICB9XG4gICAgXG4gICAgaWYgKHByZXZpb3VzU3RhdHVzID09PSBOZXR3b3JrU3RhdHVzLk9GRkxJTkUgJiYgbmV3U3RhdHVzID09PSBOZXR3b3JrU3RhdHVzLk9OTElORSkge1xuICAgICAgLy8g5LuO56a757q/5oGi5aSNXG4gICAgICB0aGlzLnJlY29ubmVjdEF0dGVtcHRzID0gMFxuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVOZXR3b3JrUmVjb3ZlcnkoKVxuICAgIH0gZWxzZSBpZiAocHJldmlvdXNTdGF0dXMgPT09IE5ldHdvcmtTdGF0dXMuT05MSU5FICYmIG5ld1N0YXR1cyA9PT0gTmV0d29ya1N0YXR1cy5PRkZMSU5FKSB7XG4gICAgICAvLyDov5vlhaXnprvnur/nirbmgIFcbiAgICAgIHRoaXMub2ZmbGluZVN0YXJ0VGltZSA9IG5ldyBEYXRlKClcbiAgICB9XG4gICAgXG4gICAgdGhpcy5ub3RpZnlOZXR3b3JrQ2hhbmdlKHRoaXMubmV0d29ya0luZm8pXG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUNvbm5lY3Rpb25JbmZvKGNvbm5lY3Rpb246IGFueSk6IHZvaWQge1xuICAgIHRoaXMubmV0d29ya0luZm8gPSB7XG4gICAgICAuLi50aGlzLm5ldHdvcmtJbmZvLFxuICAgICAgZWZmZWN0aXZlVHlwZTogY29ubmVjdGlvbi5lZmZlY3RpdmVUeXBlLFxuICAgICAgZG93bmxpbms6IGNvbm5lY3Rpb24uZG93bmxpbmssXG4gICAgICBydHQ6IGNvbm5lY3Rpb24ucnR0LFxuICAgICAgc2F2ZURhdGE6IGNvbm5lY3Rpb24uc2F2ZURhdGEsXG4gICAgICBjb25uZWN0aW9uVHlwZTogdGhpcy5kZXRlcm1pbmVDb25uZWN0aW9uVHlwZShjb25uZWN0aW9uKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZGV0ZXJtaW5lQ29ubmVjdGlvblR5cGUoY29ubmVjdGlvbjogYW55KTogJ3dpZmknIHwgJ2NlbGx1bGFyJyB8ICdldGhlcm5ldCcgfCAndW5rbm93bicge1xuICAgIGlmIChjb25uZWN0aW9uLnR5cGUpIHtcbiAgICAgIHN3aXRjaCAoY29ubmVjdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgJ3dpZmknOiByZXR1cm4gJ3dpZmknXG4gICAgICAgIGNhc2UgJ2NlbGx1bGFyJzogcmV0dXJuICdjZWxsdWxhcidcbiAgICAgICAgY2FzZSAnZXRoZXJuZXQnOiByZXR1cm4gJ2V0aGVybmV0J1xuICAgICAgICBkZWZhdWx0OiByZXR1cm4gJ3Vua25vd24nXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIOWfuuS6juacieaViOexu+Wei+aOqOaWrVxuICAgIGlmIChjb25uZWN0aW9uLmVmZmVjdGl2ZVR5cGUpIHtcbiAgICAgIGlmIChbJzRnJywgJzVnJ10uaW5jbHVkZXMoY29ubmVjdGlvbi5lZmZlY3RpdmVUeXBlKSkge1xuICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5lZmZlY3RpdmVUeXBlID09PSAnNWcnID8gJ3dpZmknIDogJ2NlbGx1bGFyJ1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gJ3Vua25vd24nXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlRGVwZW5kZW5jaWVzKGRlcGVuZGVuY3lJZHM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcGVuZGluZ09wcyA9IGF3YWl0IHRoaXMuZ2V0UGVuZGluZ09mZmxpbmVPcGVyYXRpb25zKClcbiAgICBjb25zdCBwZW5kaW5nSWRzID0gcGVuZGluZ09wcy5tYXAob3AgPT4gb3AuaWQpXG4gICAgXG4gICAgY29uc3QgdW5yZXNvbHZlZERlcGVuZGVuY2llcyA9IGRlcGVuZGVuY3lJZHMuZmlsdGVyKGlkID0+ICFwZW5kaW5nSWRzLmluY2x1ZGVzKGlkKSlcbiAgICBcbiAgICBpZiAodW5yZXNvbHZlZERlcGVuZGVuY2llcy5sZW5ndGggPiAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYERlcGVuZGVuY2llcyBub3QgZm91bmQ6ICR7dW5yZXNvbHZlZERlcGVuZGVuY2llcy5qb2luKCcsICcpfWApXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBwZXJmb3JtTG9jYWxPcGVyYXRpb24ob3BlcmF0aW9uOiBPZmZsaW5lT3BlcmF0aW9uKTogUHJvbWlzZTxhbnk+IHtcbiAgICBzd2l0Y2ggKG9wZXJhdGlvbi50eXBlKSB7XG4gICAgICBjYXNlIE9mZmxpbmVPcGVyYXRpb25UeXBlLkNSRUFURTpcbiAgICAgICAgcmV0dXJuIGxvY2FsT3BlcmF0aW9uU2VydmljZS5jcmVhdGVDYXJkKG9wZXJhdGlvbi5kYXRhLCBvcGVyYXRpb24udXNlcklkKVxuICAgICAgY2FzZSBPZmZsaW5lT3BlcmF0aW9uVHlwZS5VUERBVEU6XG4gICAgICAgIHJldHVybiBsb2NhbE9wZXJhdGlvblNlcnZpY2UudXBkYXRlQ2FyZChvcGVyYXRpb24uZW50aXR5SWQhLCBvcGVyYXRpb24uZGF0YSwgb3BlcmF0aW9uLnVzZXJJZClcbiAgICAgIGNhc2UgT2ZmbGluZU9wZXJhdGlvblR5cGUuREVMRVRFOlxuICAgICAgICByZXR1cm4gbG9jYWxPcGVyYXRpb25TZXJ2aWNlLmRlbGV0ZUNhcmQob3BlcmF0aW9uLmVudGl0eUlkISwgb3BlcmF0aW9uLnVzZXJJZClcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgb3BlcmF0aW9uIHR5cGU6ICR7b3BlcmF0aW9uLnR5cGV9YClcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHN0b3JlT2ZmbGluZU9wZXJhdGlvbihvcGVyYXRpb246IE9mZmxpbmVPcGVyYXRpb24pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZGIuc3luY1F1ZXVlLmFkZCh7XG4gICAgICAgIGlkOiBvcGVyYXRpb24uaWQsXG4gICAgICAgIHR5cGU6IG9wZXJhdGlvbi50eXBlIGFzIGFueSxcbiAgICAgICAgZW50aXR5OiBvcGVyYXRpb24uZW50aXR5LFxuICAgICAgICBlbnRpdHlJZDogb3BlcmF0aW9uLmVudGl0eUlkLFxuICAgICAgICB1c2VySWQ6IG9wZXJhdGlvbi51c2VySWQsXG4gICAgICAgIGRhdGE6IG9wZXJhdGlvbi5kYXRhLFxuICAgICAgICBwcmlvcml0eTogb3BlcmF0aW9uLnByaW9yaXR5IGFzIGFueSxcbiAgICAgICAgdGltZXN0YW1wOiBvcGVyYXRpb24udGltZXN0YW1wLFxuICAgICAgICByZXRyeUNvdW50OiBvcGVyYXRpb24ucmV0cnlDb3VudCxcbiAgICAgICAgbWF4UmV0cmllczogb3BlcmF0aW9uLm1heFJldHJpZXMsXG4gICAgICAgIGVycm9yOiB1bmRlZmluZWRcbiAgICAgIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzdG9yZSBvZmZsaW5lIG9wZXJhdGlvbjonLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBzeW5jT3BlcmF0aW9uKG9wZXJhdGlvbjogT2ZmbGluZU9wZXJhdGlvbik6IFByb21pc2U8e1xuICAgIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgICBjb25mbGljdD86IENvbmZsaWN0SW5mb1xuICAgIGVycm9yPzogc3RyaW5nXG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgLy8g6L+Z6YeM5bqU6K+l6LCD55So5a6e6ZmF55qE5ZCM5q2l5pyN5YqhXG4gICAgICAvLyDkuLrkuobmvJTnpLrvvIzmiJHku6zmqKHmi5/lkIzmraXov4fnqItcbiAgICAgIFxuICAgICAgLy8g5qOA5p+l5piv5ZCm5pyJ5Yay56qBXG4gICAgICBjb25zdCByZW1vdGVEYXRhID0gYXdhaXQgdGhpcy5mZXRjaFJlbW90ZURhdGEob3BlcmF0aW9uLmVudGl0eSwgb3BlcmF0aW9uLmVudGl0eUlkKVxuICAgICAgY29uc3QgY29uZmxpY3QgPSBhd2FpdCB0aGlzLmRldGVjdENvbmZsaWN0cyhvcGVyYXRpb24sIHJlbW90ZURhdGEpXG4gICAgICBcbiAgICAgIGlmIChjb25mbGljdCkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgY29uZmxpY3QgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDmqKHmi5/lkIzmraXmiJDlip9cbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKVxuICAgICAgXG4gICAgICAvLyDmoIforrDmk43kvZzkuLrlt7LlrozmiJBcbiAgICAgIGF3YWl0IGRiLnN5bmNRdWV1ZS53aGVyZSgnaWQnKS5lcXVhbHMob3BlcmF0aW9uLmlkKS5tb2RpZnkoe1xuICAgICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnIGFzIGFueVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaFJlbW90ZURhdGEoZW50aXR5OiBzdHJpbmcsIGVudGl0eUlkPzogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICAvLyDov5nph4zlupTor6XosIPnlKjlrp7pmYXnmoRBUEnojrflj5bov5znqIvmlbDmja5cbiAgICAvLyDkuLrkuobmvJTnpLrvvIzov5Tlm55udWxs6KGo56S65rKh5pyJ6L+c56iL5pWw5o2uXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0TG9jYWxEYXRhRm9yRW50aXR5KGVudGl0eTogc3RyaW5nLCBlbnRpdHlJZD86IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgc3dpdGNoIChlbnRpdHkpIHtcbiAgICAgIGNhc2UgJ2NhcmQnOlxuICAgICAgICByZXR1cm4gZW50aXR5SWQgPyBkYi5jYXJkcy5nZXQoZW50aXR5SWQpIDogbnVsbFxuICAgICAgY2FzZSAnZm9sZGVyJzpcbiAgICAgICAgcmV0dXJuIGVudGl0eUlkID8gZGIuZm9sZGVycy5nZXQoZW50aXR5SWQpIDogbnVsbFxuICAgICAgY2FzZSAndGFnJzpcbiAgICAgICAgcmV0dXJuIGVudGl0eUlkID8gZGIudGFncy5nZXQoZW50aXR5SWQpIDogbnVsbFxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRldGVybWluZUNvbmZsaWN0VHlwZShcbiAgICBvcGVyYXRpb246IE9mZmxpbmVPcGVyYXRpb24sXG4gICAgbG9jYWxEYXRhOiBhbnksXG4gICAgcmVtb3RlRGF0YTogYW55XG4gICk6ICdzaW11bHRhbmVvdXNfZWRpdCcgfCAnZGVsZXRlX2NvbmZsaWN0JyB8ICdzdHJ1Y3R1cmVfY29uZmxpY3QnIHtcbiAgICBpZiAob3BlcmF0aW9uLnR5cGUgPT09IE9mZmxpbmVPcGVyYXRpb25UeXBlLkRFTEVURSkge1xuICAgICAgcmV0dXJuICdkZWxldGVfY29uZmxpY3QnXG4gICAgfVxuICAgIFxuICAgIC8vIOajgOafpeaVsOaNrue7k+aehOaYr+WQpuWPkeeUn+WPmOWMllxuICAgIGlmICh0aGlzLmhhc1N0cnVjdHVyZUNoYW5nZWQobG9jYWxEYXRhLCByZW1vdGVEYXRhKSkge1xuICAgICAgcmV0dXJuICdzdHJ1Y3R1cmVfY29uZmxpY3QnXG4gICAgfVxuICAgIFxuICAgIHJldHVybiAnc2ltdWx0YW5lb3VzX2VkaXQnXG4gIH1cblxuICBwcml2YXRlIGhhc1N0cnVjdHVyZUNoYW5nZWQobG9jYWxEYXRhOiBhbnksIHJlbW90ZURhdGE6IGFueSk6IGJvb2xlYW4ge1xuICAgIC8vIOajgOafpeaVsOaNrue7k+aehOaYr+WQpuWPkeeUn+mHjeWkp+WPmOWMllxuICAgIGNvbnN0IGxvY2FsS2V5cyA9IG5ldyBTZXQoT2JqZWN0LmtleXMobG9jYWxEYXRhKSlcbiAgICBjb25zdCByZW1vdGVLZXlzID0gbmV3IFNldChPYmplY3Qua2V5cyhyZW1vdGVEYXRhKSlcbiAgICBcbiAgICByZXR1cm4gbG9jYWxLZXlzLnNpemUgIT09IHJlbW90ZUtleXMuc2l6ZSB8fCBcbiAgICAgICAgICAgIVsuLi5sb2NhbEtleXNdLmV2ZXJ5KGtleSA9PiByZW1vdGVLZXlzLmhhcyhrZXkpKVxuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0Q29udGVudEZvck1lcmdlKGRhdGE6IGFueSk6IHN0cmluZyB7XG4gICAgLy8g5o+Q5Y+W55So5LqO5ZCI5bm255qE5YaF5a65XG4gICAgaWYgKGRhdGEuZnJvbnRDb250ZW50ICYmIGRhdGEuYmFja0NvbnRlbnQpIHtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGZyb250OiBkYXRhLmZyb250Q29udGVudCxcbiAgICAgICAgYmFjazogZGF0YS5iYWNrQ29udGVudFxuICAgICAgfSlcbiAgICB9XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEpXG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZUNvbnRlbnRTaW1pbGFyaXR5KGNvbnRlbnQxOiBzdHJpbmcsIGNvbnRlbnQyOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIC8vIOeugOWNleeahOWGheWuueebuOS8vOW6puiuoeeul1xuICAgIGNvbnN0IGRpc3RhbmNlID0gdGhpcy5jYWxjdWxhdGVMZXZlbnNodGVpbkRpc3RhbmNlKGNvbnRlbnQxLCBjb250ZW50MilcbiAgICBjb25zdCBtYXhMZW5ndGggPSBNYXRoLm1heChjb250ZW50MS5sZW5ndGgsIGNvbnRlbnQyLmxlbmd0aClcbiAgICByZXR1cm4gbWF4TGVuZ3RoID4gMCA/IDEgLSAoZGlzdGFuY2UgLyBtYXhMZW5ndGgpIDogMVxuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVMZXZlbnNodGVpbkRpc3RhbmNlKHN0cjE6IHN0cmluZywgc3RyMjogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBtYXRyaXggPSBBcnJheShzdHIyLmxlbmd0aCArIDEpLmZpbGwobnVsbCkubWFwKCgpID0+IEFycmF5KHN0cjEubGVuZ3RoICsgMSkuZmlsbChudWxsKSlcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBzdHIxLmxlbmd0aDsgaSsrKSBtYXRyaXhbMF1baV0gPSBpXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPD0gc3RyMi5sZW5ndGg7IGorKykgbWF0cml4W2pdWzBdID0galxuICAgIFxuICAgIGZvciAobGV0IGogPSAxOyBqIDw9IHN0cjIubGVuZ3RoOyBqKyspIHtcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHN0cjEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgaW5kaWNhdG9yID0gc3RyMVtpIC0gMV0gPT09IHN0cjJbaiAtIDFdID8gMCA6IDFcbiAgICAgICAgbWF0cml4W2pdW2ldID0gTWF0aC5taW4oXG4gICAgICAgICAgbWF0cml4W2pdW2kgLSAxXSArIDEsXG4gICAgICAgICAgbWF0cml4W2ogLSAxXVtpXSArIDEsXG4gICAgICAgICAgbWF0cml4W2ogLSAxXVtpIC0gMV0gKyBpbmRpY2F0b3JcbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbWF0cml4W3N0cjIubGVuZ3RoXVtzdHIxLmxlbmd0aF1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYXBwbHlDb25mbGljdFJlc29sdXRpb24oY29uZmxpY3Q6IENvbmZsaWN0SW5mbywgcmVzb2x1dGlvbjogJ2xvY2FsJyB8ICdyZW1vdGUnIHwgJ21lcmdlJyk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIOW6lOeUqOWGsueqgeino+WGs+aWueahiFxuICAgIGNvbmZsaWN0LnJlc29sdXRpb24gPSByZXNvbHV0aW9uXG4gICAgXG4gICAgLy8g6L+Z6YeM5bqU6K+l5qC55o2u6Kej5Yaz5pa55qGI5pu05paw5pWw5o2uXG4gICAgLy8g5a6e6ZmF5a6e546w5Y+W5Yaz5LqO5Lia5Yqh6YC76L6RXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxvYWRPZmZsaW5lU3RhdGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8g5LuO5oyB5LmF5YyW5a2Y5YKo5Yqg6L2956a757q/54q25oCBXG4gICAgdHJ5IHtcbiAgICAgIC8vIOWwneivleS7jiBJbmRleGVkREIg5Yqg6L2977yI5Li76KaB5a2Y5YKo77yJXG4gICAgICBjb25zdCBpbmRleGVkRGJTdGF0ZSA9IGF3YWl0IHRoaXMubG9hZEZyb21JbmRleGVkREIoKVxuICAgICAgaWYgKGluZGV4ZWREYlN0YXRlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucmVzdG9yZU9mZmxpbmVTdGF0ZShpbmRleGVkRGJTdGF0ZSlcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOWbnumAgOWIsCBsb2NhbFN0b3JhZ2VcbiAgICAgIGNvbnN0IHNhdmVkU3RhdGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnb2ZmbGluZU1hbmFnZXJTdGF0ZScpXG4gICAgICBpZiAoc2F2ZWRTdGF0ZSkge1xuICAgICAgICBjb25zdCBzdGF0ZSA9IEpTT04ucGFyc2Uoc2F2ZWRTdGF0ZSlcbiAgICAgICAgYXdhaXQgdGhpcy5yZXN0b3JlT2ZmbGluZVN0YXRlKHN0YXRlKVxuICAgICAgICBcbiAgICAgICAgLy8g6L+B56e75YiwIEluZGV4ZWREQlxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVUb0luZGV4ZWREQihzdGF0ZSlcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ29mZmxpbmVNYW5hZ2VyU3RhdGUnKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBsb2FkIG9mZmxpbmUgc3RhdGU6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBzYXZlT2ZmbGluZVN0YXRlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IHRoaXMuY3JlYXRlT2ZmbGluZVN0YXRlU25hcHNob3QoKVxuICAgICAgXG4gICAgICAvLyDkv53lrZjliLAgSW5kZXhlZERCXG4gICAgICBhd2FpdCB0aGlzLnNhdmVUb0luZGV4ZWREQihzdGF0ZSlcbiAgICAgIFxuICAgICAgLy8g5ZCM5pe25L+d5a2Y5YiwIGxvY2FsU3RvcmFnZSDkvZzkuLrlpIfku71cbiAgICAgIGF3YWl0IHRoaXMuc2F2ZVRvTG9jYWxTdG9yYWdlKHN0YXRlKVxuICAgICAgXG4gICAgICAvLyDliJvlu7rlop7ph4/lpIfku71cbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlSW5jcmVtZW50YWxCYWNrdXAoc3RhdGUpXG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc2F2ZSBvZmZsaW5lIHN0YXRlOicsIGVycm9yKVxuICAgICAgLy8g5aaC5p6cIEluZGV4ZWREQiDlpLHotKXvvIzlm57pgIDliLAgbG9jYWxTdG9yYWdlXG4gICAgICBhd2FpdCB0aGlzLnNhdmVUb0xvY2FsU3RvcmFnZUZhbGxiYWNrKClcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZU9mZmxpbmVTdGF0ZVNuYXBzaG90KCk6IFByb21pc2U8T2ZmbGluZVN0YXRlU25hcHNob3Q+IHtcbiAgICBjb25zdCBwZW5kaW5nT3BzID0gYXdhaXQgdGhpcy5nZXRQZW5kaW5nT2ZmbGluZU9wZXJhdGlvbnMoKVxuICAgIGNvbnN0IGNvbmZsaWN0cyA9IHRoaXMuY29uZmxpY3RzXG4gICAgY29uc3Qgc3RhdHMgPSBhd2FpdCB0aGlzLmdldE9mZmxpbmVTdGF0cygpXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHZlcnNpb246IHRoaXMuZ2V0Q3VycmVudFN0YXRlVmVyc2lvbigpLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBvZmZsaW5lU3RhcnRUaW1lOiB0aGlzLm9mZmxpbmVTdGFydFRpbWU/LnRvSVNPU3RyaW5nKCksXG4gICAgICByZWNvbm5lY3RBdHRlbXB0czogdGhpcy5yZWNvbm5lY3RBdHRlbXB0cyxcbiAgICAgIG5ldHdvcmtJbmZvOiB0aGlzLm5ldHdvcmtJbmZvLFxuICAgICAgcGVuZGluZ09wZXJhdGlvbnM6IHBlbmRpbmdPcHMubWFwKG9wID0+IHRoaXMuc2VyaWFsaXplT2ZmbGluZU9wZXJhdGlvbihvcCkpLFxuICAgICAgY29uZmxpY3RzOiBjb25mbGljdHMubWFwKGNvbmZsaWN0ID0+IHRoaXMuc2VyaWFsaXplQ29uZmxpY3QoY29uZmxpY3QpKSxcbiAgICAgIHN0YXRzOiB0aGlzLnNlcmlhbGl6ZVN0YXRzKHN0YXRzKSxcbiAgICAgIGNoZWNrc3VtOiBhd2FpdCB0aGlzLmNhbGN1bGF0ZVN0YXRlQ2hlY2tzdW0ocGVuZGluZ09wcywgY29uZmxpY3RzKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc2F2ZVRvSW5kZXhlZERCKHN0YXRlOiBPZmZsaW5lU3RhdGVTbmFwc2hvdCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDkvb/nlKggRGV4aWUuanMg55qEIHRyYW5zYWN0aW9uIEFQSVxuICAgICAgYXdhaXQgZGIudHJhbnNhY3Rpb24oJ3J3JywgW2RiLnN5bmNRdWV1ZV0sIGFzeW5jICgpID0+IHtcbiAgICAgICAgLy8g5qOA5p+l5piv5ZCm5a2Y5Zyo54q25oCB6KGo77yM5aaC5p6c5LiN5a2Y5Zyo5YiZ5Yib5bu6XG4gICAgICAgIGlmICghZGIub2ZmbGluZVN0YXRlKSB7XG4gICAgICAgICAgLy8g5Yqo5oCB5Yib5bu654q25oCB6KGoXG4gICAgICAgICAgYXdhaXQgZGIudmVyc2lvbihkYi52ZXIgKyAxKS5zdG9yZXMoe1xuICAgICAgICAgICAgb2ZmbGluZVN0YXRlOiAnKytpZCx2ZXJzaW9uLHRpbWVzdGFtcCxjaGVja3N1bSdcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyDliKDpmaTml6fnmoTnirbmgIHorrDlvZVcbiAgICAgICAgYXdhaXQgZGIub2ZmbGluZVN0YXRlPy5jbGVhcigpXG4gICAgICAgIFxuICAgICAgICAvLyDkv53lrZjmlrDnmoTnirbmgIHorrDlvZVcbiAgICAgICAgYXdhaXQgZGIub2ZmbGluZVN0YXRlPy5hZGQoe1xuICAgICAgICAgIHZlcnNpb246IHN0YXRlLnZlcnNpb24sXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZShzdGF0ZS50aW1lc3RhbXApLFxuICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHN0YXRlKSxcbiAgICAgICAgICBjaGVja3N1bTogc3RhdGUuY2hlY2tzdW0sXG4gICAgICAgICAgY29tcHJlc3NlZDogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc2F2ZSB0byBJbmRleGVkREI6JywgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbG9hZEZyb21JbmRleGVkREIoKTogUHJvbWlzZTxPZmZsaW5lU3RhdGVTbmFwc2hvdCB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFkYi5vZmZsaW5lU3RhdGUpIHJldHVybiBudWxsXG4gICAgICBcbiAgICAgIGNvbnN0IGxhdGVzdFN0YXRlID0gYXdhaXQgZGIub2ZmbGluZVN0YXRlXG4gICAgICAgIC5vcmRlckJ5KCd0aW1lc3RhbXAnKVxuICAgICAgICAucmV2ZXJzZSgpXG4gICAgICAgIC5maXJzdCgpXG4gICAgICBcbiAgICAgIGlmICghbGF0ZXN0U3RhdGUpIHJldHVybiBudWxsXG4gICAgICBcbiAgICAgIC8vIOmqjOivgeaVsOaNruWujOaVtOaAp1xuICAgICAgaWYgKGxhdGVzdFN0YXRlLmNvbXByZXNzZWQpIHtcbiAgICAgICAgY29uc3QgZGVjb21wcmVzc2VkID0gdGhpcy5kZWNvbXByZXNzRGF0YShsYXRlc3RTdGF0ZS5kYXRhKVxuICAgICAgICBjb25zdCBzdGF0ZSA9IEpTT04ucGFyc2UoZGVjb21wcmVzc2VkKVxuICAgICAgICBcbiAgICAgICAgLy8g6aqM6K+B5qCh6aqM5ZKMXG4gICAgICAgIGlmIChhd2FpdCB0aGlzLnZlcmlmeVN0YXRlQ2hlY2tzdW0oc3RhdGUpKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YXRlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBmcm9tIEluZGV4ZWREQjonLCBlcnJvcilcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBzYXZlVG9Mb2NhbFN0b3JhZ2Uoc3RhdGU6IE9mZmxpbmVTdGF0ZVNuYXBzaG90KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbXByZXNzZWQgPSB0aGlzLmNvbXByZXNzRGF0YShKU09OLnN0cmluZ2lmeShzdGF0ZSkpXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnb2ZmbGluZU1hbmFnZXJTdGF0ZScsIGNvbXByZXNzZWQpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHNhdmUgdG8gbG9jYWxTdG9yYWdlOicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc2F2ZVRvTG9jYWxTdG9yYWdlRmFsbGJhY2soKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXRlID0ge1xuICAgICAgICBvZmZsaW5lU3RhcnRUaW1lOiB0aGlzLm9mZmxpbmVTdGFydFRpbWU/LnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHJlY29ubmVjdEF0dGVtcHRzOiB0aGlzLnJlY29ubmVjdEF0dGVtcHRzLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ29mZmxpbmVNYW5hZ2VyU3RhdGUnLCBKU09OLnN0cmluZ2lmeShzdGF0ZSkpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmFsbGJhY2sgc2F2ZSBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVJbmNyZW1lbnRhbEJhY2t1cChzdGF0ZTogT2ZmbGluZVN0YXRlU25hcHNob3QpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYmFja3VwS2V5ID0gYG9mZmxpbmVCYWNrdXBfJHtEYXRlLm5vdygpfWBcbiAgICAgIGNvbnN0IGJhY2t1cERhdGEgPSB7XG4gICAgICAgIHRpbWVzdGFtcDogc3RhdGUudGltZXN0YW1wLFxuICAgICAgICB2ZXJzaW9uOiBzdGF0ZS52ZXJzaW9uLFxuICAgICAgICBwZW5kaW5nQ291bnQ6IHN0YXRlLnBlbmRpbmdPcGVyYXRpb25zLmxlbmd0aCxcbiAgICAgICAgY29uZmxpY3RzQ291bnQ6IHN0YXRlLmNvbmZsaWN0cy5sZW5ndGgsXG4gICAgICAgIGNvbXByZXNzZWQ6IHRydWVcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g6ZmQ5Yi25aSH5Lu95pWw6YeP77yM5L+d55WZ5pyA6L+RMTDkuKpcbiAgICAgIGNvbnN0IGV4aXN0aW5nQmFja3VwcyA9IE9iamVjdC5rZXlzKGxvY2FsU3RvcmFnZSlcbiAgICAgICAgLmZpbHRlcihrZXkgPT4ga2V5LnN0YXJ0c1dpdGgoJ29mZmxpbmVCYWNrdXBfJykpXG4gICAgICAgIC5zb3J0KClcbiAgICAgIFxuICAgICAgaWYgKGV4aXN0aW5nQmFja3Vwcy5sZW5ndGggPj0gMTApIHtcbiAgICAgICAgY29uc3QgdG9EZWxldGUgPSBleGlzdGluZ0JhY2t1cHMuc2xpY2UoMCwgZXhpc3RpbmdCYWNrdXBzLmxlbmd0aCAtIDkpXG4gICAgICAgIHRvRGVsZXRlLmZvckVhY2goa2V5ID0+IGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGJhY2t1cEtleSwgSlNPTi5zdHJpbmdpZnkoYmFja3VwRGF0YSkpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNyZWF0ZSBpbmNyZW1lbnRhbCBiYWNrdXA6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjb21wcmVzc0RhdGEoZGF0YTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICB0cnkge1xuICAgICAgLy8g566A5Y2V55qE5Y6L57yp5a6e546w77yI5a6e6ZmF6aG555uu5Lit5Y+v5Lul5L2/55So5pu05aSN5p2C55qE5Y6L57yp566X5rOV77yJXG4gICAgICByZXR1cm4gYnRvYShlbmNvZGVVUklDb21wb25lbnQoZGF0YSkpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBkYXRhIC8vIOWmguaenOWOi+e8qeWksei0pe+8jOi/lOWbnuWOn+Wni+aVsOaNrlxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZGVjb21wcmVzc0RhdGEoY29tcHJlc3NlZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChhdG9iKGNvbXByZXNzZWQpKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gY29tcHJlc3NlZCAvLyDlpoLmnpzop6PljovlpLHotKXvvIzov5Tlm57ljp/lp4vmlbDmja5cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEN1cnJlbnRTdGF0ZVZlcnNpb24oKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYDEuMC4ke0RhdGUubm93KCl9YFxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjYWxjdWxhdGVTdGF0ZUNoZWNrc3VtKG9wZXJhdGlvbnM6IE9mZmxpbmVPcGVyYXRpb25bXSwgY29uZmxpY3RzOiBDb25mbGljdEluZm9bXSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIG9wZXJhdGlvbnM6IG9wZXJhdGlvbnMubGVuZ3RoLFxuICAgICAgY29uZmxpY3RzOiBjb25mbGljdHMubGVuZ3RoLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgfSlcbiAgICBcbiAgICAvLyDnroDljZXnmoTmoKHpqozlkozorqHnrpdcbiAgICBsZXQgaGFzaCA9IDBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGNoYXIgPSBkYXRhLmNoYXJDb2RlQXQoaSlcbiAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSArIGNoYXJcbiAgICAgIGhhc2ggPSBoYXNoICYgaGFzaCAvLyDovazmjaLkuLozMuS9jeaVtOaVsFxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gTWF0aC5hYnMoaGFzaCkudG9TdHJpbmcoMTYpXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHZlcmlmeVN0YXRlQ2hlY2tzdW0oc3RhdGU6IE9mZmxpbmVTdGF0ZVNuYXBzaG90KTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBzdGF0ZS5wZW5kaW5nT3BlcmF0aW9ucy5tYXAob3AgPT4gdGhpcy5kZXNlcmlhbGl6ZU9mZmxpbmVPcGVyYXRpb24ob3ApKVxuICAgICAgY29uc3QgY29uZmxpY3RzID0gc3RhdGUuY29uZmxpY3RzLm1hcChjb25mbGljdCA9PiB0aGlzLmRlc2VyaWFsaXplQ29uZmxpY3QoY29uZmxpY3QpKVxuICAgICAgXG4gICAgICBjb25zdCBjYWxjdWxhdGVkQ2hlY2tzdW0gPSBhd2FpdCB0aGlzLmNhbGN1bGF0ZVN0YXRlQ2hlY2tzdW0ob3BlcmF0aW9ucywgY29uZmxpY3RzKVxuICAgICAgcmV0dXJuIGNhbGN1bGF0ZWRDaGVja3N1bSA9PT0gc3RhdGUuY2hlY2tzdW1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZXN0b3JlT2ZmbGluZVN0YXRlKHN0YXRlOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLm9mZmxpbmVTdGFydFRpbWUgPSBzdGF0ZS5vZmZsaW5lU3RhcnRUaW1lID8gbmV3IERhdGUoc3RhdGUub2ZmbGluZVN0YXJ0VGltZSkgOiB1bmRlZmluZWRcbiAgICB0aGlzLnJlY29ubmVjdEF0dGVtcHRzID0gc3RhdGUucmVjb25uZWN0QXR0ZW1wdHMgfHwgMFxuICAgIFxuICAgIGlmIChzdGF0ZS5uZXR3b3JrSW5mbykge1xuICAgICAgdGhpcy5uZXR3b3JrSW5mbyA9IHtcbiAgICAgICAgLi4udGhpcy5uZXR3b3JrSW5mbyxcbiAgICAgICAgLi4uc3RhdGUubmV0d29ya0luZm8sXG4gICAgICAgIGxhc3RDaGFuZ2VkOiBuZXcgRGF0ZShzdGF0ZS5uZXR3b3JrSW5mby5sYXN0Q2hhbmdlZCB8fCBEYXRlLm5vdygpKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpZiAoc3RhdGUucGVuZGluZ09wZXJhdGlvbnMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBzdGF0ZS5wZW5kaW5nT3BlcmF0aW9ucy5tYXAoKG9wOiBhbnkpID0+IHRoaXMuZGVzZXJpYWxpemVPZmZsaW5lT3BlcmF0aW9uKG9wKSlcbiAgICAgICAgLy8g6aqM6K+B5bm25oGi5aSN56a757q/5pON5L2cXG4gICAgICAgIGF3YWl0IHRoaXMudmFsaWRhdGVBbmRSZXN0b3JlT3BlcmF0aW9ucyhvcGVyYXRpb25zKVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gcmVzdG9yZSBwZW5kaW5nIG9wZXJhdGlvbnM6JywgZXJyb3IpXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGlmIChzdGF0ZS5jb25mbGljdHMpIHtcbiAgICAgIHRoaXMuY29uZmxpY3RzID0gc3RhdGUuY29uZmxpY3RzLm1hcCgoY29uZmxpY3Q6IGFueSkgPT4gdGhpcy5kZXNlcmlhbGl6ZUNvbmZsaWN0KGNvbmZsaWN0KSlcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNlcmlhbGl6ZU9mZmxpbmVPcGVyYXRpb24ob3A6IE9mZmxpbmVPcGVyYXRpb24pOiBhbnkge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5vcCxcbiAgICAgIHRpbWVzdGFtcDogb3AudGltZXN0YW1wLnRvSVNPU3RyaW5nKClcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRlc2VyaWFsaXplT2ZmbGluZU9wZXJhdGlvbihvcDogYW55KTogT2ZmbGluZU9wZXJhdGlvbiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm9wLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZShvcC50aW1lc3RhbXApXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzZXJpYWxpemVDb25mbGljdChjb25mbGljdDogQ29uZmxpY3RJbmZvKTogYW55IHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uY29uZmxpY3QsXG4gICAgICB0aW1lc3RhbXA6IGNvbmZsaWN0LnRpbWVzdGFtcC50b0lTT1N0cmluZygpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkZXNlcmlhbGl6ZUNvbmZsaWN0KGNvbmZsaWN0OiBhbnkpOiBDb25mbGljdEluZm8ge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5jb25mbGljdCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoY29uZmxpY3QudGltZXN0YW1wKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2VyaWFsaXplU3RhdHMoc3RhdHM6IE9mZmxpbmVTdGF0cyk6IGFueSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnN0YXRzLFxuICAgICAgbGFzdFN5bmNUaW1lOiBzdGF0cy5sYXN0U3luY1RpbWU/LnRvSVNPU3RyaW5nKClcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlQW5kUmVzdG9yZU9wZXJhdGlvbnMob3BlcmF0aW9uczogT2ZmbGluZU9wZXJhdGlvbltdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgdmFsaWRPcGVyYXRpb25zID0gb3BlcmF0aW9ucy5maWx0ZXIob3AgPT4ge1xuICAgICAgLy8g6aqM6K+B5pON5L2c55qE5pyJ5pWI5oCnXG4gICAgICByZXR1cm4gb3AuaWQgJiYgb3AudHlwZSAmJiBvcC5lbnRpdHkgJiYgb3AudGltZXN0YW1wXG4gICAgfSlcbiAgICBcbiAgICAvLyDmgaLlpI3liLDlkIzmraXpmJ/liJdcbiAgICBmb3IgKGNvbnN0IG9wZXJhdGlvbiBvZiB2YWxpZE9wZXJhdGlvbnMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc3RvcmVPZmZsaW5lT3BlcmF0aW9uKG9wZXJhdGlvbilcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIHJlc3RvcmUgb3BlcmF0aW9uICR7b3BlcmF0aW9uLmlkfTpgLCBlcnJvcilcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZU9mZmxpbmVEdXJhdGlvbigpOiBudW1iZXIge1xuICAgIGlmICghdGhpcy5vZmZsaW5lU3RhcnRUaW1lKSByZXR1cm4gMFxuICAgIHJldHVybiBEYXRlLm5vdygpIC0gdGhpcy5vZmZsaW5lU3RhcnRUaW1lLmdldFRpbWUoKVxuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVBdmVyYWdlUmVzcG9uc2VUaW1lKCk6IG51bWJlciB7XG4gICAgLy8g566A5YyW55qE5bmz5Z2H5ZON5bqU5pe26Ze06K6h566XXG4gICAgcmV0dXJuIDUwIC8vIOavq+enklxuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVEYXRhU3luY2VkT25SZXN1bWUoKTogbnVtYmVyIHtcbiAgICAvLyDkvLDnrpflkIzmraXnmoTmlbDmja7ph49cbiAgICByZXR1cm4gMCAvLyDlrZfoioJcbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlRXN0aW1hdGVkQmFuZHdpZHRoU2F2ZWQob3BlcmF0aW9uczogT2ZmbGluZU9wZXJhdGlvbltdKTogbnVtYmVyIHtcbiAgICAvLyDkvLDnrpfoioLnnIHnmoTluKblrr1cbiAgICByZXR1cm4gb3BlcmF0aW9ucy5sZW5ndGggKiAxMDI0IC8vIOWBh+iuvuavj+S4quaTjeS9nOiKguecgTFLQlxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRMYXN0U3luY1RpbWUoKTogUHJvbWlzZTxEYXRlIHwgdW5kZWZpbmVkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxhdGVzdFN5bmMgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgICAgLndoZXJlKCdzdGF0dXMnKVxuICAgICAgICAuZXF1YWxzKCdjb21wbGV0ZWQnIGFzIGFueSlcbiAgICAgICAgLm9yZGVyQnkoJ3RpbWVzdGFtcCcpXG4gICAgICAgIC5yZXZlcnNlKClcbiAgICAgICAgLmZpcnN0KClcbiAgICAgIFxuICAgICAgcmV0dXJuIGxhdGVzdFN5bmMgPyBuZXcgRGF0ZShsYXRlc3RTeW5jLnRpbWVzdGFtcCkgOiB1bmRlZmluZWRcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWRcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdldENvbXBsZXRlZE9mZmxpbmVPcGVyYXRpb25zKCk6IFByb21pc2U8T2ZmbGluZU9wZXJhdGlvbltdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbXBsZXRlZE9wcyA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgICAud2hlcmUoJ3N0YXR1cycpXG4gICAgICAgIC5lcXVhbHMoJ2NvbXBsZXRlZCcgYXMgYW55KVxuICAgICAgICAudG9BcnJheSgpXG4gICAgICBcbiAgICAgIHJldHVybiBjb21wbGV0ZWRPcHMubWFwKG9wID0+IHRoaXMuY29udmVydFN5bmNPcGVyYXRpb25Ub09mZmxpbmVPcGVyYXRpb24ob3ApKVxuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRGYWlsZWRPZmZsaW5lT3BlcmF0aW9ucygpOiBQcm9taXNlPE9mZmxpbmVPcGVyYXRpb25bXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmYWlsZWRPcHMgPSBhd2FpdCBkYi5zeW5jUXVldWVcbiAgICAgICAgLndoZXJlKCdzdGF0dXMnKVxuICAgICAgICAuZXF1YWxzKCdmYWlsZWQnIGFzIGFueSlcbiAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgXG4gICAgICByZXR1cm4gZmFpbGVkT3BzLm1hcChvcCA9PiB0aGlzLmNvbnZlcnRTeW5jT3BlcmF0aW9uVG9PZmZsaW5lT3BlcmF0aW9uKG9wKSlcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY29udmVydFN5bmNPcGVyYXRpb25Ub09mZmxpbmVPcGVyYXRpb24oc3luY09wOiBhbnkpOiBPZmZsaW5lT3BlcmF0aW9uIHtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHN5bmNPcC5pZCxcbiAgICAgIHR5cGU6IHN5bmNPcC50eXBlLFxuICAgICAgZW50aXR5OiBzeW5jT3AuZW50aXR5LFxuICAgICAgZW50aXR5SWQ6IHN5bmNPcC5lbnRpdHlJZCxcbiAgICAgIHVzZXJJZDogc3luY09wLnVzZXJJZCxcbiAgICAgIGRhdGE6IHN5bmNPcC5kYXRhLFxuICAgICAgcHJpb3JpdHk6IHN5bmNPcC5wcmlvcml0eSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoc3luY09wLnRpbWVzdGFtcCksXG4gICAgICByZXRyeUNvdW50OiBzeW5jT3AucmV0cnlDb3VudCxcbiAgICAgIG1heFJldHJpZXM6IHN5bmNPcC5tYXhSZXRyaWVzLFxuICAgICAgc3RhdHVzOiBzeW5jT3Auc3RhdHVzXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzb3J0T3BlcmF0aW9uc0J5UHJpb3JpdHkob3BlcmF0aW9uczogT21pdDxPZmZsaW5lT3BlcmF0aW9uLCAnaWQnIHwgJ3RpbWVzdGFtcCcgfCAncmV0cnlDb3VudCc+W10pIHtcbiAgICBjb25zdCBwcmlvcml0eU9yZGVyID0geyBjcml0aWNhbDogNCwgaGlnaDogMywgbm9ybWFsOiAyLCBsb3c6IDEgfVxuICAgIHJldHVybiBbLi4ub3BlcmF0aW9uc10uc29ydCgoYSwgYikgPT4gcHJpb3JpdHlPcmRlcltiLnByaW9yaXR5XSAtIHByaW9yaXR5T3JkZXJbYS5wcmlvcml0eV0pXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHJldHJ5T3BlcmF0aW9uKG9wZXJhdGlvbjogT2ZmbGluZU9wZXJhdGlvbik6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIOmHjeivleaTjeS9nOmAu+i+kVxuICAgIGF3YWl0IGRiLnN5bmNRdWV1ZS53aGVyZSgnaWQnKS5lcXVhbHMob3BlcmF0aW9uLmlkKS5tb2RpZnkoe1xuICAgICAgc3RhdHVzOiAncGVuZGluZycgYXMgYW55LFxuICAgICAgcmV0cnlDb3VudDogb3BlcmF0aW9uLnJldHJ5Q291bnQgKyAxXG4gICAgfSlcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g5paw5aKe5aKe5by65Yqf6IO95pa55rOVXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog6K6h566X5Y6G5Y+y5Y+v6Z2g5oCnXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNhbGN1bGF0ZUhpc3RvcmljYWxSZWxpYWJpbGl0eSgpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBvbmVIb3VyQWdvID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIDYwICogNjAgKiAxMDAwKVxuICAgICAgY29uc3QgcmVjZW50T3BlcmF0aW9ucyA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgICAud2hlcmUoJ3RpbWVzdGFtcCcpXG4gICAgICAgIC5hYm92ZShvbmVIb3VyQWdvKVxuICAgICAgICAudG9BcnJheSgpXG4gICAgICBcbiAgICAgIGlmIChyZWNlbnRPcGVyYXRpb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDEuMFxuICAgICAgXG4gICAgICBjb25zdCBzdWNjZXNzZnVsT3BzID0gcmVjZW50T3BlcmF0aW9ucy5maWx0ZXIob3AgPT4gb3Auc3RhdHVzID09PSAnY29tcGxldGVkJykubGVuZ3RoXG4gICAgICByZXR1cm4gc3VjY2Vzc2Z1bE9wcyAvIHJlY2VudE9wZXJhdGlvbnMubGVuZ3RoXG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gMC45IC8vIOm7mOiupOWPr+mdoOaAp1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmmbrog73lhrLnqoHpooTmtYvlkozpooTpmLJcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcHJlZGljdEFuZFByZXZlbnRDb25mbGljdHMob3BlcmF0aW9uczogT2ZmbGluZU9wZXJhdGlvbltdKTogUHJvbWlzZTxDb25mbGljdEluZm9bXT4ge1xuICAgIGNvbnN0IGNvbmZsaWN0czogQ29uZmxpY3RJbmZvW10gPSBbXVxuICAgIFxuICAgIGZvciAoY29uc3Qgb3BlcmF0aW9uIG9mIG9wZXJhdGlvbnMpIHtcbiAgICAgIGlmIChvcGVyYXRpb24uZW50aXR5SWQpIHtcbiAgICAgICAgLy8g5qOA5p+l5piv5ZCm5pyJ5Y+v6IO955qE5Yay56qBXG4gICAgICAgIGNvbnN0IHBvdGVudGlhbENvbmZsaWN0ID0gYXdhaXQgdGhpcy5jaGVja1BvdGVudGlhbENvbmZsaWN0KG9wZXJhdGlvbilcbiAgICAgICAgaWYgKHBvdGVudGlhbENvbmZsaWN0KSB7XG4gICAgICAgICAgY29uZmxpY3RzLnB1c2gocG90ZW50aWFsQ29uZmxpY3QpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGNvbmZsaWN0c1xuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpea9nOWcqOWGsueqgVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjaGVja1BvdGVudGlhbENvbmZsaWN0KG9wZXJhdGlvbjogT2ZmbGluZU9wZXJhdGlvbik6IFByb21pc2U8Q29uZmxpY3RJbmZvIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDmo4Dmn6XlkIzkuIDlrp7kvZPnmoTmnIDov5Hmk43kvZxcbiAgICAgIGNvbnN0IHJlY2VudE9wcyA9IGF3YWl0IGRiLnN5bmNRdWV1ZVxuICAgICAgICAud2hlcmUoJ2VudGl0eScpXG4gICAgICAgIC5lcXVhbHMob3BlcmF0aW9uLmVudGl0eSlcbiAgICAgICAgLmFuZChvcCA9PiBvcC5lbnRpdHlJZCA9PT0gb3BlcmF0aW9uLmVudGl0eUlkKVxuICAgICAgICAucmV2ZXJzZSgpXG4gICAgICAgIC5saW1pdCg1KVxuICAgICAgICAudG9BcnJheSgpXG4gICAgICBcbiAgICAgIGlmIChyZWNlbnRPcHMubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbFxuICAgICAgXG4gICAgICAvLyDmo4Dmn6Xml7bpl7Tph43lj6DvvIjlgYforr415YiG6ZKf5YaF55qE5pON5L2c5Y+v6IO95Yay56qB77yJXG4gICAgICBjb25zdCBmaXZlTWludXRlc0FnbyA9IG5ldyBEYXRlKERhdGUubm93KCkgLSA1ICogNjAgKiAxMDAwKVxuICAgICAgY29uc3QgY29uZmxpY3RpbmdPcHMgPSByZWNlbnRPcHMuZmlsdGVyKG9wID0+IFxuICAgICAgICBuZXcgRGF0ZShvcC50aW1lc3RhbXApID4gZml2ZU1pbnV0ZXNBZ28gJiYgXG4gICAgICAgIG9wLmlkICE9PSBvcGVyYXRpb24uaWRcbiAgICAgIClcbiAgICAgIFxuICAgICAgaWYgKGNvbmZsaWN0aW5nT3BzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcbiAgICAgICAgICBlbnRpdHlUeXBlOiBvcGVyYXRpb24uZW50aXR5LFxuICAgICAgICAgIGVudGl0eUlkOiBvcGVyYXRpb24uZW50aXR5SWQhLFxuICAgICAgICAgIGxvY2FsRGF0YTogb3BlcmF0aW9uLmRhdGEsXG4gICAgICAgICAgcmVtb3RlRGF0YTogY29uZmxpY3RpbmdPcHNbMF0uZGF0YSwgLy8g566A5YyW55qE6L+c56iL5pWw5o2uXG4gICAgICAgICAgY29uZmxpY3RUeXBlOiAnc2ltdWx0YW5lb3VzX2VkaXQnLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICByZXNvbHV0aW9uOiAncGVuZGluZydcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5oCn6IO955uR5o6n5ZKM5LyY5YyW5bu66K6uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlUGVyZm9ybWFuY2VPcHRpbWl6YXRpb24oKTogUHJvbWlzZTx7XG4gICAgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXVxuICAgIHByZWRpY3RlZEltcHJvdmVtZW50czogbnVtYmVyW11cbiAgfT4ge1xuICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgdGhpcy5nZXRPZmZsaW5lU3RhdHMoKVxuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXVxuICAgIGNvbnN0IHByZWRpY3RlZEltcHJvdmVtZW50czogbnVtYmVyW10gPSBbXVxuICAgIFxuICAgIC8vIOWfuuS6jue7n+iuoeS/oeaBr+aPkOS+m+W7uuiurlxuICAgIGlmIChzdGF0cy5hdmVyYWdlUmVzcG9uc2VUaW1lID4gMTAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgn5bu66K6u5ZCv55So5pON5L2c5om55aSE55CG5Lul5YeP5bCR5ZON5bqU5pe26Ze0JylcbiAgICAgIHByZWRpY3RlZEltcHJvdmVtZW50cy5wdXNoKDAuMykgLy8g6aKE6K6h5o+Q5Y2HMzAlXG4gICAgfVxuICAgIFxuICAgIGlmIChzdGF0cy5wZW5kaW5nT3BlcmF0aW9ucyA+IDUwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgn5bu66K6u5aKe5Yqg5ZCM5q2l6aKR546H5oiW5LyY5YyW6Zif5YiX566h55CGJylcbiAgICAgIHByZWRpY3RlZEltcHJvdmVtZW50cy5wdXNoKDAuNCkgLy8g6aKE6K6h5o+Q5Y2HNDAlXG4gICAgfVxuICAgIFxuICAgIGlmIChzdGF0cy5mYWlsZWRPcGVyYXRpb25zID4gc3RhdHMuY29tcGxldGVkT2ZmbGluZU9wZXJhdGlvbnMgKiAwLjEpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCflu7rorq7mo4Dmn6XnvZHnu5zov57mjqXlubbkvJjljJbph43or5XnrZbnlaUnKVxuICAgICAgcHJlZGljdGVkSW1wcm92ZW1lbnRzLnB1c2goMC41KSAvLyDpooTorqHmj5DljYc1MCVcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHsgcmVjb21tZW5kYXRpb25zLCBwcmVkaWN0ZWRJbXByb3ZlbWVudHMgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaZuuiDveemu+e6v+aVsOaNruWOi+e8qVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjb21wcmVzc09mZmxpbmVEYXRhKG9wZXJhdGlvbnM6IE9mZmxpbmVPcGVyYXRpb25bXSk6IFByb21pc2U8e1xuICAgIGNvbXByZXNzZWQ6IE9mZmxpbmVPcGVyYXRpb25bXVxuICAgIGNvbXByZXNzaW9uUmF0aW86IG51bWJlclxuICB9PiB7XG4gICAgY29uc3QgY29tcHJlc3NlZDogT2ZmbGluZU9wZXJhdGlvbltdID0gW11cbiAgICBsZXQgb3JpZ2luYWxTaXplID0gMFxuICAgIGxldCBjb21wcmVzc2VkU2l6ZSA9IDBcbiAgICBcbiAgICBmb3IgKGNvbnN0IG9wZXJhdGlvbiBvZiBvcGVyYXRpb25zKSB7XG4gICAgICBvcmlnaW5hbFNpemUgKz0gSlNPTi5zdHJpbmdpZnkob3BlcmF0aW9uLmRhdGEpLmxlbmd0aFxuICAgICAgXG4gICAgICAvLyDlr7nlpKfmlbDmja7ov5vooYzljovnvKlcbiAgICAgIGlmIChKU09OLnN0cmluZ2lmeShvcGVyYXRpb24uZGF0YSkubGVuZ3RoID4gMTAyNCkge1xuICAgICAgICBjb25zdCBjb21wcmVzc2VkT3AgPSB7XG4gICAgICAgICAgLi4ub3BlcmF0aW9uLFxuICAgICAgICAgIGRhdGE6IGF3YWl0IHRoaXMuY29tcHJlc3NEYXRhKG9wZXJhdGlvbi5kYXRhKVxuICAgICAgICB9XG4gICAgICAgIGNvbXByZXNzZWQucHVzaChjb21wcmVzc2VkT3ApXG4gICAgICAgIGNvbXByZXNzZWRTaXplICs9IEpTT04uc3RyaW5naWZ5KGNvbXByZXNzZWRPcC5kYXRhKS5sZW5ndGhcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbXByZXNzZWQucHVzaChvcGVyYXRpb24pXG4gICAgICAgIGNvbXByZXNzZWRTaXplICs9IEpTT04uc3RyaW5naWZ5KG9wZXJhdGlvbi5kYXRhKS5sZW5ndGhcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbXByZXNzZWQsXG4gICAgICBjb21wcmVzc2lvblJhdGlvOiBvcmlnaW5hbFNpemUgPiAwID8gY29tcHJlc3NlZFNpemUgLyBvcmlnaW5hbFNpemUgOiAxXG4gICAgfVxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOWvvOWHuuWNleS+i+WunuS+i1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3Qgb2ZmbGluZU1hbmFnZXIgPSBuZXcgT2ZmbGluZU1hbmFnZXIoKVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDkvr/liKnmlrnms5Xlr7zlh7pcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IGV4ZWN1dGVPZmZsaW5lT3BlcmF0aW9uID0gKG9wZXJhdGlvbjogYW55KSA9PiBcbiAgb2ZmbGluZU1hbmFnZXIuZXhlY3V0ZU9mZmxpbmVPcGVyYXRpb24ob3BlcmF0aW9uKVxuXG5leHBvcnQgY29uc3QgZXhlY3V0ZUJhdGNoT2ZmbGluZU9wZXJhdGlvbnMgPSAob3BlcmF0aW9uczogYW55W10pID0+IFxuICBvZmZsaW5lTWFuYWdlci5leGVjdXRlQmF0Y2hPZmZsaW5lT3BlcmF0aW9ucyhvcGVyYXRpb25zKVxuXG5leHBvcnQgY29uc3QgZ2V0T2ZmbGluZVN0YXRzID0gKCkgPT4gb2ZmbGluZU1hbmFnZXIuZ2V0T2ZmbGluZVN0YXRzKClcbmV4cG9ydCBjb25zdCBnZXROZXR3b3JrU3RhdHVzID0gKCkgPT4gb2ZmbGluZU1hbmFnZXIuZ2V0TmV0d29ya1N0YXR1cygpXG5leHBvcnQgY29uc3QgcmV0cnlGYWlsZWRPcGVyYXRpb25zID0gKCkgPT4gb2ZmbGluZU1hbmFnZXIucmV0cnlGYWlsZWRPcGVyYXRpb25zKCkiXSwidmVyc2lvbiI6M30=