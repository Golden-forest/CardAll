{"file":"D:\\Projects\\CardEverything\\cardall-prototype\\src\\__tests__\\services\\data-migration\\test-utils.ts","mappings":"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","names":[],"sources":["D:\\Projects\\CardEverything\\cardall-prototype\\src\\__tests__\\services\\data-migration\\test-utils.ts"],"sourcesContent":["/**\n * 数据迁移测试工具函数\n */\n\nimport { DataMigrationTool, MigrationSource, MigrationPlan, MigrationResult } from '@/services/data-migration-tool'\nimport { Card, Folder, Tag } from '@/types/card'\n\n// 测试数据工厂\nexport class TestDataFactory {\n  /**\n   * 创建测试卡片\n   */\n  static createTestCard(overrides: Partial<Card> = {}): Card {\n    return {\n      id: `card-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      frontContent: {\n        title: '测试卡片正面',\n        text: '这是卡片的正面内容',\n        tags: ['测试', '示例'],\n        images: []\n      },\n      backContent: {\n        title: '测试卡片背面',\n        text: '这是卡片的背面内容',\n        tags: ['测试', '示例'],\n        images: []\n      },\n      folderId: 'test-folder',\n      createdAt: new Date('2024-01-01'),\n      updatedAt: new Date('2024-01-01'),\n      ...overrides\n    }\n  }\n\n  /**\n   * 创建测试文件夹\n   */\n  static createTestFolder(overrides: Partial<Folder> = {}): Folder {\n    return {\n      id: `folder-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      name: '测试文件夹',\n      parentId: null,\n      color: '#4f46e5',\n      icon: 'folder',\n      createdAt: new Date('2024-01-01'),\n      updatedAt: new Date('2024-01-01'),\n      ...overrides\n    }\n  }\n\n  /**\n   * 创建测试标签\n   */\n  static createTestTag(overrides: Partial<Tag> = {}): Tag {\n    return {\n      id: `tag-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      name: '测试标签',\n      color: '#ef4444',\n      count: 0,\n      createdAt: new Date('2024-01-01'),\n      ...overrides\n    }\n  }\n\n  /**\n   * 创建包含图片的卡片\n   */\n  static createCardWithImage(overrides: Partial<Card> = {}): Card {\n    const base64Image = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k='\n\n    return {\n      ...this.createTestCard(overrides),\n      frontContent: {\n        ...this.createTestCard(overrides).frontContent,\n        images: [{\n          id: 'test-image',\n          url: base64Image,\n          alt: '测试图片',\n          width: 100,\n          height: 100\n        }]\n      }\n    }\n  }\n\n  /**\n   * 创建大量测试数据\n   */\n  static createBulkTestData(\n    cardCount: number = 100,\n    folderCount: number = 10,\n    tagCount: number = 20\n  ) {\n    const folders: Folder[] = []\n    const tags: Tag[] = []\n    const cards: Card[] = []\n\n    // 创建文件夹\n    for (let i = 0; i < folderCount; i++) {\n      folders.push(this.createTestFolder({\n        id: `folder-${i}`,\n        name: `测试文件夹 ${i + 1}`,\n        parentId: i > 0 ? `folder-${Math.floor((i - 1) / 5)}` : null\n      }))\n    }\n\n    // 创建标签\n    for (let i = 0; i < tagCount; i++) {\n      tags.push(this.createTestTag({\n        id: `tag-${i}`,\n        name: `测试标签 ${i + 1}`,\n        color: `#${Math.floor(Math.random()*16777215).toString(16)}`\n      }))\n    }\n\n    // 创建卡片\n    for (let i = 0; i < cardCount; i++) {\n      const cardTags = tags\n        .sort(() => Math.random() - 0.5)\n        .slice(0, Math.floor(Math.random() * 3) + 1)\n        .map(tag => tag.name)\n\n      cards.push(this.createTestCard({\n        id: `card-${i}`,\n        folderId: folders[Math.floor(Math.random() * folders.length)].id,\n        frontContent: {\n          title: `测试卡片 ${i + 1}`,\n          text: `这是第 ${i + 1} 个测试卡片`,\n          tags: cardTags,\n          images: i % 10 === 0 ? [{\n            id: `image-${i}`,\n            url: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k=',\n            alt: `图片 ${i + 1}`,\n            width: 100,\n            height: 100\n          }] : []\n        }\n      }))\n    }\n\n    return { folders, tags, cards }\n  }\n\n  /**\n   * 创建损坏的测试数据\n   */\n  static createCorruptedTestData() {\n    return {\n      invalidCard: {\n        id: 'invalid-card',\n        frontContent: null as any, // 缺少必需字段\n        backContent: { title: '', text: '' },\n        createdAt: 'invalid-date' as any,\n        updatedAt: new Date()\n      },\n      invalidFolder: {\n        id: 'invalid-folder',\n        name: '', // 空名称\n        parentId: 'non-existent',\n        color: 'invalid-color',\n        icon: 'folder',\n        createdAt: new Date(),\n        updatedAt: new Date()\n      },\n      invalidTag: {\n        id: 'invalid-tag',\n        name: '', // 空名称\n        color: '#invalid',\n        count: -1, // 负数\n        createdAt: new Date()\n      }\n    }\n  }\n}\n\n// Mock 工具\nexport class MockDatabase {\n  private data: {\n    cards: any[]\n    folders: any[]\n    tags: any[]\n    images: any[]\n    settings: any[]\n    syncQueue: any[]\n  } = {\n    cards: [],\n    folders: [],\n    tags: [],\n    images: [],\n    settings: [],\n    syncQueue: []\n  }\n\n  async clear() {\n    Object.keys(this.data).forEach(key => {\n      this.data[key as keyof typeof this.data] = []\n    })\n  }\n\n  // 卡片操作\n  async addCard(card: any) {\n    this.data.cards.push({ ...card, id: card.id || `card-${Date.now()}` })\n    return this.data.cards[this.data.cards.length - 1]\n  }\n\n  async getCards() {\n    return this.data.cards\n  }\n\n  // 文件夹操作\n  async addFolder(folder: any) {\n    this.data.folders.push({ ...folder, id: folder.id || `folder-${Date.now()}` })\n    return this.data.folders[this.data.folders.length - 1]\n  }\n\n  async getFolders() {\n    return this.data.folders\n  }\n\n  // 标签操作\n  async addTag(tag: any) {\n    this.data.tags.push({ ...tag, id: tag.id || `tag-${Date.now()}` })\n    return this.data.tags[this.data.tags.length - 1]\n  }\n\n  async getTags() {\n    return this.data.tags\n  }\n\n  // 设置操作\n  async addSetting(key: string, value: any) {\n    const setting = {\n      key,\n      value,\n      updatedAt: new Date(),\n      scope: 'global'\n    }\n    this.data.settings.push(setting)\n    return setting\n  }\n\n  async getSetting(key: string) {\n    return this.data.settings.find(s => s.key === key)?.value\n  }\n\n  // 统计信息\n  async getStats() {\n    return {\n      cards: this.data.cards.length,\n      folders: this.data.folders.length,\n      tags: this.data.tags.length,\n      images: this.data.images.length,\n      pendingSync: this.data.syncQueue.length,\n      totalSize: JSON.stringify(this.data).length,\n      version: '4.0.0'\n    }\n  }\n\n  // 模拟数据库健康检查\n  async healthCheck() {\n    return {\n      isHealthy: true,\n      issues: []\n    }\n  }\n\n  // 清空所有数据\n  async clearAll() {\n    await this.clear()\n  }\n}\n\n// 测试辅助函数\nexport class MigrationTestHelpers {\n  /**\n   * 设置localStorage测试数据\n   */\n  static setupLocalStorageData(data: { cards?: Card[]; folders?: Folder[]; tags?: Tag[] }) {\n    if (data.cards) {\n      localStorage.setItem('cardall-cards', JSON.stringify(data.cards))\n    }\n    if (data.folders) {\n      localStorage.setItem('cardall-folders', JSON.stringify(data.folders))\n    }\n    if (data.tags) {\n      localStorage.setItem('cardall-tags', JSON.stringify(data.tags))\n    }\n    if (data.cards?.some(card => card.frontContent.images.length > 0)) {\n      localStorage.setItem('cardall-hidden-tags', JSON.stringify(['image-test']))\n    }\n  }\n\n  /**\n   * 清理localStorage\n   */\n  static cleanupLocalStorage() {\n    localStorage.removeItem('cardall-cards')\n    localStorage.removeItem('cardall-folders')\n    localStorage.removeItem('cardall-tags')\n    localStorage.removeItem('cardall-hidden-tags')\n  }\n\n  /**\n   * 模拟IndexedDB数据库\n   */\n  static mockIndexedDB(data: any = {}) {\n    const mockDb = {\n      open: jest.fn().mockResolvedValue({}),\n      close: jest.fn(),\n      delete: jest.fn().mockResolvedValue({}),\n      cards: {\n        count: jest.fn().mockResolvedValue(data.cards?.length || 0),\n        toArray: jest.fn().mockResolvedValue(data.cards || []),\n        bulkAdd: jest.fn().mockResolvedValue(undefined)\n      },\n      folders: {\n        count: jest.fn().mockResolvedValue(data.folders?.length || 0),\n        toArray: jest.fn().mockResolvedValue(data.folders || []),\n        bulkAdd: jest.fn().mockResolvedValue(undefined)\n      },\n      tags: {\n        count: jest.fn().mockResolvedValue(data.tags?.length || 0),\n        toArray: jest.fn().mockResolvedValue(data.tags || []),\n        bulkAdd: jest.fn().mockResolvedValue(undefined)\n      },\n      images: {\n        count: jest.fn().mockResolvedValue(data.images?.length || 0),\n        toArray: jest.fn().mockResolvedValue(data.images || []),\n        bulkAdd: jest.fn().mockResolvedValue(undefined)\n      },\n      syncQueue: {\n        count: jest.fn().mockResolvedValue(data.syncQueue?.length || 0),\n        toArray: jest.fn().mockResolvedValue(data.syncQueue || []),\n        bulkAdd: jest.fn().mockResolvedValue(undefined)\n      }\n    }\n\n    // 模拟Dexie构造函数\n    const OriginalDexie = (global as any).Dexie\n    ;(global as any).Dexie = jest.fn().mockImplementation(() => mockDb)\n\n    return mockDb\n  }\n\n  /**\n   * 恢复原始Dexie\n   */\n  static restoreIndexedDB() {\n    const OriginalDexie = (global as any).OriginalDexie\n    if (OriginalDexie) {\n      ;(global as any).Dexie = OriginalDexie\n    }\n  }\n\n  /**\n   * 创建迁移进度监听器\n   */\n  static createProgressListener() {\n    const progressEvents: any[] = []\n    const callback = jest.fn((progress) => {\n      progressEvents.push(progress)\n    })\n\n    return {\n      callback,\n      getEvents: () => progressEvents,\n      clearEvents: () => {\n        progressEvents.length = 0\n      },\n      getLastEvent: () => progressEvents[progressEvents.length - 1]\n    }\n  }\n\n  /**\n   * 验证迁移结果\n   */\n  static validateMigrationResult(\n    result: MigrationResult,\n    expectations: {\n      success?: boolean\n      migratedCards?: number\n      migratedFolders?: number\n      migratedTags?: number\n      migratedImages?: number\n      hasErrors?: boolean\n      hasWarnings?: boolean\n    }\n  ) {\n    if (expectations.success !== undefined) {\n      expect(result.success).toBe(expectations.success)\n    }\n\n    if (expectations.migratedCards !== undefined) {\n      expect(result.migratedCards).toBe(expectations.migratedCards)\n    }\n\n    if (expectations.migratedFolders !== undefined) {\n      expect(result.migratedFolders).toBe(expectations.migratedFolders)\n    }\n\n    if (expectations.migratedTags !== undefined) {\n      expect(result.migratedTags).toBe(expectations.migratedTags)\n    }\n\n    if (expectations.migratedImages !== undefined) {\n      expect(result.migratedImages).toBe(expectations.migratedImages)\n    }\n\n    if (expectations.hasErrors !== undefined) {\n      expect(result.errors.length > 0).toBe(expectations.hasErrors)\n    }\n\n    if (expectations.hasWarnings !== undefined) {\n      expect(result.warnings.length > 0).toBe(expectations.hasWarnings)\n    }\n\n    // 基本验证\n    expect(result.planId).toBeDefined()\n    expect(result.executedAt).toBeInstanceOf(Date)\n    expect(result.duration).toBeGreaterThan(0)\n    expect(result.stepsCompleted).toBeGreaterThanOrEqual(0)\n    expect(result.totalSteps).toBeGreaterThan(0)\n  }\n\n  /**\n   * 验证迁移计划\n   */\n  static validateMigrationPlan(\n    plan: MigrationPlan,\n    expectations: {\n      sourceType?: string\n      backupRequired?: boolean\n      rollbackEnabled?: boolean\n      minSteps?: number\n      validationLevel?: string\n    }\n  ) {\n    if (expectations.sourceType !== undefined) {\n      expect(plan.source.type).toBe(expectations.sourceType)\n    }\n\n    if (expectations.backupRequired !== undefined) {\n      expect(plan.backupRequired).toBe(expectations.backupRequired)\n    }\n\n    if (expectations.rollbackEnabled !== undefined) {\n      expect(plan.rollbackEnabled).toBe(expectations.rollbackEnabled)\n    }\n\n    if (expectations.minSteps !== undefined) {\n      expect(plan.steps.length).toBeGreaterThanOrEqual(expectations.minSteps)\n    }\n\n    if (expectations.validationLevel !== undefined) {\n      expect(plan.validationLevel).toBe(expectations.validationLevel)\n    }\n\n    // 基本验证\n    expect(plan.id).toBeDefined()\n    expect(plan.target.version).toBe('4.0.0')\n    expect(plan.target.database).toBe('CardAllUnifiedDatabase')\n    expect(plan.estimatedTime).toBeGreaterThan(0)\n    expect(plan.steps.length).toBeGreaterThan(0)\n  }\n\n  /**\n   * 等待异步操作完成\n   */\n  static async waitFor(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms))\n  }\n\n  /**\n   * 重试函数直到成功\n   */\n  static async retry<T>(\n    fn: () => Promise<T>,\n    maxAttempts: number = 3,\n    delay: number = 100\n  ): Promise<T> {\n    let lastError: Error\n\n    for (let i = 0; i < maxAttempts; i++) {\n      try {\n        return await fn()\n      } catch (error) {\n        lastError = error as Error\n        if (i < maxAttempts - 1) {\n          await this.waitFor(delay)\n        }\n      }\n    }\n\n    throw lastError!\n  }\n}\n\nexport {\n  TestDataFactory,\n  MockDatabase,\n  MigrationTestHelpers\n}"],"version":3}