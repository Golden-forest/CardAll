16aa60deff6ea98fd894bd293d1550aa
"use strict";
// ============================================================================
// 网络状态检测和监控服务
// ============================================================================
Object.defineProperty(exports, "__esModule", { value: true });
exports.getNetworkStrategy = exports.waitForNetwork = exports.networkMonitorService = exports.NetworkMonitorService = exports.DEFAULT_NETWORK_CONFIG = void 0;
// 默认配置
exports.DEFAULT_NETWORK_CONFIG = {
    checkInterval: 5000, // 5秒
    qualityCheckInterval: 30000, // 30秒
    qualityThresholds: {
        excellent: { rtt: 100, downlink: 10 }, // <100ms, >10Mbps
        good: { rtt: 200, downlink: 5 }, // <200ms, >5Mbps
        fair: { rtt: 500, downlink: 1 }, // <500ms, >1Mbps
        poor: { rtt: 1000, downlink: 0.1 } // <1000ms, >0.1Mbps
    },
    reconnect: {
        maxAttempts: 10,
        initialDelay: 1000,
        maxDelay: 30000,
        backoffMultiplier: 2
    },
    healthCheck: {
        enabled: true,
        endpoints: [
            'https://www.google.com',
            'https://www.cloudflare.com',
            'https://www.github.com'
        ],
        timeout: 5000,
        successThreshold: 2 // 需要2个成功才认为网络健康
    },
    eventFilter: {
        minQualityChange: 0.1, // 10%质量变化才触发事件
        debounceTime: 1000
    }
};
// ============================================================================
// 网络监控服务
// ============================================================================
class NetworkMonitorService {
    constructor(config = {}) {
        Object.defineProperty(this, "config", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "currentState", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "isMonitoring", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "checkTimer", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: null
        });
        Object.defineProperty(this, "qualityTimer", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: null
        });
        Object.defineProperty(this, "reconnectTimer", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: null
        });
        Object.defineProperty(this, "debounceTimer", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: null
        });
        // 事件监听器
        Object.defineProperty(this, "listeners", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Set()
        });
        // 统计信息
        Object.defineProperty(this, "stats", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "startTime", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "lastOnlineTime", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "lastOfflineTime", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // 连接API（如果可用）
        Object.defineProperty(this, "connection", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "connectionTypes", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: ['wifi', 'cellular', 'ethernet', 'bluetooth', 'wimax', 'other', 'none']
        });
        // 重连状态
        Object.defineProperty(this, "reconnectAttempts", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 0
        });
        Object.defineProperty(this, "isReconnecting", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        this.config = { ...exports.DEFAULT_NETWORK_CONFIG, ...config };
        this.currentState = this.getInitialNetworkState();
        this.stats = this.getInitialStats();
        this.startTime = new Date();
        this.initialize();
    }
    // 初始化服务
    initialize() {
        // 获取网络连接API（如果可用）
        if ('connection' in navigator) {
            this.connection = navigator.connection;
        }
        // 监听在线/离线事件
        window.addEventListener('online', this.handleOnline.bind(this));
        window.addEventListener('offline', this.handleOffline.bind(this));
        // 监听连接变化（如果支持）
        if (this.connection) {
            this.connection.addEventListener('change', this.handleConnectionChange.bind(this));
        }
        console.log('NetworkMonitorService initialized');
    }
    // 获取初始网络状态
    getInitialNetworkState() {
        return {
            online: navigator.onLine,
            connectionType: this.getConnectionType(),
            effectiveType: this.getEffectiveType(),
            downlink: this.connection?.downlink,
            rtt: this.connection?.rtt,
            saveData: this.connection?.saveData,
            deviceMemory: navigator.deviceMemory,
            hardwareConcurrency: navigator.hardwareConcurrency,
            timestamp: new Date()
        };
    }
    // 获取初始统计信息
    getInitialStats() {
        return {
            connectionChanges: 0,
            onlineTime: 0,
            offlineTime: 0,
            averageQuality: 0,
            qualityHistory: [],
            averageRtt: 0,
            averageDownlink: 0,
            errorCount: 0,
            reconnectAttempts: 0,
            successfulReconnects: 0
        };
    }
    // ============================================================================
    // 公共方法
    // ============================================================================
    // 开始监控
    startMonitoring() {
        if (this.isMonitoring)
            return;
        this.isMonitoring = true;
        this.startPeriodicChecks();
        console.log('Network monitoring started');
        this.emitEvent({
            type: 'connection-change',
            timestamp: new Date(),
            currentState: this.currentState,
            details: { action: 'monitoring_started' }
        });
    }
    // 停止监控
    stopMonitoring() {
        if (!this.isMonitoring)
            return;
        this.isMonitoring = false;
        this.stopPeriodicChecks();
        console.log('Network monitoring stopped');
        this.emitEvent({
            type: 'connection-change',
            timestamp: new Date(),
            currentState: this.currentState,
            details: { action: 'monitoring_stopped' }
        });
    }
    // 获取当前网络状态
    getCurrentState() {
        return { ...this.currentState };
    }
    // 获取网络质量
    getNetworkQuality() {
        return this.calculateQuality(this.currentState);
    }
    // 获取网络质量分数（0-1）
    getNetworkQualityScore() {
        return this.calculateQualityScore(this.currentState);
    }
    // 获取统计信息
    getStats() {
        return { ...this.stats };
    }
    // 手动触发网络检查
    async checkNetwork() {
        const newState = await this.getCurrentNetworkInfo();
        await this.updateNetworkState(newState);
        return newState;
    }
    // 执行健康检查
    async performHealthCheck() {
        if (!this.config.healthCheck.enabled) {
            return this.currentState.online;
        }
        try {
            const promises = this.config.healthCheck.endpoints.map(endpoint => this.pingEndpoint(endpoint, this.config.healthCheck.timeout));
            const results = await Promise.allSettled(promises);
            const successCount = results.filter(result => result.status === 'fulfilled' && result.value).length;
            const isHealthy = successCount >= this.config.healthCheck.successThreshold;
            console.log(`Health check: ${successCount}/${this.config.healthCheck.endpoints.length} successful`);
            return isHealthy;
        }
        catch (error) {
            console.error('Health check failed:', error);
            return false;
        }
    }
    // ============================================================================
    // 事件监听器
    // ============================================================================
    // 添加事件监听器
    addEventListener(callback) {
        this.listeners.add(callback);
    }
    // 移除事件监听器
    removeEventListener(callback) {
        this.listeners.delete(callback);
    }
    // 发送事件
    emitEvent(event) {
        // 防抖处理
        if (this.config.eventFilter.debounceTime > 0) {
            if (this.debounceTimer) {
                clearTimeout(this.debounceTimer);
            }
            this.debounceTimer = setTimeout(() => {
                this.listeners.forEach(listener => {
                    try {
                        listener(event);
                    }
                    catch (error) {
                        console.error('Error in network event listener:', error);
                    }
                });
            }, this.config.eventFilter.debounceTime);
        }
        else {
            this.listeners.forEach(listener => {
                try {
                    listener(event);
                }
                catch (error) {
                    console.error('Error in network event listener:', error);
                }
            });
        }
    }
    // ============================================================================
    // 网络状态更新
    // ============================================================================
    // 处理在线事件
    async handleOnline() {
        console.log('Network online event detected');
        const previousState = { ...this.currentState };
        this.currentState.online = true;
        this.currentState.lastChange = new Date();
        this.lastOnlineTime = new Date();
        // 更新统计
        if (this.lastOfflineTime) {
            this.stats.offlineTime += Date.now() - this.lastOfflineTime.getTime();
            this.lastOfflineTime = undefined;
        }
        // 停止重连尝试
        this.stopReconnectAttempts();
        this.emitEvent({
            type: 'online',
            timestamp: new Date(),
            previousState,
            currentState: this.currentState
        });
        // 立即检查网络质量
        await this.checkNetwork();
    }
    // 处理离线事件
    handleOffline() {
        console.log('Network offline event detected');
        const previousState = { ...this.currentState };
        this.currentState.online = false;
        this.currentState.lastChange = new Date();
        this.lastOfflineTime = new Date();
        // 更新统计
        if (this.lastOnlineTime) {
            this.stats.onlineTime += Date.now() - this.lastOnlineTime.getTime();
        }
        this.emitEvent({
            type: 'offline',
            timestamp: new Date(),
            previousState,
            currentState: this.currentState
        });
        // 开始重连尝试
        this.startReconnectAttempts();
    }
    // 处理连接变化
    async handleConnectionChange() {
        console.log('Network connection change detected');
        const previousState = { ...this.currentState };
        const newState = await this.getCurrentNetworkInfo();
        // 检查是否有显著变化
        const qualityChange = Math.abs(this.calculateQualityScore(newState) - this.calculateQualityScore(previousState));
        if (qualityChange >= this.config.eventFilter.minQualityChange) {
            this.currentState = newState;
            this.currentState.lastChange = new Date();
            this.stats.connectionChanges++;
            this.emitEvent({
                type: 'connection-change',
                timestamp: new Date(),
                previousState,
                currentState: this.currentState
            });
        }
    }
    // 更新网络状态
    async updateNetworkState(newState) {
        const previousState = { ...this.currentState };
        const qualityChange = Math.abs(this.calculateQualityScore(newState) - this.calculateQualityScore(previousState));
        // 只在质量变化显著时更新
        if (qualityChange >= this.config.eventFilter.minQualityChange) {
            this.currentState = newState;
            this.currentState.lastChange = new Date();
            // 更新质量历史
            this.updateQualityHistory();
            // 发送质量变化事件
            this.emitEvent({
                type: 'quality-change',
                timestamp: new Date(),
                previousState,
                currentState: this.currentState,
                details: {
                    qualityChange,
                    previousQuality: this.calculateQuality(previousState),
                    currentQuality: this.calculateQuality(newState)
                }
            });
        }
    }
    // ============================================================================
    // 定期检查
    // ============================================================================
    // 启动定期检查
    startPeriodicChecks() {
        // 基础网络状态检查
        this.checkTimer = setInterval(async () => {
            if (this.isMonitoring) {
                await this.checkNetwork();
            }
        }, this.config.checkInterval);
        // 网络质量检查
        this.qualityTimer = setInterval(async () => {
            if (this.isMonitoring) {
                await this.performQualityCheck();
            }
        }, this.config.qualityCheckInterval);
    }
    // 停止定期检查
    stopPeriodicChecks() {
        if (this.checkTimer) {
            clearInterval(this.checkTimer);
            this.checkTimer = null;
        }
        if (this.qualityTimer) {
            clearInterval(this.qualityTimer);
            this.qualityTimer = null;
        }
    }
    // 执行质量检查
    async performQualityCheck() {
        try {
            const healthStatus = await this.performHealthCheck();
            if (!healthStatus && this.currentState.online) {
                // 网络显示在线但健康检查失败
                console.warn('Network appears online but health check failed');
                this.currentState.online = false;
                this.currentState.lastChange = new Date();
                this.emitEvent({
                    type: 'error',
                    timestamp: new Date(),
                    currentState: this.currentState,
                    details: { message: 'Health check failed despite online status' }
                });
            }
        }
        catch (error) {
            console.error('Quality check failed:', error);
            this.stats.errorCount++;
        }
    }
    // ============================================================================
    // 重连机制
    // ============================================================================
    // 开始重连尝试
    startReconnectAttempts() {
        if (this.isReconnecting)
            return;
        this.isReconnecting = true;
        this.reconnectAttempts = 0;
        this.scheduleReconnectAttempt();
    }
    // 停止重连尝试
    stopReconnectAttempts() {
        this.isReconnecting = false;
        if (this.reconnectTimer) {
            clearTimeout(this.reconnectTimer);
            this.reconnectTimer = null;
        }
    }
    // 安排重连尝试
    scheduleReconnectAttempt() {
        if (!this.isReconnecting || this.reconnectAttempts >= this.config.reconnect.maxAttempts) {
            this.isReconnecting = false;
            return;
        }
        const delay = Math.min(this.config.reconnect.initialDelay * Math.pow(this.config.reconnect.backoffMultiplier, this.reconnectAttempts), this.config.reconnect.maxDelay);
        this.reconnectTimer = setTimeout(async () => {
            this.reconnectAttempts++;
            this.stats.reconnectAttempts++;
            console.log(`Reconnect attempt ${this.reconnectAttempts}/${this.config.reconnect.maxAttempts}`);
            try {
                const isOnline = navigator.onLine;
                if (isOnline) {
                    const healthStatus = await this.performHealthCheck();
                    if (healthStatus) {
                        this.stats.successfulReconnects++;
                        this.isReconnecting = false;
                        console.log('Reconnect successful');
                        this.emitEvent({
                            type: 'online',
                            timestamp: new Date(),
                            currentState: this.currentState,
                            details: { reconnectAttempts: this.reconnectAttempts }
                        });
                        await this.handleOnline();
                        return;
                    }
                }
            }
            catch (error) {
                console.error('Reconnect attempt failed:', error);
            }
            // 继续下一次重连
            this.scheduleReconnectAttempt();
        }, delay);
    }
    // ============================================================================
    // 工具方法
    // ============================================================================
    // 获取当前网络信息
    async getCurrentNetworkInfo() {
        const baseInfo = this.getInitialNetworkState();
        // 执行健康检查获取更准确的状态
        if (this.config.healthCheck.enabled) {
            try {
                const isHealthy = await this.performHealthCheck();
                baseInfo.online = isHealthy && navigator.onLine;
            }
            catch (error) {
                console.warn('Health check failed, using navigator.onLine:', error);
            }
        }
        // 使用增强的网络状态检测
        if (baseInfo.online) {
            try {
                const enhancedInfo = await this.getEnhancedNetworkInfo();
                return { ...baseInfo, ...enhancedInfo };
            }
            catch (error) {
                console.warn('Enhanced network info failed, using basic info:', error);
            }
        }
        return baseInfo;
    }
    // 获取连接类型
    getConnectionType() {
        if (!this.connection)
            return 'none';
        const type = this.connection.type;
        return this.connectionTypes.includes(type) ? type : 'other';
    }
    // 获取有效连接类型
    getEffectiveType() {
        if (!this.connection)
            return 'unknown';
        const effectiveType = this.connection.effectiveType;
        return ['4g', '3g', '2g', 'slow-2g'].includes(effectiveType) ? effectiveType : 'unknown';
    }
    // 计算网络质量
    calculateQuality(info) {
        const score = this.calculateQualityScore(info);
        if (score >= 0.8)
            return 'excellent';
        if (score >= 0.6)
            return 'good';
        if (score >= 0.4)
            return 'fair';
        if (score >= 0.2)
            return 'poor';
        return 'offline';
    }
    // 计算网络质量分数（0-1）
    calculateQualityScore(info) {
        if (!info.online)
            return 0;
        let score = 0.5; // 基础分数（在线）
        // RTT评分
        if (info.rtt !== undefined) {
            if (info.rtt <= 100)
                score += 0.3;
            else if (info.rtt <= 200)
                score += 0.2;
            else if (info.rtt <= 500)
                score += 0.1;
        }
        // 下行速度评分
        if (info.downlink !== undefined) {
            if (info.downlink >= 10)
                score += 0.3;
            else if (info.downlink >= 5)
                score += 0.2;
            else if (info.downlink >= 1)
                score += 0.1;
        }
        // 连接类型评分
        if (info.connectionType === 'wifi' || info.connectionType === 'ethernet') {
            score += 0.1;
        }
        // 省数据模式扣分
        if (info.saveData) {
            score -= 0.1;
        }
        return Math.max(0, Math.min(1, score));
    }
    // 更新质量历史
    updateQualityHistory() {
        const quality = this.getNetworkQuality();
        const score = this.getNetworkQualityScore();
        this.stats.qualityHistory.push({
            timestamp: new Date(),
            quality,
            score
        });
        // 保留最近100条记录
        if (this.stats.qualityHistory.length > 100) {
            this.stats.qualityHistory = this.stats.qualityHistory.slice(-100);
        }
        // 更新平均质量
        const recentHistory = this.stats.qualityHistory.slice(-20); // 最近20条
        if (recentHistory.length > 0) {
            this.stats.averageQuality = recentHistory.reduce((sum, item) => sum + item.score, 0) / recentHistory.length;
        }
    }
    // Ping端点
    async pingEndpoint(endpoint, timeout) {
        try {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), timeout);
            const startTime = performance.now();
            const response = await fetch(`${endpoint}/favicon.ico`, {
                method: 'HEAD',
                signal: controller.signal,
                mode: 'no-cors',
                headers: {
                    'Cache-Control': 'no-cache',
                    'Pragma': 'no-cache'
                }
            });
            clearTimeout(timeoutId);
            const duration = performance.now() - startTime;
            // 记录响应时间用于网络质量评估
            this.recordResponseTime(duration);
            return true;
        }
        catch (error) {
            this.recordError('ping_failed', { endpoint, error: error instanceof Error ? error.message : String(error) });
            return false;
        }
    }
    // ============================================================================
    // 增强网络状态检测方法
    // ============================================================================
    /**
     * 记录响应时间用于质量评估
     */
    recordResponseTime(duration) {
        // 更新平均RTT统计
        if (this.stats.averageRtt === 0) {
            this.stats.averageRtt = duration;
        }
        else {
            // 指数移动平均
            this.stats.averageRtt = this.stats.averageRtt * 0.8 + duration * 0.2;
        }
        // 记录到历史记录
        this.stats.qualityHistory.push({
            timestamp: new Date(),
            quality: this.calculateQuality(this.currentState),
            score: this.calculateQualityScore(this.currentState)
        });
        // 保持历史记录在合理范围内
        if (this.stats.qualityHistory.length > 100) {
            this.stats.qualityHistory = this.stats.qualityHistory.slice(-50);
        }
    }
    /**
     * 记录错误信息
     */
    recordError(type, details) {
        this.stats.errorCount++;
        this.stats.lastError = new Error(`${type}: ${JSON.stringify(details)}`);
        // 发送错误事件
        this.emitEvent({
            type: 'error',
            timestamp: new Date(),
            currentState: this.currentState,
            details: { type, details }
        });
    }
    /**
     * 增强的网络状态评估
     */
    async getEnhancedNetworkInfo() {
        const baseInfo = await this.getCurrentNetworkInfo();
        // 执行更深入的网络质量分析
        const qualityAnalysis = await this.performQualityAnalysis();
        return {
            ...baseInfo,
            ...qualityAnalysis
        };
    }
    /**
     * 执行网络质量分析
     */
    async performQualityAnalysis() {
        const analysis = {};
        try {
            // 测量实际下载速度
            const downloadSpeed = await this.measureDownloadSpeed();
            if (downloadSpeed > 0) {
                analysis.downlink = downloadSpeed;
            }
            // 测量实际延迟
            const latency = await this.measureLatency();
            if (latency > 0) {
                analysis.rtt = latency;
            }
            // 检测网络抖动
            const jitter = await this.measureJitter();
            if (jitter > 0) {
                // 将抖动信息添加到扩展属性
                analysis.jitter = jitter;
            }
            // 检测丢包率
            const packetLoss = await this.estimatePacketLoss();
            if (packetLoss >= 0) {
                this.stats.packetLoss = packetLoss;
            }
        }
        catch (error) {
            console.warn('Quality analysis failed:', error);
        }
        return analysis;
    }
    /**
     * 测量下载速度
     */
    async measureDownloadSpeed() {
        try {
            const testData = new Array(1024).fill('test').join(''); // ~4KB test data
            const testUrl = `data:text/plain;base64,${btoa(testData)}`;
            const startTime = performance.now();
            const response = await fetch(testUrl);
            await response.text();
            const duration = performance.now() - startTime;
            // 计算速度 (KB/s)
            const speedKbPerSec = (testData.length / 1024) / (duration / 1000);
            return speedKbPerSec * 8 / 1024; // 转换为 Mbps
        }
        catch {
            return 0;
        }
    }
    /**
     * 测量延迟
     */
    async measureLatency() {
        try {
            const measurements = [];
            // 进行3次测量取平均值
            for (let i = 0; i < 3; i++) {
                const startTime = performance.now();
                await fetch('https://www.google.com/favicon.ico', {
                    method: 'HEAD',
                    mode: 'no-cors',
                    signal: AbortSignal.timeout(3000)
                });
                measurements.push(performance.now() - startTime);
            }
            return measurements.reduce((sum, time) => sum + time, 0) / measurements.length;
        }
        catch {
            return 0;
        }
    }
    /**
     * 测量网络抖动
     */
    async measureJitter() {
        try {
            const measurements = [];
            // 进行5次延迟测量
            for (let i = 0; i < 5; i++) {
                const startTime = performance.now();
                await fetch('https://www.cloudflare.com/favicon.ico', {
                    method: 'HEAD',
                    mode: 'no-cors',
                    signal: AbortSignal.timeout(2000)
                });
                measurements.push(performance.now() - startTime);
            }
            // 计算标准差作为抖动
            const mean = measurements.reduce((sum, time) => sum + time, 0) / measurements.length;
            const variance = measurements.reduce((sum, time) => sum + Math.pow(time - mean, 2), 0) / measurements.length;
            return Math.sqrt(variance);
        }
        catch {
            return 0;
        }
    }
    /**
     * 估算丢包率
     */
    async estimatePacketLoss() {
        try {
            const totalPings = 10;
            let successfulPings = 0;
            const pingPromises = Array(totalPings).fill(0).map(async () => {
                try {
                    await fetch('https://www.github.com/favicon.ico', {
                        method: 'HEAD',
                        mode: 'no-cors',
                        signal: AbortSignal.timeout(1000)
                    });
                    successfulPings++;
                }
                catch {
                    // Ping失败，不增加计数
                }
            });
            await Promise.allSettled(pingPromises);
            return 1 - (successfulPings / totalPings);
        }
        catch {
            return 0;
        }
    }
    /**
     * 智能网络状态预测
     */
    async predictNetworkStability() {
        const recentHistory = this.stats.qualityHistory.slice(-10);
        if (recentHistory.length < 5) {
            return {
                isStable: this.currentState.online,
                confidence: 0.5,
                predictedDuration: 300, // 5分钟
                recommendations: ['需要更多数据来进行准确预测']
            };
        }
        // 分析趋势
        const qualityTrend = this.analyzeQualityTrend(recentHistory);
        const stabilityScore = this.calculateStabilityScore(recentHistory);
        const isStable = stabilityScore > 0.7 && qualityTrend !== 'degrading';
        const confidence = Math.min(stabilityScore, recentHistory.length / 10);
        const recommendations = this.generateNetworkRecommendations(qualityTrend, stabilityScore);
        return {
            isStable,
            confidence,
            predictedDuration: this.predictStableDuration(stabilityScore),
            recommendations
        };
    }
    /**
     * 分析质量趋势
     */
    analyzeQualityTrend(history) {
        if (history.length < 3)
            return 'stable';
        const recentScores = history.slice(-3).map(h => h.score);
        const olderScores = history.slice(-6, -3).map(h => h.score);
        const recentAvg = recentScores.reduce((sum, score) => sum + score, 0) / recentScores.length;
        const olderAvg = olderScores.reduce((sum, score) => sum + score, 0) / olderScores.length;
        const change = recentAvg - olderAvg;
        if (change > 0.1)
            return 'improving';
        if (change < -0.1)
            return 'degrading';
        return 'stable';
    }
    /**
     * 计算稳定性得分
     */
    calculateStabilityScore(history) {
        if (history.length === 0)
            return 0;
        const scores = history.map(h => h.score);
        const mean = scores.reduce((sum, score) => sum + score, 0) / scores.length;
        const variance = scores.reduce((sum, score) => sum + Math.pow(score - mean, 2), 0) / scores.length;
        const standardDeviation = Math.sqrt(variance);
        // 稳定性得分基于标准差，标准差越小越稳定
        return Math.max(0, 1 - (standardDeviation / mean));
    }
    /**
     * 生成网络建议
     */
    generateNetworkRecommendations(trend, stability) {
        const recommendations = [];
        if (trend === 'degrading') {
            recommendations.push('网络质量正在下降，建议检查网络连接');
            if (stability < 0.5) {
                recommendations.push('网络连接不稳定，建议切换到更稳定的网络');
            }
        }
        else if (trend === 'improving') {
            recommendations.push('网络质量正在改善');
        }
        if (stability > 0.8) {
            recommendations.push('网络连接稳定，可以进行大量数据同步');
        }
        else if (stability < 0.5) {
            recommendations.push('建议启用数据压缩和离线模式');
        }
        return recommendations;
    }
    /**
     * 预测稳定持续时间
     */
    predictStableDuration(stabilityScore) {
        // 基于稳定性得分预测稳定持续时间（秒）
        if (stabilityScore > 0.9)
            return 3600; // 1小时
        if (stabilityScore > 0.7)
            return 1800; // 30分钟
        if (stabilityScore > 0.5)
            return 600; // 10分钟
        return 300; // 5分钟
    }
    // 销毁服务
    destroy() {
        this.stopMonitoring();
        // 清理事件监听器
        window.removeEventListener('online', this.handleOnline.bind(this));
        window.removeEventListener('offline', this.handleOffline.bind(this));
        if (this.connection) {
            this.connection.removeEventListener('change', this.handleConnectionChange.bind(this));
        }
        // 清理定时器
        if (this.debounceTimer) {
            clearTimeout(this.debounceTimer);
        }
        console.log('NetworkMonitorService destroyed');
    }
}
exports.NetworkMonitorService = NetworkMonitorService;
// 导出单例实例
exports.networkMonitorService = new NetworkMonitorService();
// ============================================================================
// 导出工具函数
// ============================================================================
// 等待网络恢复
const waitForNetwork = (timeout = 30000) => {
    return new Promise((resolve, reject) => {
        if (navigator.onLine) {
            resolve();
            return;
        }
        const timer = setTimeout(() => {
            cleanup();
            reject(new Error('Network timeout'));
        }, timeout);
        const handleOnline = () => {
            cleanup();
            resolve();
        };
        const cleanup = () => {
            clearTimeout(timer);
            window.removeEventListener('online', handleOnline);
        };
        window.addEventListener('online', handleOnline);
    });
};
exports.waitForNetwork = waitForNetwork;
// 获取最佳网络策略
const getNetworkStrategy = () => {
    const quality = exports.networkMonitorService.getNetworkQuality();
    switch (quality) {
        case 'excellent':
            return {
                batchSize: 50,
                timeout: 10000,
                retryStrategy: 'aggressive',
                compressionEnabled: false
            };
        case 'good':
            return {
                batchSize: 25,
                timeout: 15000,
                retryStrategy: 'normal',
                compressionEnabled: false
            };
        case 'fair':
            return {
                batchSize: 10,
                timeout: 30000,
                retryStrategy: 'normal',
                compressionEnabled: true
            };
        case 'poor':
            return {
                batchSize: 5,
                timeout: 60000,
                retryStrategy: 'conservative',
                compressionEnabled: true
            };
        default:
            return {
                batchSize: 1,
                timeout: 120000,
                retryStrategy: 'conservative',
                compressionEnabled: true
            };
    }
};
exports.getNetworkStrategy = getNetworkStrategy;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXG5ldHdvcmstbW9uaXRvci50cyIsIm1hcHBpbmdzIjoiO0FBQUEsK0VBQStFO0FBQy9FLGNBQWM7QUFDZCwrRUFBK0U7OztBQTRFL0UsT0FBTztBQUNNLFFBQUEsc0JBQXNCLEdBQXlCO0lBQzFELGFBQWEsRUFBRSxJQUFJLEVBQUUsS0FBSztJQUMxQixvQkFBb0IsRUFBRSxLQUFLLEVBQUUsTUFBTTtJQUVuQyxpQkFBaUIsRUFBRTtRQUNqQixTQUFTLEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsRUFBSyxrQkFBa0I7UUFDNUQsSUFBSSxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQVcsaUJBQWlCO1FBQzNELElBQUksRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFXLGlCQUFpQjtRQUMzRCxJQUFJLEVBQUUsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsQ0FBUSxvQkFBb0I7S0FDL0Q7SUFFRCxTQUFTLEVBQUU7UUFDVCxXQUFXLEVBQUUsRUFBRTtRQUNmLFlBQVksRUFBRSxJQUFJO1FBQ2xCLFFBQVEsRUFBRSxLQUFLO1FBQ2YsaUJBQWlCLEVBQUUsQ0FBQztLQUNyQjtJQUVELFdBQVcsRUFBRTtRQUNYLE9BQU8sRUFBRSxJQUFJO1FBQ2IsU0FBUyxFQUFFO1lBQ1Qsd0JBQXdCO1lBQ3hCLDRCQUE0QjtZQUM1Qix3QkFBd0I7U0FDekI7UUFDRCxPQUFPLEVBQUUsSUFBSTtRQUNiLGdCQUFnQixFQUFFLENBQUMsQ0FBQyxnQkFBZ0I7S0FDckM7SUFFRCxXQUFXLEVBQUU7UUFDWCxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsZUFBZTtRQUN0QyxZQUFZLEVBQUUsSUFBSTtLQUNuQjtDQUNGLENBQUE7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Q0wsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsYUFBYSxFQUFFLFlBQXFCO2dCQUNwQyxrQkFBa0IsRUFBRSxLQUFLO2FBQzFCLENBQUE7UUFDSCxLQUFLLE1BQU07WUFDVCxPQUFPO2dCQUNMLFNBQVMsRUFBRSxFQUFFO2dCQUNiLE9BQU8sRUFBRSxLQUFLO2dCQUNkLGFBQWEsRUFBRSxRQUFpQjtnQkFDaEMsa0JBQWtCLEVBQUUsS0FBSzthQUMxQixDQUFBO1FBQ0gsS0FBSyxNQUFNO1lBQ1QsT0FBTztnQkFDTCxTQUFTLEVBQUUsRUFBRTtnQkFDYixPQUFPLEVBQUUsS0FBSztnQkFDZCxhQUFhLEVBQUUsUUFBaUI7Z0JBQ2hDLGtCQUFrQixFQUFFLElBQUk7YUFDekIsQ0FBQTtRQUNILEtBQUssTUFBTTtZQUNULE9BQU87Z0JBQ0wsU0FBUyxFQUFFLENBQUM7Z0JBQ1osT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsYUFBYSxFQUFFLGNBQXVCO2dCQUN0QyxrQkFBa0IsRUFBRSxJQUFJO2FBQ3pCLENBQUE7UUFDSDtZQUNFLE9BQU87Z0JBQ0wsU0FBUyxFQUFFLENBQUM7Z0JBQ1osT0FBTyxFQUFFLE1BQU07Z0JBQ2YsYUFBYSxFQUFFLGNBQXVCO2dCQUN0QyxrQkFBa0IsRUFBRSxJQUFJO2FBQ3pCLENBQUE7SUFDTCxDQUFDO0FBQ0gsQ0FBQyxDQUFBO0FBN0NZLFFBQUEsa0JBQWtCLHNCQTZDOUIiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXG5ldHdvcmstbW9uaXRvci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnvZHnu5znirbmgIHmo4DmtYvlkoznm5HmjqfmnI3liqFcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy8g572R57uc6L+e5o6l5L+h5oGv5o6l5Y+jXG5leHBvcnQgaW50ZXJmYWNlIE5ldHdvcmtJbmZvIHtcbiAgLy8g5Z+656GA6L+e5o6l54q25oCBXG4gIG9ubGluZTogYm9vbGVhblxuICBjb25uZWN0aW9uVHlwZTogJ3dpZmknIHwgJ2NlbGx1bGFyJyB8ICdldGhlcm5ldCcgfCAnYmx1ZXRvb3RoJyB8ICd3aW1heCcgfCAnb3RoZXInIHwgJ25vbmUnXG4gIGVmZmVjdGl2ZVR5cGU6ICc0ZycgfCAnM2cnIHwgJzJnJyB8ICdzbG93LTJnJyB8ICd1bmtub3duJ1xuICBcbiAgLy8g6L+e5o6l6LSo6YeP5oyH5qCHXG4gIGRvd25saW5rPzogbnVtYmVyIC8vIOS4i+ihjOmAn+W6pu+8iE1icHPvvIlcbiAgcnR0PzogbnVtYmVyIC8vIOW+gOi/lOaXtumXtO+8iG1z77yJXG4gIHNhdmVEYXRhPzogYm9vbGVhbiAvLyDmmK/lkKblpITkuo7nnIHmlbDmja7mqKHlvI9cbiAgXG4gIC8vIOe9kee7nOiDveWKm1xuICBtYXhEb3dubGluaz86IG51bWJlclxuICBtYXhSdHQ/OiBudW1iZXJcbiAgXG4gIC8vIOiuvuWkh+S/oeaBr1xuICBkZXZpY2VNZW1vcnk/OiBudW1iZXIgLy8g6K6+5aSH5YaF5a2Y77yIR0LvvIlcbiAgaGFyZHdhcmVDb25jdXJyZW5jeT86IG51bWJlciAvLyBDUFXmoLjlv4PmlbBcbiAgXG4gIC8vIOaXtumXtOaIs1xuICB0aW1lc3RhbXA6IERhdGVcbiAgbGFzdENoYW5nZT86IERhdGVcbn1cblxuLy8g572R57uc54q25oCB5Y+Y5YyW5LqL5Lu2XG5leHBvcnQgaW50ZXJmYWNlIE5ldHdvcmtFdmVudCB7XG4gIHR5cGU6ICdvbmxpbmUnIHwgJ29mZmxpbmUnIHwgJ2Nvbm5lY3Rpb24tY2hhbmdlJyB8ICdxdWFsaXR5LWNoYW5nZScgfCAnZXJyb3InXG4gIHRpbWVzdGFtcDogRGF0ZVxuICBwcmV2aW91c1N0YXRlPzogTmV0d29ya0luZm9cbiAgY3VycmVudFN0YXRlOiBOZXR3b3JrSW5mb1xuICBkZXRhaWxzPzogYW55XG59XG5cbi8vIOe9kee7nOi0qOmHj+etiee6p1xuZXhwb3J0IHR5cGUgTmV0d29ya1F1YWxpdHkgPSAnZXhjZWxsZW50JyB8ICdnb29kJyB8ICdmYWlyJyB8ICdwb29yJyB8ICdvZmZsaW5lJ1xuXG4vLyDnvZHnu5znm5HmjqfphY3nva5cbmV4cG9ydCBpbnRlcmZhY2UgTmV0d29ya01vbml0b3JDb25maWcge1xuICAvLyDmo4DmtYvpl7TpmpRcbiAgY2hlY2tJbnRlcnZhbDogbnVtYmVyXG4gIHF1YWxpdHlDaGVja0ludGVydmFsOiBudW1iZXJcbiAgXG4gIC8vIOi0qOmHj+mYiOWAvFxuICBxdWFsaXR5VGhyZXNob2xkczoge1xuICAgIGV4Y2VsbGVudDogeyBydHQ6IG51bWJlcjsgZG93bmxpbms6IG51bWJlciB9XG4gICAgZ29vZDogeyBydHQ6IG51bWJlcjsgZG93bmxpbms6IG51bWJlciB9XG4gICAgZmFpcjogeyBydHQ6IG51bWJlcjsgZG93bmxpbms6IG51bWJlciB9XG4gICAgcG9vcjogeyBydHQ6IG51bWJlcjsgZG93bmxpbms6IG51bWJlciB9XG4gIH1cbiAgXG4gIC8vIOmHjei/numFjee9rlxuICByZWNvbm5lY3Q6IHtcbiAgICBtYXhBdHRlbXB0czogbnVtYmVyXG4gICAgaW5pdGlhbERlbGF5OiBudW1iZXJcbiAgICBtYXhEZWxheTogbnVtYmVyXG4gICAgYmFja29mZk11bHRpcGxpZXI6IG51bWJlclxuICB9XG4gIFxuICAvLyDlgaXlurfmo4Dmn6VcbiAgaGVhbHRoQ2hlY2s6IHtcbiAgICBlbmFibGVkOiBib29sZWFuXG4gICAgZW5kcG9pbnRzOiBzdHJpbmdbXVxuICAgIHRpbWVvdXQ6IG51bWJlclxuICAgIHN1Y2Nlc3NUaHJlc2hvbGQ6IG51bWJlclxuICB9XG4gIFxuICAvLyDkuovku7bov4fmu6RcbiAgZXZlbnRGaWx0ZXI6IHtcbiAgICBtaW5RdWFsaXR5Q2hhbmdlOiBudW1iZXIgLy8g5pyA5bCP6LSo6YeP5Y+Y5YyW5omN6Kem5Y+R5LqL5Lu2XG4gICAgZGVib3VuY2VUaW1lOiBudW1iZXIgLy8g6Ziy5oqW5pe26Ze0XG4gIH1cbn1cblxuLy8g6buY6K6k6YWN572uXG5leHBvcnQgY29uc3QgREVGQVVMVF9ORVRXT1JLX0NPTkZJRzogTmV0d29ya01vbml0b3JDb25maWcgPSB7XG4gIGNoZWNrSW50ZXJ2YWw6IDUwMDAsIC8vIDXnp5JcbiAgcXVhbGl0eUNoZWNrSW50ZXJ2YWw6IDMwMDAwLCAvLyAzMOenklxuICBcbiAgcXVhbGl0eVRocmVzaG9sZHM6IHtcbiAgICBleGNlbGxlbnQ6IHsgcnR0OiAxMDAsIGRvd25saW5rOiAxMCB9LCAgICAvLyA8MTAwbXMsID4xME1icHNcbiAgICBnb29kOiB7IHJ0dDogMjAwLCBkb3dubGluazogNSB9LCAgICAgICAgICAvLyA8MjAwbXMsID41TWJwc1xuICAgIGZhaXI6IHsgcnR0OiA1MDAsIGRvd25saW5rOiAxIH0sICAgICAgICAgIC8vIDw1MDBtcywgPjFNYnBzXG4gICAgcG9vcjogeyBydHQ6IDEwMDAsIGRvd25saW5rOiAwLjEgfSAgICAgICAgLy8gPDEwMDBtcywgPjAuMU1icHNcbiAgfSxcbiAgXG4gIHJlY29ubmVjdDoge1xuICAgIG1heEF0dGVtcHRzOiAxMCxcbiAgICBpbml0aWFsRGVsYXk6IDEwMDAsXG4gICAgbWF4RGVsYXk6IDMwMDAwLFxuICAgIGJhY2tvZmZNdWx0aXBsaWVyOiAyXG4gIH0sXG4gIFxuICBoZWFsdGhDaGVjazoge1xuICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgZW5kcG9pbnRzOiBbXG4gICAgICAnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbScsXG4gICAgICAnaHR0cHM6Ly93d3cuY2xvdWRmbGFyZS5jb20nLFxuICAgICAgJ2h0dHBzOi8vd3d3LmdpdGh1Yi5jb20nXG4gICAgXSxcbiAgICB0aW1lb3V0OiA1MDAwLFxuICAgIHN1Y2Nlc3NUaHJlc2hvbGQ6IDIgLy8g6ZyA6KaBMuS4quaIkOWKn+aJjeiupOS4uue9kee7nOWBpeW6t1xuICB9LFxuICBcbiAgZXZlbnRGaWx0ZXI6IHtcbiAgICBtaW5RdWFsaXR5Q2hhbmdlOiAwLjEsIC8vIDEwJei0qOmHj+WPmOWMluaJjeinpuWPkeS6i+S7tlxuICAgIGRlYm91bmNlVGltZTogMTAwMFxuICB9XG59XG5cbi8vIOe9kee7nOe7n+iuoeS/oeaBr1xuZXhwb3J0IGludGVyZmFjZSBOZXR3b3JrU3RhdHMge1xuICAvLyDov57mjqXnu5/orqFcbiAgY29ubmVjdGlvbkNoYW5nZXM6IG51bWJlclxuICBvbmxpbmVUaW1lOiBudW1iZXJcbiAgb2ZmbGluZVRpbWU6IG51bWJlclxuICBcbiAgLy8g6LSo6YeP57uf6K6hXG4gIGF2ZXJhZ2VRdWFsaXR5OiBudW1iZXJcbiAgcXVhbGl0eUhpc3Rvcnk6IEFycmF5PHtcbiAgICB0aW1lc3RhbXA6IERhdGVcbiAgICBxdWFsaXR5OiBOZXR3b3JrUXVhbGl0eVxuICAgIHNjb3JlOiBudW1iZXJcbiAgfT5cbiAgXG4gIC8vIOaAp+iDvee7n+iuoVxuICBhdmVyYWdlUnR0OiBudW1iZXJcbiAgYXZlcmFnZURvd25saW5rOiBudW1iZXJcbiAgcGFja2V0TG9zcz86IG51bWJlclxuICBcbiAgLy8g6ZSZ6K+v57uf6K6hXG4gIGVycm9yQ291bnQ6IG51bWJlclxuICBsYXN0RXJyb3I/OiBFcnJvclxuICBcbiAgLy8g6YeN6L+e57uf6K6hXG4gIHJlY29ubmVjdEF0dGVtcHRzOiBudW1iZXJcbiAgc3VjY2Vzc2Z1bFJlY29ubmVjdHM6IG51bWJlclxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnvZHnu5znm5HmjqfmnI3liqFcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNsYXNzIE5ldHdvcmtNb25pdG9yU2VydmljZSB7XG4gIHByaXZhdGUgY29uZmlnOiBOZXR3b3JrTW9uaXRvckNvbmZpZ1xuICBwcml2YXRlIGN1cnJlbnRTdGF0ZTogTmV0d29ya0luZm9cbiAgcHJpdmF0ZSBpc01vbml0b3JpbmcgPSBmYWxzZVxuICBwcml2YXRlIGNoZWNrVGltZXI6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGxcbiAgcHJpdmF0ZSBxdWFsaXR5VGltZXI6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGxcbiAgcHJpdmF0ZSByZWNvbm5lY3RUaW1lcjogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbFxuICBwcml2YXRlIGRlYm91bmNlVGltZXI6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGxcbiAgXG4gIC8vIOS6i+S7tuebkeWQrOWZqFxuICBwcml2YXRlIGxpc3RlbmVyczogU2V0PChldmVudDogTmV0d29ya0V2ZW50KSA9PiB2b2lkPiA9IG5ldyBTZXQoKVxuICBcbiAgLy8g57uf6K6h5L+h5oGvXG4gIHByaXZhdGUgc3RhdHM6IE5ldHdvcmtTdGF0c1xuICBwcml2YXRlIHN0YXJ0VGltZTogRGF0ZVxuICBwcml2YXRlIGxhc3RPbmxpbmVUaW1lPzogRGF0ZVxuICBwcml2YXRlIGxhc3RPZmZsaW5lVGltZT86IERhdGVcbiAgXG4gIC8vIOi/nuaOpUFQSe+8iOWmguaenOWPr+eUqO+8iVxuICBwcml2YXRlIGNvbm5lY3Rpb24/OiBhbnlcbiAgcHJpdmF0ZSBjb25uZWN0aW9uVHlwZXMgPSBbJ3dpZmknLCAnY2VsbHVsYXInLCAnZXRoZXJuZXQnLCAnYmx1ZXRvb3RoJywgJ3dpbWF4JywgJ290aGVyJywgJ25vbmUnXVxuICBcbiAgLy8g6YeN6L+e54q25oCBXG4gIHByaXZhdGUgcmVjb25uZWN0QXR0ZW1wdHMgPSAwXG4gIHByaXZhdGUgaXNSZWNvbm5lY3RpbmcgPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogUGFydGlhbDxOZXR3b3JrTW9uaXRvckNvbmZpZz4gPSB7fSkge1xuICAgIHRoaXMuY29uZmlnID0geyAuLi5ERUZBVUxUX05FVFdPUktfQ09ORklHLCAuLi5jb25maWcgfVxuICAgIHRoaXMuY3VycmVudFN0YXRlID0gdGhpcy5nZXRJbml0aWFsTmV0d29ya1N0YXRlKClcbiAgICB0aGlzLnN0YXRzID0gdGhpcy5nZXRJbml0aWFsU3RhdHMoKVxuICAgIHRoaXMuc3RhcnRUaW1lID0gbmV3IERhdGUoKVxuICAgIFxuICAgIHRoaXMuaW5pdGlhbGl6ZSgpXG4gIH1cblxuICAvLyDliJ3lp4vljJbmnI3liqFcbiAgcHJpdmF0ZSBpbml0aWFsaXplKCk6IHZvaWQge1xuICAgIC8vIOiOt+WPlue9kee7nOi/nuaOpUFQSe+8iOWmguaenOWPr+eUqO+8iVxuICAgIGlmICgnY29ubmVjdGlvbicgaW4gbmF2aWdhdG9yKSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb24gPSAobmF2aWdhdG9yIGFzIGFueSkuY29ubmVjdGlvblxuICAgIH1cbiAgICBcbiAgICAvLyDnm5HlkKzlnKjnur8v56a757q/5LqL5Lu2XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29ubGluZScsIHRoaXMuaGFuZGxlT25saW5lLmJpbmQodGhpcykpXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29mZmxpbmUnLCB0aGlzLmhhbmRsZU9mZmxpbmUuYmluZCh0aGlzKSlcbiAgICBcbiAgICAvLyDnm5HlkKzov57mjqXlj5jljJbvvIjlpoLmnpzmlK/mjIHvvIlcbiAgICBpZiAodGhpcy5jb25uZWN0aW9uKSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5oYW5kbGVDb25uZWN0aW9uQ2hhbmdlLmJpbmQodGhpcykpXG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdOZXR3b3JrTW9uaXRvclNlcnZpY2UgaW5pdGlhbGl6ZWQnKVxuICB9XG5cbiAgLy8g6I635Y+W5Yid5aeL572R57uc54q25oCBXG4gIHByaXZhdGUgZ2V0SW5pdGlhbE5ldHdvcmtTdGF0ZSgpOiBOZXR3b3JrSW5mbyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG9ubGluZTogbmF2aWdhdG9yLm9uTGluZSxcbiAgICAgIGNvbm5lY3Rpb25UeXBlOiB0aGlzLmdldENvbm5lY3Rpb25UeXBlKCksXG4gICAgICBlZmZlY3RpdmVUeXBlOiB0aGlzLmdldEVmZmVjdGl2ZVR5cGUoKSxcbiAgICAgIGRvd25saW5rOiB0aGlzLmNvbm5lY3Rpb24/LmRvd25saW5rLFxuICAgICAgcnR0OiB0aGlzLmNvbm5lY3Rpb24/LnJ0dCxcbiAgICAgIHNhdmVEYXRhOiB0aGlzLmNvbm5lY3Rpb24/LnNhdmVEYXRhLFxuICAgICAgZGV2aWNlTWVtb3J5OiAobmF2aWdhdG9yIGFzIGFueSkuZGV2aWNlTWVtb3J5LFxuICAgICAgaGFyZHdhcmVDb25jdXJyZW5jeTogbmF2aWdhdG9yLmhhcmR3YXJlQ29uY3VycmVuY3ksXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICB9XG4gIH1cblxuICAvLyDojrflj5bliJ3lp4vnu5/orqHkv6Hmga9cbiAgcHJpdmF0ZSBnZXRJbml0aWFsU3RhdHMoKTogTmV0d29ya1N0YXRzIHtcbiAgICByZXR1cm4ge1xuICAgICAgY29ubmVjdGlvbkNoYW5nZXM6IDAsXG4gICAgICBvbmxpbmVUaW1lOiAwLFxuICAgICAgb2ZmbGluZVRpbWU6IDAsXG4gICAgICBhdmVyYWdlUXVhbGl0eTogMCxcbiAgICAgIHF1YWxpdHlIaXN0b3J5OiBbXSxcbiAgICAgIGF2ZXJhZ2VSdHQ6IDAsXG4gICAgICBhdmVyYWdlRG93bmxpbms6IDAsXG4gICAgICBlcnJvckNvdW50OiAwLFxuICAgICAgcmVjb25uZWN0QXR0ZW1wdHM6IDAsXG4gICAgICBzdWNjZXNzZnVsUmVjb25uZWN0czogMFxuICAgIH1cbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g5YWs5YWx5pa55rOVXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvLyDlvIDlp4vnm5HmjqdcbiAgc3RhcnRNb25pdG9yaW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzTW9uaXRvcmluZykgcmV0dXJuXG4gICAgXG4gICAgdGhpcy5pc01vbml0b3JpbmcgPSB0cnVlXG4gICAgdGhpcy5zdGFydFBlcmlvZGljQ2hlY2tzKClcbiAgICBcbiAgICBjb25zb2xlLmxvZygnTmV0d29yayBtb25pdG9yaW5nIHN0YXJ0ZWQnKVxuICAgIHRoaXMuZW1pdEV2ZW50KHtcbiAgICAgIHR5cGU6ICdjb25uZWN0aW9uLWNoYW5nZScsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBjdXJyZW50U3RhdGU6IHRoaXMuY3VycmVudFN0YXRlLFxuICAgICAgZGV0YWlsczogeyBhY3Rpb246ICdtb25pdG9yaW5nX3N0YXJ0ZWQnIH1cbiAgICB9KVxuICB9XG5cbiAgLy8g5YGc5q2i55uR5o6nXG4gIHN0b3BNb25pdG9yaW5nKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5pc01vbml0b3JpbmcpIHJldHVyblxuICAgIFxuICAgIHRoaXMuaXNNb25pdG9yaW5nID0gZmFsc2VcbiAgICB0aGlzLnN0b3BQZXJpb2RpY0NoZWNrcygpXG4gICAgXG4gICAgY29uc29sZS5sb2coJ05ldHdvcmsgbW9uaXRvcmluZyBzdG9wcGVkJylcbiAgICB0aGlzLmVtaXRFdmVudCh7XG4gICAgICB0eXBlOiAnY29ubmVjdGlvbi1jaGFuZ2UnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgY3VycmVudFN0YXRlOiB0aGlzLmN1cnJlbnRTdGF0ZSxcbiAgICAgIGRldGFpbHM6IHsgYWN0aW9uOiAnbW9uaXRvcmluZ19zdG9wcGVkJyB9XG4gICAgfSlcbiAgfVxuXG4gIC8vIOiOt+WPluW9k+WJjee9kee7nOeKtuaAgVxuICBnZXRDdXJyZW50U3RhdGUoKTogTmV0d29ya0luZm8ge1xuICAgIHJldHVybiB7IC4uLnRoaXMuY3VycmVudFN0YXRlIH1cbiAgfVxuXG4gIC8vIOiOt+WPlue9kee7nOi0qOmHj1xuICBnZXROZXR3b3JrUXVhbGl0eSgpOiBOZXR3b3JrUXVhbGl0eSB7XG4gICAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlUXVhbGl0eSh0aGlzLmN1cnJlbnRTdGF0ZSlcbiAgfVxuXG4gIC8vIOiOt+WPlue9kee7nOi0qOmHj+WIhuaVsO+8iDAtMe+8iVxuICBnZXROZXR3b3JrUXVhbGl0eVNjb3JlKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlUXVhbGl0eVNjb3JlKHRoaXMuY3VycmVudFN0YXRlKVxuICB9XG5cbiAgLy8g6I635Y+W57uf6K6h5L+h5oGvXG4gIGdldFN0YXRzKCk6IE5ldHdvcmtTdGF0cyB7XG4gICAgcmV0dXJuIHsgLi4udGhpcy5zdGF0cyB9XG4gIH1cblxuICAvLyDmiYvliqjop6blj5HnvZHnu5zmo4Dmn6VcbiAgYXN5bmMgY2hlY2tOZXR3b3JrKCk6IFByb21pc2U8TmV0d29ya0luZm8+IHtcbiAgICBjb25zdCBuZXdTdGF0ZSA9IGF3YWl0IHRoaXMuZ2V0Q3VycmVudE5ldHdvcmtJbmZvKClcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZU5ldHdvcmtTdGF0ZShuZXdTdGF0ZSlcbiAgICByZXR1cm4gbmV3U3RhdGVcbiAgfVxuXG4gIC8vIOaJp+ihjOWBpeW6t+ajgOafpVxuICBhc3luYyBwZXJmb3JtSGVhbHRoQ2hlY2soKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZy5oZWFsdGhDaGVjay5lbmFibGVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5jdXJyZW50U3RhdGUub25saW5lXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb21pc2VzID0gdGhpcy5jb25maWcuaGVhbHRoQ2hlY2suZW5kcG9pbnRzLm1hcChlbmRwb2ludCA9PlxuICAgICAgICB0aGlzLnBpbmdFbmRwb2ludChlbmRwb2ludCwgdGhpcy5jb25maWcuaGVhbHRoQ2hlY2sudGltZW91dClcbiAgICAgIClcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChwcm9taXNlcylcbiAgICAgIGNvbnN0IHN1Y2Nlc3NDb3VudCA9IHJlc3VsdHMuZmlsdGVyKHJlc3VsdCA9PiBcbiAgICAgICAgcmVzdWx0LnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgJiYgcmVzdWx0LnZhbHVlXG4gICAgICApLmxlbmd0aFxuICAgICAgXG4gICAgICBjb25zdCBpc0hlYWx0aHkgPSBzdWNjZXNzQ291bnQgPj0gdGhpcy5jb25maWcuaGVhbHRoQ2hlY2suc3VjY2Vzc1RocmVzaG9sZFxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhgSGVhbHRoIGNoZWNrOiAke3N1Y2Nlc3NDb3VudH0vJHt0aGlzLmNvbmZpZy5oZWFsdGhDaGVjay5lbmRwb2ludHMubGVuZ3RofSBzdWNjZXNzZnVsYClcbiAgICAgIFxuICAgICAgcmV0dXJuIGlzSGVhbHRoeVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdIZWFsdGggY2hlY2sgZmFpbGVkOicsIGVycm9yKVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDkuovku7bnm5HlkKzlmahcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8vIOa3u+WKoOS6i+S7tuebkeWQrOWZqFxuICBhZGRFdmVudExpc3RlbmVyKGNhbGxiYWNrOiAoZXZlbnQ6IE5ldHdvcmtFdmVudCkgPT4gdm9pZCk6IHZvaWQge1xuICAgIHRoaXMubGlzdGVuZXJzLmFkZChjYWxsYmFjaylcbiAgfVxuXG4gIC8vIOenu+mZpOS6i+S7tuebkeWQrOWZqFxuICByZW1vdmVFdmVudExpc3RlbmVyKGNhbGxiYWNrOiAoZXZlbnQ6IE5ldHdvcmtFdmVudCkgPT4gdm9pZCk6IHZvaWQge1xuICAgIHRoaXMubGlzdGVuZXJzLmRlbGV0ZShjYWxsYmFjaylcbiAgfVxuXG4gIC8vIOWPkemAgeS6i+S7tlxuICBwcml2YXRlIGVtaXRFdmVudChldmVudDogTmV0d29ya0V2ZW50KTogdm9pZCB7XG4gICAgLy8g6Ziy5oqW5aSE55CGXG4gICAgaWYgKHRoaXMuY29uZmlnLmV2ZW50RmlsdGVyLmRlYm91bmNlVGltZSA+IDApIHtcbiAgICAgIGlmICh0aGlzLmRlYm91bmNlVGltZXIpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZGVib3VuY2VUaW1lcilcbiAgICAgIH1cbiAgICAgIFxuICAgICAgdGhpcy5kZWJvdW5jZVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzLmZvckVhY2gobGlzdGVuZXIgPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsaXN0ZW5lcihldmVudClcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gbmV0d29yayBldmVudCBsaXN0ZW5lcjonLCBlcnJvcilcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9LCB0aGlzLmNvbmZpZy5ldmVudEZpbHRlci5kZWJvdW5jZVRpbWUpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubGlzdGVuZXJzLmZvckVhY2gobGlzdGVuZXIgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGxpc3RlbmVyKGV2ZW50KVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIG5ldHdvcmsgZXZlbnQgbGlzdGVuZXI6JywgZXJyb3IpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDnvZHnu5znirbmgIHmm7TmlrBcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8vIOWkhOeQhuWcqOe6v+S6i+S7tlxuICBwcml2YXRlIGFzeW5jIGhhbmRsZU9ubGluZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnTmV0d29yayBvbmxpbmUgZXZlbnQgZGV0ZWN0ZWQnKVxuICAgIFxuICAgIGNvbnN0IHByZXZpb3VzU3RhdGUgPSB7IC4uLnRoaXMuY3VycmVudFN0YXRlIH1cbiAgICB0aGlzLmN1cnJlbnRTdGF0ZS5vbmxpbmUgPSB0cnVlXG4gICAgdGhpcy5jdXJyZW50U3RhdGUubGFzdENoYW5nZSA9IG5ldyBEYXRlKClcbiAgICBcbiAgICB0aGlzLmxhc3RPbmxpbmVUaW1lID0gbmV3IERhdGUoKVxuICAgIFxuICAgIC8vIOabtOaWsOe7n+iuoVxuICAgIGlmICh0aGlzLmxhc3RPZmZsaW5lVGltZSkge1xuICAgICAgdGhpcy5zdGF0cy5vZmZsaW5lVGltZSArPSBEYXRlLm5vdygpIC0gdGhpcy5sYXN0T2ZmbGluZVRpbWUuZ2V0VGltZSgpXG4gICAgICB0aGlzLmxhc3RPZmZsaW5lVGltZSA9IHVuZGVmaW5lZFxuICAgIH1cbiAgICBcbiAgICAvLyDlgZzmraLph43ov57lsJ3or5VcbiAgICB0aGlzLnN0b3BSZWNvbm5lY3RBdHRlbXB0cygpXG4gICAgXG4gICAgdGhpcy5lbWl0RXZlbnQoe1xuICAgICAgdHlwZTogJ29ubGluZScsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBwcmV2aW91c1N0YXRlLFxuICAgICAgY3VycmVudFN0YXRlOiB0aGlzLmN1cnJlbnRTdGF0ZVxuICAgIH0pXG4gICAgXG4gICAgLy8g56uL5Y2z5qOA5p+l572R57uc6LSo6YePXG4gICAgYXdhaXQgdGhpcy5jaGVja05ldHdvcmsoKVxuICB9XG5cbiAgLy8g5aSE55CG56a757q/5LqL5Lu2XG4gIHByaXZhdGUgaGFuZGxlT2ZmbGluZSgpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygnTmV0d29yayBvZmZsaW5lIGV2ZW50IGRldGVjdGVkJylcbiAgICBcbiAgICBjb25zdCBwcmV2aW91c1N0YXRlID0geyAuLi50aGlzLmN1cnJlbnRTdGF0ZSB9XG4gICAgdGhpcy5jdXJyZW50U3RhdGUub25saW5lID0gZmFsc2VcbiAgICB0aGlzLmN1cnJlbnRTdGF0ZS5sYXN0Q2hhbmdlID0gbmV3IERhdGUoKVxuICAgIFxuICAgIHRoaXMubGFzdE9mZmxpbmVUaW1lID0gbmV3IERhdGUoKVxuICAgIFxuICAgIC8vIOabtOaWsOe7n+iuoVxuICAgIGlmICh0aGlzLmxhc3RPbmxpbmVUaW1lKSB7XG4gICAgICB0aGlzLnN0YXRzLm9ubGluZVRpbWUgKz0gRGF0ZS5ub3coKSAtIHRoaXMubGFzdE9ubGluZVRpbWUuZ2V0VGltZSgpXG4gICAgfVxuICAgIFxuICAgIHRoaXMuZW1pdEV2ZW50KHtcbiAgICAgIHR5cGU6ICdvZmZsaW5lJyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIHByZXZpb3VzU3RhdGUsXG4gICAgICBjdXJyZW50U3RhdGU6IHRoaXMuY3VycmVudFN0YXRlXG4gICAgfSlcbiAgICBcbiAgICAvLyDlvIDlp4vph43ov57lsJ3or5VcbiAgICB0aGlzLnN0YXJ0UmVjb25uZWN0QXR0ZW1wdHMoKVxuICB9XG5cbiAgLy8g5aSE55CG6L+e5o6l5Y+Y5YyWXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlQ29ubmVjdGlvbkNoYW5nZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnTmV0d29yayBjb25uZWN0aW9uIGNoYW5nZSBkZXRlY3RlZCcpXG4gICAgXG4gICAgY29uc3QgcHJldmlvdXNTdGF0ZSA9IHsgLi4udGhpcy5jdXJyZW50U3RhdGUgfVxuICAgIGNvbnN0IG5ld1N0YXRlID0gYXdhaXQgdGhpcy5nZXRDdXJyZW50TmV0d29ya0luZm8oKVxuICAgIFxuICAgIC8vIOajgOafpeaYr+WQpuacieaYvuiRl+WPmOWMllxuICAgIGNvbnN0IHF1YWxpdHlDaGFuZ2UgPSBNYXRoLmFicyhcbiAgICAgIHRoaXMuY2FsY3VsYXRlUXVhbGl0eVNjb3JlKG5ld1N0YXRlKSAtIHRoaXMuY2FsY3VsYXRlUXVhbGl0eVNjb3JlKHByZXZpb3VzU3RhdGUpXG4gICAgKVxuICAgIFxuICAgIGlmIChxdWFsaXR5Q2hhbmdlID49IHRoaXMuY29uZmlnLmV2ZW50RmlsdGVyLm1pblF1YWxpdHlDaGFuZ2UpIHtcbiAgICAgIHRoaXMuY3VycmVudFN0YXRlID0gbmV3U3RhdGVcbiAgICAgIHRoaXMuY3VycmVudFN0YXRlLmxhc3RDaGFuZ2UgPSBuZXcgRGF0ZSgpXG4gICAgICBcbiAgICAgIHRoaXMuc3RhdHMuY29ubmVjdGlvbkNoYW5nZXMrK1xuICAgICAgXG4gICAgICB0aGlzLmVtaXRFdmVudCh7XG4gICAgICAgIHR5cGU6ICdjb25uZWN0aW9uLWNoYW5nZScsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgcHJldmlvdXNTdGF0ZSxcbiAgICAgICAgY3VycmVudFN0YXRlOiB0aGlzLmN1cnJlbnRTdGF0ZVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICAvLyDmm7TmlrDnvZHnu5znirbmgIFcbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVOZXR3b3JrU3RhdGUobmV3U3RhdGU6IE5ldHdvcmtJbmZvKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcHJldmlvdXNTdGF0ZSA9IHsgLi4udGhpcy5jdXJyZW50U3RhdGUgfVxuICAgIGNvbnN0IHF1YWxpdHlDaGFuZ2UgPSBNYXRoLmFicyhcbiAgICAgIHRoaXMuY2FsY3VsYXRlUXVhbGl0eVNjb3JlKG5ld1N0YXRlKSAtIHRoaXMuY2FsY3VsYXRlUXVhbGl0eVNjb3JlKHByZXZpb3VzU3RhdGUpXG4gICAgKVxuICAgIFxuICAgIC8vIOWPquWcqOi0qOmHj+WPmOWMluaYvuiRl+aXtuabtOaWsFxuICAgIGlmIChxdWFsaXR5Q2hhbmdlID49IHRoaXMuY29uZmlnLmV2ZW50RmlsdGVyLm1pblF1YWxpdHlDaGFuZ2UpIHtcbiAgICAgIHRoaXMuY3VycmVudFN0YXRlID0gbmV3U3RhdGVcbiAgICAgIHRoaXMuY3VycmVudFN0YXRlLmxhc3RDaGFuZ2UgPSBuZXcgRGF0ZSgpXG4gICAgICBcbiAgICAgIC8vIOabtOaWsOi0qOmHj+WOhuWPslxuICAgICAgdGhpcy51cGRhdGVRdWFsaXR5SGlzdG9yeSgpXG4gICAgICBcbiAgICAgIC8vIOWPkemAgei0qOmHj+WPmOWMluS6i+S7tlxuICAgICAgdGhpcy5lbWl0RXZlbnQoe1xuICAgICAgICB0eXBlOiAncXVhbGl0eS1jaGFuZ2UnLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHByZXZpb3VzU3RhdGUsXG4gICAgICAgIGN1cnJlbnRTdGF0ZTogdGhpcy5jdXJyZW50U3RhdGUsXG4gICAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgICBxdWFsaXR5Q2hhbmdlLFxuICAgICAgICAgIHByZXZpb3VzUXVhbGl0eTogdGhpcy5jYWxjdWxhdGVRdWFsaXR5KHByZXZpb3VzU3RhdGUpLFxuICAgICAgICAgIGN1cnJlbnRRdWFsaXR5OiB0aGlzLmNhbGN1bGF0ZVF1YWxpdHkobmV3U3RhdGUpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDlrprmnJ/mo4Dmn6VcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8vIOWQr+WKqOWumuacn+ajgOafpVxuICBwcml2YXRlIHN0YXJ0UGVyaW9kaWNDaGVja3MoKTogdm9pZCB7XG4gICAgLy8g5Z+656GA572R57uc54q25oCB5qOA5p+lXG4gICAgdGhpcy5jaGVja1RpbWVyID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaXNNb25pdG9yaW5nKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY2hlY2tOZXR3b3JrKClcbiAgICAgIH1cbiAgICB9LCB0aGlzLmNvbmZpZy5jaGVja0ludGVydmFsKVxuICAgIFxuICAgIC8vIOe9kee7nOi0qOmHj+ajgOafpVxuICAgIHRoaXMucXVhbGl0eVRpbWVyID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaXNNb25pdG9yaW5nKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucGVyZm9ybVF1YWxpdHlDaGVjaygpXG4gICAgICB9XG4gICAgfSwgdGhpcy5jb25maWcucXVhbGl0eUNoZWNrSW50ZXJ2YWwpXG4gIH1cblxuICAvLyDlgZzmraLlrprmnJ/mo4Dmn6VcbiAgcHJpdmF0ZSBzdG9wUGVyaW9kaWNDaGVja3MoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY2hlY2tUaW1lcikge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNoZWNrVGltZXIpXG4gICAgICB0aGlzLmNoZWNrVGltZXIgPSBudWxsXG4gICAgfVxuICAgIFxuICAgIGlmICh0aGlzLnF1YWxpdHlUaW1lcikge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnF1YWxpdHlUaW1lcilcbiAgICAgIHRoaXMucXVhbGl0eVRpbWVyID0gbnVsbFxuICAgIH1cbiAgfVxuXG4gIC8vIOaJp+ihjOi0qOmHj+ajgOafpVxuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1RdWFsaXR5Q2hlY2soKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGhlYWx0aFN0YXR1cyA9IGF3YWl0IHRoaXMucGVyZm9ybUhlYWx0aENoZWNrKClcbiAgICAgIFxuICAgICAgaWYgKCFoZWFsdGhTdGF0dXMgJiYgdGhpcy5jdXJyZW50U3RhdGUub25saW5lKSB7XG4gICAgICAgIC8vIOe9kee7nOaYvuekuuWcqOe6v+S9huWBpeW6t+ajgOafpeWksei0pVxuICAgICAgICBjb25zb2xlLndhcm4oJ05ldHdvcmsgYXBwZWFycyBvbmxpbmUgYnV0IGhlYWx0aCBjaGVjayBmYWlsZWQnKVxuICAgICAgICBcbiAgICAgICAgdGhpcy5jdXJyZW50U3RhdGUub25saW5lID0gZmFsc2VcbiAgICAgICAgdGhpcy5jdXJyZW50U3RhdGUubGFzdENoYW5nZSA9IG5ldyBEYXRlKClcbiAgICAgICAgXG4gICAgICAgIHRoaXMuZW1pdEV2ZW50KHtcbiAgICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICBjdXJyZW50U3RhdGU6IHRoaXMuY3VycmVudFN0YXRlLFxuICAgICAgICAgIGRldGFpbHM6IHsgbWVzc2FnZTogJ0hlYWx0aCBjaGVjayBmYWlsZWQgZGVzcGl0ZSBvbmxpbmUgc3RhdHVzJyB9XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1F1YWxpdHkgY2hlY2sgZmFpbGVkOicsIGVycm9yKVxuICAgICAgdGhpcy5zdGF0cy5lcnJvckNvdW50KytcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOmHjei/nuacuuWItlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLy8g5byA5aeL6YeN6L+e5bCd6K+VXG4gIHByaXZhdGUgc3RhcnRSZWNvbm5lY3RBdHRlbXB0cygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5pc1JlY29ubmVjdGluZykgcmV0dXJuXG4gICAgXG4gICAgdGhpcy5pc1JlY29ubmVjdGluZyA9IHRydWVcbiAgICB0aGlzLnJlY29ubmVjdEF0dGVtcHRzID0gMFxuICAgIHRoaXMuc2NoZWR1bGVSZWNvbm5lY3RBdHRlbXB0KClcbiAgfVxuXG4gIC8vIOWBnOatoumHjei/nuWwneivlVxuICBwcml2YXRlIHN0b3BSZWNvbm5lY3RBdHRlbXB0cygpOiB2b2lkIHtcbiAgICB0aGlzLmlzUmVjb25uZWN0aW5nID0gZmFsc2VcbiAgICBpZiAodGhpcy5yZWNvbm5lY3RUaW1lcikge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucmVjb25uZWN0VGltZXIpXG4gICAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gbnVsbFxuICAgIH1cbiAgfVxuXG4gIC8vIOWuieaOkumHjei/nuWwneivlVxuICBwcml2YXRlIHNjaGVkdWxlUmVjb25uZWN0QXR0ZW1wdCgpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuaXNSZWNvbm5lY3RpbmcgfHwgdGhpcy5yZWNvbm5lY3RBdHRlbXB0cyA+PSB0aGlzLmNvbmZpZy5yZWNvbm5lY3QubWF4QXR0ZW1wdHMpIHtcbiAgICAgIHRoaXMuaXNSZWNvbm5lY3RpbmcgPSBmYWxzZVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGRlbGF5ID0gTWF0aC5taW4oXG4gICAgICB0aGlzLmNvbmZpZy5yZWNvbm5lY3QuaW5pdGlhbERlbGF5ICogTWF0aC5wb3codGhpcy5jb25maWcucmVjb25uZWN0LmJhY2tvZmZNdWx0aXBsaWVyLCB0aGlzLnJlY29ubmVjdEF0dGVtcHRzKSxcbiAgICAgIHRoaXMuY29uZmlnLnJlY29ubmVjdC5tYXhEZWxheVxuICAgIClcbiAgICBcbiAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICB0aGlzLnJlY29ubmVjdEF0dGVtcHRzKytcbiAgICAgIHRoaXMuc3RhdHMucmVjb25uZWN0QXR0ZW1wdHMrK1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhgUmVjb25uZWN0IGF0dGVtcHQgJHt0aGlzLnJlY29ubmVjdEF0dGVtcHRzfS8ke3RoaXMuY29uZmlnLnJlY29ubmVjdC5tYXhBdHRlbXB0c31gKVxuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpc09ubGluZSA9IG5hdmlnYXRvci5vbkxpbmVcbiAgICAgICAgaWYgKGlzT25saW5lKSB7XG4gICAgICAgICAgY29uc3QgaGVhbHRoU3RhdHVzID0gYXdhaXQgdGhpcy5wZXJmb3JtSGVhbHRoQ2hlY2soKVxuICAgICAgICAgIGlmIChoZWFsdGhTdGF0dXMpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHMuc3VjY2Vzc2Z1bFJlY29ubmVjdHMrK1xuICAgICAgICAgICAgdGhpcy5pc1JlY29ubmVjdGluZyA9IGZhbHNlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVjb25uZWN0IHN1Y2Nlc3NmdWwnKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmVtaXRFdmVudCh7XG4gICAgICAgICAgICAgIHR5cGU6ICdvbmxpbmUnLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZTogdGhpcy5jdXJyZW50U3RhdGUsXG4gICAgICAgICAgICAgIGRldGFpbHM6IHsgcmVjb25uZWN0QXR0ZW1wdHM6IHRoaXMucmVjb25uZWN0QXR0ZW1wdHMgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVPbmxpbmUoKVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdSZWNvbm5lY3QgYXR0ZW1wdCBmYWlsZWQ6JywgZXJyb3IpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOe7p+e7reS4i+S4gOasoemHjei/nlxuICAgICAgdGhpcy5zY2hlZHVsZVJlY29ubmVjdEF0dGVtcHQoKVxuICAgIH0sIGRlbGF5KVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDlt6Xlhbfmlrnms5VcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8vIOiOt+WPluW9k+WJjee9kee7nOS/oeaBr1xuICBwcml2YXRlIGFzeW5jIGdldEN1cnJlbnROZXR3b3JrSW5mbygpOiBQcm9taXNlPE5ldHdvcmtJbmZvPiB7XG4gICAgY29uc3QgYmFzZUluZm8gPSB0aGlzLmdldEluaXRpYWxOZXR3b3JrU3RhdGUoKVxuICAgIFxuICAgIC8vIOaJp+ihjOWBpeW6t+ajgOafpeiOt+WPluabtOWHhuehrueahOeKtuaAgVxuICAgIGlmICh0aGlzLmNvbmZpZy5oZWFsdGhDaGVjay5lbmFibGVkKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpc0hlYWx0aHkgPSBhd2FpdCB0aGlzLnBlcmZvcm1IZWFsdGhDaGVjaygpXG4gICAgICAgIGJhc2VJbmZvLm9ubGluZSA9IGlzSGVhbHRoeSAmJiBuYXZpZ2F0b3Iub25MaW5lXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0hlYWx0aCBjaGVjayBmYWlsZWQsIHVzaW5nIG5hdmlnYXRvci5vbkxpbmU6JywgZXJyb3IpXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIOS9v+eUqOWinuW8uueahOe9kee7nOeKtuaAgeajgOa1i1xuICAgIGlmIChiYXNlSW5mby5vbmxpbmUpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGVuaGFuY2VkSW5mbyA9IGF3YWl0IHRoaXMuZ2V0RW5oYW5jZWROZXR3b3JrSW5mbygpXG4gICAgICAgIHJldHVybiB7IC4uLmJhc2VJbmZvLCAuLi5lbmhhbmNlZEluZm8gfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdFbmhhbmNlZCBuZXR3b3JrIGluZm8gZmFpbGVkLCB1c2luZyBiYXNpYyBpbmZvOicsIGVycm9yKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gYmFzZUluZm9cbiAgfVxuXG4gIC8vIOiOt+WPlui/nuaOpeexu+Wei1xuICBwcml2YXRlIGdldENvbm5lY3Rpb25UeXBlKCk6IE5ldHdvcmtJbmZvWydjb25uZWN0aW9uVHlwZSddIHtcbiAgICBpZiAoIXRoaXMuY29ubmVjdGlvbikgcmV0dXJuICdub25lJ1xuICAgIFxuICAgIGNvbnN0IHR5cGUgPSB0aGlzLmNvbm5lY3Rpb24udHlwZVxuICAgIHJldHVybiB0aGlzLmNvbm5lY3Rpb25UeXBlcy5pbmNsdWRlcyh0eXBlKSA/IHR5cGUgOiAnb3RoZXInXG4gIH1cblxuICAvLyDojrflj5bmnInmlYjov57mjqXnsbvlnotcbiAgcHJpdmF0ZSBnZXRFZmZlY3RpdmVUeXBlKCk6IE5ldHdvcmtJbmZvWydlZmZlY3RpdmVUeXBlJ10ge1xuICAgIGlmICghdGhpcy5jb25uZWN0aW9uKSByZXR1cm4gJ3Vua25vd24nXG4gICAgXG4gICAgY29uc3QgZWZmZWN0aXZlVHlwZSA9IHRoaXMuY29ubmVjdGlvbi5lZmZlY3RpdmVUeXBlXG4gICAgcmV0dXJuIFsnNGcnLCAnM2cnLCAnMmcnLCAnc2xvdy0yZyddLmluY2x1ZGVzKGVmZmVjdGl2ZVR5cGUpID8gZWZmZWN0aXZlVHlwZSA6ICd1bmtub3duJ1xuICB9XG5cbiAgLy8g6K6h566X572R57uc6LSo6YePXG4gIHByaXZhdGUgY2FsY3VsYXRlUXVhbGl0eShpbmZvOiBOZXR3b3JrSW5mbyk6IE5ldHdvcmtRdWFsaXR5IHtcbiAgICBjb25zdCBzY29yZSA9IHRoaXMuY2FsY3VsYXRlUXVhbGl0eVNjb3JlKGluZm8pXG4gICAgXG4gICAgaWYgKHNjb3JlID49IDAuOCkgcmV0dXJuICdleGNlbGxlbnQnXG4gICAgaWYgKHNjb3JlID49IDAuNikgcmV0dXJuICdnb29kJ1xuICAgIGlmIChzY29yZSA+PSAwLjQpIHJldHVybiAnZmFpcidcbiAgICBpZiAoc2NvcmUgPj0gMC4yKSByZXR1cm4gJ3Bvb3InXG4gICAgcmV0dXJuICdvZmZsaW5lJ1xuICB9XG5cbiAgLy8g6K6h566X572R57uc6LSo6YeP5YiG5pWw77yIMC0x77yJXG4gIHByaXZhdGUgY2FsY3VsYXRlUXVhbGl0eVNjb3JlKGluZm86IE5ldHdvcmtJbmZvKTogbnVtYmVyIHtcbiAgICBpZiAoIWluZm8ub25saW5lKSByZXR1cm4gMFxuICAgIFxuICAgIGxldCBzY29yZSA9IDAuNSAvLyDln7rnoYDliIbmlbDvvIjlnKjnur/vvIlcbiAgICBcbiAgICAvLyBSVFTor4TliIZcbiAgICBpZiAoaW5mby5ydHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKGluZm8ucnR0IDw9IDEwMCkgc2NvcmUgKz0gMC4zXG4gICAgICBlbHNlIGlmIChpbmZvLnJ0dCA8PSAyMDApIHNjb3JlICs9IDAuMlxuICAgICAgZWxzZSBpZiAoaW5mby5ydHQgPD0gNTAwKSBzY29yZSArPSAwLjFcbiAgICB9XG4gICAgXG4gICAgLy8g5LiL6KGM6YCf5bqm6K+E5YiGXG4gICAgaWYgKGluZm8uZG93bmxpbmsgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKGluZm8uZG93bmxpbmsgPj0gMTApIHNjb3JlICs9IDAuM1xuICAgICAgZWxzZSBpZiAoaW5mby5kb3dubGluayA+PSA1KSBzY29yZSArPSAwLjJcbiAgICAgIGVsc2UgaWYgKGluZm8uZG93bmxpbmsgPj0gMSkgc2NvcmUgKz0gMC4xXG4gICAgfVxuICAgIFxuICAgIC8vIOi/nuaOpeexu+Wei+ivhOWIhlxuICAgIGlmIChpbmZvLmNvbm5lY3Rpb25UeXBlID09PSAnd2lmaScgfHwgaW5mby5jb25uZWN0aW9uVHlwZSA9PT0gJ2V0aGVybmV0Jykge1xuICAgICAgc2NvcmUgKz0gMC4xXG4gICAgfVxuICAgIFxuICAgIC8vIOecgeaVsOaNruaooeW8j+aJo+WIhlxuICAgIGlmIChpbmZvLnNhdmVEYXRhKSB7XG4gICAgICBzY29yZSAtPSAwLjFcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHNjb3JlKSlcbiAgfVxuXG4gIC8vIOabtOaWsOi0qOmHj+WOhuWPslxuICBwcml2YXRlIHVwZGF0ZVF1YWxpdHlIaXN0b3J5KCk6IHZvaWQge1xuICAgIGNvbnN0IHF1YWxpdHkgPSB0aGlzLmdldE5ldHdvcmtRdWFsaXR5KClcbiAgICBjb25zdCBzY29yZSA9IHRoaXMuZ2V0TmV0d29ya1F1YWxpdHlTY29yZSgpXG4gICAgXG4gICAgdGhpcy5zdGF0cy5xdWFsaXR5SGlzdG9yeS5wdXNoKHtcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIHF1YWxpdHksXG4gICAgICBzY29yZVxuICAgIH0pXG4gICAgXG4gICAgLy8g5L+d55WZ5pyA6L+RMTAw5p2h6K6w5b2VXG4gICAgaWYgKHRoaXMuc3RhdHMucXVhbGl0eUhpc3RvcnkubGVuZ3RoID4gMTAwKSB7XG4gICAgICB0aGlzLnN0YXRzLnF1YWxpdHlIaXN0b3J5ID0gdGhpcy5zdGF0cy5xdWFsaXR5SGlzdG9yeS5zbGljZSgtMTAwKVxuICAgIH1cbiAgICBcbiAgICAvLyDmm7TmlrDlubPlnYfotKjph49cbiAgICBjb25zdCByZWNlbnRIaXN0b3J5ID0gdGhpcy5zdGF0cy5xdWFsaXR5SGlzdG9yeS5zbGljZSgtMjApIC8vIOacgOi/kTIw5p2hXG4gICAgaWYgKHJlY2VudEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5zdGF0cy5hdmVyYWdlUXVhbGl0eSA9IHJlY2VudEhpc3RvcnkucmVkdWNlKChzdW0sIGl0ZW0pID0+IHN1bSArIGl0ZW0uc2NvcmUsIDApIC8gcmVjZW50SGlzdG9yeS5sZW5ndGhcbiAgICB9XG4gIH1cblxuICAvLyBQaW5n56uv54K5XG4gIHByaXZhdGUgYXN5bmMgcGluZ0VuZHBvaW50KGVuZHBvaW50OiBzdHJpbmcsIHRpbWVvdXQ6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpXG4gICAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgdGltZW91dClcbiAgICAgIFxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KClcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2Zhdmljb24uaWNvYCwge1xuICAgICAgICBtZXRob2Q6ICdIRUFEJyxcbiAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcbiAgICAgICAgbW9kZTogJ25vLWNvcnMnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NhY2hlLUNvbnRyb2wnOiAnbm8tY2FjaGUnLFxuICAgICAgICAgICdQcmFnbWEnOiAnbm8tY2FjaGUnXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgICBcbiAgICAgIC8vIOiusOW9leWTjeW6lOaXtumXtOeUqOS6jue9kee7nOi0qOmHj+ivhOS8sFxuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZVRpbWUoZHVyYXRpb24pXG4gICAgICBcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMucmVjb3JkRXJyb3IoJ3BpbmdfZmFpbGVkJywgeyBlbmRwb2ludCwgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSB9KVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDlop7lvLrnvZHnu5znirbmgIHmo4DmtYvmlrnms5VcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDorrDlvZXlk43lupTml7bpl7TnlKjkuo7otKjph4/or4TkvLBcbiAgICovXG4gIHByaXZhdGUgcmVjb3JkUmVzcG9uc2VUaW1lKGR1cmF0aW9uOiBudW1iZXIpOiB2b2lkIHtcbiAgICAvLyDmm7TmlrDlubPlnYdSVFTnu5/orqFcbiAgICBpZiAodGhpcy5zdGF0cy5hdmVyYWdlUnR0ID09PSAwKSB7XG4gICAgICB0aGlzLnN0YXRzLmF2ZXJhZ2VSdHQgPSBkdXJhdGlvblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyDmjIfmlbDnp7vliqjlubPlnYdcbiAgICAgIHRoaXMuc3RhdHMuYXZlcmFnZVJ0dCA9IHRoaXMuc3RhdHMuYXZlcmFnZVJ0dCAqIDAuOCArIGR1cmF0aW9uICogMC4yXG4gICAgfVxuICAgIFxuICAgIC8vIOiusOW9leWIsOWOhuWPsuiusOW9lVxuICAgIHRoaXMuc3RhdHMucXVhbGl0eUhpc3RvcnkucHVzaCh7XG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBxdWFsaXR5OiB0aGlzLmNhbGN1bGF0ZVF1YWxpdHkodGhpcy5jdXJyZW50U3RhdGUpLFxuICAgICAgc2NvcmU6IHRoaXMuY2FsY3VsYXRlUXVhbGl0eVNjb3JlKHRoaXMuY3VycmVudFN0YXRlKVxuICAgIH0pXG4gICAgXG4gICAgLy8g5L+d5oyB5Y6G5Y+y6K6w5b2V5Zyo5ZCI55CG6IyD5Zu05YaFXG4gICAgaWYgKHRoaXMuc3RhdHMucXVhbGl0eUhpc3RvcnkubGVuZ3RoID4gMTAwKSB7XG4gICAgICB0aGlzLnN0YXRzLnF1YWxpdHlIaXN0b3J5ID0gdGhpcy5zdGF0cy5xdWFsaXR5SGlzdG9yeS5zbGljZSgtNTApXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiusOW9lemUmeivr+S/oeaBr1xuICAgKi9cbiAgcHJpdmF0ZSByZWNvcmRFcnJvcih0eXBlOiBzdHJpbmcsIGRldGFpbHM6IGFueSk6IHZvaWQge1xuICAgIHRoaXMuc3RhdHMuZXJyb3JDb3VudCsrXG4gICAgdGhpcy5zdGF0cy5sYXN0RXJyb3IgPSBuZXcgRXJyb3IoYCR7dHlwZX06ICR7SlNPTi5zdHJpbmdpZnkoZGV0YWlscyl9YClcbiAgICBcbiAgICAvLyDlj5HpgIHplJnor6/kuovku7ZcbiAgICB0aGlzLmVtaXRFdmVudCh7XG4gICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgY3VycmVudFN0YXRlOiB0aGlzLmN1cnJlbnRTdGF0ZSxcbiAgICAgIGRldGFpbHM6IHsgdHlwZSwgZGV0YWlscyB9XG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDlop7lvLrnmoTnvZHnu5znirbmgIHor4TkvLBcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0RW5oYW5jZWROZXR3b3JrSW5mbygpOiBQcm9taXNlPE5ldHdvcmtJbmZvPiB7XG4gICAgY29uc3QgYmFzZUluZm8gPSBhd2FpdCB0aGlzLmdldEN1cnJlbnROZXR3b3JrSW5mbygpXG4gICAgXG4gICAgLy8g5omn6KGM5pu05rex5YWl55qE572R57uc6LSo6YeP5YiG5p6QXG4gICAgY29uc3QgcXVhbGl0eUFuYWx5c2lzID0gYXdhaXQgdGhpcy5wZXJmb3JtUXVhbGl0eUFuYWx5c2lzKClcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgLi4uYmFzZUluZm8sXG4gICAgICAuLi5xdWFsaXR5QW5hbHlzaXNcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5omn6KGM572R57uc6LSo6YeP5YiG5p6QXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1RdWFsaXR5QW5hbHlzaXMoKTogUHJvbWlzZTxQYXJ0aWFsPE5ldHdvcmtJbmZvPj4ge1xuICAgIGNvbnN0IGFuYWx5c2lzOiBQYXJ0aWFsPE5ldHdvcmtJbmZvPiA9IHt9XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIOa1i+mHj+WunumZheS4i+i9vemAn+W6plxuICAgICAgY29uc3QgZG93bmxvYWRTcGVlZCA9IGF3YWl0IHRoaXMubWVhc3VyZURvd25sb2FkU3BlZWQoKVxuICAgICAgaWYgKGRvd25sb2FkU3BlZWQgPiAwKSB7XG4gICAgICAgIGFuYWx5c2lzLmRvd25saW5rID0gZG93bmxvYWRTcGVlZFxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDmtYvph4/lrp7pmYXlu7bov59cbiAgICAgIGNvbnN0IGxhdGVuY3kgPSBhd2FpdCB0aGlzLm1lYXN1cmVMYXRlbmN5KClcbiAgICAgIGlmIChsYXRlbmN5ID4gMCkge1xuICAgICAgICBhbmFseXNpcy5ydHQgPSBsYXRlbmN5XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOajgOa1i+e9kee7nOaKluWKqFxuICAgICAgY29uc3Qgaml0dGVyID0gYXdhaXQgdGhpcy5tZWFzdXJlSml0dGVyKClcbiAgICAgIGlmIChqaXR0ZXIgPiAwKSB7XG4gICAgICAgIC8vIOWwhuaKluWKqOS/oeaBr+a3u+WKoOWIsOaJqeWxleWxnuaAp1xuICAgICAgICAoYW5hbHlzaXMgYXMgYW55KS5qaXR0ZXIgPSBqaXR0ZXJcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g5qOA5rWL5Lii5YyF546HXG4gICAgICBjb25zdCBwYWNrZXRMb3NzID0gYXdhaXQgdGhpcy5lc3RpbWF0ZVBhY2tldExvc3MoKVxuICAgICAgaWYgKHBhY2tldExvc3MgPj0gMCkge1xuICAgICAgICB0aGlzLnN0YXRzLnBhY2tldExvc3MgPSBwYWNrZXRMb3NzXG4gICAgICB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdRdWFsaXR5IGFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcilcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGFuYWx5c2lzXG4gIH1cblxuICAvKipcbiAgICog5rWL6YeP5LiL6L296YCf5bqmXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIG1lYXN1cmVEb3dubG9hZFNwZWVkKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRlc3REYXRhID0gbmV3IEFycmF5KDEwMjQpLmZpbGwoJ3Rlc3QnKS5qb2luKCcnKSAvLyB+NEtCIHRlc3QgZGF0YVxuICAgICAgY29uc3QgdGVzdFVybCA9IGBkYXRhOnRleHQvcGxhaW47YmFzZTY0LCR7YnRvYSh0ZXN0RGF0YSl9YFxuICAgICAgXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh0ZXN0VXJsKVxuICAgICAgYXdhaXQgcmVzcG9uc2UudGV4dCgpXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgICBcbiAgICAgIC8vIOiuoeeul+mAn+W6piAoS0IvcylcbiAgICAgIGNvbnN0IHNwZWVkS2JQZXJTZWMgPSAodGVzdERhdGEubGVuZ3RoIC8gMTAyNCkgLyAoZHVyYXRpb24gLyAxMDAwKVxuICAgICAgcmV0dXJuIHNwZWVkS2JQZXJTZWMgKiA4IC8gMTAyNCAvLyDovazmjaLkuLogTWJwc1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIDBcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5rWL6YeP5bu26L+fXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIG1lYXN1cmVMYXRlbmN5KCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG1lYXN1cmVtZW50czogbnVtYmVyW10gPSBbXVxuICAgICAgXG4gICAgICAvLyDov5vooYwz5qyh5rWL6YeP5Y+W5bmz5Z2H5YC8XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkrKykge1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKVxuICAgICAgICBhd2FpdCBmZXRjaCgnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9mYXZpY29uLmljbycsIHtcbiAgICAgICAgICBtZXRob2Q6ICdIRUFEJyxcbiAgICAgICAgICBtb2RlOiAnbm8tY29ycycsXG4gICAgICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDMwMDApXG4gICAgICAgIH0pXG4gICAgICAgIG1lYXN1cmVtZW50cy5wdXNoKHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gbWVhc3VyZW1lbnRzLnJlZHVjZSgoc3VtLCB0aW1lKSA9PiBzdW0gKyB0aW1lLCAwKSAvIG1lYXN1cmVtZW50cy5sZW5ndGhcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiAwXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa1i+mHj+e9kee7nOaKluWKqFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBtZWFzdXJlSml0dGVyKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG1lYXN1cmVtZW50czogbnVtYmVyW10gPSBbXVxuICAgICAgXG4gICAgICAvLyDov5vooYw15qyh5bu26L+f5rWL6YePXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDU7IGkrKykge1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKVxuICAgICAgICBhd2FpdCBmZXRjaCgnaHR0cHM6Ly93d3cuY2xvdWRmbGFyZS5jb20vZmF2aWNvbi5pY28nLCB7XG4gICAgICAgICAgbWV0aG9kOiAnSEVBRCcsXG4gICAgICAgICAgbW9kZTogJ25vLWNvcnMnLFxuICAgICAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCgyMDAwKVxuICAgICAgICB9KVxuICAgICAgICBtZWFzdXJlbWVudHMucHVzaChwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g6K6h566X5qCH5YeG5beu5L2c5Li65oqW5YqoXG4gICAgICBjb25zdCBtZWFuID0gbWVhc3VyZW1lbnRzLnJlZHVjZSgoc3VtLCB0aW1lKSA9PiBzdW0gKyB0aW1lLCAwKSAvIG1lYXN1cmVtZW50cy5sZW5ndGhcbiAgICAgIGNvbnN0IHZhcmlhbmNlID0gbWVhc3VyZW1lbnRzLnJlZHVjZSgoc3VtLCB0aW1lKSA9PiBzdW0gKyBNYXRoLnBvdyh0aW1lIC0gbWVhbiwgMiksIDApIC8gbWVhc3VyZW1lbnRzLmxlbmd0aFxuICAgICAgXG4gICAgICByZXR1cm4gTWF0aC5zcXJ0KHZhcmlhbmNlKVxuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIDBcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Lyw566X5Lii5YyF546HXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGVzdGltYXRlUGFja2V0TG9zcygpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0b3RhbFBpbmdzID0gMTBcbiAgICAgIGxldCBzdWNjZXNzZnVsUGluZ3MgPSAwXG4gICAgICBcbiAgICAgIGNvbnN0IHBpbmdQcm9taXNlcyA9IEFycmF5KHRvdGFsUGluZ3MpLmZpbGwoMCkubWFwKGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBmZXRjaCgnaHR0cHM6Ly93d3cuZ2l0aHViLmNvbS9mYXZpY29uLmljbycsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0hFQUQnLFxuICAgICAgICAgICAgbW9kZTogJ25vLWNvcnMnLFxuICAgICAgICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDEwMDApXG4gICAgICAgICAgfSlcbiAgICAgICAgICBzdWNjZXNzZnVsUGluZ3MrK1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAvLyBQaW5n5aSx6LSl77yM5LiN5aKe5Yqg6K6h5pWwXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChwaW5nUHJvbWlzZXMpXG4gICAgICBcbiAgICAgIHJldHVybiAxIC0gKHN1Y2Nlc3NmdWxQaW5ncyAvIHRvdGFsUGluZ3MpXG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gMFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmmbrog73nvZHnu5znirbmgIHpooTmtYtcbiAgICovXG4gIGFzeW5jIHByZWRpY3ROZXR3b3JrU3RhYmlsaXR5KCk6IFByb21pc2U8e1xuICAgIGlzU3RhYmxlOiBib29sZWFuXG4gICAgY29uZmlkZW5jZTogbnVtYmVyXG4gICAgcHJlZGljdGVkRHVyYXRpb246IG51bWJlclxuICAgIHJlY29tbWVuZGF0aW9uczogc3RyaW5nW11cbiAgfT4ge1xuICAgIGNvbnN0IHJlY2VudEhpc3RvcnkgPSB0aGlzLnN0YXRzLnF1YWxpdHlIaXN0b3J5LnNsaWNlKC0xMClcbiAgICBcbiAgICBpZiAocmVjZW50SGlzdG9yeS5sZW5ndGggPCA1KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1N0YWJsZTogdGhpcy5jdXJyZW50U3RhdGUub25saW5lLFxuICAgICAgICBjb25maWRlbmNlOiAwLjUsXG4gICAgICAgIHByZWRpY3RlZER1cmF0aW9uOiAzMDAsIC8vIDXliIbpkp9cbiAgICAgICAgcmVjb21tZW5kYXRpb25zOiBbJ+mcgOimgeabtOWkmuaVsOaNruadpei/m+ihjOWHhuehrumihOa1iyddXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIOWIhuaekOi2i+WKv1xuICAgIGNvbnN0IHF1YWxpdHlUcmVuZCA9IHRoaXMuYW5hbHl6ZVF1YWxpdHlUcmVuZChyZWNlbnRIaXN0b3J5KVxuICAgIGNvbnN0IHN0YWJpbGl0eVNjb3JlID0gdGhpcy5jYWxjdWxhdGVTdGFiaWxpdHlTY29yZShyZWNlbnRIaXN0b3J5KVxuICAgIFxuICAgIGNvbnN0IGlzU3RhYmxlID0gc3RhYmlsaXR5U2NvcmUgPiAwLjcgJiYgcXVhbGl0eVRyZW5kICE9PSAnZGVncmFkaW5nJ1xuICAgIGNvbnN0IGNvbmZpZGVuY2UgPSBNYXRoLm1pbihzdGFiaWxpdHlTY29yZSwgcmVjZW50SGlzdG9yeS5sZW5ndGggLyAxMClcbiAgICBcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSB0aGlzLmdlbmVyYXRlTmV0d29ya1JlY29tbWVuZGF0aW9ucyhxdWFsaXR5VHJlbmQsIHN0YWJpbGl0eVNjb3JlKVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpc1N0YWJsZSxcbiAgICAgIGNvbmZpZGVuY2UsXG4gICAgICBwcmVkaWN0ZWREdXJhdGlvbjogdGhpcy5wcmVkaWN0U3RhYmxlRHVyYXRpb24oc3RhYmlsaXR5U2NvcmUpLFxuICAgICAgcmVjb21tZW5kYXRpb25zXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIhuaekOi0qOmHj+i2i+WKv1xuICAgKi9cbiAgcHJpdmF0ZSBhbmFseXplUXVhbGl0eVRyZW5kKGhpc3Rvcnk6IEFycmF5PHsgdGltZXN0YW1wOiBEYXRlOyBzY29yZTogbnVtYmVyIH0+KTogJ2ltcHJvdmluZycgfCAnc3RhYmxlJyB8ICdkZWdyYWRpbmcnIHtcbiAgICBpZiAoaGlzdG9yeS5sZW5ndGggPCAzKSByZXR1cm4gJ3N0YWJsZSdcbiAgICBcbiAgICBjb25zdCByZWNlbnRTY29yZXMgPSBoaXN0b3J5LnNsaWNlKC0zKS5tYXAoaCA9PiBoLnNjb3JlKVxuICAgIGNvbnN0IG9sZGVyU2NvcmVzID0gaGlzdG9yeS5zbGljZSgtNiwgLTMpLm1hcChoID0+IGguc2NvcmUpXG4gICAgXG4gICAgY29uc3QgcmVjZW50QXZnID0gcmVjZW50U2NvcmVzLnJlZHVjZSgoc3VtLCBzY29yZSkgPT4gc3VtICsgc2NvcmUsIDApIC8gcmVjZW50U2NvcmVzLmxlbmd0aFxuICAgIGNvbnN0IG9sZGVyQXZnID0gb2xkZXJTY29yZXMucmVkdWNlKChzdW0sIHNjb3JlKSA9PiBzdW0gKyBzY29yZSwgMCkgLyBvbGRlclNjb3Jlcy5sZW5ndGhcbiAgICBcbiAgICBjb25zdCBjaGFuZ2UgPSByZWNlbnRBdmcgLSBvbGRlckF2Z1xuICAgIFxuICAgIGlmIChjaGFuZ2UgPiAwLjEpIHJldHVybiAnaW1wcm92aW5nJ1xuICAgIGlmIChjaGFuZ2UgPCAtMC4xKSByZXR1cm4gJ2RlZ3JhZGluZydcbiAgICByZXR1cm4gJ3N0YWJsZSdcbiAgfVxuXG4gIC8qKlxuICAgKiDorqHnrpfnqLPlrprmgKflvpfliIZcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlU3RhYmlsaXR5U2NvcmUoaGlzdG9yeTogQXJyYXk8eyB0aW1lc3RhbXA6IERhdGU7IHNjb3JlOiBudW1iZXIgfT4pOiBudW1iZXIge1xuICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcbiAgICBcbiAgICBjb25zdCBzY29yZXMgPSBoaXN0b3J5Lm1hcChoID0+IGguc2NvcmUpXG4gICAgY29uc3QgbWVhbiA9IHNjb3Jlcy5yZWR1Y2UoKHN1bSwgc2NvcmUpID0+IHN1bSArIHNjb3JlLCAwKSAvIHNjb3Jlcy5sZW5ndGhcbiAgICBjb25zdCB2YXJpYW5jZSA9IHNjb3Jlcy5yZWR1Y2UoKHN1bSwgc2NvcmUpID0+IHN1bSArIE1hdGgucG93KHNjb3JlIC0gbWVhbiwgMiksIDApIC8gc2NvcmVzLmxlbmd0aFxuICAgIGNvbnN0IHN0YW5kYXJkRGV2aWF0aW9uID0gTWF0aC5zcXJ0KHZhcmlhbmNlKVxuICAgIFxuICAgIC8vIOeos+WumuaAp+W+l+WIhuWfuuS6juagh+WHhuW3ru+8jOagh+WHhuW3rui2iuWwj+i2iueos+WumlxuICAgIHJldHVybiBNYXRoLm1heCgwLCAxIC0gKHN0YW5kYXJkRGV2aWF0aW9uIC8gbWVhbikpXG4gIH1cblxuICAvKipcbiAgICog55Sf5oiQ572R57uc5bu66K6uXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlTmV0d29ya1JlY29tbWVuZGF0aW9ucyh0cmVuZDogc3RyaW5nLCBzdGFiaWxpdHk6IG51bWJlcik6IHN0cmluZ1tdIHtcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICBpZiAodHJlbmQgPT09ICdkZWdyYWRpbmcnKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgn572R57uc6LSo6YeP5q2j5Zyo5LiL6ZmN77yM5bu66K6u5qOA5p+l572R57uc6L+e5o6lJylcbiAgICAgIGlmIChzdGFiaWxpdHkgPCAwLjUpIHtcbiAgICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ+e9kee7nOi/nuaOpeS4jeeos+Wumu+8jOW7uuiuruWIh+aNouWIsOabtOeos+WumueahOe9kee7nCcpXG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0cmVuZCA9PT0gJ2ltcHJvdmluZycpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCfnvZHnu5zotKjph4/mraPlnKjmlLnlloQnKVxuICAgIH1cbiAgICBcbiAgICBpZiAoc3RhYmlsaXR5ID4gMC44KSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgn572R57uc6L+e5o6l56iz5a6a77yM5Y+v5Lul6L+b6KGM5aSn6YeP5pWw5o2u5ZCM5q2lJylcbiAgICB9IGVsc2UgaWYgKHN0YWJpbGl0eSA8IDAuNSkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ+W7uuiuruWQr+eUqOaVsOaNruWOi+e8qeWSjOemu+e6v+aooeW8jycpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnNcbiAgfVxuXG4gIC8qKlxuICAgKiDpooTmtYvnqLPlrprmjIHnu63ml7bpl7RcbiAgICovXG4gIHByaXZhdGUgcHJlZGljdFN0YWJsZUR1cmF0aW9uKHN0YWJpbGl0eVNjb3JlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIC8vIOWfuuS6jueos+WumuaAp+W+l+WIhumihOa1i+eos+WumuaMgee7reaXtumXtO+8iOenku+8iVxuICAgIGlmIChzdGFiaWxpdHlTY29yZSA+IDAuOSkgcmV0dXJuIDM2MDAgLy8gMeWwj+aXtlxuICAgIGlmIChzdGFiaWxpdHlTY29yZSA+IDAuNykgcmV0dXJuIDE4MDAgLy8gMzDliIbpkp9cbiAgICBpZiAoc3RhYmlsaXR5U2NvcmUgPiAwLjUpIHJldHVybiA2MDAgIC8vIDEw5YiG6ZKfXG4gICAgcmV0dXJuIDMwMCAvLyA15YiG6ZKfXG4gIH1cblxuICAvLyDplIDmr4HmnI3liqFcbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLnN0b3BNb25pdG9yaW5nKClcbiAgICBcbiAgICAvLyDmuIXnkIbkuovku7bnm5HlkKzlmahcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignb25saW5lJywgdGhpcy5oYW5kbGVPbmxpbmUuYmluZCh0aGlzKSlcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignb2ZmbGluZScsIHRoaXMuaGFuZGxlT2ZmbGluZS5iaW5kKHRoaXMpKVxuICAgIFxuICAgIGlmICh0aGlzLmNvbm5lY3Rpb24pIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvbi5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLmhhbmRsZUNvbm5lY3Rpb25DaGFuZ2UuYmluZCh0aGlzKSlcbiAgICB9XG4gICAgXG4gICAgLy8g5riF55CG5a6a5pe25ZmoXG4gICAgaWYgKHRoaXMuZGVib3VuY2VUaW1lcikge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZGVib3VuY2VUaW1lcilcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ05ldHdvcmtNb25pdG9yU2VydmljZSBkZXN0cm95ZWQnKVxuICB9XG59XG5cbi8vIOWvvOWHuuWNleS+i+WunuS+i1xuZXhwb3J0IGNvbnN0IG5ldHdvcmtNb25pdG9yU2VydmljZSA9IG5ldyBOZXR3b3JrTW9uaXRvclNlcnZpY2UoKVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDlr7zlh7rlt6Xlhbflh73mlbBcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy8g562J5b6F572R57uc5oGi5aSNXG5leHBvcnQgY29uc3Qgd2FpdEZvck5ldHdvcmsgPSAodGltZW91dDogbnVtYmVyID0gMzAwMDApOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpZiAobmF2aWdhdG9yLm9uTGluZSkge1xuICAgICAgcmVzb2x2ZSgpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgXG4gICAgY29uc3QgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNsZWFudXAoKVxuICAgICAgcmVqZWN0KG5ldyBFcnJvcignTmV0d29yayB0aW1lb3V0JykpXG4gICAgfSwgdGltZW91dClcbiAgICBcbiAgICBjb25zdCBoYW5kbGVPbmxpbmUgPSAoKSA9PiB7XG4gICAgICBjbGVhbnVwKClcbiAgICAgIHJlc29sdmUoKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBjbGVhbnVwID0gKCkgPT4ge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKVxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29ubGluZScsIGhhbmRsZU9ubGluZSlcbiAgICB9XG4gICAgXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29ubGluZScsIGhhbmRsZU9ubGluZSlcbiAgfSlcbn1cblxuLy8g6I635Y+W5pyA5L2z572R57uc562W55WlXG5leHBvcnQgY29uc3QgZ2V0TmV0d29ya1N0cmF0ZWd5ID0gKCk6IHtcbiAgYmF0Y2hTaXplOiBudW1iZXJcbiAgdGltZW91dDogbnVtYmVyXG4gIHJldHJ5U3RyYXRlZ3k6ICdhZ2dyZXNzaXZlJyB8ICdjb25zZXJ2YXRpdmUnIHwgJ25vcm1hbCdcbiAgY29tcHJlc3Npb25FbmFibGVkOiBib29sZWFuXG59ID0+IHtcbiAgY29uc3QgcXVhbGl0eSA9IG5ldHdvcmtNb25pdG9yU2VydmljZS5nZXROZXR3b3JrUXVhbGl0eSgpXG4gIFxuICBzd2l0Y2ggKHF1YWxpdHkpIHtcbiAgICBjYXNlICdleGNlbGxlbnQnOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYmF0Y2hTaXplOiA1MCxcbiAgICAgICAgdGltZW91dDogMTAwMDAsXG4gICAgICAgIHJldHJ5U3RyYXRlZ3k6ICdhZ2dyZXNzaXZlJyBhcyBjb25zdCxcbiAgICAgICAgY29tcHJlc3Npb25FbmFibGVkOiBmYWxzZVxuICAgICAgfVxuICAgIGNhc2UgJ2dvb2QnOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYmF0Y2hTaXplOiAyNSxcbiAgICAgICAgdGltZW91dDogMTUwMDAsXG4gICAgICAgIHJldHJ5U3RyYXRlZ3k6ICdub3JtYWwnIGFzIGNvbnN0LFxuICAgICAgICBjb21wcmVzc2lvbkVuYWJsZWQ6IGZhbHNlXG4gICAgICB9XG4gICAgY2FzZSAnZmFpcic6XG4gICAgICByZXR1cm4ge1xuICAgICAgICBiYXRjaFNpemU6IDEwLFxuICAgICAgICB0aW1lb3V0OiAzMDAwMCxcbiAgICAgICAgcmV0cnlTdHJhdGVneTogJ25vcm1hbCcgYXMgY29uc3QsXG4gICAgICAgIGNvbXByZXNzaW9uRW5hYmxlZDogdHJ1ZVxuICAgICAgfVxuICAgIGNhc2UgJ3Bvb3InOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYmF0Y2hTaXplOiA1LFxuICAgICAgICB0aW1lb3V0OiA2MDAwMCxcbiAgICAgICAgcmV0cnlTdHJhdGVneTogJ2NvbnNlcnZhdGl2ZScgYXMgY29uc3QsXG4gICAgICAgIGNvbXByZXNzaW9uRW5hYmxlZDogdHJ1ZVxuICAgICAgfVxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4ge1xuICAgICAgICBiYXRjaFNpemU6IDEsXG4gICAgICAgIHRpbWVvdXQ6IDEyMDAwMCxcbiAgICAgICAgcmV0cnlTdHJhdGVneTogJ2NvbnNlcnZhdGl2ZScgYXMgY29uc3QsXG4gICAgICAgIGNvbXByZXNzaW9uRW5hYmxlZDogdHJ1ZVxuICAgICAgfVxuICB9XG59Il0sInZlcnNpb24iOjN9