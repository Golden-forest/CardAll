ed5710b94251db863394c74d89010eb6
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.clearQueryCache = exports.cachedQuery = exports.validateCardData = exports.batchOperation = exports.generateSearchVector = exports.convertFromDbCard = exports.convertToDbCard = exports.initializeDatabase = exports.db = void 0;
const dexie_1 = require("dexie");
// ============================================================================
// 统一数据库类
// ============================================================================
class CardAllUnifiedDatabase extends dexie_1.default {
    constructor() {
        super('CardAllUnifiedDatabase');
        // 数据表定义
        Object.defineProperty(this, "cards", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "folders", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "tags", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "images", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "syncQueue", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "settings", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "sessions", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // 离线数据持久化增强表
        Object.defineProperty(this, "offlineSnapshots", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "offlineBackups", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        // 版本 4: 添加离线数据持久化功能
        this.version(4).stores({
            // 核心实体表 - 优化的索引设计
            cards: '++id, userId, folderId, createdAt, updatedAt, syncVersion, pendingSync, [userId+folderId], searchVector',
            folders: '++id, userId, parentId, createdAt, updatedAt, syncVersion, pendingSync, [userId+parentId], fullPath, depth',
            tags: '++id, userId, name, createdAt, syncVersion, pendingSync, [userId+name]',
            images: '++id, cardId, userId, createdAt, updatedAt, syncVersion, pendingSync, storageMode, [cardId+userId]',
            // 同步和设置表
            syncQueue: '++id, type, entity, entityId, userId, timestamp, retryCount, priority, [userId+priority]',
            settings: '++id, key, updatedAt, scope, [key+scope]',
            sessions: '++id, userId, deviceId, lastActivity, isActive, [userId+deviceId]',
            // 离线数据持久化表
            offlineSnapshots: '++id, timestamp, userId, version, dataHash, dataSize, [userId+timestamp]',
            offlineBackups: '++id, snapshotId, createdAt, compression, encrypted, size, [snapshotId+createdAt]'
        });
        // 数据库升级逻辑 - 支持从旧版本迁移
        this.upgradeDatabase();
    }
    async upgradeDatabase() {
        // 版本 1 -> 2: 添加用户支持
        this.version(2).upgrade(async (tx) => {
            console.log('Upgrading to version 2: Adding user support...');
            // 检查是否需要从旧数据库迁移
            const oldDb = new CardAllDatabase_v1();
            try {
                await oldDb.open();
                console.log('Found old database, migrating data...');
                // 迁移卡片
                const oldCards = await oldDb.cards.toArray();
                const newCards = oldCards.map(card => ({
                    ...card,
                    userId: 'default', // 设置默认用户
                    updatedAt: new Date()
                }));
                await this.cards.bulkAdd(newCards);
                // 迁移文件夹
                const oldFolders = await oldDb.folders.toArray();
                const newFolders = oldFolders.map(folder => ({
                    ...folder,
                    userId: 'default',
                    updatedAt: new Date()
                }));
                await this.folders.bulkAdd(newFolders);
                // 迁移标签
                const oldTags = await oldDb.tags.toArray();
                const newTags = oldTags.map(tag => ({
                    ...tag,
                    userId: 'default',
                    updatedAt: new Date()
                }));
                await this.tags.bulkAdd(newTags);
                console.log('Migration completed successfully');
            }
            catch (error) {
                console.log('No old database found or migration failed:', error);
            }
        });
        // 版本 2 -> 3: 优化索引和添加新功能
        this.version(3).upgrade(async (tx) => {
            console.log('Upgrading to version 3: Optimizing indexes and adding new features...');
            // 添加默认设置
            await this.initializeDefaultSettings();
            // 重建搜索索引
            await this.rebuildSearchIndexes();
        });
        // 版本 3 -> 4: 添加离线数据持久化功能
        this.version(4).upgrade(async (tx) => {
            console.log('Upgrading to version 4: Adding offline data persistence features...');
            // 初始化离线数据持久化配置
            await this.initializeOfflinePersistence();
            // 创建初始离线快照
            await this.createInitialOfflineSnapshot();
        });
    }
    async initializeDefaultSettings() {
        const defaultSettings = [
            {
                key: 'storageMode',
                value: 'hybrid',
                scope: 'global',
                updatedAt: new Date()
            },
            {
                key: 'syncEnabled',
                value: true,
                scope: 'global',
                updatedAt: new Date()
            },
            {
                key: 'imageCompression',
                value: {
                    enabled: true,
                    quality: 0.8,
                    maxWidth: 1920,
                    maxHeight: 1080,
                    format: 'webp'
                },
                scope: 'global',
                updatedAt: new Date()
            },
            {
                key: 'databaseVersion',
                value: '3.0.0',
                scope: 'global',
                updatedAt: new Date()
            }
        ];
        for (const setting of defaultSettings) {
            const exists = await this.settings.where('key').equals(setting.key).first();
            if (!exists) {
                await this.settings.add(setting);
            }
        }
    }
    async rebuildSearchIndexes() {
        console.log('Rebuilding search indexes...');
        // 这里可以实现搜索索引的重建逻辑
    }
    // ============================================================================
    // 离线数据持久化增强方法
    // ============================================================================
    /**
     * 初始化离线数据持久化
     */
    async initializeOfflinePersistence() {
        console.log('Initializing offline persistence...');
        // 添加离线数据持久化的默认设置
        const offlineSettings = [
            {
                key: 'offlineAutoBackup',
                value: {
                    enabled: true,
                    interval: 30 * 60 * 1000, // 30分钟
                    maxBackups: 10,
                    compression: true
                },
                scope: 'global',
                updatedAt: new Date()
            },
            {
                key: 'offlineCompression',
                value: {
                    enabled: true,
                    algorithm: 'lz-string',
                    threshold: 1024, // 1KB以上才压缩
                    quality: 0.8
                },
                scope: 'global',
                updatedAt: new Date()
            },
            {
                key: 'offlineDataRetention',
                value: {
                    days: 30,
                    maxSize: 100 // 100MB
                },
                scope: 'global',
                updatedAt: new Date()
            }
        ];
        for (const setting of offlineSettings) {
            const exists = await this.settings.where('key').equals(setting.key).first();
            if (!exists) {
                await this.settings.add(setting);
            }
        }
    }
    /**
     * 创建初始离线快照
     */
    async createInitialOfflineSnapshot() {
        try {
            const snapshot = await this.createOfflineSnapshot({
                includeCards: true,
                includeFolders: true,
                includeTags: true,
                includeSettings: true,
                includeImages: false // 初始快照不包括图片，因为图片较大
            });
            console.log('Initial offline snapshot created:', snapshot.id);
        }
        catch (error) {
            console.error('Failed to create initial offline snapshot:', error);
        }
    }
    /**
     * 创建离线快照
     */
    async createOfflineSnapshot(options = {}) {
        const { includeCards = true, includeFolders = true, includeTags = true, includeImages = false, includeSettings = true, userId } = options;
        const snapshotId = crypto.randomUUID();
        const timestamp = new Date();
        // 收集数据
        const data = {};
        let totalSize = 0;
        if (includeCards) {
            data.cards = await this.cards.toArray();
            totalSize += JSON.stringify(data.cards).length;
        }
        if (includeFolders) {
            data.folders = await this.folders.toArray();
            totalSize += JSON.stringify(data.folders).length;
        }
        if (includeTags) {
            data.tags = await this.tags.toArray();
            totalSize += JSON.stringify(data.tags).length;
        }
        if (includeImages) {
            data.images = await this.images.toArray();
            totalSize += JSON.stringify(data.images).length;
        }
        if (includeSettings) {
            data.settings = await this.settings.toArray();
            totalSize += JSON.stringify(data.settings).length;
        }
        // 计算数据哈希
        const dataHash = await this.calculateDataHash(data);
        // 获取设备信息
        const deviceInfo = await this.getDeviceInfo();
        const storageQuota = await this.getStorageQuota();
        const snapshot = {
            id: snapshotId,
            timestamp,
            version: '4.0.0',
            userId,
            dataHash,
            dataSize: totalSize,
            compressedSize: totalSize, // 初始未压缩
            includes: {
                cards: includeCards,
                folders: includeFolders,
                tags: includeTags,
                images: includeImages,
                settings: includeSettings
            },
            metadata: {
                deviceInfo,
                networkStatus: navigator.onLine ? 'online' : 'offline',
                batteryLevel: navigator.getBattery?.() ? undefined : undefined,
                storageQuota
            }
        };
        await this.offlineSnapshots.add(snapshot);
        return snapshot;
    }
    /**
     * 计算数据哈希
     */
    async calculateDataHash(data) {
        const dataString = JSON.stringify(data);
        const encoder = new TextEncoder();
        const dataBuffer = encoder.encode(dataString);
        const hashBuffer = await crypto.subtle.digest('SHA-256', dataBuffer);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
    /**
     * 获取设备信息
     */
    async getDeviceInfo() {
        const info = {
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            language: navigator.language,
            deviceMemory: navigator.deviceMemory,
            hardwareConcurrency: navigator.hardwareConcurrency,
            screenResolution: `${screen.width}x${screen.height}`,
            timestamp: new Date().toISOString()
        };
        return JSON.stringify(info);
    }
    /**
     * 获取存储配额信息
     */
    async getStorageQuota() {
        try {
            if ('storage' in navigator && 'estimate' in navigator.storage) {
                const estimate = await navigator.storage.estimate();
                return {
                    used: estimate.usage || 0,
                    total: estimate.quota || 0
                };
            }
        }
        catch (error) {
            console.warn('Failed to get storage quota:', error);
        }
        return { used: 0, total: 0 };
    }
    /**
     * 恢复离线快照
     */
    async restoreOfflineSnapshot(snapshotId) {
        try {
            const snapshot = await this.offlineSnapshots.get(snapshotId);
            if (!snapshot) {
                throw new Error('Snapshot not found');
            }
            // 检查数据完整性
            const currentData = await this.getCurrentDataHash();
            if (currentData === snapshot.dataHash) {
                console.log('Data already matches snapshot, no restore needed');
                return true;
            }
            // 恢复数据
            if (snapshot.includes.cards) {
                const backupCards = await this.cards.toArray();
                await this.cards.clear();
                // 这里需要从备份中恢复卡片数据
                // 由于快照只存储元数据，实际恢复需要更复杂的逻辑
            }
            if (snapshot.includes.folders) {
                const backupFolders = await this.folders.toArray();
                await this.folders.clear();
                // 恢复文件夹数据
            }
            if (snapshot.includes.tags) {
                const backupTags = await this.tags.toArray();
                await this.tags.clear();
                // 恢复标签数据
            }
            if (snapshot.includes.settings) {
                const backupSettings = await this.settings.toArray();
                await this.settings.clear();
                // 恢复设置数据
            }
            console.log('Offline snapshot restored successfully:', snapshotId);
            return true;
        }
        catch (error) {
            console.error('Failed to restore offline snapshot:', error);
            return false;
        }
    }
    /**
     * 获取当前数据哈希
     */
    async getCurrentDataHash() {
        const data = {
            cards: await this.cards.toArray(),
            folders: await this.folders.toArray(),
            tags: await this.tags.toArray(),
            settings: await this.settings.toArray()
        };
        return await this.calculateDataHash(data);
    }
    /**
     * 智能清理离线数据
     */
    async cleanupOfflineData() {
        const now = new Date();
        let cleanedSnapshots = 0;
        let cleanedBackups = 0;
        let freedSpace = 0;
        try {
            // 获取清理策略
            const retentionDays = await this.getSetting('offlineDataRetention')?.days || 30;
            const maxSizeMB = await this.getSetting('offlineDataRetention')?.maxSize || 100;
            const cutoffDate = new Date(now.getTime() - retentionDays * 24 * 60 * 60 * 1000);
            // 清理过期快照
            const expiredSnapshots = await this.offlineSnapshots
                .where('timestamp')
                .below(cutoffDate)
                .toArray();
            for (const snapshot of expiredSnapshots) {
                freedSpace += snapshot.dataSize;
                await this.offlineSnapshots.delete(snapshot.id);
                cleanedSnapshots++;
            }
            // 清理过期备份
            const expiredBackups = await this.offlineBackups
                .where('createdAt')
                .below(cutoffDate)
                .toArray();
            for (const backup of expiredBackups) {
                freedSpace += backup.size;
                await this.offlineBackups.delete(backup.id);
                cleanedBackups++;
            }
            // 如果存储空间仍然过大，按时间清理最旧的快照
            const currentSnapshots = await this.offlineSnapshots.orderBy('timestamp').reverse().toArray();
            let totalSize = currentSnapshots.reduce((sum, s) => sum + s.dataSize, 0);
            while (totalSize > maxSizeMB * 1024 * 1024 && currentSnapshots.length > 5) {
                const oldestSnapshot = currentSnapshots.pop();
                if (oldestSnapshot) {
                    freedSpace += oldestSnapshot.dataSize;
                    await this.offlineSnapshots.delete(oldestSnapshot.id);
                    cleanedSnapshots++;
                    totalSize -= oldestSnapshot.dataSize;
                }
            }
            console.log(`Offline data cleanup completed: ${cleanedSnapshots} snapshots, ${cleanedBackups} backups, ${freedSpace} bytes freed`);
            return {
                cleanedSnapshots,
                cleanedBackups,
                freedSpace
            };
        }
        catch (error) {
            console.error('Failed to cleanup offline data:', error);
            return {
                cleanedSnapshots: 0,
                cleanedBackups: 0,
                freedSpace: 0
            };
        }
    }
    /**
     * 自动备份离线数据
     */
    async autoBackupOfflineData() {
        try {
            const backupConfig = await this.getSetting('offlineAutoBackup');
            if (!backupConfig?.enabled) {
                return false;
            }
            // 检查是否需要备份
            const lastBackup = await this.offlineSnapshots.orderBy('timestamp').reverse().first();
            const now = new Date();
            if (lastBackup) {
                const timeSinceLastBackup = now.getTime() - lastBackup.timestamp.getTime();
                if (timeSinceLastBackup < backupConfig.interval) {
                    return false; // 还未到备份时间
                }
            }
            // 创建新的快照
            const snapshot = await this.createOfflineSnapshot({
                includeCards: true,
                includeFolders: true,
                includeTags: true,
                includeImages: false, // 自动备份不包括大文件
                includeSettings: true
            });
            // 清理旧备份
            const maxBackups = backupConfig.maxBackups || 10;
            const allSnapshots = await this.offlineSnapshots.orderBy('timestamp').reverse().toArray();
            if (allSnapshots.length > maxBackups) {
                const snapshotsToDelete = allSnapshots.slice(maxBackups);
                for (const snapshot of snapshotsToDelete) {
                    await this.offlineSnapshots.delete(snapshot.id);
                }
            }
            console.log('Auto backup completed:', snapshot.id);
            return true;
        }
        catch (error) {
            console.error('Auto backup failed:', error);
            return false;
        }
    }
    /**
     * 获取离线数据统计
     */
    async getOfflineDataStats() {
        const snapshots = await this.offlineSnapshots.toArray();
        const backups = await this.offlineBackups.toArray();
        const totalSize = snapshots.reduce((sum, s) => sum + s.dataSize, 0) +
            backups.reduce((sum, b) => sum + b.size, 0);
        const lastBackup = snapshots.length > 0 ?
            snapshots.reduce((latest, s) => s.timestamp > latest.timestamp ? s : latest, snapshots[0]).timestamp :
            undefined;
        const oldestBackup = snapshots.length > 0 ?
            snapshots.reduce((oldest, s) => s.timestamp < oldest.timestamp ? s : oldest, snapshots[0]).timestamp :
            undefined;
        return {
            snapshots: snapshots.length,
            backups: backups.length,
            totalSize,
            lastBackup,
            oldestBackup
        };
    }
    // ============================================================================
    // 统一的CRUD操作方法
    // ============================================================================
    // 获取设置 - 支持用户级和全局设置
    async getSetting(key, userId) {
        // 优先返回用户级设置
        if (userId) {
            const userSetting = await this.settings
                .where('[key+scope]')
                .equals([key, 'user'])
                .and(setting => !setting.userId || setting.userId === userId)
                .first();
            if (userSetting)
                return userSetting.value;
        }
        // 返回全局设置
        const globalSetting = await this.settings
            .where('[key+scope]')
            .equals([key, 'global'])
            .first();
        return globalSetting?.value;
    }
    // 更新设置
    async updateSetting(key, value, scope = 'global', userId) {
        await this.settings.where('[key+scope]').equals([key, scope]).modify({
            value,
            userId,
            updatedAt: new Date()
        });
    }
    // 获取数据库统计信息
    async getStats() {
        const [cards, folders, tags, images, pendingSync] = await Promise.all([
            this.cards.count(),
            this.folders.count(),
            this.tags.count(),
            this.images.count(),
            this.syncQueue.count()
        ]);
        // 计算总大小（简化版本）
        const totalSize = await this.calculateTotalSize();
        return {
            cards,
            folders,
            tags,
            images,
            pendingSync,
            totalSize,
            version: '3.0.0'
        };
    }
    async calculateTotalSize() {
        // 计算所有图片的总大小
        const images = await this.images.toArray();
        return images.reduce((total, image) => total + image.metadata.size, 0);
    }
    // 统一的卡片操作
    async createCard(cardData, userId) {
        const id = crypto.randomUUID();
        const now = new Date();
        await this.cards.add({
            ...cardData,
            id,
            userId,
            syncVersion: 1,
            pendingSync: true,
            updatedAt: now
        });
        return id;
    }
    async updateCard(id, updates) {
        const result = await this.cards.update(id, {
            ...updates,
            syncVersion: updates.syncVersion ? updates.syncVersion + 1 : undefined,
            pendingSync: true,
            updatedAt: new Date()
        });
        return result;
    }
    async deleteCard(id) {
        await this.transaction('rw', [this.cards, this.images], async () => {
            // 删除相关图片
            await this.images.where('cardId').equals(id).delete();
            // 删除卡片
            await this.cards.delete(id);
        });
    }
    // 批量操作支持
    async bulkCreateCards(cardsData, userId) {
        const now = new Date();
        const cards = cardsData.map(cardData => ({
            ...cardData,
            id: crypto.randomUUID(),
            userId,
            syncVersion: 1,
            pendingSync: true,
            updatedAt: now
        }));
        await this.cards.bulkAdd(cards);
        return cards.map(card => card.id);
    }
    // 性能优化的查询方法
    async getCardsByFolder(folderId, userId) {
        return await this.cards
            .where('[userId+folderId]')
            .equals([userId || 'default', folderId])
            .toArray();
    }
    async searchCards(searchTerm, userId) {
        const searchLower = searchTerm.toLowerCase();
        return await this.cards
            .filter(card => card.searchVector?.includes(searchLower) ||
            card.frontContent.title.toLowerCase().includes(searchLower) ||
            card.frontContent.text.toLowerCase().includes(searchLower) ||
            card.backContent.title.toLowerCase().includes(searchLower) ||
            card.backContent.text.toLowerCase().includes(searchLower))
            .toArray();
    }
    // 数据库清理和优化
    async cleanup() {
        await this.transaction('rw', [this.cards, this.folders, this.tags, this.images, this.syncQueue], async () => {
            // 清理过期的同步操作
            const expiredDate = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000); // 7天前
            await this.syncQueue.where('timestamp').below(expiredDate).delete();
            // 清理孤立图片（没有对应卡片的图片）
            const cardIds = await this.cards.toCollection().primaryKeys();
            await this.images.where('cardId').noneOf(cardIds).delete();
            console.log('Database cleanup completed');
        });
    }
    // 数据库健康检查
    async healthCheck() {
        const issues = [];
        try {
            // 检查数据库连接
            await this.tables.toArray();
            // 检查数据一致性
            const stats = await this.getStats();
            // 检查是否有大量待同步项目
            if (stats.pendingSync > 1000) {
                issues.push(`High number of pending sync operations: ${stats.pendingSync}`);
            }
            // 检查数据库大小
            if (stats.totalSize > 500 * 1024 * 1024) { // 500MB
                issues.push(`Database size is large: ${(stats.totalSize / 1024 / 1024).toFixed(2)} MB`);
            }
            return {
                isHealthy: issues.length === 0,
                issues,
                stats
            };
        }
        catch (error) {
            return {
                isHealthy: false,
                issues: [`Database connection failed: ${error}`],
                stats: { cards: 0, folders: 0, tags: 0, images: 0, pendingSync: 0, totalSize: 0, version: '3.0.0' }
            };
        }
    }
    // 完全清理数据库（谨慎使用）
    async clearAll() {
        await this.transaction('rw', [this.cards, this.folders, this.tags, this.images, this.syncQueue, this.settings, this.sessions], async () => {
            await this.cards.clear();
            await this.folders.clear();
            await this.tags.clear();
            await this.images.clear();
            await this.syncQueue.clear();
            // 保留设置，只清除用户数据
            await this.sessions.clear();
        });
    }
    // ============================================================================
    // 向后兼容的方法 - 保持现有代码不中断
    // ============================================================================
    // 旧版getSetting方法（保持兼容）
    async getSettingLegacy(key) {
        return await this.getSetting(key);
    }
    // 旧版updateSetting方法（保持兼容）
    async updateSettingLegacy(key, value) {
        await this.updateSetting(key, value);
    }
    // 旧版clearAll方法（保持兼容）
    async clearAllLegacy() {
        await this.transaction('rw', this.cards, this.folders, this.tags, this.images, this.syncQueue, async () => {
            await this.cards.clear();
            await this.folders.clear();
            await this.tags.clear();
            await this.images.clear();
            await this.syncQueue.clear();
        });
    }
    // 旧版getStats方法（保持兼容）
    async getStatsLegacy() {
        const stats = await this.getStats();
        return {
            cards: stats.cards,
            folders: stats.folders,
            tags: stats.tags,
            images: stats.images,
            pendingSync: stats.pendingSync
        };
    }
}
// ============================================================================
// 向后兼容支持
// ============================================================================
// 旧版本数据库类（用于迁移）
class CardAllDatabase_v1 extends dexie_1.default {
    constructor() {
        super('CardAllDatabase');
        Object.defineProperty(this, "cards", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "folders", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "tags", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "images", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "syncQueue", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "settings", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.version(1).stores({
            cards: '++id, folderId, createdAt, updatedAt, syncVersion, pendingSync',
            folders: '++id, parentId, createdAt, updatedAt, syncVersion, pendingSync',
            tags: '++id, name, createdAt, syncVersion, pendingSync',
            images: '++id, cardId, filePath, createdAt, syncVersion, pendingSync',
            syncQueue: '++id, type, entity, entityId, timestamp, retryCount',
            settings: '++id, key, updatedAt'
        });
    }
}
// 创建数据库实例
exports.db = new CardAllUnifiedDatabase();
// 数据库初始化
const initializeDatabase = async () => {
    try {
        await exports.db.open();
        console.log('CardAll unified database initialized successfully');
        // 执行健康检查
        const health = await exports.db.healthCheck();
        if (!health.isHealthy) {
            console.warn('Database health issues detected:', health.issues);
        }
        // 定期清理
        setInterval(() => {
            exports.db.cleanup().catch(console.error);
        }, 24 * 60 * 60 * 1000); // 每天清理一次
    }
    catch (error) {
        console.error('Failed to initialize database:', error);
        throw error;
    }
};
exports.initializeDatabase = initializeDatabase;
// 数据库错误处理
exports.db.on('error', (error) => {
    console.error('Database error:', error);
});
exports.db.on('blocked', () => {
    console.warn('Database operation blocked');
});
exports.db.on('versionchange', () => {
    console.warn('Database version changed, reloading page...');
    window.location.reload();
});
exports.db.on('ready', () => {
    console.log('Database is ready');
});
// ============================================================================
// 导出工具函数
// ============================================================================
// 数据转换工具
const convertToDbCard = (card, userId) => {
    return {
        ...card,
        userId,
        syncVersion: 1,
        pendingSync: true,
        updatedAt: new Date()
    };
};
exports.convertToDbCard = convertToDbCard;
const convertFromDbCard = (dbCard) => {
    const { userId, syncVersion, lastSyncAt, pendingSync, ...card } = dbCard;
    return {
        ...card,
        id: card.id || '',
        createdAt: new Date(card.createdAt),
        updatedAt: new Date(card.updatedAt)
    };
};
exports.convertFromDbCard = convertFromDbCard;
// 搜索优化工具
const generateSearchVector = (card) => {
    const searchableText = [
        card.frontContent.title,
        card.frontContent.text,
        card.backContent.title,
        card.backContent.text,
        ...card.frontContent.tags,
        ...card.backContent.tags
    ].join(' ').toLowerCase();
    return searchableText;
};
exports.generateSearchVector = generateSearchVector;
// 批量操作工具
const batchOperation = async (items, batchSize = 100, operation) => {
    for (let i = 0; i < items.length; i += batchSize) {
        const batch = items.slice(i, i + batchSize);
        await operation(batch);
    }
};
exports.batchOperation = batchOperation;
// 数据验证工具
const validateCardData = (card) => {
    const errors = [];
    if (!card.frontContent?.title) {
        errors.push('Front content title is required');
    }
    if (!card.backContent?.title) {
        errors.push('Back content title is required');
    }
    if (card.style && !['solid', 'gradient', 'glass'].includes(card.style.type)) {
        errors.push('Invalid card style type');
    }
    return errors;
};
exports.validateCardData = validateCardData;
// ============================================================================
// 性能优化和缓存
// ============================================================================
// 简单的查询缓存
const queryCache = new Map();
const CACHE_TTL = 5 * 60 * 1000; // 5分钟缓存
const cachedQuery = async (key, query) => {
    const cached = queryCache.get(key);
    if (cached && Date.now() - cached.timestamp < CACHE_TTL) {
        return cached.data;
    }
    const data = await query();
    queryCache.set(key, { data, timestamp: Date.now() });
    return data;
};
exports.cachedQuery = cachedQuery;
// 清理缓存
const clearQueryCache = () => {
    queryCache.clear();
};
exports.clearQueryCache = clearQueryCache;
// 定期清理过期缓存
setInterval(() => {
    const now = Date.now();
    for (const [key, value] of queryCache.entries()) {
        if (now - value.timestamp > CACHE_TTL) {
            queryCache.delete(key);
        }
    }
}, CACHE_TTL);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXGRhdGFiYXNlLXVuaWZpZWQudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQUEsaUNBQW9DO0FBcUxwQywrRUFBK0U7QUFDL0UsU0FBUztBQUNULCtFQUErRTtBQUUvRSxNQUFNLHNCQUF1QixTQUFRLGVBQUs7SUFzQnhDO1FBQ0UsS0FBSyxDQUFDLHdCQUF3QixDQUFDLENBQUE7UUF0QmpDLFFBQVE7UUFDUjs7Ozs7V0FBcUI7UUFDckI7Ozs7O1dBQXlCO1FBQ3pCOzs7OztXQUFtQjtRQUNuQjs7Ozs7V0FBdUI7UUFDdkI7Ozs7O1dBQWdDO1FBQ2hDOzs7OztXQUE2QjtRQUM3Qjs7Ozs7V0FBNkI7UUFFN0IsYUFBYTtRQUNiOzs7OztXQUF5QztRQUN6Qzs7Ozs7V0FRRTtRQUtBLG9CQUFvQjtRQUNwQixJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQztZQUNyQixrQkFBa0I7WUFDbEIsS0FBSyxFQUFFLHlHQUF5RztZQUNoSCxPQUFPLEVBQUUsNEdBQTRHO1lBQ3JILElBQUksRUFBRSx3RUFBd0U7WUFDOUUsTUFBTSxFQUFFLG9HQUFvRztZQUU1RyxTQUFTO1lBQ1QsU0FBUyxFQUFFLDBGQUEwRjtZQUNyRyxRQUFRLEVBQUUsMENBQTBDO1lBQ3BELFFBQVEsRUFBRSxtRUFBbUU7WUFFN0UsV0FBVztZQUNYLGdCQUFnQixFQUFFLDBFQUEwRTtZQUM1RixjQUFjLEVBQUUsbUZBQW1GO1NBQ3BHLENBQUMsQ0FBQTtRQUVGLHFCQUFxQjtRQUNyQixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUE7SUFDeEIsQ0FBQztJQUVPLEtBQUssQ0FBQyxlQUFlO1FBQzNCLG9CQUFvQjtRQUNwQixJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsRUFBRSxFQUFFLEVBQUU7WUFDbkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxn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LEdBQUcsRUFBRSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQTtJQUNwRCxPQUFPLElBQUksQ0FBQTtBQUNiLENBQUMsQ0FBQTtBQVpZLFFBQUEsV0FBVyxlQVl2QjtBQUVELE9BQU87QUFDQSxNQUFNLGVBQWUsR0FBRyxHQUFTLEVBQUU7SUFDeEMsVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFBO0FBQ3BCLENBQUMsQ0FBQTtBQUZZLFFBQUEsZUFBZSxtQkFFM0I7QUFFRCxXQUFXO0FBQ1gsV0FBVyxDQUFDLEdBQUcsRUFBRTtJQUNmLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQTtJQUN0QixLQUFLLE1BQU0sQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLElBQUksVUFBVSxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUM7UUFDaEQsSUFBSSxHQUFHLEdBQUcsS0FBSyxDQUFDLFNBQVMsR0FBRyxTQUFTLEVBQUUsQ0FBQztZQUN0QyxVQUFVLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3hCLENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxDQUFBIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkQ6XFxQcm9qZWN0c1xcQ2FyZEV2ZXJ5dGhpbmdcXGNhcmRhbGwtcHJvdG90eXBlXFxzcmNcXHNlcnZpY2VzXFxkYXRhYmFzZS11bmlmaWVkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEZXhpZSwgeyBUYWJsZSB9IGZyb20gJ2RleGllJ1xuaW1wb3J0IHsgQ2FyZCwgRm9sZGVyLCBUYWcsIEltYWdlRGF0YSB9IGZyb20gJ0AvdHlwZXMvY2FyZCdcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g57uf5LiA5pWw5o2u5bqT57G75Z6L5a6a5LmJIC0g6Kej5Yaz5pWw5o2u5bqT5p625p6E57uf5LiAXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8vIOWfuuehgOWQjOatpeaOpeWPo1xuZXhwb3J0IGludGVyZmFjZSBTeW5jYWJsZUVudGl0eSB7XG4gIGlkPzogc3RyaW5nXG4gIHVzZXJJZD86IHN0cmluZ1xuICBzeW5jVmVyc2lvbjogbnVtYmVyXG4gIGxhc3RTeW5jQXQ/OiBEYXRlXG4gIHBlbmRpbmdTeW5jOiBib29sZWFuXG4gIHVwZGF0ZWRBdDogRGF0ZVxufVxuXG4vLyDmianlsZXnmoTmlbDmja7lupPljaHniYflrp7kvZNcbmV4cG9ydCBpbnRlcmZhY2UgRGJDYXJkIGV4dGVuZHMgT21pdDxDYXJkLCAnaWQnPiwgU3luY2FibGVFbnRpdHkge1xuICBpZD86IHN0cmluZ1xuICAvLyDkv53mjIHlkJHlkI7lhbzlrrnnmoTlrZfmrrVcbiAgZm9sZGVySWQ/OiBzdHJpbmdcbiAgLy8g5paw5aKe5a2X5q6155So5LqO5LyY5YyW5p+l6K+iXG4gIHNlYXJjaFZlY3Rvcj86IHN0cmluZyAvLyDlhajmlofmkJzntKLkvJjljJZcbiAgdGh1bWJuYWlsVXJsPzogc3RyaW5nIC8vIOWNoeeJh+e8qeeVpeWbvlxufVxuXG4vLyDmianlsZXnmoTmlbDmja7lupPmlofku7blpLnlrp7kvZNcbmV4cG9ydCBpbnRlcmZhY2UgRGJGb2xkZXIgZXh0ZW5kcyBPbWl0PEZvbGRlciwgJ2lkJz4sIFN5bmNhYmxlRW50aXR5IHtcbiAgaWQ/OiBzdHJpbmdcbiAgLy8g5paw5aKe5a2X5q6155So5LqO5LyY5YyW5p+l6K+iXG4gIGZ1bGxQYXRoPzogc3RyaW5nIC8vIOWujOaVtOi3r+W+hOeUqOS6juW/q+mAn+afpeaJvlxuICBkZXB0aD86IG51bWJlciAvLyDmlofku7blpLnmt7HluqZcbn1cblxuLy8g5omp5bGV55qE5pWw5o2u5bqT5qCH562+5a6e5L2TXG5leHBvcnQgaW50ZXJmYWNlIERiVGFnIGV4dGVuZHMgT21pdDxUYWcsICdpZCc+LCBTeW5jYWJsZUVudGl0eSB7XG4gIGlkPzogc3RyaW5nXG4gIC8vIOS/neaMgeWQkeWQjuWFvOWuuVxuICBjb3VudDogbnVtYmVyXG59XG5cbi8vIOWbvueJh+WtmOWCqOWunuS9kyAtIOe7n+S4gOWbvueJh+euoeeQhlxuZXhwb3J0IGludGVyZmFjZSBEYkltYWdlIHtcbiAgaWQ/OiBzdHJpbmdcbiAgY2FyZElkOiBzdHJpbmdcbiAgdXNlcklkPzogc3RyaW5nXG4gIGZpbGVOYW1lOiBzdHJpbmdcbiAgZmlsZVBhdGg6IHN0cmluZ1xuICBjbG91ZFVybD86IHN0cmluZ1xuICB0aHVtYm5haWxQYXRoPzogc3RyaW5nXG4gIG1ldGFkYXRhOiB7XG4gICAgb3JpZ2luYWxOYW1lOiBzdHJpbmdcbiAgICBzaXplOiBudW1iZXJcbiAgICB3aWR0aDogbnVtYmVyXG4gICAgaGVpZ2h0OiBudW1iZXJcbiAgICBmb3JtYXQ6IHN0cmluZ1xuICAgIGNvbXByZXNzZWQ6IGJvb2xlYW5cbiAgICBxdWFsaXR5PzogbnVtYmVyXG4gIH1cbiAgc3RvcmFnZU1vZGU6ICdpbmRleGVkZGInIHwgJ2ZpbGVzeXN0ZW0nIHwgJ2Nsb3VkJ1xuICBjcmVhdGVkQXQ6IERhdGVcbiAgdXBkYXRlZEF0OiBEYXRlXG4gIHN5bmNWZXJzaW9uOiBudW1iZXJcbiAgbGFzdFN5bmNBdD86IERhdGVcbiAgcGVuZGluZ1N5bmM6IGJvb2xlYW5cbn1cblxuLy8g5ZCM5q2l5pON5L2c6Zif5YiXIC0g57uf5LiA5ZCM5q2l6YC76L6RXG5leHBvcnQgaW50ZXJmYWNlIFN5bmNPcGVyYXRpb24ge1xuICBpZD86IHN0cmluZ1xuICB0eXBlOiAnY3JlYXRlJyB8ICd1cGRhdGUnIHwgJ2RlbGV0ZSdcbiAgZW50aXR5OiAnY2FyZCcgfCAnZm9sZGVyJyB8ICd0YWcnIHwgJ2ltYWdlJ1xuICBlbnRpdHlJZDogc3RyaW5nXG4gIHVzZXJJZD86IHN0cmluZ1xuICBkYXRhPzogYW55XG4gIHRpbWVzdGFtcDogRGF0ZVxuICByZXRyeUNvdW50OiBudW1iZXJcbiAgbWF4UmV0cmllczogbnVtYmVyXG4gIGVycm9yPzogc3RyaW5nXG4gIHByaW9yaXR5OiAnaGlnaCcgfCAnbm9ybWFsJyB8ICdsb3cnXG59XG5cbi8vIOW6lOeUqOiuvue9riAtIOe7n+S4gOmFjee9rueuoeeQhlxuZXhwb3J0IGludGVyZmFjZSBBcHBTZXR0aW5ncyB7XG4gIGlkPzogc3RyaW5nXG4gIGtleTogc3RyaW5nXG4gIHZhbHVlOiBhbnlcbiAgdXBkYXRlZEF0OiBEYXRlXG4gIHNjb3BlOiAndXNlcicgfCAnZ2xvYmFsJyAvLyDorr7nva7kvZznlKjln59cbn1cblxuLy8g55So5oi35Lya6K+d5L+h5oGvXG5leHBvcnQgaW50ZXJmYWNlIFVzZXJTZXNzaW9uIHtcbiAgaWQ/OiBzdHJpbmdcbiAgdXNlcklkOiBzdHJpbmdcbiAgZGV2aWNlSWQ6IHN0cmluZ1xuICB0b2tlbj86IHN0cmluZ1xuICBleHBpcmVzQXQ/OiBEYXRlXG4gIGxhc3RBY3Rpdml0eTogRGF0ZVxuICBpc0FjdGl2ZTogYm9vbGVhblxufVxuXG4vLyDmlbDmja7lupPnu5/orqHkv6Hmga9cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YWJhc2VTdGF0cyB7XG4gIGNhcmRzOiBudW1iZXJcbiAgZm9sZGVyczogbnVtYmVyXG4gIHRhZ3M6IG51bWJlclxuICBpbWFnZXM6IG51bWJlclxuICBwZW5kaW5nU3luYzogbnVtYmVyXG4gIHRvdGFsU2l6ZTogbnVtYmVyXG4gIGxhc3RCYWNrdXA/OiBEYXRlXG4gIHZlcnNpb246IHN0cmluZ1xufVxuXG4vLyDlkJHlkI7lhbzlrrnnmoTml6fmjqXlj6PvvIjkv53mjIHnjrDmnInku6PnoIHkuI3kuK3mlq3vvIlcbmV4cG9ydCBpbnRlcmZhY2UgTGVnYWN5U3luY09wZXJhdGlvbiB7XG4gIGlkPzogc3RyaW5nXG4gIHR5cGU6ICdjcmVhdGUnIHwgJ3VwZGF0ZScgfCAnZGVsZXRlJ1xuICB0YWJsZTogJ2NhcmRzJyB8ICdmb2xkZXJzJyB8ICd0YWdzJyB8ICdpbWFnZXMnXG4gIGRhdGE/OiBhbnlcbiAgbG9jYWxJZDogc3RyaW5nXG4gIHRpbWVzdGFtcDogRGF0ZVxuICByZXRyeUNvdW50OiBudW1iZXJcbiAgbWF4UmV0cmllczogbnVtYmVyXG4gIGVycm9yPzogc3RyaW5nXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOemu+e6v+aVsOaNruaMgeS5heWMluWinuW8uuaOpeWPo1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLyDnprvnur/nirbmgIHlv6vnhadcbmV4cG9ydCBpbnRlcmZhY2UgT2ZmbGluZVNuYXBzaG90IHtcbiAgaWQ6IHN0cmluZ1xuICB0aW1lc3RhbXA6IERhdGVcbiAgdmVyc2lvbjogc3RyaW5nXG4gIHVzZXJJZD86IHN0cmluZ1xuICBkYXRhSGFzaDogc3RyaW5nXG4gIGRhdGFTaXplOiBudW1iZXJcbiAgY29tcHJlc3NlZFNpemU6IG51bWJlclxuICBpbmNsdWRlczoge1xuICAgIGNhcmRzOiBib29sZWFuXG4gICAgZm9sZGVyczogYm9vbGVhblxuICAgIHRhZ3M6IGJvb2xlYW5cbiAgICBpbWFnZXM6IGJvb2xlYW5cbiAgICBzZXR0aW5nczogYm9vbGVhblxuICB9XG4gIG1ldGFkYXRhOiB7XG4gICAgZGV2aWNlSW5mbzogc3RyaW5nXG4gICAgbmV0d29ya1N0YXR1czogc3RyaW5nXG4gICAgYmF0dGVyeUxldmVsPzogbnVtYmVyXG4gICAgc3RvcmFnZVF1b3RhOiB7XG4gICAgICB1c2VkOiBudW1iZXJcbiAgICAgIHRvdGFsOiBudW1iZXJcbiAgICB9XG4gIH1cbn1cblxuLy8g56a757q/5pWw5o2u5Y6L57yp6YWN572uXG5leHBvcnQgaW50ZXJmYWNlIE9mZmxpbmVDb21wcmVzc2lvbkNvbmZpZyB7XG4gIGVuYWJsZWQ6IGJvb2xlYW5cbiAgYWxnb3JpdGhtOiAnZ3ppcCcgfCAnbHotc3RyaW5nJyB8ICdjdXN0b20nXG4gIHRocmVzaG9sZDogbnVtYmVyIC8vIOWOi+e8qemYiOWAvO+8iOWtl+iKgu+8iVxuICBxdWFsaXR5OiBudW1iZXIgLy8g5Y6L57yp6LSo6YeP77yIMC0x77yJXG4gIGV4Y2x1ZGVQYXR0ZXJuczogc3RyaW5nW10gLy8g5LiN5Y6L57yp55qE5pWw5o2u5qih5byPXG59XG5cbi8vIOemu+e6v+Wkh+S7veetlueVpVxuZXhwb3J0IGludGVyZmFjZSBPZmZsaW5lQmFja3VwU3RyYXRlZ3kge1xuICBhdXRvQmFja3VwOiBib29sZWFuXG4gIGludGVydmFsOiBudW1iZXIgLy8g5aSH5Lu96Ze06ZqU77yI5q+r56eS77yJXG4gIG1heEJhY2t1cHM6IG51bWJlclxuICBjb21wcmVzc2lvbkVuYWJsZWQ6IGJvb2xlYW5cbiAgZW5jcnlwdGlvbkVuYWJsZWQ6IGJvb2xlYW5cbiAgcmV0ZW50aW9uUG9saWN5OiB7XG4gICAgZGF5czogbnVtYmVyXG4gICAgbWF4U2l6ZTogbnVtYmVyIC8vIE1CXG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g57uf5LiA5pWw5o2u5bqT57G7XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNsYXNzIENhcmRBbGxVbmlmaWVkRGF0YWJhc2UgZXh0ZW5kcyBEZXhpZSB7XG4gIC8vIOaVsOaNruihqOWumuS5iVxuICBjYXJkcyE6IFRhYmxlPERiQ2FyZD5cbiAgZm9sZGVycyE6IFRhYmxlPERiRm9sZGVyPlxuICB0YWdzITogVGFibGU8RGJUYWc+XG4gIGltYWdlcyE6IFRhYmxlPERiSW1hZ2U+XG4gIHN5bmNRdWV1ZSE6IFRhYmxlPFN5bmNPcGVyYXRpb24+XG4gIHNldHRpbmdzITogVGFibGU8QXBwU2V0dGluZ3M+XG4gIHNlc3Npb25zITogVGFibGU8VXNlclNlc3Npb24+XG4gIFxuICAvLyDnprvnur/mlbDmja7mjIHkuYXljJblop7lvLrooahcbiAgb2ZmbGluZVNuYXBzaG90cyE6IFRhYmxlPE9mZmxpbmVTbmFwc2hvdD5cbiAgb2ZmbGluZUJhY2t1cHMhOiBUYWJsZTx7XG4gICAgaWQ/OiBzdHJpbmdcbiAgICBzbmFwc2hvdElkOiBzdHJpbmdcbiAgICBkYXRhOiBCbG9iXG4gICAgY29tcHJlc3Npb246IHN0cmluZ1xuICAgIGVuY3J5cHRlZDogYm9vbGVhblxuICAgIGNyZWF0ZWRBdDogRGF0ZVxuICAgIHNpemU6IG51bWJlclxuICB9PlxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCdDYXJkQWxsVW5pZmllZERhdGFiYXNlJylcbiAgICBcbiAgICAvLyDniYjmnKwgNDog5re75Yqg56a757q/5pWw5o2u5oyB5LmF5YyW5Yqf6IO9XG4gICAgdGhpcy52ZXJzaW9uKDQpLnN0b3Jlcyh7XG4gICAgICAvLyDmoLjlv4Plrp7kvZPooaggLSDkvJjljJbnmoTntKLlvJXorr7orqFcbiAgICAgIGNhcmRzOiAnKytpZCwgdXNlcklkLCBmb2xkZXJJZCwgY3JlYXRlZEF0LCB1cGRhdGVkQXQsIHN5bmNWZXJzaW9uLCBwZW5kaW5nU3luYywgW3VzZXJJZCtmb2xkZXJJZF0sIHNlYXJjaFZlY3RvcicsXG4gICAgICBmb2xkZXJzOiAnKytpZCwgdXNlcklkLCBwYXJlbnRJZCwgY3JlYXRlZEF0LCB1cGRhdGVkQXQsIHN5bmNWZXJzaW9uLCBwZW5kaW5nU3luYywgW3VzZXJJZCtwYXJlbnRJZF0sIGZ1bGxQYXRoLCBkZXB0aCcsXG4gICAgICB0YWdzOiAnKytpZCwgdXNlcklkLCBuYW1lLCBjcmVhdGVkQXQsIHN5bmNWZXJzaW9uLCBwZW5kaW5nU3luYywgW3VzZXJJZCtuYW1lXScsXG4gICAgICBpbWFnZXM6ICcrK2lkLCBjYXJkSWQsIHVzZXJJZCwgY3JlYXRlZEF0LCB1cGRhdGVkQXQsIHN5bmNWZXJzaW9uLCBwZW5kaW5nU3luYywgc3RvcmFnZU1vZGUsIFtjYXJkSWQrdXNlcklkXScsXG4gICAgICBcbiAgICAgIC8vIOWQjOatpeWSjOiuvue9ruihqFxuICAgICAgc3luY1F1ZXVlOiAnKytpZCwgdHlwZSwgZW50aXR5LCBlbnRpdHlJZCwgdXNlcklkLCB0aW1lc3RhbXAsIHJldHJ5Q291bnQsIHByaW9yaXR5LCBbdXNlcklkK3ByaW9yaXR5XScsXG4gICAgICBzZXR0aW5nczogJysraWQsIGtleSwgdXBkYXRlZEF0LCBzY29wZSwgW2tleStzY29wZV0nLFxuICAgICAgc2Vzc2lvbnM6ICcrK2lkLCB1c2VySWQsIGRldmljZUlkLCBsYXN0QWN0aXZpdHksIGlzQWN0aXZlLCBbdXNlcklkK2RldmljZUlkXScsXG4gICAgICBcbiAgICAgIC8vIOemu+e6v+aVsOaNruaMgeS5heWMluihqFxuICAgICAgb2ZmbGluZVNuYXBzaG90czogJysraWQsIHRpbWVzdGFtcCwgdXNlcklkLCB2ZXJzaW9uLCBkYXRhSGFzaCwgZGF0YVNpemUsIFt1c2VySWQrdGltZXN0YW1wXScsXG4gICAgICBvZmZsaW5lQmFja3VwczogJysraWQsIHNuYXBzaG90SWQsIGNyZWF0ZWRBdCwgY29tcHJlc3Npb24sIGVuY3J5cHRlZCwgc2l6ZSwgW3NuYXBzaG90SWQrY3JlYXRlZEF0XSdcbiAgICB9KVxuXG4gICAgLy8g5pWw5o2u5bqT5Y2H57qn6YC76L6RIC0g5pSv5oyB5LuO5pen54mI5pys6L+B56e7XG4gICAgdGhpcy51cGdyYWRlRGF0YWJhc2UoKVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB1cGdyYWRlRGF0YWJhc2UoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8g54mI5pysIDEgLT4gMjog5re75Yqg55So5oi35pSv5oyBXG4gICAgdGhpcy52ZXJzaW9uKDIpLnVwZ3JhZGUoYXN5bmMgKHR4KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnVXBncmFkaW5nIHRvIHZlcnNpb24gMjogQWRkaW5nIHVzZXIgc3VwcG9ydC4uLicpXG4gICAgICBcbiAgICAgIC8vIOajgOafpeaYr+WQpumcgOimgeS7juaXp+aVsOaNruW6k+i/geenu1xuICAgICAgY29uc3Qgb2xkRGIgPSBuZXcgQ2FyZEFsbERhdGFiYXNlX3YxKClcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IG9sZERiLm9wZW4oKVxuICAgICAgICBjb25zb2xlLmxvZygnRm91bmQgb2xkIGRhdGFiYXNlLCBtaWdyYXRpbmcgZGF0YS4uLicpXG4gICAgICAgIFxuICAgICAgICAvLyDov4Hnp7vljaHniYdcbiAgICAgICAgY29uc3Qgb2xkQ2FyZHMgPSBhd2FpdCBvbGREYi5jYXJkcy50b0FycmF5KClcbiAgICAgICAgY29uc3QgbmV3Q2FyZHMgPSBvbGRDYXJkcy5tYXAoY2FyZCA9PiAoe1xuICAgICAgICAgIC4uLmNhcmQsXG4gICAgICAgICAgdXNlcklkOiAnZGVmYXVsdCcsIC8vIOiuvue9rum7mOiupOeUqOaIt1xuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgICB9KSlcbiAgICAgICAgYXdhaXQgdGhpcy5jYXJkcy5idWxrQWRkKG5ld0NhcmRzKVxuICAgICAgICBcbiAgICAgICAgLy8g6L+B56e75paH5Lu25aS5XG4gICAgICAgIGNvbnN0IG9sZEZvbGRlcnMgPSBhd2FpdCBvbGREYi5mb2xkZXJzLnRvQXJyYXkoKVxuICAgICAgICBjb25zdCBuZXdGb2xkZXJzID0gb2xkRm9sZGVycy5tYXAoZm9sZGVyID0+ICh7XG4gICAgICAgICAgLi4uZm9sZGVyLFxuICAgICAgICAgIHVzZXJJZDogJ2RlZmF1bHQnLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgICB9KSlcbiAgICAgICAgYXdhaXQgdGhpcy5mb2xkZXJzLmJ1bGtBZGQobmV3Rm9sZGVycylcbiAgICAgICAgXG4gICAgICAgIC8vIOi/geenu+agh+etvlxuICAgICAgICBjb25zdCBvbGRUYWdzID0gYXdhaXQgb2xkRGIudGFncy50b0FycmF5KClcbiAgICAgICAgY29uc3QgbmV3VGFncyA9IG9sZFRhZ3MubWFwKHRhZyA9PiAoe1xuICAgICAgICAgIC4uLnRhZyxcbiAgICAgICAgICB1c2VySWQ6ICdkZWZhdWx0JyxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgfSkpXG4gICAgICAgIGF3YWl0IHRoaXMudGFncy5idWxrQWRkKG5ld1RhZ3MpXG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnTWlncmF0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknKVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ05vIG9sZCBkYXRhYmFzZSBmb3VuZCBvciBtaWdyYXRpb24gZmFpbGVkOicsIGVycm9yKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICAvLyDniYjmnKwgMiAtPiAzOiDkvJjljJbntKLlvJXlkozmt7vliqDmlrDlip/og71cbiAgICB0aGlzLnZlcnNpb24oMykudXBncmFkZShhc3luYyAodHgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdVcGdyYWRpbmcgdG8gdmVyc2lvbiAzOiBPcHRpbWl6aW5nIGluZGV4ZXMgYW5kIGFkZGluZyBuZXcgZmVhdHVyZXMuLi4nKVxuICAgICAgXG4gICAgICAvLyDmt7vliqDpu5jorqTorr7nva5cbiAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZURlZmF1bHRTZXR0aW5ncygpXG4gICAgICBcbiAgICAgIC8vIOmHjeW7uuaQnOe0oue0ouW8lVxuICAgICAgYXdhaXQgdGhpcy5yZWJ1aWxkU2VhcmNoSW5kZXhlcygpXG4gICAgfSlcblxuICAgIC8vIOeJiOacrCAzIC0+IDQ6IOa3u+WKoOemu+e6v+aVsOaNruaMgeS5heWMluWKn+iDvVxuICAgIHRoaXMudmVyc2lvbig0KS51cGdyYWRlKGFzeW5jICh0eCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ1VwZ3JhZGluZyB0byB2ZXJzaW9uIDQ6IEFkZGluZyBvZmZsaW5lIGRhdGEgcGVyc2lzdGVuY2UgZmVhdHVyZXMuLi4nKVxuICAgICAgXG4gICAgICAvLyDliJ3lp4vljJbnprvnur/mlbDmja7mjIHkuYXljJbphY3nva5cbiAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZU9mZmxpbmVQZXJzaXN0ZW5jZSgpXG4gICAgICBcbiAgICAgIC8vIOWIm+W7uuWIneWni+emu+e6v+W/q+eFp1xuICAgICAgYXdhaXQgdGhpcy5jcmVhdGVJbml0aWFsT2ZmbGluZVNuYXBzaG90KClcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplRGVmYXVsdFNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGRlZmF1bHRTZXR0aW5ncyA9IFtcbiAgICAgIHtcbiAgICAgICAga2V5OiAnc3RvcmFnZU1vZGUnLFxuICAgICAgICB2YWx1ZTogJ2h5YnJpZCcsXG4gICAgICAgIHNjb3BlOiAnZ2xvYmFsJyBhcyBjb25zdCxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBrZXk6ICdzeW5jRW5hYmxlZCcsXG4gICAgICAgIHZhbHVlOiB0cnVlLFxuICAgICAgICBzY29wZTogJ2dsb2JhbCcgYXMgY29uc3QsXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAga2V5OiAnaW1hZ2VDb21wcmVzc2lvbicsXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICBxdWFsaXR5OiAwLjgsXG4gICAgICAgICAgbWF4V2lkdGg6IDE5MjAsXG4gICAgICAgICAgbWF4SGVpZ2h0OiAxMDgwLFxuICAgICAgICAgIGZvcm1hdDogJ3dlYnAnXG4gICAgICAgIH0sXG4gICAgICAgIHNjb3BlOiAnZ2xvYmFsJyBhcyBjb25zdCxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBrZXk6ICdkYXRhYmFzZVZlcnNpb24nLFxuICAgICAgICB2YWx1ZTogJzMuMC4wJyxcbiAgICAgICAgc2NvcGU6ICdnbG9iYWwnIGFzIGNvbnN0LFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgIH1cbiAgICBdXG5cbiAgICBmb3IgKGNvbnN0IHNldHRpbmcgb2YgZGVmYXVsdFNldHRpbmdzKSB7XG4gICAgICBjb25zdCBleGlzdHMgPSBhd2FpdCB0aGlzLnNldHRpbmdzLndoZXJlKCdrZXknKS5lcXVhbHMoc2V0dGluZy5rZXkpLmZpcnN0KClcbiAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2V0dGluZ3MuYWRkKHNldHRpbmcpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZWJ1aWxkU2VhcmNoSW5kZXhlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnUmVidWlsZGluZyBzZWFyY2ggaW5kZXhlcy4uLicpXG4gICAgLy8g6L+Z6YeM5Y+v5Lul5a6e546w5pCc57Si57Si5byV55qE6YeN5bu66YC76L6RXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOemu+e6v+aVsOaNruaMgeS5heWMluWinuW8uuaWueazlVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLyoqXG4gICAqIOWIneWni+WMluemu+e6v+aVsOaNruaMgeS5heWMllxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplT2ZmbGluZVBlcnNpc3RlbmNlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnNvbGUubG9nKCdJbml0aWFsaXppbmcgb2ZmbGluZSBwZXJzaXN0ZW5jZS4uLicpXG4gICAgXG4gICAgLy8g5re75Yqg56a757q/5pWw5o2u5oyB5LmF5YyW55qE6buY6K6k6K6+572uXG4gICAgY29uc3Qgb2ZmbGluZVNldHRpbmdzID0gW1xuICAgICAge1xuICAgICAgICBrZXk6ICdvZmZsaW5lQXV0b0JhY2t1cCcsXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICBpbnRlcnZhbDogMzAgKiA2MCAqIDEwMDAsIC8vIDMw5YiG6ZKfXG4gICAgICAgICAgbWF4QmFja3VwczogMTAsXG4gICAgICAgICAgY29tcHJlc3Npb246IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgc2NvcGU6ICdnbG9iYWwnIGFzIGNvbnN0LFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGtleTogJ29mZmxpbmVDb21wcmVzc2lvbicsXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICBhbGdvcml0aG06ICdsei1zdHJpbmcnLFxuICAgICAgICAgIHRocmVzaG9sZDogMTAyNCwgLy8gMUtC5Lul5LiK5omN5Y6L57ypXG4gICAgICAgICAgcXVhbGl0eTogMC44XG4gICAgICAgIH0sXG4gICAgICAgIHNjb3BlOiAnZ2xvYmFsJyBhcyBjb25zdCxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBrZXk6ICdvZmZsaW5lRGF0YVJldGVudGlvbicsXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgZGF5czogMzAsXG4gICAgICAgICAgbWF4U2l6ZTogMTAwIC8vIDEwME1CXG4gICAgICAgIH0sXG4gICAgICAgIHNjb3BlOiAnZ2xvYmFsJyBhcyBjb25zdCxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9XG4gICAgXVxuXG4gICAgZm9yIChjb25zdCBzZXR0aW5nIG9mIG9mZmxpbmVTZXR0aW5ncykge1xuICAgICAgY29uc3QgZXhpc3RzID0gYXdhaXQgdGhpcy5zZXR0aW5ncy53aGVyZSgna2V5JykuZXF1YWxzKHNldHRpbmcua2V5KS5maXJzdCgpXG4gICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICBhd2FpdCB0aGlzLnNldHRpbmdzLmFkZChzZXR0aW5nKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rliJ3lp4vnprvnur/lv6vnhadcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY3JlYXRlSW5pdGlhbE9mZmxpbmVTbmFwc2hvdCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc25hcHNob3QgPSBhd2FpdCB0aGlzLmNyZWF0ZU9mZmxpbmVTbmFwc2hvdCh7XG4gICAgICAgIGluY2x1ZGVDYXJkczogdHJ1ZSxcbiAgICAgICAgaW5jbHVkZUZvbGRlcnM6IHRydWUsXG4gICAgICAgIGluY2x1ZGVUYWdzOiB0cnVlLFxuICAgICAgICBpbmNsdWRlU2V0dGluZ3M6IHRydWUsXG4gICAgICAgIGluY2x1ZGVJbWFnZXM6IGZhbHNlIC8vIOWIneWni+W/q+eFp+S4jeWMheaLrOWbvueJh++8jOWboOS4uuWbvueJh+i+g+Wkp1xuICAgICAgfSlcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ0luaXRpYWwgb2ZmbGluZSBzbmFwc2hvdCBjcmVhdGVkOicsIHNuYXBzaG90LmlkKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIGluaXRpYWwgb2ZmbGluZSBzbmFwc2hvdDonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu656a757q/5b+r54WnXG4gICAqL1xuICBhc3luYyBjcmVhdGVPZmZsaW5lU25hcHNob3Qob3B0aW9uczoge1xuICAgIGluY2x1ZGVDYXJkcz86IGJvb2xlYW5cbiAgICBpbmNsdWRlRm9sZGVycz86IGJvb2xlYW5cbiAgICBpbmNsdWRlVGFncz86IGJvb2xlYW5cbiAgICBpbmNsdWRlSW1hZ2VzPzogYm9vbGVhblxuICAgIGluY2x1ZGVTZXR0aW5ncz86IGJvb2xlYW5cbiAgICB1c2VySWQ/OiBzdHJpbmdcbiAgfSA9IHt9KTogUHJvbWlzZTxPZmZsaW5lU25hcHNob3Q+IHtcbiAgICBjb25zdCB7XG4gICAgICBpbmNsdWRlQ2FyZHMgPSB0cnVlLFxuICAgICAgaW5jbHVkZUZvbGRlcnMgPSB0cnVlLFxuICAgICAgaW5jbHVkZVRhZ3MgPSB0cnVlLFxuICAgICAgaW5jbHVkZUltYWdlcyA9IGZhbHNlLFxuICAgICAgaW5jbHVkZVNldHRpbmdzID0gdHJ1ZSxcbiAgICAgIHVzZXJJZFxuICAgIH0gPSBvcHRpb25zXG5cbiAgICBjb25zdCBzbmFwc2hvdElkID0gY3J5cHRvLnJhbmRvbVVVSUQoKVxuICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKClcbiAgICBcbiAgICAvLyDmlLbpm4bmlbDmja5cbiAgICBjb25zdCBkYXRhOiBhbnkgPSB7fVxuICAgIGxldCB0b3RhbFNpemUgPSAwXG5cbiAgICBpZiAoaW5jbHVkZUNhcmRzKSB7XG4gICAgICBkYXRhLmNhcmRzID0gYXdhaXQgdGhpcy5jYXJkcy50b0FycmF5KClcbiAgICAgIHRvdGFsU2l6ZSArPSBKU09OLnN0cmluZ2lmeShkYXRhLmNhcmRzKS5sZW5ndGhcbiAgICB9XG5cbiAgICBpZiAoaW5jbHVkZUZvbGRlcnMpIHtcbiAgICAgIGRhdGEuZm9sZGVycyA9IGF3YWl0IHRoaXMuZm9sZGVycy50b0FycmF5KClcbiAgICAgIHRvdGFsU2l6ZSArPSBKU09OLnN0cmluZ2lmeShkYXRhLmZvbGRlcnMpLmxlbmd0aFxuICAgIH1cblxuICAgIGlmIChpbmNsdWRlVGFncykge1xuICAgICAgZGF0YS50YWdzID0gYXdhaXQgdGhpcy50YWdzLnRvQXJyYXkoKVxuICAgICAgdG90YWxTaXplICs9IEpTT04uc3RyaW5naWZ5KGRhdGEudGFncykubGVuZ3RoXG4gICAgfVxuXG4gICAgaWYgKGluY2x1ZGVJbWFnZXMpIHtcbiAgICAgIGRhdGEuaW1hZ2VzID0gYXdhaXQgdGhpcy5pbWFnZXMudG9BcnJheSgpXG4gICAgICB0b3RhbFNpemUgKz0gSlNPTi5zdHJpbmdpZnkoZGF0YS5pbWFnZXMpLmxlbmd0aFxuICAgIH1cblxuICAgIGlmIChpbmNsdWRlU2V0dGluZ3MpIHtcbiAgICAgIGRhdGEuc2V0dGluZ3MgPSBhd2FpdCB0aGlzLnNldHRpbmdzLnRvQXJyYXkoKVxuICAgICAgdG90YWxTaXplICs9IEpTT04uc3RyaW5naWZ5KGRhdGEuc2V0dGluZ3MpLmxlbmd0aFxuICAgIH1cblxuICAgIC8vIOiuoeeul+aVsOaNruWTiOW4jFxuICAgIGNvbnN0IGRhdGFIYXNoID0gYXdhaXQgdGhpcy5jYWxjdWxhdGVEYXRhSGFzaChkYXRhKVxuICAgIFxuICAgIC8vIOiOt+WPluiuvuWkh+S/oeaBr1xuICAgIGNvbnN0IGRldmljZUluZm8gPSBhd2FpdCB0aGlzLmdldERldmljZUluZm8oKVxuICAgIGNvbnN0IHN0b3JhZ2VRdW90YSA9IGF3YWl0IHRoaXMuZ2V0U3RvcmFnZVF1b3RhKClcblxuICAgIGNvbnN0IHNuYXBzaG90OiBPZmZsaW5lU25hcHNob3QgPSB7XG4gICAgICBpZDogc25hcHNob3RJZCxcbiAgICAgIHRpbWVzdGFtcCxcbiAgICAgIHZlcnNpb246ICc0LjAuMCcsXG4gICAgICB1c2VySWQsXG4gICAgICBkYXRhSGFzaCxcbiAgICAgIGRhdGFTaXplOiB0b3RhbFNpemUsXG4gICAgICBjb21wcmVzc2VkU2l6ZTogdG90YWxTaXplLCAvLyDliJ3lp4vmnKrljovnvKlcbiAgICAgIGluY2x1ZGVzOiB7XG4gICAgICAgIGNhcmRzOiBpbmNsdWRlQ2FyZHMsXG4gICAgICAgIGZvbGRlcnM6IGluY2x1ZGVGb2xkZXJzLFxuICAgICAgICB0YWdzOiBpbmNsdWRlVGFncyxcbiAgICAgICAgaW1hZ2VzOiBpbmNsdWRlSW1hZ2VzLFxuICAgICAgICBzZXR0aW5nczogaW5jbHVkZVNldHRpbmdzXG4gICAgICB9LFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgZGV2aWNlSW5mbyxcbiAgICAgICAgbmV0d29ya1N0YXR1czogbmF2aWdhdG9yLm9uTGluZSA/ICdvbmxpbmUnIDogJ29mZmxpbmUnLFxuICAgICAgICBiYXR0ZXJ5TGV2ZWw6IChuYXZpZ2F0b3IgYXMgYW55KS5nZXRCYXR0ZXJ5Py4oKSA/IHVuZGVmaW5lZCA6IHVuZGVmaW5lZCxcbiAgICAgICAgc3RvcmFnZVF1b3RhXG4gICAgICB9XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy5vZmZsaW5lU25hcHNob3RzLmFkZChzbmFwc2hvdClcbiAgICBcbiAgICByZXR1cm4gc25hcHNob3RcbiAgfVxuXG4gIC8qKlxuICAgKiDorqHnrpfmlbDmja7lk4jluIxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY2FsY3VsYXRlRGF0YUhhc2goZGF0YTogYW55KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBkYXRhU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoZGF0YSlcbiAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKClcbiAgICBjb25zdCBkYXRhQnVmZmVyID0gZW5jb2Rlci5lbmNvZGUoZGF0YVN0cmluZylcbiAgICBjb25zdCBoYXNoQnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5kaWdlc3QoJ1NIQS0yNTYnLCBkYXRhQnVmZmVyKVxuICAgIGNvbnN0IGhhc2hBcnJheSA9IEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoaGFzaEJ1ZmZlcikpXG4gICAgcmV0dXJuIGhhc2hBcnJheS5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKS5qb2luKCcnKVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluiuvuWkh+S/oeaBr1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXREZXZpY2VJbmZvKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgaW5mbyA9IHtcbiAgICAgIHVzZXJBZ2VudDogbmF2aWdhdG9yLnVzZXJBZ2VudCxcbiAgICAgIHBsYXRmb3JtOiBuYXZpZ2F0b3IucGxhdGZvcm0sXG4gICAgICBsYW5ndWFnZTogbmF2aWdhdG9yLmxhbmd1YWdlLFxuICAgICAgZGV2aWNlTWVtb3J5OiAobmF2aWdhdG9yIGFzIGFueSkuZGV2aWNlTWVtb3J5LFxuICAgICAgaGFyZHdhcmVDb25jdXJyZW5jeTogbmF2aWdhdG9yLmhhcmR3YXJlQ29uY3VycmVuY3ksXG4gICAgICBzY3JlZW5SZXNvbHV0aW9uOiBgJHtzY3JlZW4ud2lkdGh9eCR7c2NyZWVuLmhlaWdodH1gLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGluZm8pXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5a2Y5YKo6YWN6aKd5L+h5oGvXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldFN0b3JhZ2VRdW90YSgpOiBQcm9taXNlPHsgdXNlZDogbnVtYmVyOyB0b3RhbDogbnVtYmVyIH0+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKCdzdG9yYWdlJyBpbiBuYXZpZ2F0b3IgJiYgJ2VzdGltYXRlJyBpbiAobmF2aWdhdG9yIGFzIGFueSkuc3RvcmFnZSkge1xuICAgICAgICBjb25zdCBlc3RpbWF0ZSA9IGF3YWl0IChuYXZpZ2F0b3IgYXMgYW55KS5zdG9yYWdlLmVzdGltYXRlKClcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VkOiBlc3RpbWF0ZS51c2FnZSB8fCAwLFxuICAgICAgICAgIHRvdGFsOiBlc3RpbWF0ZS5xdW90YSB8fCAwXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gZ2V0IHN0b3JhZ2UgcXVvdGE6JywgZXJyb3IpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7IHVzZWQ6IDAsIHRvdGFsOiAwIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmgaLlpI3nprvnur/lv6vnhadcbiAgICovXG4gIGFzeW5jIHJlc3RvcmVPZmZsaW5lU25hcHNob3Qoc25hcHNob3RJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgdGhpcy5vZmZsaW5lU25hcHNob3RzLmdldChzbmFwc2hvdElkKVxuICAgICAgaWYgKCFzbmFwc2hvdCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NuYXBzaG90IG5vdCBmb3VuZCcpXG4gICAgICB9XG5cbiAgICAgIC8vIOajgOafpeaVsOaNruWujOaVtOaAp1xuICAgICAgY29uc3QgY3VycmVudERhdGEgPSBhd2FpdCB0aGlzLmdldEN1cnJlbnREYXRhSGFzaCgpXG4gICAgICBpZiAoY3VycmVudERhdGEgPT09IHNuYXBzaG90LmRhdGFIYXNoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdEYXRhIGFscmVhZHkgbWF0Y2hlcyBzbmFwc2hvdCwgbm8gcmVzdG9yZSBuZWVkZWQnKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuXG4gICAgICAvLyDmgaLlpI3mlbDmja5cbiAgICAgIGlmIChzbmFwc2hvdC5pbmNsdWRlcy5jYXJkcykge1xuICAgICAgICBjb25zdCBiYWNrdXBDYXJkcyA9IGF3YWl0IHRoaXMuY2FyZHMudG9BcnJheSgpXG4gICAgICAgIGF3YWl0IHRoaXMuY2FyZHMuY2xlYXIoKVxuICAgICAgICAvLyDov5nph4zpnIDopoHku47lpIfku73kuK3mgaLlpI3ljaHniYfmlbDmja5cbiAgICAgICAgLy8g55Sx5LqO5b+r54Wn5Y+q5a2Y5YKo5YWD5pWw5o2u77yM5a6e6ZmF5oGi5aSN6ZyA6KaB5pu05aSN5p2C55qE6YC76L6RXG4gICAgICB9XG5cbiAgICAgIGlmIChzbmFwc2hvdC5pbmNsdWRlcy5mb2xkZXJzKSB7XG4gICAgICAgIGNvbnN0IGJhY2t1cEZvbGRlcnMgPSBhd2FpdCB0aGlzLmZvbGRlcnMudG9BcnJheSgpXG4gICAgICAgIGF3YWl0IHRoaXMuZm9sZGVycy5jbGVhcigpXG4gICAgICAgIC8vIOaBouWkjeaWh+S7tuWkueaVsOaNrlxuICAgICAgfVxuXG4gICAgICBpZiAoc25hcHNob3QuaW5jbHVkZXMudGFncykge1xuICAgICAgICBjb25zdCBiYWNrdXBUYWdzID0gYXdhaXQgdGhpcy50YWdzLnRvQXJyYXkoKVxuICAgICAgICBhd2FpdCB0aGlzLnRhZ3MuY2xlYXIoKVxuICAgICAgICAvLyDmgaLlpI3moIfnrb7mlbDmja5cbiAgICAgIH1cblxuICAgICAgaWYgKHNuYXBzaG90LmluY2x1ZGVzLnNldHRpbmdzKSB7XG4gICAgICAgIGNvbnN0IGJhY2t1cFNldHRpbmdzID0gYXdhaXQgdGhpcy5zZXR0aW5ncy50b0FycmF5KClcbiAgICAgICAgYXdhaXQgdGhpcy5zZXR0aW5ncy5jbGVhcigpXG4gICAgICAgIC8vIOaBouWkjeiuvue9ruaVsOaNrlxuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZygnT2ZmbGluZSBzbmFwc2hvdCByZXN0b3JlZCBzdWNjZXNzZnVsbHk6Jywgc25hcHNob3RJZClcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byByZXN0b3JlIG9mZmxpbmUgc25hcHNob3Q6JywgZXJyb3IpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5b2T5YmN5pWw5o2u5ZOI5biMXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldEN1cnJlbnREYXRhSGFzaCgpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBjYXJkczogYXdhaXQgdGhpcy5jYXJkcy50b0FycmF5KCksXG4gICAgICBmb2xkZXJzOiBhd2FpdCB0aGlzLmZvbGRlcnMudG9BcnJheSgpLFxuICAgICAgdGFnczogYXdhaXQgdGhpcy50YWdzLnRvQXJyYXkoKSxcbiAgICAgIHNldHRpbmdzOiBhd2FpdCB0aGlzLnNldHRpbmdzLnRvQXJyYXkoKVxuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgdGhpcy5jYWxjdWxhdGVEYXRhSGFzaChkYXRhKVxuICB9XG5cbiAgLyoqXG4gICAqIOaZuuiDvea4heeQhuemu+e6v+aVsOaNrlxuICAgKi9cbiAgYXN5bmMgY2xlYW51cE9mZmxpbmVEYXRhKCk6IFByb21pc2U8e1xuICAgIGNsZWFuZWRTbmFwc2hvdHM6IG51bWJlclxuICAgIGNsZWFuZWRCYWNrdXBzOiBudW1iZXJcbiAgICBmcmVlZFNwYWNlOiBudW1iZXJcbiAgfT4ge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBsZXQgY2xlYW5lZFNuYXBzaG90cyA9IDBcbiAgICBsZXQgY2xlYW5lZEJhY2t1cHMgPSAwXG4gICAgbGV0IGZyZWVkU3BhY2UgPSAwXG5cbiAgICB0cnkge1xuICAgICAgLy8g6I635Y+W5riF55CG562W55WlXG4gICAgICBjb25zdCByZXRlbnRpb25EYXlzID0gYXdhaXQgdGhpcy5nZXRTZXR0aW5nKCdvZmZsaW5lRGF0YVJldGVudGlvbicpPy5kYXlzIHx8IDMwXG4gICAgICBjb25zdCBtYXhTaXplTUIgPSBhd2FpdCB0aGlzLmdldFNldHRpbmcoJ29mZmxpbmVEYXRhUmV0ZW50aW9uJyk/Lm1heFNpemUgfHwgMTAwXG4gICAgICBjb25zdCBjdXRvZmZEYXRlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSAtIHJldGVudGlvbkRheXMgKiAyNCAqIDYwICogNjAgKiAxMDAwKVxuXG4gICAgICAvLyDmuIXnkIbov4fmnJ/lv6vnhadcbiAgICAgIGNvbnN0IGV4cGlyZWRTbmFwc2hvdHMgPSBhd2FpdCB0aGlzLm9mZmxpbmVTbmFwc2hvdHNcbiAgICAgICAgLndoZXJlKCd0aW1lc3RhbXAnKVxuICAgICAgICAuYmVsb3coY3V0b2ZmRGF0ZSlcbiAgICAgICAgLnRvQXJyYXkoKVxuXG4gICAgICBmb3IgKGNvbnN0IHNuYXBzaG90IG9mIGV4cGlyZWRTbmFwc2hvdHMpIHtcbiAgICAgICAgZnJlZWRTcGFjZSArPSBzbmFwc2hvdC5kYXRhU2l6ZVxuICAgICAgICBhd2FpdCB0aGlzLm9mZmxpbmVTbmFwc2hvdHMuZGVsZXRlKHNuYXBzaG90LmlkISlcbiAgICAgICAgY2xlYW5lZFNuYXBzaG90cysrXG4gICAgICB9XG5cbiAgICAgIC8vIOa4heeQhui/h+acn+Wkh+S7vVxuICAgICAgY29uc3QgZXhwaXJlZEJhY2t1cHMgPSBhd2FpdCB0aGlzLm9mZmxpbmVCYWNrdXBzXG4gICAgICAgIC53aGVyZSgnY3JlYXRlZEF0JylcbiAgICAgICAgLmJlbG93KGN1dG9mZkRhdGUpXG4gICAgICAgIC50b0FycmF5KClcblxuICAgICAgZm9yIChjb25zdCBiYWNrdXAgb2YgZXhwaXJlZEJhY2t1cHMpIHtcbiAgICAgICAgZnJlZWRTcGFjZSArPSBiYWNrdXAuc2l6ZVxuICAgICAgICBhd2FpdCB0aGlzLm9mZmxpbmVCYWNrdXBzLmRlbGV0ZShiYWNrdXAuaWQhKVxuICAgICAgICBjbGVhbmVkQmFja3VwcysrXG4gICAgICB9XG5cbiAgICAgIC8vIOWmguaenOWtmOWCqOepuumXtOS7jeeEtui/h+Wkp++8jOaMieaXtumXtOa4heeQhuacgOaXp+eahOW/q+eFp1xuICAgICAgY29uc3QgY3VycmVudFNuYXBzaG90cyA9IGF3YWl0IHRoaXMub2ZmbGluZVNuYXBzaG90cy5vcmRlckJ5KCd0aW1lc3RhbXAnKS5yZXZlcnNlKCkudG9BcnJheSgpXG4gICAgICBsZXQgdG90YWxTaXplID0gY3VycmVudFNuYXBzaG90cy5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcy5kYXRhU2l6ZSwgMClcbiAgICAgIFxuICAgICAgd2hpbGUgKHRvdGFsU2l6ZSA+IG1heFNpemVNQiAqIDEwMjQgKiAxMDI0ICYmIGN1cnJlbnRTbmFwc2hvdHMubGVuZ3RoID4gNSkge1xuICAgICAgICBjb25zdCBvbGRlc3RTbmFwc2hvdCA9IGN1cnJlbnRTbmFwc2hvdHMucG9wKClcbiAgICAgICAgaWYgKG9sZGVzdFNuYXBzaG90KSB7XG4gICAgICAgICAgZnJlZWRTcGFjZSArPSBvbGRlc3RTbmFwc2hvdC5kYXRhU2l6ZVxuICAgICAgICAgIGF3YWl0IHRoaXMub2ZmbGluZVNuYXBzaG90cy5kZWxldGUob2xkZXN0U25hcHNob3QuaWQhKVxuICAgICAgICAgIGNsZWFuZWRTbmFwc2hvdHMrK1xuICAgICAgICAgIHRvdGFsU2l6ZSAtPSBvbGRlc3RTbmFwc2hvdC5kYXRhU2l6ZVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKGBPZmZsaW5lIGRhdGEgY2xlYW51cCBjb21wbGV0ZWQ6ICR7Y2xlYW5lZFNuYXBzaG90c30gc25hcHNob3RzLCAke2NsZWFuZWRCYWNrdXBzfSBiYWNrdXBzLCAke2ZyZWVkU3BhY2V9IGJ5dGVzIGZyZWVkYClcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY2xlYW5lZFNuYXBzaG90cyxcbiAgICAgICAgY2xlYW5lZEJhY2t1cHMsXG4gICAgICAgIGZyZWVkU3BhY2VcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNsZWFudXAgb2ZmbGluZSBkYXRhOicsIGVycm9yKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY2xlYW5lZFNuYXBzaG90czogMCxcbiAgICAgICAgY2xlYW5lZEJhY2t1cHM6IDAsXG4gICAgICAgIGZyZWVkU3BhY2U6IDBcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6Ieq5Yqo5aSH5Lu956a757q/5pWw5o2uXG4gICAqL1xuICBhc3luYyBhdXRvQmFja3VwT2ZmbGluZURhdGEoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGJhY2t1cENvbmZpZyA9IGF3YWl0IHRoaXMuZ2V0U2V0dGluZygnb2ZmbGluZUF1dG9CYWNrdXAnKVxuICAgICAgaWYgKCFiYWNrdXBDb25maWc/LmVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG5cbiAgICAgIC8vIOajgOafpeaYr+WQpumcgOimgeWkh+S7vVxuICAgICAgY29uc3QgbGFzdEJhY2t1cCA9IGF3YWl0IHRoaXMub2ZmbGluZVNuYXBzaG90cy5vcmRlckJ5KCd0aW1lc3RhbXAnKS5yZXZlcnNlKCkuZmlyc3QoKVxuICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxuICAgICAgXG4gICAgICBpZiAobGFzdEJhY2t1cCkge1xuICAgICAgICBjb25zdCB0aW1lU2luY2VMYXN0QmFja3VwID0gbm93LmdldFRpbWUoKSAtIGxhc3RCYWNrdXAudGltZXN0YW1wLmdldFRpbWUoKVxuICAgICAgICBpZiAodGltZVNpbmNlTGFzdEJhY2t1cCA8IGJhY2t1cENvbmZpZy5pbnRlcnZhbCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZSAvLyDov5jmnKrliLDlpIfku73ml7bpl7RcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyDliJvlu7rmlrDnmoTlv6vnhadcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgdGhpcy5jcmVhdGVPZmZsaW5lU25hcHNob3Qoe1xuICAgICAgICBpbmNsdWRlQ2FyZHM6IHRydWUsXG4gICAgICAgIGluY2x1ZGVGb2xkZXJzOiB0cnVlLFxuICAgICAgICBpbmNsdWRlVGFnczogdHJ1ZSxcbiAgICAgICAgaW5jbHVkZUltYWdlczogZmFsc2UsIC8vIOiHquWKqOWkh+S7veS4jeWMheaLrOWkp+aWh+S7tlxuICAgICAgICBpbmNsdWRlU2V0dGluZ3M6IHRydWVcbiAgICAgIH0pXG5cbiAgICAgIC8vIOa4heeQhuaXp+Wkh+S7vVxuICAgICAgY29uc3QgbWF4QmFja3VwcyA9IGJhY2t1cENvbmZpZy5tYXhCYWNrdXBzIHx8IDEwXG4gICAgICBjb25zdCBhbGxTbmFwc2hvdHMgPSBhd2FpdCB0aGlzLm9mZmxpbmVTbmFwc2hvdHMub3JkZXJCeSgndGltZXN0YW1wJykucmV2ZXJzZSgpLnRvQXJyYXkoKVxuICAgICAgXG4gICAgICBpZiAoYWxsU25hcHNob3RzLmxlbmd0aCA+IG1heEJhY2t1cHMpIHtcbiAgICAgICAgY29uc3Qgc25hcHNob3RzVG9EZWxldGUgPSBhbGxTbmFwc2hvdHMuc2xpY2UobWF4QmFja3VwcylcbiAgICAgICAgZm9yIChjb25zdCBzbmFwc2hvdCBvZiBzbmFwc2hvdHNUb0RlbGV0ZSkge1xuICAgICAgICAgIGF3YWl0IHRoaXMub2ZmbGluZVNuYXBzaG90cy5kZWxldGUoc25hcHNob3QuaWQhKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdBdXRvIGJhY2t1cCBjb21wbGV0ZWQ6Jywgc25hcHNob3QuaWQpXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdBdXRvIGJhY2t1cCBmYWlsZWQ6JywgZXJyb3IpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W56a757q/5pWw5o2u57uf6K6hXG4gICAqL1xuICBhc3luYyBnZXRPZmZsaW5lRGF0YVN0YXRzKCk6IFByb21pc2U8e1xuICAgIHNuYXBzaG90czogbnVtYmVyXG4gICAgYmFja3VwczogbnVtYmVyXG4gICAgdG90YWxTaXplOiBudW1iZXJcbiAgICBsYXN0QmFja3VwPzogRGF0ZVxuICAgIG9sZGVzdEJhY2t1cD86IERhdGVcbiAgfT4ge1xuICAgIGNvbnN0IHNuYXBzaG90cyA9IGF3YWl0IHRoaXMub2ZmbGluZVNuYXBzaG90cy50b0FycmF5KClcbiAgICBjb25zdCBiYWNrdXBzID0gYXdhaXQgdGhpcy5vZmZsaW5lQmFja3Vwcy50b0FycmF5KClcbiAgICBcbiAgICBjb25zdCB0b3RhbFNpemUgPSBzbmFwc2hvdHMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuZGF0YVNpemUsIDApICsgXG4gICAgICAgICAgICAgICAgICAgICAgYmFja3Vwcy5yZWR1Y2UoKHN1bSwgYikgPT4gc3VtICsgYi5zaXplLCAwKVxuICAgIFxuICAgIGNvbnN0IGxhc3RCYWNrdXAgPSBzbmFwc2hvdHMubGVuZ3RoID4gMCA/IFxuICAgICAgc25hcHNob3RzLnJlZHVjZSgobGF0ZXN0LCBzKSA9PiBzLnRpbWVzdGFtcCA+IGxhdGVzdC50aW1lc3RhbXAgPyBzIDogbGF0ZXN0LCBzbmFwc2hvdHNbMF0pLnRpbWVzdGFtcCA6IFxuICAgICAgdW5kZWZpbmVkXG4gICAgXG4gICAgY29uc3Qgb2xkZXN0QmFja3VwID0gc25hcHNob3RzLmxlbmd0aCA+IDAgPyBcbiAgICAgIHNuYXBzaG90cy5yZWR1Y2UoKG9sZGVzdCwgcykgPT4gcy50aW1lc3RhbXAgPCBvbGRlc3QudGltZXN0YW1wID8gcyA6IG9sZGVzdCwgc25hcHNob3RzWzBdKS50aW1lc3RhbXAgOiBcbiAgICAgIHVuZGVmaW5lZFxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHNuYXBzaG90czogc25hcHNob3RzLmxlbmd0aCxcbiAgICAgIGJhY2t1cHM6IGJhY2t1cHMubGVuZ3RoLFxuICAgICAgdG90YWxTaXplLFxuICAgICAgbGFzdEJhY2t1cCxcbiAgICAgIG9sZGVzdEJhY2t1cFxuICAgIH1cbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g57uf5LiA55qEQ1JVROaTjeS9nOaWueazlVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLy8g6I635Y+W6K6+572uIC0g5pSv5oyB55So5oi357qn5ZKM5YWo5bGA6K6+572uXG4gIGFzeW5jIGdldFNldHRpbmcoa2V5OiBzdHJpbmcsIHVzZXJJZD86IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgLy8g5LyY5YWI6L+U5Zue55So5oi357qn6K6+572uXG4gICAgaWYgKHVzZXJJZCkge1xuICAgICAgY29uc3QgdXNlclNldHRpbmcgPSBhd2FpdCB0aGlzLnNldHRpbmdzXG4gICAgICAgIC53aGVyZSgnW2tleStzY29wZV0nKVxuICAgICAgICAuZXF1YWxzKFtrZXksICd1c2VyJ10pXG4gICAgICAgIC5hbmQoc2V0dGluZyA9PiAhc2V0dGluZy51c2VySWQgfHwgc2V0dGluZy51c2VySWQgPT09IHVzZXJJZClcbiAgICAgICAgLmZpcnN0KClcbiAgICAgIGlmICh1c2VyU2V0dGluZykgcmV0dXJuIHVzZXJTZXR0aW5nLnZhbHVlXG4gICAgfVxuICAgIFxuICAgIC8vIOi/lOWbnuWFqOWxgOiuvue9rlxuICAgIGNvbnN0IGdsb2JhbFNldHRpbmcgPSBhd2FpdCB0aGlzLnNldHRpbmdzXG4gICAgICAud2hlcmUoJ1trZXkrc2NvcGVdJylcbiAgICAgIC5lcXVhbHMoW2tleSwgJ2dsb2JhbCddKVxuICAgICAgLmZpcnN0KClcbiAgICByZXR1cm4gZ2xvYmFsU2V0dGluZz8udmFsdWVcbiAgfVxuXG4gIC8vIOabtOaWsOiuvue9rlxuICBhc3luYyB1cGRhdGVTZXR0aW5nKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBzY29wZTogJ3VzZXInIHwgJ2dsb2JhbCcgPSAnZ2xvYmFsJywgdXNlcklkPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zZXR0aW5ncy53aGVyZSgnW2tleStzY29wZV0nKS5lcXVhbHMoW2tleSwgc2NvcGVdKS5tb2RpZnkoe1xuICAgICAgdmFsdWUsXG4gICAgICB1c2VySWQsXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICB9KVxuICB9XG5cbiAgLy8g6I635Y+W5pWw5o2u5bqT57uf6K6h5L+h5oGvXG4gIGFzeW5jIGdldFN0YXRzKCk6IFByb21pc2U8RGF0YWJhc2VTdGF0cz4ge1xuICAgIGNvbnN0IFtjYXJkcywgZm9sZGVycywgdGFncywgaW1hZ2VzLCBwZW5kaW5nU3luY10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICB0aGlzLmNhcmRzLmNvdW50KCksXG4gICAgICB0aGlzLmZvbGRlcnMuY291bnQoKSxcbiAgICAgIHRoaXMudGFncy5jb3VudCgpLFxuICAgICAgdGhpcy5pbWFnZXMuY291bnQoKSxcbiAgICAgIHRoaXMuc3luY1F1ZXVlLmNvdW50KClcbiAgICBdKVxuXG4gICAgLy8g6K6h566X5oC75aSn5bCP77yI566A5YyW54mI5pys77yJXG4gICAgY29uc3QgdG90YWxTaXplID0gYXdhaXQgdGhpcy5jYWxjdWxhdGVUb3RhbFNpemUoKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNhcmRzLFxuICAgICAgZm9sZGVycyxcbiAgICAgIHRhZ3MsXG4gICAgICBpbWFnZXMsXG4gICAgICBwZW5kaW5nU3luYyxcbiAgICAgIHRvdGFsU2l6ZSxcbiAgICAgIHZlcnNpb246ICczLjAuMCdcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNhbGN1bGF0ZVRvdGFsU2l6ZSgpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIC8vIOiuoeeul+aJgOacieWbvueJh+eahOaAu+Wkp+Wwj1xuICAgIGNvbnN0IGltYWdlcyA9IGF3YWl0IHRoaXMuaW1hZ2VzLnRvQXJyYXkoKVxuICAgIHJldHVybiBpbWFnZXMucmVkdWNlKCh0b3RhbCwgaW1hZ2UpID0+IHRvdGFsICsgaW1hZ2UubWV0YWRhdGEuc2l6ZSwgMClcbiAgfVxuXG4gIC8vIOe7n+S4gOeahOWNoeeJh+aTjeS9nFxuICBhc3luYyBjcmVhdGVDYXJkKGNhcmREYXRhOiBPbWl0PERiQ2FyZCwgJ2lkJyB8ICdzeW5jVmVyc2lvbicgfCAncGVuZGluZ1N5bmMnIHwgJ3VwZGF0ZWRBdCc+LCB1c2VySWQ/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGlkID0gY3J5cHRvLnJhbmRvbVVVSUQoKVxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBcbiAgICBhd2FpdCB0aGlzLmNhcmRzLmFkZCh7XG4gICAgICAuLi5jYXJkRGF0YSxcbiAgICAgIGlkLFxuICAgICAgdXNlcklkLFxuICAgICAgc3luY1ZlcnNpb246IDEsXG4gICAgICBwZW5kaW5nU3luYzogdHJ1ZSxcbiAgICAgIHVwZGF0ZWRBdDogbm93XG4gICAgfSlcbiAgICBcbiAgICByZXR1cm4gaWRcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZUNhcmQoaWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxEYkNhcmQ+KTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNhcmRzLnVwZGF0ZShpZCwge1xuICAgICAgLi4udXBkYXRlcyxcbiAgICAgIHN5bmNWZXJzaW9uOiB1cGRhdGVzLnN5bmNWZXJzaW9uID8gdXBkYXRlcy5zeW5jVmVyc2lvbiArIDEgOiB1bmRlZmluZWQsXG4gICAgICBwZW5kaW5nU3luYzogdHJ1ZSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgIH0pXG4gICAgXG4gICAgcmV0dXJuIHJlc3VsdFxuICB9XG5cbiAgYXN5bmMgZGVsZXRlQ2FyZChpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy50cmFuc2FjdGlvbigncncnLCBbdGhpcy5jYXJkcywgdGhpcy5pbWFnZXNdLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyDliKDpmaTnm7jlhbPlm77niYdcbiAgICAgIGF3YWl0IHRoaXMuaW1hZ2VzLndoZXJlKCdjYXJkSWQnKS5lcXVhbHMoaWQpLmRlbGV0ZSgpXG4gICAgICAvLyDliKDpmaTljaHniYdcbiAgICAgIGF3YWl0IHRoaXMuY2FyZHMuZGVsZXRlKGlkKVxuICAgIH0pXG4gIH1cblxuICAvLyDmibnph4/mk43kvZzmlK/mjIFcbiAgYXN5bmMgYnVsa0NyZWF0ZUNhcmRzKGNhcmRzRGF0YTogT21pdDxEYkNhcmQsICdpZCcgfCAnc3luY1ZlcnNpb24nIHwgJ3BlbmRpbmdTeW5jJyB8ICd1cGRhdGVkQXQnPltdLCB1c2VySWQ/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxuICAgIGNvbnN0IGNhcmRzID0gY2FyZHNEYXRhLm1hcChjYXJkRGF0YSA9PiAoe1xuICAgICAgLi4uY2FyZERhdGEsXG4gICAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcbiAgICAgIHVzZXJJZCxcbiAgICAgIHN5bmNWZXJzaW9uOiAxLFxuICAgICAgcGVuZGluZ1N5bmM6IHRydWUsXG4gICAgICB1cGRhdGVkQXQ6IG5vd1xuICAgIH0pKVxuICAgIFxuICAgIGF3YWl0IHRoaXMuY2FyZHMuYnVsa0FkZChjYXJkcylcbiAgICByZXR1cm4gY2FyZHMubWFwKGNhcmQgPT4gY2FyZC5pZCEpXG4gIH1cblxuICAvLyDmgKfog73kvJjljJbnmoTmn6Xor6Lmlrnms5VcbiAgYXN5bmMgZ2V0Q2FyZHNCeUZvbGRlcihmb2xkZXJJZDogc3RyaW5nLCB1c2VySWQ/OiBzdHJpbmcpOiBQcm9taXNlPERiQ2FyZFtdPiB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuY2FyZHNcbiAgICAgIC53aGVyZSgnW3VzZXJJZCtmb2xkZXJJZF0nKVxuICAgICAgLmVxdWFscyhbdXNlcklkIHx8ICdkZWZhdWx0JywgZm9sZGVySWRdKVxuICAgICAgLnRvQXJyYXkoKVxuICB9XG5cbiAgYXN5bmMgc2VhcmNoQ2FyZHMoc2VhcmNoVGVybTogc3RyaW5nLCB1c2VySWQ/OiBzdHJpbmcpOiBQcm9taXNlPERiQ2FyZFtdPiB7XG4gICAgY29uc3Qgc2VhcmNoTG93ZXIgPSBzZWFyY2hUZXJtLnRvTG93ZXJDYXNlKClcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5jYXJkc1xuICAgICAgLmZpbHRlcihjYXJkID0+IFxuICAgICAgICBjYXJkLnNlYXJjaFZlY3Rvcj8uaW5jbHVkZXMoc2VhcmNoTG93ZXIpIHx8XG4gICAgICAgIGNhcmQuZnJvbnRDb250ZW50LnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoTG93ZXIpIHx8XG4gICAgICAgIGNhcmQuZnJvbnRDb250ZW50LnRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hMb3dlcikgfHxcbiAgICAgICAgY2FyZC5iYWNrQ29udGVudC50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKSB8fFxuICAgICAgICBjYXJkLmJhY2tDb250ZW50LnRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hMb3dlcilcbiAgICAgIClcbiAgICAgIC50b0FycmF5KClcbiAgfVxuXG4gIC8vIOaVsOaNruW6k+a4heeQhuWSjOS8mOWMllxuICBhc3luYyBjbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMudHJhbnNhY3Rpb24oJ3J3JywgW3RoaXMuY2FyZHMsIHRoaXMuZm9sZGVycywgdGhpcy50YWdzLCB0aGlzLmltYWdlcywgdGhpcy5zeW5jUXVldWVdLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyDmuIXnkIbov4fmnJ/nmoTlkIzmraXmk43kvZxcbiAgICAgIGNvbnN0IGV4cGlyZWREYXRlID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKSAvLyA35aSp5YmNXG4gICAgICBhd2FpdCB0aGlzLnN5bmNRdWV1ZS53aGVyZSgndGltZXN0YW1wJykuYmVsb3coZXhwaXJlZERhdGUpLmRlbGV0ZSgpXG4gICAgICBcbiAgICAgIC8vIOa4heeQhuWtpOeri+WbvueJh++8iOayoeacieWvueW6lOWNoeeJh+eahOWbvueJh++8iVxuICAgICAgY29uc3QgY2FyZElkcyA9IGF3YWl0IHRoaXMuY2FyZHMudG9Db2xsZWN0aW9uKCkucHJpbWFyeUtleXMoKVxuICAgICAgYXdhaXQgdGhpcy5pbWFnZXMud2hlcmUoJ2NhcmRJZCcpLm5vbmVPZihjYXJkSWRzIGFzIHN0cmluZ1tdKS5kZWxldGUoKVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgY2xlYW51cCBjb21wbGV0ZWQnKVxuICAgIH0pXG4gIH1cblxuICAvLyDmlbDmja7lupPlgaXlurfmo4Dmn6VcbiAgYXN5bmMgaGVhbHRoQ2hlY2soKTogUHJvbWlzZTx7XG4gICAgaXNIZWFsdGh5OiBib29sZWFuXG4gICAgaXNzdWVzOiBzdHJpbmdbXVxuICAgIHN0YXRzOiBEYXRhYmFzZVN0YXRzXG4gIH0+IHtcbiAgICBjb25zdCBpc3N1ZXM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8g5qOA5p+l5pWw5o2u5bqT6L+e5o6lXG4gICAgICBhd2FpdCB0aGlzLnRhYmxlcy50b0FycmF5KClcbiAgICAgIFxuICAgICAgLy8g5qOA5p+l5pWw5o2u5LiA6Ie05oCnXG4gICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHRoaXMuZ2V0U3RhdHMoKVxuICAgICAgXG4gICAgICAvLyDmo4Dmn6XmmK/lkKbmnInlpKfph4/lvoXlkIzmraXpobnnm65cbiAgICAgIGlmIChzdGF0cy5wZW5kaW5nU3luYyA+IDEwMDApIHtcbiAgICAgICAgaXNzdWVzLnB1c2goYEhpZ2ggbnVtYmVyIG9mIHBlbmRpbmcgc3luYyBvcGVyYXRpb25zOiAke3N0YXRzLnBlbmRpbmdTeW5jfWApXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOajgOafpeaVsOaNruW6k+Wkp+Wwj1xuICAgICAgaWYgKHN0YXRzLnRvdGFsU2l6ZSA+IDUwMCAqIDEwMjQgKiAxMDI0KSB7IC8vIDUwME1CXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBEYXRhYmFzZSBzaXplIGlzIGxhcmdlOiAkeyhzdGF0cy50b3RhbFNpemUgLyAxMDI0IC8gMTAyNCkudG9GaXhlZCgyKX0gTUJgKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc0hlYWx0aHk6IGlzc3Vlcy5sZW5ndGggPT09IDAsXG4gICAgICAgIGlzc3VlcyxcbiAgICAgICAgc3RhdHNcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNIZWFsdGh5OiBmYWxzZSxcbiAgICAgICAgaXNzdWVzOiBbYERhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkOiAke2Vycm9yfWBdLFxuICAgICAgICBzdGF0czogeyBjYXJkczogMCwgZm9sZGVyczogMCwgdGFnczogMCwgaW1hZ2VzOiAwLCBwZW5kaW5nU3luYzogMCwgdG90YWxTaXplOiAwLCB2ZXJzaW9uOiAnMy4wLjAnIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyDlrozlhajmuIXnkIbmlbDmja7lupPvvIjosKjmhY7kvb/nlKjvvIlcbiAgYXN5bmMgY2xlYXJBbGwoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy50cmFuc2FjdGlvbigncncnLCBbdGhpcy5jYXJkcywgdGhpcy5mb2xkZXJzLCB0aGlzLnRhZ3MsIHRoaXMuaW1hZ2VzLCB0aGlzLnN5bmNRdWV1ZSwgdGhpcy5zZXR0aW5ncywgdGhpcy5zZXNzaW9uc10sIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHRoaXMuY2FyZHMuY2xlYXIoKVxuICAgICAgYXdhaXQgdGhpcy5mb2xkZXJzLmNsZWFyKClcbiAgICAgIGF3YWl0IHRoaXMudGFncy5jbGVhcigpXG4gICAgICBhd2FpdCB0aGlzLmltYWdlcy5jbGVhcigpXG4gICAgICBhd2FpdCB0aGlzLnN5bmNRdWV1ZS5jbGVhcigpXG4gICAgICAvLyDkv53nlZnorr7nva7vvIzlj6rmuIXpmaTnlKjmiLfmlbDmja5cbiAgICAgIGF3YWl0IHRoaXMuc2Vzc2lvbnMuY2xlYXIoKVxuICAgIH0pXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOWQkeWQjuWFvOWuueeahOaWueazlSAtIOS/neaMgeeOsOacieS7o+eggeS4jeS4reaWrVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLy8g5pen54mIZ2V0U2V0dGluZ+aWueazle+8iOS/neaMgeWFvOWuue+8iVxuICBhc3luYyBnZXRTZXR0aW5nTGVnYWN5KGtleTogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRTZXR0aW5nKGtleSlcbiAgfVxuXG4gIC8vIOaXp+eJiHVwZGF0ZVNldHRpbmfmlrnms5XvvIjkv53mjIHlhbzlrrnvvIlcbiAgYXN5bmMgdXBkYXRlU2V0dGluZ0xlZ2FjeShrZXk6IHN0cmluZywgdmFsdWU6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMudXBkYXRlU2V0dGluZyhrZXksIHZhbHVlKVxuICB9XG5cbiAgLy8g5pen54mIY2xlYXJBbGzmlrnms5XvvIjkv53mjIHlhbzlrrnvvIlcbiAgYXN5bmMgY2xlYXJBbGxMZWdhY3koKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy50cmFuc2FjdGlvbigncncnLCB0aGlzLmNhcmRzLCB0aGlzLmZvbGRlcnMsIHRoaXMudGFncywgdGhpcy5pbWFnZXMsIHRoaXMuc3luY1F1ZXVlLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCB0aGlzLmNhcmRzLmNsZWFyKClcbiAgICAgIGF3YWl0IHRoaXMuZm9sZGVycy5jbGVhcigpXG4gICAgICBhd2FpdCB0aGlzLnRhZ3MuY2xlYXIoKVxuICAgICAgYXdhaXQgdGhpcy5pbWFnZXMuY2xlYXIoKVxuICAgICAgYXdhaXQgdGhpcy5zeW5jUXVldWUuY2xlYXIoKVxuICAgIH0pXG4gIH1cblxuICAvLyDml6fniYhnZXRTdGF0c+aWueazle+8iOS/neaMgeWFvOWuue+8iVxuICBhc3luYyBnZXRTdGF0c0xlZ2FjeSgpOiBQcm9taXNlPHtcbiAgICBjYXJkczogbnVtYmVyXG4gICAgZm9sZGVyczogbnVtYmVyXG4gICAgdGFnczogbnVtYmVyXG4gICAgaW1hZ2VzOiBudW1iZXJcbiAgICBwZW5kaW5nU3luYzogbnVtYmVyXG4gIH0+IHtcbiAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHRoaXMuZ2V0U3RhdHMoKVxuICAgIHJldHVybiB7XG4gICAgICBjYXJkczogc3RhdHMuY2FyZHMsXG4gICAgICBmb2xkZXJzOiBzdGF0cy5mb2xkZXJzLFxuICAgICAgdGFnczogc3RhdHMudGFncyxcbiAgICAgIGltYWdlczogc3RhdHMuaW1hZ2VzLFxuICAgICAgcGVuZGluZ1N5bmM6IHN0YXRzLnBlbmRpbmdTeW5jXG4gICAgfVxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOWQkeWQjuWFvOWuueaUr+aMgVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLyDml6fniYjmnKzmlbDmja7lupPnsbvvvIjnlKjkuo7ov4Hnp7vvvIlcbmNsYXNzIENhcmRBbGxEYXRhYmFzZV92MSBleHRlbmRzIERleGllIHtcbiAgY2FyZHMhOiBUYWJsZTxhbnk+XG4gIGZvbGRlcnMhOiBUYWJsZTxhbnk+XG4gIHRhZ3MhOiBUYWJsZTxhbnk+XG4gIGltYWdlcyE6IFRhYmxlPGFueT5cbiAgc3luY1F1ZXVlITogVGFibGU8YW55PlxuICBzZXR0aW5ncyE6IFRhYmxlPGFueT5cbiAgXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCdDYXJkQWxsRGF0YWJhc2UnKVxuICAgIHRoaXMudmVyc2lvbigxKS5zdG9yZXMoe1xuICAgICAgY2FyZHM6ICcrK2lkLCBmb2xkZXJJZCwgY3JlYXRlZEF0LCB1cGRhdGVkQXQsIHN5bmNWZXJzaW9uLCBwZW5kaW5nU3luYycsXG4gICAgICBmb2xkZXJzOiAnKytpZCwgcGFyZW50SWQsIGNyZWF0ZWRBdCwgdXBkYXRlZEF0LCBzeW5jVmVyc2lvbiwgcGVuZGluZ1N5bmMnLFxuICAgICAgdGFnczogJysraWQsIG5hbWUsIGNyZWF0ZWRBdCwgc3luY1ZlcnNpb24sIHBlbmRpbmdTeW5jJyxcbiAgICAgIGltYWdlczogJysraWQsIGNhcmRJZCwgZmlsZVBhdGgsIGNyZWF0ZWRBdCwgc3luY1ZlcnNpb24sIHBlbmRpbmdTeW5jJyxcbiAgICAgIHN5bmNRdWV1ZTogJysraWQsIHR5cGUsIGVudGl0eSwgZW50aXR5SWQsIHRpbWVzdGFtcCwgcmV0cnlDb3VudCcsXG4gICAgICBzZXR0aW5nczogJysraWQsIGtleSwgdXBkYXRlZEF0J1xuICAgIH0pXG4gIH1cbn1cblxuLy8g5Yib5bu65pWw5o2u5bqT5a6e5L6LXG5leHBvcnQgY29uc3QgZGIgPSBuZXcgQ2FyZEFsbFVuaWZpZWREYXRhYmFzZSgpXG5cbi8vIOaVsOaNruW6k+WIneWni+WMllxuZXhwb3J0IGNvbnN0IGluaXRpYWxpemVEYXRhYmFzZSA9IGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBkYi5vcGVuKClcbiAgICBjb25zb2xlLmxvZygnQ2FyZEFsbCB1bmlmaWVkIGRhdGFiYXNlIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseScpXG4gICAgXG4gICAgLy8g5omn6KGM5YGl5bq35qOA5p+lXG4gICAgY29uc3QgaGVhbHRoID0gYXdhaXQgZGIuaGVhbHRoQ2hlY2soKVxuICAgIGlmICghaGVhbHRoLmlzSGVhbHRoeSkge1xuICAgICAgY29uc29sZS53YXJuKCdEYXRhYmFzZSBoZWFsdGggaXNzdWVzIGRldGVjdGVkOicsIGhlYWx0aC5pc3N1ZXMpXG4gICAgfVxuICAgIFxuICAgIC8vIOWumuacn+a4heeQhlxuICAgIHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGRiLmNsZWFudXAoKS5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIH0sIDI0ICogNjAgKiA2MCAqIDEwMDApIC8vIOavj+Wkqea4heeQhuS4gOasoVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIGRhdGFiYXNlOicsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH1cbn1cblxuLy8g5pWw5o2u5bqT6ZSZ6K+v5aSE55CGXG5kYi5vbignZXJyb3InLCAoZXJyb3IpID0+IHtcbiAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgZXJyb3I6JywgZXJyb3IpXG59KVxuXG5kYi5vbignYmxvY2tlZCcsICgpID0+IHtcbiAgY29uc29sZS53YXJuKCdEYXRhYmFzZSBvcGVyYXRpb24gYmxvY2tlZCcpXG59KVxuXG5kYi5vbigndmVyc2lvbmNoYW5nZScsICgpID0+IHtcbiAgY29uc29sZS53YXJuKCdEYXRhYmFzZSB2ZXJzaW9uIGNoYW5nZWQsIHJlbG9hZGluZyBwYWdlLi4uJylcbiAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXG59KVxuXG5kYi5vbigncmVhZHknLCAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdEYXRhYmFzZSBpcyByZWFkeScpXG59KVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDlr7zlh7rlt6Xlhbflh73mlbBcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy8g5pWw5o2u6L2s5o2i5bel5YW3XG5leHBvcnQgY29uc3QgY29udmVydFRvRGJDYXJkID0gKGNhcmQ6IENhcmQsIHVzZXJJZD86IHN0cmluZyk6IERiQ2FyZCA9PiB7XG4gIHJldHVybiB7XG4gICAgLi4uY2FyZCxcbiAgICB1c2VySWQsXG4gICAgc3luY1ZlcnNpb246IDEsXG4gICAgcGVuZGluZ1N5bmM6IHRydWUsXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGNvbnZlcnRGcm9tRGJDYXJkID0gKGRiQ2FyZDogRGJDYXJkKTogQ2FyZCA9PiB7XG4gIGNvbnN0IHsgdXNlcklkLCBzeW5jVmVyc2lvbiwgbGFzdFN5bmNBdCwgcGVuZGluZ1N5bmMsIC4uLmNhcmQgfSA9IGRiQ2FyZFxuICByZXR1cm4ge1xuICAgIC4uLmNhcmQsXG4gICAgaWQ6IGNhcmQuaWQgfHwgJycsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShjYXJkLmNyZWF0ZWRBdCksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZShjYXJkLnVwZGF0ZWRBdClcbiAgfVxufVxuXG4vLyDmkJzntKLkvJjljJblt6XlhbdcbmV4cG9ydCBjb25zdCBnZW5lcmF0ZVNlYXJjaFZlY3RvciA9IChjYXJkOiBDYXJkKTogc3RyaW5nID0+IHtcbiAgY29uc3Qgc2VhcmNoYWJsZVRleHQgPSBbXG4gICAgY2FyZC5mcm9udENvbnRlbnQudGl0bGUsXG4gICAgY2FyZC5mcm9udENvbnRlbnQudGV4dCxcbiAgICBjYXJkLmJhY2tDb250ZW50LnRpdGxlLFxuICAgIGNhcmQuYmFja0NvbnRlbnQudGV4dCxcbiAgICAuLi5jYXJkLmZyb250Q29udGVudC50YWdzLFxuICAgIC4uLmNhcmQuYmFja0NvbnRlbnQudGFnc1xuICBdLmpvaW4oJyAnKS50b0xvd2VyQ2FzZSgpXG4gIFxuICByZXR1cm4gc2VhcmNoYWJsZVRleHRcbn1cblxuLy8g5om56YeP5pON5L2c5bel5YW3XG5leHBvcnQgY29uc3QgYmF0Y2hPcGVyYXRpb24gPSBhc3luYyA8VD4oXG4gIGl0ZW1zOiBUW10sXG4gIGJhdGNoU2l6ZTogbnVtYmVyID0gMTAwLFxuICBvcGVyYXRpb246IChiYXRjaDogVFtdKSA9PiBQcm9taXNlPHZvaWQ+XG4pOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkgKz0gYmF0Y2hTaXplKSB7XG4gICAgY29uc3QgYmF0Y2ggPSBpdGVtcy5zbGljZShpLCBpICsgYmF0Y2hTaXplKVxuICAgIGF3YWl0IG9wZXJhdGlvbihiYXRjaClcbiAgfVxufVxuXG4vLyDmlbDmja7pqozor4Hlt6XlhbdcbmV4cG9ydCBjb25zdCB2YWxpZGF0ZUNhcmREYXRhID0gKGNhcmQ6IFBhcnRpYWw8Q2FyZD4pOiBzdHJpbmdbXSA9PiB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXVxuICBcbiAgaWYgKCFjYXJkLmZyb250Q29udGVudD8udGl0bGUpIHtcbiAgICBlcnJvcnMucHVzaCgnRnJvbnQgY29udGVudCB0aXRsZSBpcyByZXF1aXJlZCcpXG4gIH1cbiAgXG4gIGlmICghY2FyZC5iYWNrQ29udGVudD8udGl0bGUpIHtcbiAgICBlcnJvcnMucHVzaCgnQmFjayBjb250ZW50IHRpdGxlIGlzIHJlcXVpcmVkJylcbiAgfVxuICBcbiAgaWYgKGNhcmQuc3R5bGUgJiYgIVsnc29saWQnLCAnZ3JhZGllbnQnLCAnZ2xhc3MnXS5pbmNsdWRlcyhjYXJkLnN0eWxlLnR5cGUpKSB7XG4gICAgZXJyb3JzLnB1c2goJ0ludmFsaWQgY2FyZCBzdHlsZSB0eXBlJylcbiAgfVxuICBcbiAgcmV0dXJuIGVycm9yc1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDmgKfog73kvJjljJblkoznvJPlrZhcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLy8g566A5Y2V55qE5p+l6K+i57yT5a2YXG5jb25zdCBxdWVyeUNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIHsgZGF0YTogYW55OyB0aW1lc3RhbXA6IG51bWJlciB9PigpXG5jb25zdCBDQUNIRV9UVEwgPSA1ICogNjAgKiAxMDAwIC8vIDXliIbpkp/nvJPlrZhcblxuZXhwb3J0IGNvbnN0IGNhY2hlZFF1ZXJ5ID0gYXN5bmMgPFQ+KFxuICBrZXk6IHN0cmluZyxcbiAgcXVlcnk6ICgpID0+IFByb21pc2U8VD5cbik6IFByb21pc2U8VD4gPT4ge1xuICBjb25zdCBjYWNoZWQgPSBxdWVyeUNhY2hlLmdldChrZXkpXG4gIGlmIChjYWNoZWQgJiYgRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAgPCBDQUNIRV9UVEwpIHtcbiAgICByZXR1cm4gY2FjaGVkLmRhdGFcbiAgfVxuICBcbiAgY29uc3QgZGF0YSA9IGF3YWl0IHF1ZXJ5KClcbiAgcXVlcnlDYWNoZS5zZXQoa2V5LCB7IGRhdGEsIHRpbWVzdGFtcDogRGF0ZS5ub3coKSB9KVxuICByZXR1cm4gZGF0YVxufVxuXG4vLyDmuIXnkIbnvJPlrZhcbmV4cG9ydCBjb25zdCBjbGVhclF1ZXJ5Q2FjaGUgPSAoKTogdm9pZCA9PiB7XG4gIHF1ZXJ5Q2FjaGUuY2xlYXIoKVxufVxuXG4vLyDlrprmnJ/muIXnkIbov4fmnJ/nvJPlrZhcbnNldEludGVydmFsKCgpID0+IHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBxdWVyeUNhY2hlLmVudHJpZXMoKSkge1xuICAgIGlmIChub3cgLSB2YWx1ZS50aW1lc3RhbXAgPiBDQUNIRV9UVEwpIHtcbiAgICAgIHF1ZXJ5Q2FjaGUuZGVsZXRlKGtleSlcbiAgICB9XG4gIH1cbn0sIENBQ0hFX1RUTCkiXSwidmVyc2lvbiI6M30=