5806d1418c3e8453b9c02c59ebe75e33
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.cacheStats = exports.cacheClear = exports.cacheDelete = exports.cacheSet = exports.cacheGet = exports.cardCache = exports.CardCache = exports.advancedCacheManager = exports.AdvancedCacheManager = exports.CacheStrategy = void 0;
// ============================================================================
// 缓存策略枚举
// ============================================================================
var CacheStrategy;
(function (CacheStrategy) {
    CacheStrategy["LRU"] = "lru";
    CacheStrategy["LFU"] = "lfu";
    CacheStrategy["FIFO"] = "fifo";
    CacheStrategy["TTL"] = "ttl";
    CacheStrategy["ADAPTIVE"] = "adaptive"; // 自适应策略
})(CacheStrategy || (exports.CacheStrategy = CacheStrategy = {}));
// ============================================================================
// 高级缓存管理器
// ============================================================================
class AdvancedCacheManager {
    constructor(config = {}) {
        Object.defineProperty(this, "cache", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Map()
        });
        Object.defineProperty(this, "accessLog", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        Object.defineProperty(this, "compressionMap", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Map()
        }); // 压缩映射
        Object.defineProperty(this, "persistentStorage", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: new Map()
        }); // 持久化存储
        Object.defineProperty(this, "config", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "stats", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "cleanupTimer", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "warmupStrategies", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        this.config = {
            maxEntries: 1000,
            defaultTTL: 5 * 60 * 1000, // 5分钟
            strategy: CacheStrategy.ADAPTIVE,
            enableCompression: true,
            enablePersistence: true,
            cleanupInterval: 60 * 1000, // 1分钟
            memoryLimit: 50, // 50MB
            ...config
        };
        this.initializeStats();
        this.initializeCache();
        this.startCleanupTimer();
    }
    // ============================================================================
    // 核心缓存操作
    // ============================================================================
    /**
     * 获取缓存值
     */
    async get(key, options) {
        const startTime = performance.now();
        try {
            // 检查内存缓存
            let entry = this.cache.get(key);
            // 如果内存中没有，检查持久化存储
            if (!entry && this.config.enablePersistence) {
                entry = await this.loadFromPersistentStorage(key);
                if (entry) {
                    this.cache.set(key, entry);
                }
            }
            if (!entry) {
                this.recordMiss(key, performance.now() - startTime);
                return null;
            }
            // 检查TTL
            if (this.isExpired(entry)) {
                this.evictEntry(key);
                this.recordMiss(key, performance.now() - startTime);
                return null;
            }
            // 解压数据
            let data = entry.data;
            if (entry.metadata.compressed && !options?.skipDecompression) {
                data = await this.decompressData(data);
            }
            // 更新访问信息
            if (options?.updateAccessTime !== false) {
                this.updateAccessInfo(entry);
            }
            this.recordHit(key, performance.now() - startTime);
            return data;
        }
        catch (error) {
            console.error('Cache get error:', error);
            this.recordMiss(key, performance.now() - startTime);
            return null;
        }
    }
    /**
     * 设置缓存值
     */
    async set(key, data, options) {
        try {
            // 计算数据大小
            const dataSize = this.calculateDataSize(data);
            // 检查内存限制
            if (this.getCurrentMemoryUsage() + dataSize > this.config.memoryLimit * 1024 * 1024) {
                this.evictByMemoryPressure(dataSize);
            }
            // 检查条目限制
            if (this.cache.size >= this.config.maxEntries) {
                this.evictByStrategy();
            }
            // 压缩数据
            let processedData = data;
            let compressed = false;
            if (this.config.enableCompression &&
                dataSize > 1024 && // 大于1KB才压缩
                !options?.skipCompression) {
                processedData = await this.compressData(data);
                compressed = true;
            }
            const entry = {
                key,
                data: processedData,
                metadata: {
                    createdAt: new Date(),
                    accessedAt: new Date(),
                    accessCount: 1,
                    ttl: options?.ttl || this.config.defaultTTL,
                    size: compressed ? this.calculateDataSize(processedData) : dataSize,
                    compressed,
                    tags: options?.tags || [],
                    priority: options?.priority || 'normal'
                }
            };
            if (options?.persistOnly) {
                // 仅持久化，不存入内存
                await this.saveToPersistentStorage(key, entry);
            }
            else {
                // 存入内存
                this.cache.set(key, entry);
                // 同时持久化
                if (this.config.enablePersistence) {
                    await this.saveToPersistentStorage(key, entry);
                }
            }
            this.updateStats();
        }
        catch (error) {
            console.error('Cache set error:', error);
        }
    }
    /**
     * 删除缓存项
     */
    async delete(key) {
        try {
            const deleted = this.cache.delete(key);
            if (this.config.enablePersistence) {
                await this.deleteFromPersistentStorage(key);
            }
            if (deleted) {
                this.stats.totalEntries = this.cache.size;
            }
            return deleted;
        }
        catch (error) {
            console.error('Cache delete error:', error);
            return false;
        }
    }
    /**
     * 批量删除缓存项
     */
    async deleteByPattern(pattern) {
        let deletedCount = 0;
        const keysToDelete = [];
        this.cache.forEach((_, key) => {
            if (pattern.test(key)) {
                keysToDelete.push(key);
            }
        });
        for (const key of keysToDelete) {
            if (await this.delete(key)) {
                deletedCount++;
            }
        }
        return deletedCount;
    }
    /**
     * 清空缓存
     */
    async clear() {
        this.cache.clear();
        if (this.config.enablePersistence) {
            await this.clearPersistentStorage();
        }
        this.initializeStats();
    }
    // ============================================================================
    // 智能缓存策略
    // ============================================================================
    /**
     * 预测性缓存预热
     */
    async predictiveWarmup() {
        const predictions = await this.generateAccessPredictions();
        for (const prediction of predictions) {
            if (prediction.probability > 0.7) { // 70%以上概率才预热
                try {
                    const data = await this.fetchDataForPrediction(prediction);
                    if (data) {
                        await this.set(prediction.key, data, {
                            ttl: prediction.ttl,
                            priority: prediction.priority,
                            tags: ['predictive', prediction.entityType]
                        });
                    }
                }
                catch (error) {
                    console.warn(`Failed to warmup cache for ${prediction.key}:`, error);
                }
            }
        }
    }
    /**
     * 自适应缓存策略
     */
    evictByStrategy() {
        switch (this.config.strategy) {
            case CacheStrategy.LRU:
                this.evictLRU();
                break;
            case CacheStrategy.LFU:
                this.evictLFU();
                break;
            case CacheStrategy.FIFO:
                this.evictFIFO();
                break;
            case CacheStrategy.TTL:
                this.evictByTTL();
                break;
            case CacheStrategy.ADAPTIVE:
                this.evictAdaptive();
                break;
        }
    }
    evictLRU() {
        let oldestKey = null;
        let oldestTime = Date.now();
        this.cache.forEach((entry, key) => {
            if (entry.metadata.accessedAt.getTime() < oldestTime) {
                oldestTime = entry.metadata.accessedAt.getTime();
                oldestKey = key;
            }
        });
        if (oldestKey) {
            this.evictEntry(oldestKey);
        }
    }
    evictLFU() {
        let leastFrequentKey = null;
        let lowestCount = Infinity;
        this.cache.forEach((entry, key) => {
            if (entry.metadata.accessCount < lowestCount) {
                lowestCount = entry.metadata.accessCount;
                leastFrequentKey = key;
            }
        });
        if (leastFrequentKey) {
            this.evictEntry(leastFrequentKey);
        }
    }
    evictFIFO() {
        let oldestKey = null;
        let oldestTime = Date.now();
        this.cache.forEach((entry, key) => {
            if (entry.metadata.createdAt.getTime() < oldestTime) {
                oldestTime = entry.metadata.createdAt.getTime();
                oldestKey = key;
            }
        });
        if (oldestKey) {
            this.evictEntry(oldestKey);
        }
    }
    evictByTTL() {
        const now = Date.now();
        const expiredKeys = [];
        this.cache.forEach((entry, key) => {
            if (now - entry.metadata.createdAt.getTime() > entry.metadata.ttl) {
                expiredKeys.push(key);
            }
        });
        // 删除最旧的过期条目
        if (expiredKeys.length > 0) {
            const oldestExpiredKey = expiredKeys.reduce((oldest, current) => {
                const oldestEntry = this.cache.get(oldest);
                const currentEntry = this.cache.get(current);
                return oldestEntry.metadata.createdAt.getTime() < currentEntry.metadata.createdAt.getTime()
                    ? oldest
                    : current;
            });
            this.evictEntry(oldestExpiredKey);
        }
    }
    evictAdaptive() {
        // 基于命中率、访问频率、内存压力的混合策略
        const entries = Array.from(this.cache.entries());
        // 计算每个条目的分数（分数越高越应该被保留）
        const scoredEntries = entries.map(([key, entry]) => {
            const age = Date.now() - entry.metadata.createdAt.getTime();
            const accessFreq = entry.metadata.accessCount;
            const hitRate = this.calculateHitRate(key);
            const priorityMultiplier = entry.metadata.priority === 'high' ? 2 :
                entry.metadata.priority === 'low' ? 0.5 : 1;
            const score = (accessFreq * hitRate * priorityMultiplier) / (age / 1000);
            return { key, score };
        });
        // 删除分数最低的条目
        scoredEntries.sort((a, b) => a.score - b.score);
        if (scoredEntries.length > 0) {
            this.evictEntry(scoredEntries[0].key);
        }
    }
    /**
     * 基于内存压力清理
     */
    evictByMemoryPressure(requiredSize) {
        const entries = Array.from(this.cache.entries());
        // 按优先级和访问频率排序
        entries.sort((a, b) => {
            const entryA = a[1];
            const entryB = b[1];
            // 优先级权重
            const priorityWeight = {
                high: 3,
                normal: 2,
                low: 1
            };
            const scoreA = entryA.metadata.accessCount * priorityWeight[entryA.metadata.priority];
            const scoreB = entryB.metadata.accessCount * priorityWeight[entryB.metadata.priority];
            return scoreA - scoreB;
        });
        // 逐个删除直到有足够空间
        let freedSpace = 0;
        for (const [key, entry] of entries) {
            if (freedSpace >= requiredSize)
                break;
            this.evictEntry(key);
            freedSpace += entry.metadata.size;
        }
    }
    // ============================================================================
    // 数据压缩和解压缩
    // ============================================================================
    async compressData(data) {
        if (!this.config.enableCompression)
            return data;
        try {
            // 简单的JSON压缩（实际项目中可以使用更复杂的压缩算法）
            const jsonString = JSON.stringify(data);
            // 使用LZ-String压缩（如果可用）
            if (typeof window !== 'undefined' && window.LZString) {
                return window.LZString.compress(jsonString);
            }
            // 降级到简单的Base64编码
            return btoa(jsonString);
        }
        catch (error) {
            console.warn('Compression failed, using original data:', error);
            return data;
        }
    }
    async decompressData(compressedData) {
        try {
            // 检查是否是LZString压缩
            if (typeof compressedData === 'string' && compressedData.length < 1000) {
                if (typeof window !== 'undefined' && window.LZString) {
                    try {
                        const decompressed = window.LZString.decompress(compressedData);
                        if (decompressed) {
                            return JSON.parse(decompressed);
                        }
                    }
                    catch {
                        // 继续尝试Base64
                    }
                }
                // 尝试Base64解码
                try {
                    const jsonString = atob(compressedData);
                    return JSON.parse(jsonString);
                }
                catch {
                    // 不是压缩数据，直接返回
                }
            }
            return compressedData;
        }
        catch (error) {
            console.warn('Decompression failed:', error);
            return compressedData;
        }
    }
    // ============================================================================
    // 持久化存储
    // ============================================================================
    async saveToPersistentStorage(key, entry) {
        try {
            if (!this.config.enablePersistence)
                return;
            const storageKey = `cache_${key}`;
            const serialized = JSON.stringify({
                ...entry,
                // 转换Date对象为ISO字符串
                metadata: {
                    ...entry.metadata,
                    createdAt: entry.metadata.createdAt.toISOString(),
                    accessedAt: entry.metadata.accessedAt.toISOString()
                }
            });
            // 使用localStorage或IndexedDB
            if (typeof localStorage !== 'undefined') {
                localStorage.setItem(storageKey, serialized);
            }
            else {
                // 降级到内存持久化
                this.persistentStorage.set(storageKey, serialized);
            }
        }
        catch (error) {
            console.warn('Failed to save to persistent storage:', error);
        }
    }
    async loadFromPersistentStorage(key) {
        try {
            if (!this.config.enablePersistence)
                return null;
            const storageKey = `cache_${key}`;
            let serialized;
            if (typeof localStorage !== 'undefined') {
                serialized = localStorage.getItem(storageKey);
            }
            else {
                serialized = this.persistentStorage.get(storageKey) || null;
            }
            if (!serialized)
                return null;
            const parsed = JSON.parse(serialized);
            // 转换ISO字符串回Date对象
            return {
                ...parsed,
                metadata: {
                    ...parsed.metadata,
                    createdAt: new Date(parsed.metadata.createdAt),
                    accessedAt: new Date(parsed.metadata.accessedAt)
                }
            };
        }
        catch (error) {
            console.warn('Failed to load from persistent storage:', error);
            return null;
        }
    }
    async deleteFromPersistentStorage(key) {
        try {
            if (!this.config.enablePersistence)
                return;
            const storageKey = `cache_${key}`;
            if (typeof localStorage !== 'undefined') {
                localStorage.removeItem(storageKey);
            }
            else {
                this.persistentStorage.delete(storageKey);
            }
        }
        catch (error) {
            console.warn('Failed to delete from persistent storage:', error);
        }
    }
    async clearPersistentStorage() {
        try {
            if (typeof localStorage !== 'undefined') {
                // 清除所有cache_前缀的项
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key?.startsWith('cache_')) {
                        localStorage.removeItem(key);
                    }
                }
            }
            else {
                this.persistentStorage.clear();
            }
        }
        catch (error) {
            console.warn('Failed to clear persistent storage:', error);
        }
    }
    // ============================================================================
    // 统计和监控
    // ============================================================================
    initializeStats() {
        this.stats = {
            totalEntries: 0,
            hitCount: 0,
            missCount: 0,
            evictionCount: 0,
            compressionRatio: 0,
            memoryUsage: 0,
            hitRate: 0,
            avgAccessTime: 0,
            byStrategy: {
                [CacheStrategy.LRU]: { hits: 0, misses: 0, evictions: 0 },
                [CacheStrategy.LFU]: { hits: 0, misses: 0, evictions: 0 },
                [CacheStrategy.FIFO]: { hits: 0, misses: 0, evictions: 0 },
                [CacheStrategy.TTL]: { hits: 0, misses: 0, evictions: 0 },
                [CacheStrategy.ADAPTIVE]: { hits: 0, misses: 0, evictions: 0 }
            },
            byEntityType: {}
        };
    }
    updateStats() {
        this.stats.totalEntries = this.cache.size;
        this.stats.hitRate = this.calculateOverallHitRate();
        this.stats.memoryUsage = this.getCurrentMemoryUsage();
        this.stats.compressionRatio = this.calculateCompressionRatio();
    }
    recordHit(key, accessTime) {
        this.stats.hitCount++;
        this.stats.byStrategy[this.config.strategy].hits++;
        // 更新实体类型统计
        const entityType = this.extractEntityType(key);
        if (!this.stats.byEntityType[entityType]) {
            this.stats.byEntityType[entityType] = { entries: 0, hits: 0, misses: 0 };
        }
        this.stats.byEntityType[entityType].hits++;
        // 记录访问日志
        this.accessLog.push({ key, timestamp: new Date(), type: 'hit' });
        this.trimAccessLog();
        // 更新平均访问时间
        this.updateAverageAccessTime(accessTime);
        this.updateStats();
    }
    recordMiss(key, accessTime) {
        this.stats.missCount++;
        this.stats.byStrategy[this.config.strategy].misses++;
        // 更新实体类型统计
        const entityType = this.extractEntityType(key);
        if (!this.stats.byEntityType[entityType]) {
            this.stats.byEntityType[entityType] = { entries: 0, hits: 0, misses: 0 };
        }
        this.stats.byEntityType[entityType].misses++;
        // 记录访问日志
        this.accessLog.push({ key, timestamp: new Date(), type: 'miss' });
        this.trimAccessLog();
        // 更新平均访问时间
        this.updateAverageAccessTime(accessTime);
        this.updateStats();
    }
    updateAverageAccessTime(accessTime) {
        const totalRequests = this.stats.hitCount + this.stats.missCount;
        const totalTime = this.stats.avgAccessTime * (totalRequests - 1) + accessTime;
        this.stats.avgAccessTime = totalTime / totalRequests;
    }
    trimAccessLog() {
        // 保持最近1000条记录
        if (this.accessLog.length > 1000) {
            this.accessLog = this.accessLog.slice(-1000);
        }
    }
    calculateOverallHitRate() {
        const total = this.stats.hitCount + this.stats.missCount;
        return total > 0 ? this.stats.hitCount / total : 0;
    }
    calculateHitRate(key) {
        const keyAccesses = this.accessLog.filter(log => log.key === key);
        if (keyAccesses.length === 0)
            return 0;
        const hits = keyAccesses.filter(log => log.type === 'hit').length;
        return hits / keyAccesses.length;
    }
    getCurrentMemoryUsage() {
        let totalSize = 0;
        this.cache.forEach(entry => {
            totalSize += entry.metadata.size;
        });
        return totalSize;
    }
    calculateCompressionRatio() {
        let compressedSize = 0;
        let originalSize = 0;
        this.cache.forEach(entry => {
            if (entry.metadata.compressed) {
                compressedSize += entry.metadata.size;
                // 估算原始大小（压缩前的大小）
                originalSize += entry.metadata.size * 2.5; // 假设压缩率为60%
            }
        });
        return originalSize > 0 ? compressedSize / originalSize : 0;
    }
    calculateDataSize(data) {
        try {
            return JSON.stringify(data).length * 2; // 简化的字节估算
        }
        catch {
            return 1024; // 默认1KB
        }
    }
    extractEntityType(key) {
        const parts = key.split(':');
        return parts[0] || 'unknown';
    }
    // ============================================================================
    // 缓存预热和预测
    // ============================================================================
    async generateAccessPredictions() {
        const predictions = [];
        // 基于访问模式分析
        const recentAccesses = this.accessLog
            .filter(log => log.timestamp.getTime() > Date.now() - 24 * 60 * 60 * 1000) // 最近24小时
            .sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());
        // 分析高频访问的键
        const keyFrequency = new Map();
        recentAccesses.forEach(access => {
            keyFrequency.set(access.key, (keyFrequency.get(access.key) || 0) + 1);
        });
        // 为高频键生成预测
        keyFrequency.forEach((frequency, key) => {
            if (frequency > 3) { // 访问次数超过3次
                const probability = Math.min(frequency / 10, 0.9);
                const entityType = this.extractEntityType(key);
                predictions.push({
                    key,
                    probability,
                    ttl: this.config.defaultTTL,
                    priority: frequency > 5 ? 'high' : 'normal',
                    entityType
                });
            }
        });
        return predictions.sort((a, b) => b.probability - a.probability);
    }
    async fetchDataForPrediction(prediction) {
        // 这里应该根据预测的key获取实际数据
        // 实现取决于具体的业务逻辑
        return null;
    }
    // ============================================================================
    // 辅助方法
    // ============================================================================
    isExpired(entry) {
        return Date.now() - entry.metadata.createdAt.getTime() > entry.metadata.ttl;
    }
    updateAccessInfo(entry) {
        entry.metadata.accessedAt = new Date();
        entry.metadata.accessCount++;
    }
    evictEntry(key) {
        const entry = this.cache.get(key);
        if (entry) {
            this.cache.delete(key);
            this.stats.evictionCount++;
            this.stats.byStrategy[this.config.strategy].evictions++;
            // 从持久化存储中删除
            if (this.config.enablePersistence) {
                this.deleteFromPersistentStorage(key).catch(console.error);
            }
        }
    }
    startCleanupTimer() {
        this.cleanupTimer = setInterval(() => {
            this.performCleanup();
        }, this.config.cleanupInterval);
    }
    async performCleanup() {
        try {
            // 清理过期条目
            const expiredKeys = [];
            this.cache.forEach((entry, key) => {
                if (this.isExpired(entry)) {
                    expiredKeys.push(key);
                }
            });
            for (const key of expiredKeys) {
                this.evictEntry(key);
            }
            // 清理持久化存储中的过期条目
            if (this.config.enablePersistence) {
                await this.cleanupPersistentStorage();
            }
            // 更新统计
            this.updateStats();
        }
        catch (error) {
            console.error('Cache cleanup failed:', error);
        }
    }
    async cleanupPersistentStorage() {
        try {
            if (typeof localStorage !== 'undefined') {
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key?.startsWith('cache_')) {
                        try {
                            const serialized = localStorage.getItem(key);
                            if (serialized) {
                                const entry = JSON.parse(serialized);
                                const entryDate = new Date(entry.metadata.createdAt);
                                if (Date.now() - entryDate.getTime() > entry.metadata.ttl) {
                                    keysToRemove.push(key);
                                }
                            }
                        }
                        catch {
                            // 无效数据，删除
                            keysToRemove.push(key);
                        }
                    }
                }
                keysToRemove.forEach(key => localStorage.removeItem(key));
            }
        }
        catch (error) {
            console.warn('Persistent storage cleanup failed:', error);
        }
    }
    initializeCache() {
        // 从持久化存储恢复缓存
        if (this.config.enablePersistence) {
            this.loadFromPersistentStorageAsync().catch(console.error);
        }
        // 启动预测性预热
        setTimeout(() => {
            this.predictiveWarmup().catch(console.error);
        }, 5000); // 5秒后开始预热
    }
    async loadFromPersistentStorageAsync() {
        try {
            if (typeof localStorage !== 'undefined') {
                const keysToLoad = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key?.startsWith('cache_')) {
                        keysToLoad.push(key);
                    }
                }
                // 限制恢复的条目数量以避免内存溢出
                const loadLimit = Math.min(keysToLoad.length, this.config.maxEntries / 2);
                for (let i = 0; i < loadLimit; i++) {
                    const storageKey = keysToLoad[i];
                    const cacheKey = storageKey.replace('cache_', '');
                    try {
                        const entry = await this.loadFromPersistentStorage(cacheKey);
                        if (entry && !this.isExpired(entry)) {
                            this.cache.set(cacheKey, entry);
                        }
                        else {
                            // 删除过期条目
                            localStorage.removeItem(storageKey);
                        }
                    }
                    catch (error) {
                        console.warn(`Failed to load cache entry ${cacheKey}:`, error);
                        localStorage.removeItem(storageKey);
                    }
                }
            }
        }
        catch (error) {
            console.warn('Failed to load cache from persistent storage:', error);
        }
    }
    // ============================================================================
    // 公共API方法
    // ============================================================================
    /**
     * 获取缓存统计信息
     */
    getStats() {
        return { ...this.stats };
    }
    /**
     * 获取缓存配置
     */
    getConfig() {
        return { ...this.config };
    }
    /**
     * 更新缓存配置
     */
    updateConfig(newConfig) {
        this.config = { ...this.config, ...newConfig };
        // 如果清理间隔改变，重启定时器
        if (this.cleanupTimer) {
            clearInterval(this.cleanupTimer);
        }
        this.startCleanupTimer();
    }
    /**
     * 添加预热策略
     */
    addWarmupStrategy(strategy) {
        this.warmupStrategies.push(strategy);
        this.warmupStrategies.sort((a, b) => b.priority - a.priority);
    }
    /**
     * 手动触发缓存预热
     */
    async warmup() {
        await this.predictiveWarmup();
    }
    /**
     * 获取缓存中的所有键
     */
    getKeys() {
        return Array.from(this.cache.keys());
    }
    /**
     * 检查键是否存在
     */
    has(key) {
        return this.cache.has(key);
    }
    /**
     * 获取缓存大小
     */
    size() {
        return this.cache.size;
    }
    /**
     * 停止缓存管理器
     */
    stop() {
        if (this.cleanupTimer) {
            clearInterval(this.cleanupTimer);
            this.cleanupTimer = undefined;
        }
    }
}
exports.AdvancedCacheManager = AdvancedCacheManager;
// ============================================================================
// 导出单例实例
// ============================================================================
exports.advancedCacheManager = new AdvancedCacheManager();
// ============================================================================
// 针对特定实体类型的缓存包装器
// ============================================================================
class CardCache {
    constructor(cacheManager) {
        Object.defineProperty(this, "cacheManager", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: cacheManager
        });
    }
    async getCard(cardId) {
        return this.cacheManager.get(`card:${cardId}`);
    }
    async setCard(cardId, card) {
        await this.cacheManager.set(`card:${cardId}`, card, {
            tags: ['card', 'data'],
            priority: 'normal',
            ttl: 10 * 60 * 1000 // 10分钟
        });
    }
    async getCardsByFolder(folderId) {
        return this.cacheManager.get(`cards:folder:${folderId}`);
    }
    async setCardsByFolder(folderId, cards) {
        await this.cacheManager.set(`cards:folder:${folderId}`, cards, {
            tags: ['cards', 'folder', 'list'],
            priority: 'normal',
            ttl: 5 * 60 * 1000 // 5分钟
        });
    }
    async invalidateCard(cardId) {
        await this.cacheManager.delete(`card:${cardId}`);
    }
    async invalidateFolder(folderId) {
        await this.cacheManager.delete(`cards:folder:${folderId}`);
    }
}
exports.CardCache = CardCache;
exports.cardCache = new CardCache(exports.advancedCacheManager);
// ============================================================================
// 便利方法导出
// ============================================================================
const cacheGet = (key) => exports.advancedCacheManager.get(key);
exports.cacheGet = cacheGet;
const cacheSet = (key, data, options) => exports.advancedCacheManager.set(key, data, options);
exports.cacheSet = cacheSet;
const cacheDelete = (key) => exports.advancedCacheManager.delete(key);
exports.cacheDelete = cacheDelete;
const cacheClear = () => exports.advancedCacheManager.clear();
exports.cacheClear = cacheClear;
const cacheStats = () => exports.advancedCacheManager.getStats();
exports.cacheStats = cacheStats;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXGFkdmFuY2VkLWNhY2hlLnRzIiwibWFwcGluZ3MiOiI7OztBQUdBLCtFQUErRTtBQUMvRSxTQUFTO0FBQ1QsK0VBQStFO0FBRS9FLElBQVksYUFNWDtBQU5ELFdBQVksYUFBYTtJQUN2Qiw0QkFBVyxDQUFBO0lBQ1gsNEJBQVcsQ0FBQTtJQUNYLDhCQUFhLENBQUE7SUFDYiw0QkFBVyxDQUFBO0lBQ1gsc0NBQXFCLENBQUEsQ0FBRyxRQUFRO0FBQ2xDLENBQUMsRUFOVyxhQUFhLDZCQUFiLGFBQWEsUUFNeEI7QUF3RUQsK0VBQStFO0FBQy9FLFVBQVU7QUFDViwrRUFBK0U7QUFFL0UsTUFBYSxvQkFBb0I7SUFXL0IsWUFBWSxTQUErQixFQUFFO1FBVnJDOzs7O21CQUFzQyxJQUFJLEdBQUcsRUFBRTtXQUFBO1FBQy9DOzs7O21CQUEyRSxFQUFFO1dBQUE7UUFDN0U7Ozs7bUJBQXNDLElBQUksR0FBRyxFQUFFO1dBQUEsQ0FBQyxPQUFPO1FBQ3ZEOzs7O21CQUFzQyxJQUFJLEdBQUcsRUFBRTtXQUFBLENBQUMsUUFBUTtRQUV4RDs7Ozs7V0FBbUI7UUFDbkI7Ozs7O1dBQWlCO1FBQ2pCOzs7OztXQUE2QjtRQUM3Qjs7OzttQkFBcUMsRUFBRTtXQUFBO1FBRzdDLElBQUksQ0FBQyxNQUFNLEdBQUc7WUFDWixVQUFVLEVBQUUsSUFBSTtZQUNoQixVQUFVLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFJLEVBQUUsTUFBTTtZQUNqQyxRQUFRLEVBQUUsYUFBYSxDQUFDLFFBQVE7WUFDaEMsaUJBQWlCLEVBQUUsSUFBSTtZQUN2QixpQkFBaUIsRUFBRSxJQUFJO1lBQ3ZCLGVBQWUsRUFBRSxFQUFFLEdBQUcsSUFBSSxFQUFFLE1BQU07WUFDbEMsV0FBVyxFQUFFLEVBQUUsRUFBRSxPQUFPO1lBQ3hCLEdBQUcsTUFBTTtTQUNWLENBQUE7UUFFRCxJQUFJLENBQUMsZUFBZSxF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QyxRQUFRLE1BQU0sRUFBRSxDQUFDLENBQUE7SUFDbEQsQ0FBQztJQUVELEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFnQjtRQUNyQyxNQUFNLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLGdCQUFnQixRQUFRLEVBQUUsQ0FBQyxDQUFBO0lBQzVELENBQUM7Q0FDRjtBQWxDRCw4QkFrQ0M7QUFFWSxRQUFBLFNBQVMsR0FBRyxJQUFJLFNBQVMsQ0FBQyw0QkFBb0IsQ0FBQyxDQUFBO0FBRTVELCtFQUErRTtBQUMvRSxTQUFTO0FBQ1QsK0VBQStFO0FBRXhFLE1BQU0sUUFBUSxHQUFHLENBQUksR0FBVyxFQUFFLEVBQUUsQ0FBQyw0QkFBb0IsQ0FBQyxHQUFHLENBQUksR0FBRyxDQUFDLENBQUE7QUFBL0QsUUFBQSxRQUFRLFlBQXVEO0FBQ3JFLE1BQU0sUUFBUSxHQUFHLENBQUksR0FBVyxFQUFFLElBQU8sRUFBRSxPQUFhLEVBQUUsRUFBRSxDQUNqRSw0QkFBb0IsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQTtBQURqQyxRQUFBLFFBQVEsWUFDeUI7QUFDdkMsTUFBTSxXQUFXLEdBQUcsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUFDLDRCQUFvQixDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUEvRCxRQUFBLFdBQVcsZUFBb0Q7QUFDckUsTUFBTSxVQUFVLEdBQUcsR0FBRyxFQUFFLENBQUMsNEJBQW9CLENBQUMsS0FBSyxFQUFFLENBQUE7QUFBL0MsUUFBQSxVQUFVLGNBQXFDO0FBQ3JELE1BQU0sVUFBVSxHQUFHLEdBQUcsRUFBRSxDQUFDLDRCQUFvQixDQUFDLFFBQVEsRUFBRSxDQUFBO0FBQWxELFFBQUEsVUFBVSxjQUF3QyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJEOlxcUHJvamVjdHNcXENhcmRFdmVyeXRoaW5nXFxjYXJkYWxsLXByb3RvdHlwZVxcc3JjXFxzZXJ2aWNlc1xcYWR2YW5jZWQtY2FjaGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGIsIHR5cGUgRGJDYXJkLCBEYkZvbGRlciwgRGJUYWcsIERiSW1hZ2UgfSBmcm9tICcuL2RhdGFiYXNlLXVuaWZpZWQnXG5pbXBvcnQgdHlwZSB7IENhcmQsIEZvbGRlciwgVGFnIH0gZnJvbSAnQC90eXBlcy9jYXJkJ1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnvJPlrZjnrZbnlaXmnprkuL5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGVudW0gQ2FjaGVTdHJhdGVneSB7XG4gIExSVSA9ICdscnUnLCAgICAgICAgICAgLy8g5pyA6L+R5pyA5bCR5L2/55SoXG4gIExGVSA9ICdsZnUnLCAgICAgICAgICAgLy8g5pyA5LiN57uP5bi45L2/55SoXG4gIEZJRk8gPSAnZmlmbycsICAgICAgICAgLy8g5YWI6L+b5YWI5Ye6XG4gIFRUTCA9ICd0dGwnLCAgICAgICAgICAgLy8g5Z+65LqO5pe26Ze0XG4gIEFEQVBUSVZFID0gJ2FkYXB0aXZlJyAgIC8vIOiHqumAguW6lOetlueVpVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnvJPlrZjphY3nva7mjqXlj6Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBDYWNoZUNvbmZpZyB7XG4gIG1heEVudHJpZXM6IG51bWJlclxuICBkZWZhdWx0VFRMOiBudW1iZXJcbiAgc3RyYXRlZ3k6IENhY2hlU3RyYXRlZ3lcbiAgZW5hYmxlQ29tcHJlc3Npb246IGJvb2xlYW5cbiAgZW5hYmxlUGVyc2lzdGVuY2U6IGJvb2xlYW5cbiAgY2xlYW51cEludGVydmFsOiBudW1iZXJcbiAgbWVtb3J5TGltaXQ6IG51bWJlciAvLyBNQlxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnvJPlrZjmnaHnm67mjqXlj6Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBDYWNoZUVudHJ5PFQ+IHtcbiAga2V5OiBzdHJpbmdcbiAgZGF0YTogVFxuICBtZXRhZGF0YToge1xuICAgIGNyZWF0ZWRBdDogRGF0ZVxuICAgIGFjY2Vzc2VkQXQ6IERhdGVcbiAgICBhY2Nlc3NDb3VudDogbnVtYmVyXG4gICAgdHRsOiBudW1iZXJcbiAgICBzaXplOiBudW1iZXJcbiAgICBjb21wcmVzc2VkOiBib29sZWFuXG4gICAgdGFnczogc3RyaW5nW11cbiAgICBwcmlvcml0eTogJ2hpZ2gnIHwgJ25vcm1hbCcgfCAnbG93J1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOe8k+WtmOe7n+iuoeS/oeaBr1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIENhY2hlU3RhdHMge1xuICB0b3RhbEVudHJpZXM6IG51bWJlclxuICBoaXRDb3VudDogbnVtYmVyXG4gIG1pc3NDb3VudDogbnVtYmVyXG4gIGV2aWN0aW9uQ291bnQ6IG51bWJlclxuICBjb21wcmVzc2lvblJhdGlvOiBudW1iZXJcbiAgbWVtb3J5VXNhZ2U6IG51bWJlclxuICBoaXRSYXRlOiBudW1iZXJcbiAgYXZnQWNjZXNzVGltZTogbnVtYmVyXG4gIGJ5U3RyYXRlZ3k6IFJlY29yZDxDYWNoZVN0cmF0ZWd5LCB7XG4gICAgaGl0czogbnVtYmVyXG4gICAgbWlzc2VzOiBudW1iZXJcbiAgICBldmljdGlvbnM6IG51bWJlclxuICB9PlxuICBieUVudGl0eVR5cGU6IFJlY29yZDxzdHJpbmcsIHtcbiAgICBlbnRyaWVzOiBudW1iZXJcbiAgICBoaXRzOiBudW1iZXJcbiAgICBtaXNzZXM6IG51bWJlclxuICB9PlxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDnvJPlrZjpooTng63nrZbnlaVcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBXYXJtdXBTdHJhdGVneSB7XG4gIHBhdHRlcm46IFJlZ0V4cFxuICBxdWVyeTogKCkgPT4gUHJvbWlzZTxhbnlbXT5cbiAgcHJpb3JpdHk6IG51bWJlclxuICB0dGw6IG51bWJlclxuICBiYXRjaFNpemU/OiBudW1iZXJcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g6auY57qn57yT5a2Y566h55CG5ZmoXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjbGFzcyBBZHZhbmNlZENhY2hlTWFuYWdlciB7XG4gIHByaXZhdGUgY2FjaGU6IE1hcDxzdHJpbmcsIENhY2hlRW50cnk8YW55Pj4gPSBuZXcgTWFwKClcbiAgcHJpdmF0ZSBhY2Nlc3NMb2c6IEFycmF5PHsga2V5OiBzdHJpbmc7IHRpbWVzdGFtcDogRGF0ZTsgdHlwZTogJ2hpdCcgfCAnbWlzcycgfT4gPSBbXVxuICBwcml2YXRlIGNvbXByZXNzaW9uTWFwOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gbmV3IE1hcCgpIC8vIOWOi+e8qeaYoOWwhFxuICBwcml2YXRlIHBlcnNpc3RlbnRTdG9yYWdlOiBNYXA8c3RyaW5nLCBhbnk+ID0gbmV3IE1hcCgpIC8vIOaMgeS5heWMluWtmOWCqFxuICBcbiAgcHJpdmF0ZSBjb25maWc6IENhY2hlQ29uZmlnXG4gIHByaXZhdGUgc3RhdHM6IENhY2hlU3RhdHNcbiAgcHJpdmF0ZSBjbGVhbnVwVGltZXI/OiBOb2RlSlMuVGltZW91dFxuICBwcml2YXRlIHdhcm11cFN0cmF0ZWdpZXM6IFdhcm11cFN0cmF0ZWd5W10gPSBbXVxuICBcbiAgY29uc3RydWN0b3IoY29uZmlnOiBQYXJ0aWFsPENhY2hlQ29uZmlnPiA9IHt9KSB7XG4gICAgdGhpcy5jb25maWcgPSB7XG4gICAgICBtYXhFbnRyaWVzOiAxMDAwLFxuICAgICAgZGVmYXVsdFRUTDogNSAqIDYwICogMTAwMCwgLy8gNeWIhumSn1xuICAgICAgc3RyYXRlZ3k6IENhY2hlU3RyYXRlZ3kuQURBUFRJVkUsXG4gICAgICBlbmFibGVDb21wcmVzc2lvbjogdHJ1ZSxcbiAgICAgIGVuYWJsZVBlcnNpc3RlbmNlOiB0cnVlLFxuICAgICAgY2xlYW51cEludGVydmFsOiA2MCAqIDEwMDAsIC8vIDHliIbpkp9cbiAgICAgIG1lbW9yeUxpbWl0OiA1MCwgLy8gNTBNQlxuICAgICAgLi4uY29uZmlnXG4gICAgfVxuICAgIFxuICAgIHRoaXMuaW5pdGlhbGl6ZVN0YXRzKClcbiAgICB0aGlzLmluaXRpYWxpemVDYWNoZSgpXG4gICAgdGhpcy5zdGFydENsZWFudXBUaW1lcigpXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOaguOW/g+e8k+WtmOaTjeS9nFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLyoqXG4gICAqIOiOt+WPlue8k+WtmOWAvFxuICAgKi9cbiAgYXN5bmMgZ2V0PFQ+KGtleTogc3RyaW5nLCBvcHRpb25zPzoge1xuICAgIHNraXBEZWNvbXByZXNzaW9uPzogYm9vbGVhblxuICAgIHVwZGF0ZUFjY2Vzc1RpbWU/OiBib29sZWFuXG4gIH0pOiBQcm9taXNlPFQgfCBudWxsPiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KClcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8g5qOA5p+l5YaF5a2Y57yT5a2YXG4gICAgICBsZXQgZW50cnkgPSB0aGlzLmNhY2hlLmdldChrZXkpXG4gICAgICBcbiAgICAgIC8vIOWmguaenOWGheWtmOS4reayoeacie+8jOajgOafpeaMgeS5heWMluWtmOWCqFxuICAgICAgaWYgKCFlbnRyeSAmJiB0aGlzLmNvbmZpZy5lbmFibGVQZXJzaXN0ZW5jZSkge1xuICAgICAgICBlbnRyeSA9IGF3YWl0IHRoaXMubG9hZEZyb21QZXJzaXN0ZW50U3RvcmFnZShrZXkpXG4gICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgIHRoaXMuY2FjaGUuc2V0KGtleSwgZW50cnkpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICB0aGlzLnJlY29yZE1pc3Moa2V5LCBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZSlcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgLy8g5qOA5p+lVFRMXG4gICAgICBpZiAodGhpcy5pc0V4cGlyZWQoZW50cnkpKSB7XG4gICAgICAgIHRoaXMuZXZpY3RFbnRyeShrZXkpXG4gICAgICAgIHRoaXMucmVjb3JkTWlzcyhrZXksIHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lKVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuXG4gICAgICAvLyDop6PljovmlbDmja5cbiAgICAgIGxldCBkYXRhID0gZW50cnkuZGF0YVxuICAgICAgaWYgKGVudHJ5Lm1ldGFkYXRhLmNvbXByZXNzZWQgJiYgIW9wdGlvbnM/LnNraXBEZWNvbXByZXNzaW9uKSB7XG4gICAgICAgIGRhdGEgPSBhd2FpdCB0aGlzLmRlY29tcHJlc3NEYXRhKGRhdGEpXG4gICAgICB9XG5cbiAgICAgIC8vIOabtOaWsOiuv+mXruS/oeaBr1xuICAgICAgaWYgKG9wdGlvbnM/LnVwZGF0ZUFjY2Vzc1RpbWUgIT09IGZhbHNlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlQWNjZXNzSW5mbyhlbnRyeSlcbiAgICAgIH1cblxuICAgICAgdGhpcy5yZWNvcmRIaXQoa2V5LCBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZSlcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NhY2hlIGdldCBlcnJvcjonLCBlcnJvcilcbiAgICAgIHRoaXMucmVjb3JkTWlzcyhrZXksIHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lKVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6K6+572u57yT5a2Y5YC8XG4gICAqL1xuICBhc3luYyBzZXQ8VD4oXG4gICAga2V5OiBzdHJpbmcsIFxuICAgIGRhdGE6IFQsIFxuICAgIG9wdGlvbnM/OiB7XG4gICAgICB0dGw/OiBudW1iZXJcbiAgICAgIHRhZ3M/OiBzdHJpbmdbXVxuICAgICAgcHJpb3JpdHk/OiAnaGlnaCcgfCAnbm9ybWFsJyB8ICdsb3cnXG4gICAgICBza2lwQ29tcHJlc3Npb24/OiBib29sZWFuXG4gICAgICBwZXJzaXN0T25seT86IGJvb2xlYW5cbiAgICB9XG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDorqHnrpfmlbDmja7lpKflsI9cbiAgICAgIGNvbnN0IGRhdGFTaXplID0gdGhpcy5jYWxjdWxhdGVEYXRhU2l6ZShkYXRhKVxuICAgICAgXG4gICAgICAvLyDmo4Dmn6XlhoXlrZjpmZDliLZcbiAgICAgIGlmICh0aGlzLmdldEN1cnJlbnRNZW1vcnlVc2FnZSgpICsgZGF0YVNpemUgPiB0aGlzLmNvbmZpZy5tZW1vcnlMaW1pdCAqIDEwMjQgKiAxMDI0KSB7XG4gICAgICAgIHRoaXMuZXZpY3RCeU1lbW9yeVByZXNzdXJlKGRhdGFTaXplKVxuICAgICAgfVxuXG4gICAgICAvLyDmo4Dmn6XmnaHnm67pmZDliLZcbiAgICAgIGlmICh0aGlzLmNhY2hlLnNpemUgPj0gdGhpcy5jb25maWcubWF4RW50cmllcykge1xuICAgICAgICB0aGlzLmV2aWN0QnlTdHJhdGVneSgpXG4gICAgICB9XG5cbiAgICAgIC8vIOWOi+e8qeaVsOaNrlxuICAgICAgbGV0IHByb2Nlc3NlZERhdGEgPSBkYXRhXG4gICAgICBsZXQgY29tcHJlc3NlZCA9IGZhbHNlXG4gICAgICBcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVDb21wcmVzc2lvbiAmJiBcbiAgICAgICAgICBkYXRhU2l6ZSA+IDEwMjQgJiYgLy8g5aSn5LqOMUtC5omN5Y6L57ypXG4gICAgICAgICAgIW9wdGlvbnM/LnNraXBDb21wcmVzc2lvbikge1xuICAgICAgICBwcm9jZXNzZWREYXRhID0gYXdhaXQgdGhpcy5jb21wcmVzc0RhdGEoZGF0YSlcbiAgICAgICAgY29tcHJlc3NlZCA9IHRydWVcbiAgICAgIH1cblxuICAgICAgY29uc3QgZW50cnk6IENhY2hlRW50cnk8VD4gPSB7XG4gICAgICAgIGtleSxcbiAgICAgICAgZGF0YTogcHJvY2Vzc2VkRGF0YSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgYWNjZXNzZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICBhY2Nlc3NDb3VudDogMSxcbiAgICAgICAgICB0dGw6IG9wdGlvbnM/LnR0bCB8fCB0aGlzLmNvbmZpZy5kZWZhdWx0VFRMLFxuICAgICAgICAgIHNpemU6IGNvbXByZXNzZWQgPyB0aGlzLmNhbGN1bGF0ZURhdGFTaXplKHByb2Nlc3NlZERhdGEpIDogZGF0YVNpemUsXG4gICAgICAgICAgY29tcHJlc3NlZCxcbiAgICAgICAgICB0YWdzOiBvcHRpb25zPy50YWdzIHx8IFtdLFxuICAgICAgICAgIHByaW9yaXR5OiBvcHRpb25zPy5wcmlvcml0eSB8fCAnbm9ybWFsJ1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zPy5wZXJzaXN0T25seSkge1xuICAgICAgICAvLyDku4XmjIHkuYXljJbvvIzkuI3lrZjlhaXlhoXlrZhcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlVG9QZXJzaXN0ZW50U3RvcmFnZShrZXksIGVudHJ5KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8g5a2Y5YWl5YaF5a2YXG4gICAgICAgIHRoaXMuY2FjaGUuc2V0KGtleSwgZW50cnkpXG4gICAgICAgIFxuICAgICAgICAvLyDlkIzml7bmjIHkuYXljJZcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmVuYWJsZVBlcnNpc3RlbmNlKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5zYXZlVG9QZXJzaXN0ZW50U3RvcmFnZShrZXksIGVudHJ5KVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMudXBkYXRlU3RhdHMoKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdDYWNoZSBzZXQgZXJyb3I6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIoOmZpOe8k+WtmOmhuVxuICAgKi9cbiAgYXN5bmMgZGVsZXRlKGtleTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRlbGV0ZWQgPSB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpXG4gICAgICBcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVQZXJzaXN0ZW5jZSkge1xuICAgICAgICBhd2FpdCB0aGlzLmRlbGV0ZUZyb21QZXJzaXN0ZW50U3RvcmFnZShrZXkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgIHRoaXMuc3RhdHMudG90YWxFbnRyaWVzID0gdGhpcy5jYWNoZS5zaXplXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBkZWxldGVkXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NhY2hlIGRlbGV0ZSBlcnJvcjonLCBlcnJvcilcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmibnph4/liKDpmaTnvJPlrZjpoblcbiAgICovXG4gIGFzeW5jIGRlbGV0ZUJ5UGF0dGVybihwYXR0ZXJuOiBSZWdFeHApOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGxldCBkZWxldGVkQ291bnQgPSAwXG4gICAgXG4gICAgY29uc3Qga2V5c1RvRGVsZXRlOiBzdHJpbmdbXSA9IFtdXG4gICAgdGhpcy5jYWNoZS5mb3JFYWNoKChfLCBrZXkpID0+IHtcbiAgICAgIGlmIChwYXR0ZXJuLnRlc3Qoa2V5KSkge1xuICAgICAgICBrZXlzVG9EZWxldGUucHVzaChrZXkpXG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzVG9EZWxldGUpIHtcbiAgICAgIGlmIChhd2FpdCB0aGlzLmRlbGV0ZShrZXkpKSB7XG4gICAgICAgIGRlbGV0ZWRDb3VudCsrXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBkZWxldGVkQ291bnRcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnqbrnvJPlrZhcbiAgICovXG4gIGFzeW5jIGNsZWFyKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuY2FjaGUuY2xlYXIoKVxuICAgIFxuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVQZXJzaXN0ZW5jZSkge1xuICAgICAgYXdhaXQgdGhpcy5jbGVhclBlcnNpc3RlbnRTdG9yYWdlKClcbiAgICB9XG4gICAgXG4gICAgdGhpcy5pbml0aWFsaXplU3RhdHMoKVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDmmbrog73nvJPlrZjnrZbnlaVcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDpooTmtYvmgKfnvJPlrZjpooTng61cbiAgICovXG4gIGFzeW5jIHByZWRpY3RpdmVXYXJtdXAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcHJlZGljdGlvbnMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQWNjZXNzUHJlZGljdGlvbnMoKVxuICAgIFxuICAgIGZvciAoY29uc3QgcHJlZGljdGlvbiBvZiBwcmVkaWN0aW9ucykge1xuICAgICAgaWYgKHByZWRpY3Rpb24ucHJvYmFiaWxpdHkgPiAwLjcpIHsgLy8gNzAl5Lul5LiK5qaC546H5omN6aKE54OtXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuZmV0Y2hEYXRhRm9yUHJlZGljdGlvbihwcmVkaWN0aW9uKVxuICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNldChcbiAgICAgICAgICAgICAgcHJlZGljdGlvbi5rZXksXG4gICAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0dGw6IHByZWRpY3Rpb24udHRsLFxuICAgICAgICAgICAgICAgIHByaW9yaXR5OiBwcmVkaWN0aW9uLnByaW9yaXR5LFxuICAgICAgICAgICAgICAgIHRhZ3M6IFsncHJlZGljdGl2ZScsIHByZWRpY3Rpb24uZW50aXR5VHlwZV1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byB3YXJtdXAgY2FjaGUgZm9yICR7cHJlZGljdGlvbi5rZXl9OmAsIGVycm9yKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiHqumAguW6lOe8k+WtmOetlueVpVxuICAgKi9cbiAgcHJpdmF0ZSBldmljdEJ5U3RyYXRlZ3koKTogdm9pZCB7XG4gICAgc3dpdGNoICh0aGlzLmNvbmZpZy5zdHJhdGVneSkge1xuICAgICAgY2FzZSBDYWNoZVN0cmF0ZWd5LkxSVTpcbiAgICAgICAgdGhpcy5ldmljdExSVSgpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIENhY2hlU3RyYXRlZ3kuTEZVOlxuICAgICAgICB0aGlzLmV2aWN0TEZVKClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgQ2FjaGVTdHJhdGVneS5GSUZPOlxuICAgICAgICB0aGlzLmV2aWN0RklGTygpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIENhY2hlU3RyYXRlZ3kuVFRMOlxuICAgICAgICB0aGlzLmV2aWN0QnlUVEwoKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBDYWNoZVN0cmF0ZWd5LkFEQVBUSVZFOlxuICAgICAgICB0aGlzLmV2aWN0QWRhcHRpdmUoKVxuICAgICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZXZpY3RMUlUoKTogdm9pZCB7XG4gICAgbGV0IG9sZGVzdEtleTogc3RyaW5nIHwgbnVsbCA9IG51bGxcbiAgICBsZXQgb2xkZXN0VGltZSA9IERhdGUubm93KClcbiAgICBcbiAgICB0aGlzLmNhY2hlLmZvckVhY2goKGVudHJ5LCBrZXkpID0+IHtcbiAgICAgIGlmIChlbnRyeS5tZXRhZGF0YS5hY2Nlc3NlZEF0LmdldFRpbWUoKSA8IG9sZGVzdFRpbWUpIHtcbiAgICAgICAgb2xkZXN0VGltZSA9IGVudHJ5Lm1ldGFkYXRhLmFjY2Vzc2VkQXQuZ2V0VGltZSgpXG4gICAgICAgIG9sZGVzdEtleSA9IGtleVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgaWYgKG9sZGVzdEtleSkge1xuICAgICAgdGhpcy5ldmljdEVudHJ5KG9sZGVzdEtleSlcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGV2aWN0TEZVKCk6IHZvaWQge1xuICAgIGxldCBsZWFzdEZyZXF1ZW50S2V5OiBzdHJpbmcgfCBudWxsID0gbnVsbFxuICAgIGxldCBsb3dlc3RDb3VudCA9IEluZmluaXR5XG4gICAgXG4gICAgdGhpcy5jYWNoZS5mb3JFYWNoKChlbnRyeSwga2V5KSA9PiB7XG4gICAgICBpZiAoZW50cnkubWV0YWRhdGEuYWNjZXNzQ291bnQgPCBsb3dlc3RDb3VudCkge1xuICAgICAgICBsb3dlc3RDb3VudCA9IGVudHJ5Lm1ldGFkYXRhLmFjY2Vzc0NvdW50XG4gICAgICAgIGxlYXN0RnJlcXVlbnRLZXkgPSBrZXlcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIGlmIChsZWFzdEZyZXF1ZW50S2V5KSB7XG4gICAgICB0aGlzLmV2aWN0RW50cnkobGVhc3RGcmVxdWVudEtleSlcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGV2aWN0RklGTygpOiB2b2lkIHtcbiAgICBsZXQgb2xkZXN0S2V5OiBzdHJpbmcgfCBudWxsID0gbnVsbFxuICAgIGxldCBvbGRlc3RUaW1lID0gRGF0ZS5ub3coKVxuICAgIFxuICAgIHRoaXMuY2FjaGUuZm9yRWFjaCgoZW50cnksIGtleSkgPT4ge1xuICAgICAgaWYgKGVudHJ5Lm1ldGFkYXRhLmNyZWF0ZWRBdC5nZXRUaW1lKCkgPCBvbGRlc3RUaW1lKSB7XG4gICAgICAgIG9sZGVzdFRpbWUgPSBlbnRyeS5tZXRhZGF0YS5jcmVhdGVkQXQuZ2V0VGltZSgpXG4gICAgICAgIG9sZGVzdEtleSA9IGtleVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgaWYgKG9sZGVzdEtleSkge1xuICAgICAgdGhpcy5ldmljdEVudHJ5KG9sZGVzdEtleSlcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGV2aWN0QnlUVEwoKTogdm9pZCB7XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxuICAgIGNvbnN0IGV4cGlyZWRLZXlzOiBzdHJpbmdbXSA9IFtdXG4gICAgXG4gICAgdGhpcy5jYWNoZS5mb3JFYWNoKChlbnRyeSwga2V5KSA9PiB7XG4gICAgICBpZiAobm93IC0gZW50cnkubWV0YWRhdGEuY3JlYXRlZEF0LmdldFRpbWUoKSA+IGVudHJ5Lm1ldGFkYXRhLnR0bCkge1xuICAgICAgICBleHBpcmVkS2V5cy5wdXNoKGtleSlcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIC8vIOWIoOmZpOacgOaXp+eahOi/h+acn+adoeebrlxuICAgIGlmIChleHBpcmVkS2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBvbGRlc3RFeHBpcmVkS2V5ID0gZXhwaXJlZEtleXMucmVkdWNlKChvbGRlc3QsIGN1cnJlbnQpID0+IHtcbiAgICAgICAgY29uc3Qgb2xkZXN0RW50cnkgPSB0aGlzLmNhY2hlLmdldChvbGRlc3QpIVxuICAgICAgICBjb25zdCBjdXJyZW50RW50cnkgPSB0aGlzLmNhY2hlLmdldChjdXJyZW50KSFcbiAgICAgICAgcmV0dXJuIG9sZGVzdEVudHJ5Lm1ldGFkYXRhLmNyZWF0ZWRBdC5nZXRUaW1lKCkgPCBjdXJyZW50RW50cnkubWV0YWRhdGEuY3JlYXRlZEF0LmdldFRpbWUoKSBcbiAgICAgICAgICA/IG9sZGVzdCBcbiAgICAgICAgICA6IGN1cnJlbnRcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIHRoaXMuZXZpY3RFbnRyeShvbGRlc3RFeHBpcmVkS2V5KVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZXZpY3RBZGFwdGl2ZSgpOiB2b2lkIHtcbiAgICAvLyDln7rkuo7lkb3kuK3njofjgIHorr/pl67popHnjofjgIHlhoXlrZjljovlipvnmoTmt7flkIjnrZbnlaVcbiAgICBjb25zdCBlbnRyaWVzID0gQXJyYXkuZnJvbSh0aGlzLmNhY2hlLmVudHJpZXMoKSlcbiAgICBcbiAgICAvLyDorqHnrpfmr4/kuKrmnaHnm67nmoTliIbmlbDvvIjliIbmlbDotorpq5jotorlupTor6Xooqvkv53nlZnvvIlcbiAgICBjb25zdCBzY29yZWRFbnRyaWVzID0gZW50cmllcy5tYXAoKFtrZXksIGVudHJ5XSkgPT4ge1xuICAgICAgY29uc3QgYWdlID0gRGF0ZS5ub3coKSAtIGVudHJ5Lm1ldGFkYXRhLmNyZWF0ZWRBdC5nZXRUaW1lKClcbiAgICAgIGNvbnN0IGFjY2Vzc0ZyZXEgPSBlbnRyeS5tZXRhZGF0YS5hY2Nlc3NDb3VudFxuICAgICAgY29uc3QgaGl0UmF0ZSA9IHRoaXMuY2FsY3VsYXRlSGl0UmF0ZShrZXkpXG4gICAgICBjb25zdCBwcmlvcml0eU11bHRpcGxpZXIgPSBlbnRyeS5tZXRhZGF0YS5wcmlvcml0eSA9PT0gJ2hpZ2gnID8gMiA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5Lm1ldGFkYXRhLnByaW9yaXR5ID09PSAnbG93JyA/IDAuNSA6IDFcbiAgICAgIFxuICAgICAgY29uc3Qgc2NvcmUgPSAoYWNjZXNzRnJlcSAqIGhpdFJhdGUgKiBwcmlvcml0eU11bHRpcGxpZXIpIC8gKGFnZSAvIDEwMDApXG4gICAgICByZXR1cm4geyBrZXksIHNjb3JlIH1cbiAgICB9KVxuICAgIFxuICAgIC8vIOWIoOmZpOWIhuaVsOacgOS9jueahOadoeebrlxuICAgIHNjb3JlZEVudHJpZXMuc29ydCgoYSwgYikgPT4gYS5zY29yZSAtIGIuc2NvcmUpXG4gICAgaWYgKHNjb3JlZEVudHJpZXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5ldmljdEVudHJ5KHNjb3JlZEVudHJpZXNbMF0ua2V5KVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDln7rkuo7lhoXlrZjljovlipvmuIXnkIZcbiAgICovXG4gIHByaXZhdGUgZXZpY3RCeU1lbW9yeVByZXNzdXJlKHJlcXVpcmVkU2l6ZTogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgZW50cmllcyA9IEFycmF5LmZyb20odGhpcy5jYWNoZS5lbnRyaWVzKCkpXG4gICAgXG4gICAgLy8g5oyJ5LyY5YWI57qn5ZKM6K6/6Zeu6aKR546H5o6S5bqPXG4gICAgZW50cmllcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICBjb25zdCBlbnRyeUEgPSBhWzFdXG4gICAgICBjb25zdCBlbnRyeUIgPSBiWzFdXG4gICAgICBcbiAgICAgIC8vIOS8mOWFiOe6p+adg+mHjVxuICAgICAgY29uc3QgcHJpb3JpdHlXZWlnaHQgPSB7XG4gICAgICAgIGhpZ2g6IDMsXG4gICAgICAgIG5vcm1hbDogMixcbiAgICAgICAgbG93OiAxXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHNjb3JlQSA9IGVudHJ5QS5tZXRhZGF0YS5hY2Nlc3NDb3VudCAqIHByaW9yaXR5V2VpZ2h0W2VudHJ5QS5tZXRhZGF0YS5wcmlvcml0eV1cbiAgICAgIGNvbnN0IHNjb3JlQiA9IGVudHJ5Qi5tZXRhZGF0YS5hY2Nlc3NDb3VudCAqIHByaW9yaXR5V2VpZ2h0W2VudHJ5Qi5tZXRhZGF0YS5wcmlvcml0eV1cbiAgICAgIFxuICAgICAgcmV0dXJuIHNjb3JlQSAtIHNjb3JlQlxuICAgIH0pXG4gICAgXG4gICAgLy8g6YCQ5Liq5Yig6Zmk55u05Yiw5pyJ6Laz5aSf56m66Ze0XG4gICAgbGV0IGZyZWVkU3BhY2UgPSAwXG4gICAgZm9yIChjb25zdCBba2V5LCBlbnRyeV0gb2YgZW50cmllcykge1xuICAgICAgaWYgKGZyZWVkU3BhY2UgPj0gcmVxdWlyZWRTaXplKSBicmVha1xuICAgICAgXG4gICAgICB0aGlzLmV2aWN0RW50cnkoa2V5KVxuICAgICAgZnJlZWRTcGFjZSArPSBlbnRyeS5tZXRhZGF0YS5zaXplXG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDmlbDmja7ljovnvKnlkozop6PljovnvKlcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgYXN5bmMgY29tcHJlc3NEYXRhPFQ+KGRhdGE6IFQpOiBQcm9taXNlPGFueT4ge1xuICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlQ29tcHJlc3Npb24pIHJldHVybiBkYXRhXG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIOeugOWNleeahEpTT07ljovnvKnvvIjlrp7pmYXpobnnm67kuK3lj6/ku6Xkvb/nlKjmm7TlpI3mnYLnmoTljovnvKnnrpfms5XvvIlcbiAgICAgIGNvbnN0IGpzb25TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICAgXG4gICAgICAvLyDkvb/nlKhMWi1TdHJpbmfljovnvKnvvIjlpoLmnpzlj6/nlKjvvIlcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiAod2luZG93IGFzIGFueSkuTFpTdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuICh3aW5kb3cgYXMgYW55KS5MWlN0cmluZy5jb21wcmVzcyhqc29uU3RyaW5nKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDpmY3nuqfliLDnroDljZXnmoRCYXNlNjTnvJbnoIFcbiAgICAgIHJldHVybiBidG9hKGpzb25TdHJpbmcpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignQ29tcHJlc3Npb24gZmFpbGVkLCB1c2luZyBvcmlnaW5hbCBkYXRhOicsIGVycm9yKVxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGRlY29tcHJlc3NEYXRhPFQ+KGNvbXByZXNzZWREYXRhOiBhbnkpOiBQcm9taXNlPFQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8g5qOA5p+l5piv5ZCm5pivTFpTdHJpbmfljovnvKlcbiAgICAgIGlmICh0eXBlb2YgY29tcHJlc3NlZERhdGEgPT09ICdzdHJpbmcnICYmIGNvbXByZXNzZWREYXRhLmxlbmd0aCA8IDEwMDApIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmICh3aW5kb3cgYXMgYW55KS5MWlN0cmluZykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkZWNvbXByZXNzZWQgPSAod2luZG93IGFzIGFueSkuTFpTdHJpbmcuZGVjb21wcmVzcyhjb21wcmVzc2VkRGF0YSlcbiAgICAgICAgICAgIGlmIChkZWNvbXByZXNzZWQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGVjb21wcmVzc2VkKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgLy8g57un57ut5bCd6K+VQmFzZTY0XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyDlsJ3or5VCYXNlNjTop6PnoIFcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBqc29uU3RyaW5nID0gYXRvYihjb21wcmVzc2VkRGF0YSlcbiAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uU3RyaW5nKVxuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAvLyDkuI3mmK/ljovnvKnmlbDmja7vvIznm7TmjqXov5Tlm55cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gY29tcHJlc3NlZERhdGFcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdEZWNvbXByZXNzaW9uIGZhaWxlZDonLCBlcnJvcilcbiAgICAgIHJldHVybiBjb21wcmVzc2VkRGF0YVxuICAgIH1cbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g5oyB5LmF5YyW5a2Y5YKoXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBwcml2YXRlIGFzeW5jIHNhdmVUb1BlcnNpc3RlbnRTdG9yYWdlKGtleTogc3RyaW5nLCBlbnRyeTogQ2FjaGVFbnRyeTxhbnk+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlUGVyc2lzdGVuY2UpIHJldHVyblxuICAgICAgXG4gICAgICBjb25zdCBzdG9yYWdlS2V5ID0gYGNhY2hlXyR7a2V5fWBcbiAgICAgIGNvbnN0IHNlcmlhbGl6ZWQgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIC4uLmVudHJ5LFxuICAgICAgICAvLyDovazmjaJEYXRl5a+56LGh5Li6SVNP5a2X56ym5LiyXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgLi4uZW50cnkubWV0YWRhdGEsXG4gICAgICAgICAgY3JlYXRlZEF0OiBlbnRyeS5tZXRhZGF0YS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBhY2Nlc3NlZEF0OiBlbnRyeS5tZXRhZGF0YS5hY2Nlc3NlZEF0LnRvSVNPU3RyaW5nKClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgLy8g5L2/55SobG9jYWxTdG9yYWdl5oiWSW5kZXhlZERCXG4gICAgICBpZiAodHlwZW9mIGxvY2FsU3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc3RvcmFnZUtleSwgc2VyaWFsaXplZClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOmZjee6p+WIsOWGheWtmOaMgeS5heWMllxuICAgICAgICB0aGlzLnBlcnNpc3RlbnRTdG9yYWdlLnNldChzdG9yYWdlS2V5LCBzZXJpYWxpemVkKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzYXZlIHRvIHBlcnNpc3RlbnQgc3RvcmFnZTonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxvYWRGcm9tUGVyc2lzdGVudFN0b3JhZ2U8VD4oa2V5OiBzdHJpbmcpOiBQcm9taXNlPENhY2hlRW50cnk8VD4gfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlUGVyc2lzdGVuY2UpIHJldHVybiBudWxsXG4gICAgICBcbiAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBgY2FjaGVfJHtrZXl9YFxuICAgICAgbGV0IHNlcmlhbGl6ZWQ6IHN0cmluZyB8IG51bGxcbiAgICAgIFxuICAgICAgaWYgKHR5cGVvZiBsb2NhbFN0b3JhZ2UgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHNlcmlhbGl6ZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VyaWFsaXplZCA9IHRoaXMucGVyc2lzdGVudFN0b3JhZ2UuZ2V0KHN0b3JhZ2VLZXkpIHx8IG51bGxcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKCFzZXJpYWxpemVkKSByZXR1cm4gbnVsbFxuICAgICAgXG4gICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHNlcmlhbGl6ZWQpXG4gICAgICBcbiAgICAgIC8vIOi9rOaNoklTT+Wtl+espuS4suWbnkRhdGXlr7nosaFcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnBhcnNlZCxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAuLi5wYXJzZWQubWV0YWRhdGEsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShwYXJzZWQubWV0YWRhdGEuY3JlYXRlZEF0KSxcbiAgICAgICAgICBhY2Nlc3NlZEF0OiBuZXcgRGF0ZShwYXJzZWQubWV0YWRhdGEuYWNjZXNzZWRBdClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBsb2FkIGZyb20gcGVyc2lzdGVudCBzdG9yYWdlOicsIGVycm9yKVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGRlbGV0ZUZyb21QZXJzaXN0ZW50U3RvcmFnZShrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoIXRoaXMuY29uZmlnLmVuYWJsZVBlcnNpc3RlbmNlKSByZXR1cm5cbiAgICAgIFxuICAgICAgY29uc3Qgc3RvcmFnZUtleSA9IGBjYWNoZV8ke2tleX1gXG4gICAgICBcbiAgICAgIGlmICh0eXBlb2YgbG9jYWxTdG9yYWdlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShzdG9yYWdlS2V5KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW50U3RvcmFnZS5kZWxldGUoc3RvcmFnZUtleSlcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gZGVsZXRlIGZyb20gcGVyc2lzdGVudCBzdG9yYWdlOicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY2xlYXJQZXJzaXN0ZW50U3RvcmFnZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKHR5cGVvZiBsb2NhbFN0b3JhZ2UgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIC8vIOa4hemZpOaJgOaciWNhY2hlX+WJjee8gOeahOmhuVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxvY2FsU3RvcmFnZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IGtleSA9IGxvY2FsU3RvcmFnZS5rZXkoaSlcbiAgICAgICAgICBpZiAoa2V5Py5zdGFydHNXaXRoKCdjYWNoZV8nKSkge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW50U3RvcmFnZS5jbGVhcigpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNsZWFyIHBlcnNpc3RlbnQgc3RvcmFnZTonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOe7n+iuoeWSjOebkeaOp1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplU3RhdHMoKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0cyA9IHtcbiAgICAgIHRvdGFsRW50cmllczogMCxcbiAgICAgIGhpdENvdW50OiAwLFxuICAgICAgbWlzc0NvdW50OiAwLFxuICAgICAgZXZpY3Rpb25Db3VudDogMCxcbiAgICAgIGNvbXByZXNzaW9uUmF0aW86IDAsXG4gICAgICBtZW1vcnlVc2FnZTogMCxcbiAgICAgIGhpdFJhdGU6IDAsXG4gICAgICBhdmdBY2Nlc3NUaW1lOiAwLFxuICAgICAgYnlTdHJhdGVneToge1xuICAgICAgICBbQ2FjaGVTdHJhdGVneS5MUlVdOiB7IGhpdHM6IDAsIG1pc3NlczogMCwgZXZpY3Rpb25zOiAwIH0sXG4gICAgICAgIFtDYWNoZVN0cmF0ZWd5LkxGVV06IHsgaGl0czogMCwgbWlzc2VzOiAwLCBldmljdGlvbnM6IDAgfSxcbiAgICAgICAgW0NhY2hlU3RyYXRlZ3kuRklGT106IHsgaGl0czogMCwgbWlzc2VzOiAwLCBldmljdGlvbnM6IDAgfSxcbiAgICAgICAgW0NhY2hlU3RyYXRlZ3kuVFRMXTogeyBoaXRzOiAwLCBtaXNzZXM6IDAsIGV2aWN0aW9uczogMCB9LFxuICAgICAgICBbQ2FjaGVTdHJhdGVneS5BREFQVElWRV06IHsgaGl0czogMCwgbWlzc2VzOiAwLCBldmljdGlvbnM6IDAgfVxuICAgICAgfSxcbiAgICAgIGJ5RW50aXR5VHlwZToge31cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVN0YXRzKCk6IHZvaWQge1xuICAgIHRoaXMuc3RhdHMudG90YWxFbnRyaWVzID0gdGhpcy5jYWNoZS5zaXplXG4gICAgdGhpcy5zdGF0cy5oaXRSYXRlID0gdGhpcy5jYWxjdWxhdGVPdmVyYWxsSGl0UmF0ZSgpXG4gICAgdGhpcy5zdGF0cy5tZW1vcnlVc2FnZSA9IHRoaXMuZ2V0Q3VycmVudE1lbW9yeVVzYWdlKClcbiAgICB0aGlzLnN0YXRzLmNvbXByZXNzaW9uUmF0aW8gPSB0aGlzLmNhbGN1bGF0ZUNvbXByZXNzaW9uUmF0aW8oKVxuICB9XG5cbiAgcHJpdmF0ZSByZWNvcmRIaXQoa2V5OiBzdHJpbmcsIGFjY2Vzc1RpbWU6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuc3RhdHMuaGl0Q291bnQrK1xuICAgIHRoaXMuc3RhdHMuYnlTdHJhdGVneVt0aGlzLmNvbmZpZy5zdHJhdGVneV0uaGl0cysrXG4gICAgXG4gICAgLy8g5pu05paw5a6e5L2T57G75Z6L57uf6K6hXG4gICAgY29uc3QgZW50aXR5VHlwZSA9IHRoaXMuZXh0cmFjdEVudGl0eVR5cGUoa2V5KVxuICAgIGlmICghdGhpcy5zdGF0cy5ieUVudGl0eVR5cGVbZW50aXR5VHlwZV0pIHtcbiAgICAgIHRoaXMuc3RhdHMuYnlFbnRpdHlUeXBlW2VudGl0eVR5cGVdID0geyBlbnRyaWVzOiAwLCBoaXRzOiAwLCBtaXNzZXM6IDAgfVxuICAgIH1cbiAgICB0aGlzLnN0YXRzLmJ5RW50aXR5VHlwZVtlbnRpdHlUeXBlXS5oaXRzKytcbiAgICBcbiAgICAvLyDorrDlvZXorr/pl67ml6Xlv5dcbiAgICB0aGlzLmFjY2Vzc0xvZy5wdXNoKHsga2V5LCB0aW1lc3RhbXA6IG5ldyBEYXRlKCksIHR5cGU6ICdoaXQnIH0pXG4gICAgdGhpcy50cmltQWNjZXNzTG9nKClcbiAgICBcbiAgICAvLyDmm7TmlrDlubPlnYforr/pl67ml7bpl7RcbiAgICB0aGlzLnVwZGF0ZUF2ZXJhZ2VBY2Nlc3NUaW1lKGFjY2Vzc1RpbWUpXG4gICAgXG4gICAgdGhpcy51cGRhdGVTdGF0cygpXG4gIH1cblxuICBwcml2YXRlIHJlY29yZE1pc3Moa2V5OiBzdHJpbmcsIGFjY2Vzc1RpbWU6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuc3RhdHMubWlzc0NvdW50KytcbiAgICB0aGlzLnN0YXRzLmJ5U3RyYXRlZ3lbdGhpcy5jb25maWcuc3RyYXRlZ3ldLm1pc3NlcysrXG4gICAgXG4gICAgLy8g5pu05paw5a6e5L2T57G75Z6L57uf6K6hXG4gICAgY29uc3QgZW50aXR5VHlwZSA9IHRoaXMuZXh0cmFjdEVudGl0eVR5cGUoa2V5KVxuICAgIGlmICghdGhpcy5zdGF0cy5ieUVudGl0eVR5cGVbZW50aXR5VHlwZV0pIHtcbiAgICAgIHRoaXMuc3RhdHMuYnlFbnRpdHlUeXBlW2VudGl0eVR5cGVdID0geyBlbnRyaWVzOiAwLCBoaXRzOiAwLCBtaXNzZXM6IDAgfVxuICAgIH1cbiAgICB0aGlzLnN0YXRzLmJ5RW50aXR5VHlwZVtlbnRpdHlUeXBlXS5taXNzZXMrK1xuICAgIFxuICAgIC8vIOiusOW9leiuv+mXruaXpeW/l1xuICAgIHRoaXMuYWNjZXNzTG9nLnB1c2goeyBrZXksIHRpbWVzdGFtcDogbmV3IERhdGUoKSwgdHlwZTogJ21pc3MnIH0pXG4gICAgdGhpcy50cmltQWNjZXNzTG9nKClcbiAgICBcbiAgICAvLyDmm7TmlrDlubPlnYforr/pl67ml7bpl7RcbiAgICB0aGlzLnVwZGF0ZUF2ZXJhZ2VBY2Nlc3NUaW1lKGFjY2Vzc1RpbWUpXG4gICAgXG4gICAgdGhpcy51cGRhdGVTdGF0cygpXG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUF2ZXJhZ2VBY2Nlc3NUaW1lKGFjY2Vzc1RpbWU6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IHRvdGFsUmVxdWVzdHMgPSB0aGlzLnN0YXRzLmhpdENvdW50ICsgdGhpcy5zdGF0cy5taXNzQ291bnRcbiAgICBjb25zdCB0b3RhbFRpbWUgPSB0aGlzLnN0YXRzLmF2Z0FjY2Vzc1RpbWUgKiAodG90YWxSZXF1ZXN0cyAtIDEpICsgYWNjZXNzVGltZVxuICAgIHRoaXMuc3RhdHMuYXZnQWNjZXNzVGltZSA9IHRvdGFsVGltZSAvIHRvdGFsUmVxdWVzdHNcbiAgfVxuXG4gIHByaXZhdGUgdHJpbUFjY2Vzc0xvZygpOiB2b2lkIHtcbiAgICAvLyDkv53mjIHmnIDov5ExMDAw5p2h6K6w5b2VXG4gICAgaWYgKHRoaXMuYWNjZXNzTG9nLmxlbmd0aCA+IDEwMDApIHtcbiAgICAgIHRoaXMuYWNjZXNzTG9nID0gdGhpcy5hY2Nlc3NMb2cuc2xpY2UoLTEwMDApXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVPdmVyYWxsSGl0UmF0ZSgpOiBudW1iZXIge1xuICAgIGNvbnN0IHRvdGFsID0gdGhpcy5zdGF0cy5oaXRDb3VudCArIHRoaXMuc3RhdHMubWlzc0NvdW50XG4gICAgcmV0dXJuIHRvdGFsID4gMCA/IHRoaXMuc3RhdHMuaGl0Q291bnQgLyB0b3RhbCA6IDBcbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlSGl0UmF0ZShrZXk6IHN0cmluZyk6IG51bWJlciB7XG4gICAgY29uc3Qga2V5QWNjZXNzZXMgPSB0aGlzLmFjY2Vzc0xvZy5maWx0ZXIobG9nID0+IGxvZy5rZXkgPT09IGtleSlcbiAgICBpZiAoa2V5QWNjZXNzZXMubGVuZ3RoID09PSAwKSByZXR1cm4gMFxuICAgIFxuICAgIGNvbnN0IGhpdHMgPSBrZXlBY2Nlc3Nlcy5maWx0ZXIobG9nID0+IGxvZy50eXBlID09PSAnaGl0JykubGVuZ3RoXG4gICAgcmV0dXJuIGhpdHMgLyBrZXlBY2Nlc3Nlcy5sZW5ndGhcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q3VycmVudE1lbW9yeVVzYWdlKCk6IG51bWJlciB7XG4gICAgbGV0IHRvdGFsU2l6ZSA9IDBcbiAgICB0aGlzLmNhY2hlLmZvckVhY2goZW50cnkgPT4ge1xuICAgICAgdG90YWxTaXplICs9IGVudHJ5Lm1ldGFkYXRhLnNpemVcbiAgICB9KVxuICAgIHJldHVybiB0b3RhbFNpemVcbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlQ29tcHJlc3Npb25SYXRpbygpOiBudW1iZXIge1xuICAgIGxldCBjb21wcmVzc2VkU2l6ZSA9IDBcbiAgICBsZXQgb3JpZ2luYWxTaXplID0gMFxuICAgIFxuICAgIHRoaXMuY2FjaGUuZm9yRWFjaChlbnRyeSA9PiB7XG4gICAgICBpZiAoZW50cnkubWV0YWRhdGEuY29tcHJlc3NlZCkge1xuICAgICAgICBjb21wcmVzc2VkU2l6ZSArPSBlbnRyeS5tZXRhZGF0YS5zaXplXG4gICAgICAgIC8vIOS8sOeul+WOn+Wni+Wkp+Wwj++8iOWOi+e8qeWJjeeahOWkp+Wwj++8iVxuICAgICAgICBvcmlnaW5hbFNpemUgKz0gZW50cnkubWV0YWRhdGEuc2l6ZSAqIDIuNSAvLyDlgYforr7ljovnvKnnjofkuLo2MCVcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIHJldHVybiBvcmlnaW5hbFNpemUgPiAwID8gY29tcHJlc3NlZFNpemUgLyBvcmlnaW5hbFNpemUgOiAwXG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZURhdGFTaXplKGRhdGE6IGFueSk6IG51bWJlciB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhKS5sZW5ndGggKiAyIC8vIOeugOWMlueahOWtl+iKguS8sOeul1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIDEwMjQgLy8g6buY6K6kMUtCXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0RW50aXR5VHlwZShrZXk6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgcGFydHMgPSBrZXkuc3BsaXQoJzonKVxuICAgIHJldHVybiBwYXJ0c1swXSB8fCAndW5rbm93bidcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g57yT5a2Y6aKE54Ot5ZKM6aKE5rWLXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlQWNjZXNzUHJlZGljdGlvbnMoKTogUHJvbWlzZTxBcnJheTx7XG4gICAga2V5OiBzdHJpbmdcbiAgICBwcm9iYWJpbGl0eTogbnVtYmVyXG4gICAgdHRsOiBudW1iZXJcbiAgICBwcmlvcml0eTogJ2hpZ2gnIHwgJ25vcm1hbCcgfCAnbG93J1xuICAgIGVudGl0eVR5cGU6IHN0cmluZ1xuICB9Pj4ge1xuICAgIGNvbnN0IHByZWRpY3Rpb25zOiBBcnJheTx7XG4gICAgICBrZXk6IHN0cmluZ1xuICAgICAgcHJvYmFiaWxpdHk6IG51bWJlclxuICAgICAgdHRsOiBudW1iZXJcbiAgICAgIHByaW9yaXR5OiAnaGlnaCcgfCAnbm9ybWFsJyB8ICdsb3cnXG4gICAgICBlbnRpdHlUeXBlOiBzdHJpbmdcbiAgICB9PiA9IFtdXG4gICAgXG4gICAgLy8g5Z+65LqO6K6/6Zeu5qih5byP5YiG5p6QXG4gICAgY29uc3QgcmVjZW50QWNjZXNzZXMgPSB0aGlzLmFjY2Vzc0xvZ1xuICAgICAgLmZpbHRlcihsb2cgPT4gbG9nLnRpbWVzdGFtcC5nZXRUaW1lKCkgPiBEYXRlLm5vdygpIC0gMjQgKiA2MCAqIDYwICogMTAwMCkgLy8g5pyA6L+RMjTlsI/ml7ZcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnRpbWVzdGFtcC5nZXRUaW1lKCkgLSBhLnRpbWVzdGFtcC5nZXRUaW1lKCkpXG4gICAgXG4gICAgLy8g5YiG5p6Q6auY6aKR6K6/6Zeu55qE6ZSuXG4gICAgY29uc3Qga2V5RnJlcXVlbmN5ID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKVxuICAgIHJlY2VudEFjY2Vzc2VzLmZvckVhY2goYWNjZXNzID0+IHtcbiAgICAgIGtleUZyZXF1ZW5jeS5zZXQoYWNjZXNzLmtleSwgKGtleUZyZXF1ZW5jeS5nZXQoYWNjZXNzLmtleSkgfHwgMCkgKyAxKVxuICAgIH0pXG4gICAgXG4gICAgLy8g5Li66auY6aKR6ZSu55Sf5oiQ6aKE5rWLXG4gICAga2V5RnJlcXVlbmN5LmZvckVhY2goKGZyZXF1ZW5jeSwga2V5KSA9PiB7XG4gICAgICBpZiAoZnJlcXVlbmN5ID4gMykgeyAvLyDorr/pl67mrKHmlbDotoXov4cz5qyhXG4gICAgICAgIGNvbnN0IHByb2JhYmlsaXR5ID0gTWF0aC5taW4oZnJlcXVlbmN5IC8gMTAsIDAuOSlcbiAgICAgICAgY29uc3QgZW50aXR5VHlwZSA9IHRoaXMuZXh0cmFjdEVudGl0eVR5cGUoa2V5KVxuICAgICAgICBcbiAgICAgICAgcHJlZGljdGlvbnMucHVzaCh7XG4gICAgICAgICAga2V5LFxuICAgICAgICAgIHByb2JhYmlsaXR5LFxuICAgICAgICAgIHR0bDogdGhpcy5jb25maWcuZGVmYXVsdFRUTCxcbiAgICAgICAgICBwcmlvcml0eTogZnJlcXVlbmN5ID4gNSA/ICdoaWdoJyA6ICdub3JtYWwnLFxuICAgICAgICAgIGVudGl0eVR5cGVcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIHJldHVybiBwcmVkaWN0aW9ucy5zb3J0KChhLCBiKSA9PiBiLnByb2JhYmlsaXR5IC0gYS5wcm9iYWJpbGl0eSlcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hEYXRhRm9yUHJlZGljdGlvbihwcmVkaWN0aW9uOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICAgIC8vIOi/memHjOW6lOivpeagueaNrumihOa1i+eahGtleeiOt+WPluWunumZheaVsOaNrlxuICAgIC8vIOWunueOsOWPluWGs+S6juWFt+S9k+eahOS4muWKoemAu+i+kVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOi+heWKqeaWueazlVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgcHJpdmF0ZSBpc0V4cGlyZWQoZW50cnk6IENhY2hlRW50cnk8YW55Pik6IGJvb2xlYW4ge1xuICAgIHJldHVybiBEYXRlLm5vdygpIC0gZW50cnkubWV0YWRhdGEuY3JlYXRlZEF0LmdldFRpbWUoKSA+IGVudHJ5Lm1ldGFkYXRhLnR0bFxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVBY2Nlc3NJbmZvKGVudHJ5OiBDYWNoZUVudHJ5PGFueT4pOiB2b2lkIHtcbiAgICBlbnRyeS5tZXRhZGF0YS5hY2Nlc3NlZEF0ID0gbmV3IERhdGUoKVxuICAgIGVudHJ5Lm1ldGFkYXRhLmFjY2Vzc0NvdW50KytcbiAgfVxuXG4gIHByaXZhdGUgZXZpY3RFbnRyeShrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5jYWNoZS5nZXQoa2V5KVxuICAgIGlmIChlbnRyeSkge1xuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KVxuICAgICAgdGhpcy5zdGF0cy5ldmljdGlvbkNvdW50KytcbiAgICAgIHRoaXMuc3RhdHMuYnlTdHJhdGVneVt0aGlzLmNvbmZpZy5zdHJhdGVneV0uZXZpY3Rpb25zKytcbiAgICAgIFxuICAgICAgLy8g5LuO5oyB5LmF5YyW5a2Y5YKo5Lit5Yig6ZmkXG4gICAgICBpZiAodGhpcy5jb25maWcuZW5hYmxlUGVyc2lzdGVuY2UpIHtcbiAgICAgICAgdGhpcy5kZWxldGVGcm9tUGVyc2lzdGVudFN0b3JhZ2Uoa2V5KS5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc3RhcnRDbGVhbnVwVGltZXIoKTogdm9pZCB7XG4gICAgdGhpcy5jbGVhbnVwVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLnBlcmZvcm1DbGVhbnVwKClcbiAgICB9LCB0aGlzLmNvbmZpZy5jbGVhbnVwSW50ZXJ2YWwpXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1DbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDmuIXnkIbov4fmnJ/mnaHnm65cbiAgICAgIGNvbnN0IGV4cGlyZWRLZXlzOiBzdHJpbmdbXSA9IFtdXG4gICAgICB0aGlzLmNhY2hlLmZvckVhY2goKGVudHJ5LCBrZXkpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuaXNFeHBpcmVkKGVudHJ5KSkge1xuICAgICAgICAgIGV4cGlyZWRLZXlzLnB1c2goa2V5KVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGtleSBvZiBleHBpcmVkS2V5cykge1xuICAgICAgICB0aGlzLmV2aWN0RW50cnkoa2V5KVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDmuIXnkIbmjIHkuYXljJblrZjlgqjkuK3nmoTov4fmnJ/mnaHnm65cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVQZXJzaXN0ZW5jZSkge1xuICAgICAgICBhd2FpdCB0aGlzLmNsZWFudXBQZXJzaXN0ZW50U3RvcmFnZSgpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOabtOaWsOe7n+iuoVxuICAgICAgdGhpcy51cGRhdGVTdGF0cygpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NhY2hlIGNsZWFudXAgZmFpbGVkOicsIGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY2xlYW51cFBlcnNpc3RlbnRTdG9yYWdlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAodHlwZW9mIGxvY2FsU3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgY29uc3Qga2V5c1RvUmVtb3ZlOiBzdHJpbmdbXSA9IFtdXG4gICAgICAgIFxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxvY2FsU3RvcmFnZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IGtleSA9IGxvY2FsU3RvcmFnZS5rZXkoaSlcbiAgICAgICAgICBpZiAoa2V5Py5zdGFydHNXaXRoKCdjYWNoZV8nKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3Qgc2VyaWFsaXplZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSlcbiAgICAgICAgICAgICAgaWYgKHNlcmlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbnRyeSA9IEpTT04ucGFyc2Uoc2VyaWFsaXplZClcbiAgICAgICAgICAgICAgICBjb25zdCBlbnRyeURhdGUgPSBuZXcgRGF0ZShlbnRyeS5tZXRhZGF0YS5jcmVhdGVkQXQpXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBlbnRyeURhdGUuZ2V0VGltZSgpID4gZW50cnkubWV0YWRhdGEudHRsKSB7XG4gICAgICAgICAgICAgICAgICBrZXlzVG9SZW1vdmUucHVzaChrZXkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgLy8g5peg5pWI5pWw5o2u77yM5Yig6ZmkXG4gICAgICAgICAgICAgIGtleXNUb1JlbW92ZS5wdXNoKGtleSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGtleXNUb1JlbW92ZS5mb3JFYWNoKGtleSA9PiBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1BlcnNpc3RlbnQgc3RvcmFnZSBjbGVhbnVwIGZhaWxlZDonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGluaXRpYWxpemVDYWNoZSgpOiB2b2lkIHtcbiAgICAvLyDku47mjIHkuYXljJblrZjlgqjmgaLlpI3nvJPlrZhcbiAgICBpZiAodGhpcy5jb25maWcuZW5hYmxlUGVyc2lzdGVuY2UpIHtcbiAgICAgIHRoaXMubG9hZEZyb21QZXJzaXN0ZW50U3RvcmFnZUFzeW5jKCkuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICB9XG4gICAgXG4gICAgLy8g5ZCv5Yqo6aKE5rWL5oCn6aKE54OtXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLnByZWRpY3RpdmVXYXJtdXAoKS5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIH0sIDUwMDApIC8vIDXnp5LlkI7lvIDlp4vpooTng61cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbG9hZEZyb21QZXJzaXN0ZW50U3RvcmFnZUFzeW5jKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAodHlwZW9mIGxvY2FsU3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgY29uc3Qga2V5c1RvTG9hZDogc3RyaW5nW10gPSBbXVxuICAgICAgICBcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NhbFN0b3JhZ2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBrZXkgPSBsb2NhbFN0b3JhZ2Uua2V5KGkpXG4gICAgICAgICAgaWYgKGtleT8uc3RhcnRzV2l0aCgnY2FjaGVfJykpIHtcbiAgICAgICAgICAgIGtleXNUb0xvYWQucHVzaChrZXkpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyDpmZDliLbmgaLlpI3nmoTmnaHnm67mlbDph4/ku6Xpgb/lhY3lhoXlrZjmuqLlh7pcbiAgICAgICAgY29uc3QgbG9hZExpbWl0ID0gTWF0aC5taW4oa2V5c1RvTG9hZC5sZW5ndGgsIHRoaXMuY29uZmlnLm1heEVudHJpZXMgLyAyKVxuICAgICAgICBcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2FkTGltaXQ7IGkrKykge1xuICAgICAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBrZXlzVG9Mb2FkW2ldXG4gICAgICAgICAgY29uc3QgY2FjaGVLZXkgPSBzdG9yYWdlS2V5LnJlcGxhY2UoJ2NhY2hlXycsICcnKVxuICAgICAgICAgIFxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBlbnRyeSA9IGF3YWl0IHRoaXMubG9hZEZyb21QZXJzaXN0ZW50U3RvcmFnZShjYWNoZUtleSlcbiAgICAgICAgICAgIGlmIChlbnRyeSAmJiAhdGhpcy5pc0V4cGlyZWQoZW50cnkpKSB7XG4gICAgICAgICAgICAgIHRoaXMuY2FjaGUuc2V0KGNhY2hlS2V5LCBlbnRyeSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIOWIoOmZpOi/h+acn+adoeebrlxuICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShzdG9yYWdlS2V5KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byBsb2FkIGNhY2hlIGVudHJ5ICR7Y2FjaGVLZXl9OmAsIGVycm9yKVxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oc3RvcmFnZUtleSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBjYWNoZSBmcm9tIHBlcnNpc3RlbnQgc3RvcmFnZTonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIOWFrOWFsUFQSeaWueazlVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLyoqXG4gICAqIOiOt+WPlue8k+WtmOe7n+iuoeS/oeaBr1xuICAgKi9cbiAgZ2V0U3RhdHMoKTogQ2FjaGVTdGF0cyB7XG4gICAgcmV0dXJuIHsgLi4udGhpcy5zdGF0cyB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W57yT5a2Y6YWN572uXG4gICAqL1xuICBnZXRDb25maWcoKTogQ2FjaGVDb25maWcge1xuICAgIHJldHVybiB7IC4uLnRoaXMuY29uZmlnIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDnvJPlrZjphY3nva5cbiAgICovXG4gIHVwZGF0ZUNvbmZpZyhuZXdDb25maWc6IFBhcnRpYWw8Q2FjaGVDb25maWc+KTogdm9pZCB7XG4gICAgdGhpcy5jb25maWcgPSB7IC4uLnRoaXMuY29uZmlnLCAuLi5uZXdDb25maWcgfVxuICAgIFxuICAgIC8vIOWmguaenOa4heeQhumXtOmalOaUueWPmO+8jOmHjeWQr+WumuaXtuWZqFxuICAgIGlmICh0aGlzLmNsZWFudXBUaW1lcikge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNsZWFudXBUaW1lcilcbiAgICB9XG4gICAgdGhpcy5zdGFydENsZWFudXBUaW1lcigpXG4gIH1cblxuICAvKipcbiAgICog5re75Yqg6aKE54Ot562W55WlXG4gICAqL1xuICBhZGRXYXJtdXBTdHJhdGVneShzdHJhdGVneTogV2FybXVwU3RyYXRlZ3kpOiB2b2lkIHtcbiAgICB0aGlzLndhcm11cFN0cmF0ZWdpZXMucHVzaChzdHJhdGVneSlcbiAgICB0aGlzLndhcm11cFN0cmF0ZWdpZXMuc29ydCgoYSwgYikgPT4gYi5wcmlvcml0eSAtIGEucHJpb3JpdHkpXG4gIH1cblxuICAvKipcbiAgICog5omL5Yqo6Kem5Y+R57yT5a2Y6aKE54OtXG4gICAqL1xuICBhc3luYyB3YXJtdXAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5wcmVkaWN0aXZlV2FybXVwKClcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bnvJPlrZjkuK3nmoTmiYDmnInplK5cbiAgICovXG4gIGdldEtleXMoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuY2FjaGUua2V5cygpKVxuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpemUruaYr+WQpuWtmOWcqFxuICAgKi9cbiAgaGFzKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuY2FjaGUuaGFzKGtleSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bnvJPlrZjlpKflsI9cbiAgICovXG4gIHNpemUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZS5zaXplXG4gIH1cblxuICAvKipcbiAgICog5YGc5q2i57yT5a2Y566h55CG5ZmoXG4gICAqL1xuICBzdG9wKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNsZWFudXBUaW1lcikge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNsZWFudXBUaW1lcilcbiAgICAgIHRoaXMuY2xlYW51cFRpbWVyID0gdW5kZWZpbmVkXG4gICAgfVxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOWvvOWHuuWNleS+i+WunuS+i1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgYWR2YW5jZWRDYWNoZU1hbmFnZXIgPSBuZXcgQWR2YW5jZWRDYWNoZU1hbmFnZXIoKVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDpkojlr7nnibnlrprlrp7kvZPnsbvlnovnmoTnvJPlrZjljIXoo4Xlmahcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNsYXNzIENhcmRDYWNoZSB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY2FjaGVNYW5hZ2VyOiBBZHZhbmNlZENhY2hlTWFuYWdlcikge31cblxuICBhc3luYyBnZXRDYXJkKGNhcmRJZDogc3RyaW5nKTogUHJvbWlzZTxDYXJkIHwgbnVsbD4ge1xuICAgIHJldHVybiB0aGlzLmNhY2hlTWFuYWdlci5nZXQ8Q2FyZD4oYGNhcmQ6JHtjYXJkSWR9YClcbiAgfVxuXG4gIGFzeW5jIHNldENhcmQoY2FyZElkOiBzdHJpbmcsIGNhcmQ6IENhcmQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLmNhY2hlTWFuYWdlci5zZXQoYGNhcmQ6JHtjYXJkSWR9YCwgY2FyZCwge1xuICAgICAgdGFnczogWydjYXJkJywgJ2RhdGEnXSxcbiAgICAgIHByaW9yaXR5OiAnbm9ybWFsJyxcbiAgICAgIHR0bDogMTAgKiA2MCAqIDEwMDAgLy8gMTDliIbpkp9cbiAgICB9KVxuICB9XG5cbiAgYXN5bmMgZ2V0Q2FyZHNCeUZvbGRlcihmb2xkZXJJZDogc3RyaW5nKTogUHJvbWlzZTxDYXJkW10+IHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZU1hbmFnZXIuZ2V0PENhcmRbXT4oYGNhcmRzOmZvbGRlcjoke2ZvbGRlcklkfWApXG4gIH1cblxuICBhc3luYyBzZXRDYXJkc0J5Rm9sZGVyKGZvbGRlcklkOiBzdHJpbmcsIGNhcmRzOiBDYXJkW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLmNhY2hlTWFuYWdlci5zZXQoYGNhcmRzOmZvbGRlcjoke2ZvbGRlcklkfWAsIGNhcmRzLCB7XG4gICAgICB0YWdzOiBbJ2NhcmRzJywgJ2ZvbGRlcicsICdsaXN0J10sXG4gICAgICBwcmlvcml0eTogJ25vcm1hbCcsXG4gICAgICB0dGw6IDUgKiA2MCAqIDEwMDAgLy8gNeWIhumSn1xuICAgIH0pXG4gIH1cblxuICBhc3luYyBpbnZhbGlkYXRlQ2FyZChjYXJkSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuY2FjaGVNYW5hZ2VyLmRlbGV0ZShgY2FyZDoke2NhcmRJZH1gKVxuICB9XG5cbiAgYXN5bmMgaW52YWxpZGF0ZUZvbGRlcihmb2xkZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5jYWNoZU1hbmFnZXIuZGVsZXRlKGBjYXJkczpmb2xkZXI6JHtmb2xkZXJJZH1gKVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBjYXJkQ2FjaGUgPSBuZXcgQ2FyZENhY2hlKGFkdmFuY2VkQ2FjaGVNYW5hZ2VyKVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDkvr/liKnmlrnms5Xlr7zlh7pcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IGNhY2hlR2V0ID0gPFQ+KGtleTogc3RyaW5nKSA9PiBhZHZhbmNlZENhY2hlTWFuYWdlci5nZXQ8VD4oa2V5KVxuZXhwb3J0IGNvbnN0IGNhY2hlU2V0ID0gPFQ+KGtleTogc3RyaW5nLCBkYXRhOiBULCBvcHRpb25zPzogYW55KSA9PiBcbiAgYWR2YW5jZWRDYWNoZU1hbmFnZXIuc2V0KGtleSwgZGF0YSwgb3B0aW9ucylcbmV4cG9ydCBjb25zdCBjYWNoZURlbGV0ZSA9IChrZXk6IHN0cmluZykgPT4gYWR2YW5jZWRDYWNoZU1hbmFnZXIuZGVsZXRlKGtleSlcbmV4cG9ydCBjb25zdCBjYWNoZUNsZWFyID0gKCkgPT4gYWR2YW5jZWRDYWNoZU1hbmFnZXIuY2xlYXIoKVxuZXhwb3J0IGNvbnN0IGNhY2hlU3RhdHMgPSAoKSA9PiBhZHZhbmNlZENhY2hlTWFuYWdlci5nZXRTdGF0cygpIl0sInZlcnNpb24iOjN9