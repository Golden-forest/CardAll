efc859f9ceb332e497b211301abe6a25
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.cloudSyncService = void 0;
const supabase_1 = require("./supabase");
const database_1 = require("./database");
const network_state_detector_1 = require("./network-state-detector");
class CloudSyncService {
    constructor() {
        Object.defineProperty(this, "syncQueue", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        Object.defineProperty(this, "syncInProgress", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "lastSyncTime", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: null
        });
        Object.defineProperty(this, "conflicts", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        Object.defineProperty(this, "listeners", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: []
        });
        Object.defineProperty(this, "authService", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: null
        }); // 延迟初始化
        Object.defineProperty(this, "networkInitialized", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: false
        });
        Object.defineProperty(this, "syncInterval", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: null
        });
        this.initialize();
    }
    // 初始化同步服务
    initialize() {
        // 使用网络状态检测器替代原生事件监听
        this.initializeNetworkIntegration();
        // 定期同步（每5分钟）- 现在基于网络质量动态调整
        this.startAdaptiveSync();
    }
    // 初始化网络集成
    initializeNetworkIntegration() {
        if (this.networkInitialized)
            return;
        // 监听网络状态检测器
        network_state_detector_1.networkStateDetector.addListener({
            onNetworkStateChanged: this.handleNetworkStateChange.bind(this),
            onNetworkError: this.handleNetworkError.bind(this),
            onSyncCompleted: this.handleSyncCompleted.bind(this),
            onSyncStrategyChanged: this.handleSyncStrategyChanged.bind(this)
        });
        this.networkInitialized = true;
        console.log('Cloud sync service integrated with network state detector');
    }
    // 处理网络状态变化
    handleNetworkStateChange(state) {
        console.log('Network state changed:', state.isOnline, state.quality);
        // 如果网络恢复且可靠，立即尝试同步
        if (state.isOnline && state.isReliable && state.canSync) {
            this.processSyncQueue();
        }
        this.notifyStatusChange();
    }
    // 处理网络错误
    handleNetworkError(error, context) {
        console.warn('Network error in sync service:', error.message, context);
        // 根据错误类型调整同步策略
        if (error.type === 'connection_lost' || error.type === 'network_slow') {
            // 网络问题，暂停同步队列
            this.pauseSyncQueue();
        }
    }
    // 处理同步完成
    handleSyncCompleted(request, response) {
        if (response.success) {
            // 同步成功，更新相关状态
            this.lastSyncTime = new Date();
        }
        this.notifyStatusChange();
    }
    // 处理同步策略变化
    handleSyncStrategyChanged(strategy) {
        console.log('Sync strategy changed:', strategy);
        // 根据新的策略调整同步行为
        if (strategy.backgroundSyncEnabled) {
            this.startAdaptiveSync();
        }
    }
    // 启动自适应同步
    startAdaptiveSync() {
        // 清除现有定时器
        if (this.syncInterval) {
            clearInterval(this.syncInterval);
        }
        // 获取当前同步策略
        const syncStrategy = network_state_detector_1.networkStateDetector.getSyncStrategy();
        // 基于网络质量动态调整同步间隔
        const networkState = network_state_detector_1.networkStateDetector.getCurrentState();
        let syncInterval = 5 * 60 * 1000; // 默认5分钟
        if (networkState.quality === 'excellent') {
            syncInterval = 1 * 60 * 1000; // 1分钟
        }
        else if (networkState.quality === 'good') {
            syncInterval = 2 * 60 * 1000; // 2分钟
        }
        else if (networkState.quality === 'fair') {
            syncInterval = 5 * 60 * 1000; // 5分钟
        }
        else if (networkState.quality === 'poor') {
            syncInterval = 10 * 60 * 1000; // 10分钟
        }
        this.syncInterval = setInterval(() => {
            const currentState = network_state_detector_1.networkStateDetector.getCurrentState();
            if (currentState.canSync && this.authService?.isAuthenticated()) {
                this.processSyncQueue();
            }
        }, syncInterval);
        console.log(`Adaptive sync started with interval: ${syncInterval / 1000}s`);
    }
    // 设置认证服务（解决循环依赖）
    setAuthService(authService) {
        this.authService = authService;
        // 监听认证状态变化 - 现在使用网络状态检测器
        authService.onAuthStateChange((authState) => {
            if (authState.user) {
                const networkState = network_state_detector_1.networkStateDetector.getCurrentState();
                if (networkState.canSync) {
                    this.performFullSync();
                }
            }
        });
    }
    // 添加状态监听器
    onStatusChange(callback) {
        this.listeners.push(callback);
        callback(this.getCurrentStatus());
        return () => {
            const index = this.listeners.indexOf(callback);
            if (index > -1) {
                this.listeners.splice(index, 1);
            }
        };
    }
    // 通知状态变化
    notifyStatusChange() {
        const status = this.getCurrentStatus();
        this.listeners.forEach(listener => listener(status));
    }
    // 获取当前同步状态 - 现在使用网络状态检测器
    getCurrentStatus() {
        const networkState = network_state_detector_1.networkStateDetector.getCurrentState();
        return {
            isOnline: networkState.isOnline,
            lastSyncTime: this.lastSyncTime,
            pendingOperations: this.syncQueue.length,
            syncInProgress: this.syncInProgress,
            hasConflicts: this.conflicts.length > 0
        };
    }
    // 添加同步操作到队列
    async queueOperation(operation) {
        const syncOp = {
            ...operation,
            id: crypto.randomUUID(),
            timestamp: new Date(),
            retryCount: 0
        };
        this.syncQueue.push(syncOp);
        // 保存到本地存储
        await this.persistSyncQueue();
        // 如果在线且已认证，立即尝试同步
        if (this.isOnline && this.authService?.isAuthenticated()) {
            this.processSyncQueue();
        }
        this.notifyStatusChange();
    }
    // 处理同步队列
    async processSyncQueue() {
        if (this.syncInProgress || !this.isOnline || !this.authService?.isAuthenticated()) {
            return;
        }
        this.syncInProgress = true;
        this.notifyStatusChange();
        try {
            const operations = [...this.syncQueue];
            for (const operation of operations) {
                try {
                    await this.executeOperation(operation);
                    // 成功后从队列中移除
                    const index = this.syncQueue.findIndex(op => op.id === operation.id);
                    if (index > -1) {
                        this.syncQueue.splice(index, 1);
                    }
                }
                catch (error) {
                    console.error('Sync operation failed:', error);
                    // 增加重试次数
                    operation.retryCount++;
                    // 如果重试次数过多，移除操作
                    if (operation.retryCount > 3) {
                        const index = this.syncQueue.findIndex(op => op.id === operation.id);
                        if (index > -1) {
                            this.syncQueue.splice(index, 1);
                        }
                    }
                }
            }
            await this.persistSyncQueue();
            this.lastSyncTime = new Date();
        }
        finally {
            this.syncInProgress = false;
            this.notifyStatusChange();
        }
    }
    // 执行单个同步操作
    async executeOperation(operation) {
        const user = this.authService?.getCurrentUser();
        if (!user)
            throw new Error('User not authenticated');
        switch (operation.table) {
            case 'cards':
                await this.syncCard(operation, user.id);
                break;
            case 'folders':
                await this.syncFolder(operation, user.id);
                break;
            case 'tags':
                await this.syncTag(operation, user.id);
                break;
            case 'images':
                await this.syncImage(operation, user.id);
                break;
        }
    }
    // 同步卡片
    async syncCard(operation, userId) {
        const { type, data, localId } = operation;
        switch (type) {
            case 'create':
            case 'update':
                const { error } = await supabase_1.supabase
                    .from('cards')
                    .upsert({
                    id: localId,
                    user_id: userId,
                    front_content: data.frontContent,
                    back_content: data.backContent,
                    style: data.style,
                    folder_id: data.folderId,
                    updated_at: new Date().toISOString(),
                    sync_version: data.syncVersion + 1
                });
                if (error)
                    throw error;
                break;
            case 'delete':
                const { error: deleteError } = await supabase_1.supabase
                    .from('cards')
                    .update({
                    is_deleted: true,
                    updated_at: new Date().toISOString()
                })
                    .eq('id', localId)
                    .eq('user_id', userId);
                if (deleteError)
                    throw deleteError;
                break;
        }
    }
    // 同步文件夹
    async syncFolder(operation, userId) {
        const { type, data, localId } = operation;
        switch (type) {
            case 'create':
            case 'update':
                const { error } = await supabase_1.supabase
                    .from('folders')
                    .upsert({
                    id: localId,
                    user_id: userId,
                    name: data.name,
                    parent_id: data.parentId,
                    updated_at: new Date().toISOString(),
                    sync_version: data.syncVersion + 1
                });
                if (error)
                    throw error;
                break;
            case 'delete':
                const { error: deleteError } = await supabase_1.supabase
                    .from('folders')
                    .update({
                    is_deleted: true,
                    updated_at: new Date().toISOString()
                })
                    .eq('id', localId)
                    .eq('user_id', userId);
                if (deleteError)
                    throw deleteError;
                break;
        }
    }
    // 同步标签
    async syncTag(operation, userId) {
        const { type, data, localId } = operation;
        switch (type) {
            case 'create':
            case 'update':
                const { error } = await supabase_1.supabase
                    .from('tags')
                    .upsert({
                    id: localId,
                    user_id: userId,
                    name: data.name,
                    color: data.color,
                    updated_at: new Date().toISOString(),
                    sync_version: data.syncVersion + 1
                });
                if (error)
                    throw error;
                break;
            case 'delete':
                const { error: deleteError } = await supabase_1.supabase
                    .from('tags')
                    .update({
                    is_deleted: true,
                    updated_at: new Date().toISOString()
                })
                    .eq('id', localId)
                    .eq('user_id', userId);
                if (deleteError)
                    throw deleteError;
                break;
        }
    }
    // 同步图片
    async syncImage(operation, userId) {
        const { type, data, localId } = operation;
        switch (type) {
            case 'create':
            case 'update':
                const { error } = await supabase_1.supabase
                    .from('images')
                    .upsert({
                    id: localId,
                    user_id: userId,
                    card_id: data.cardId,
                    file_name: data.fileName,
                    file_path: data.filePath,
                    cloud_url: data.cloudUrl,
                    metadata: data.metadata,
                    updated_at: new Date().toISOString(),
                    sync_version: data.syncVersion + 1
                });
                if (error)
                    throw error;
                break;
            case 'delete':
                const { error: deleteError } = await supabase_1.supabase
                    .from('images')
                    .update({
                    is_deleted: true,
                    updated_at: new Date().toISOString()
                })
                    .eq('id', localId)
                    .eq('user_id', userId);
                if (deleteError)
                    throw deleteError;
                break;
        }
    }
    // 执行完整同步
    async performFullSync() {
        if (!this.authService?.isAuthenticated() || !this.isOnline) {
            return;
        }
        try {
            this.syncInProgress = true;
            this.notifyStatusChange();
            const user = this.authService.getCurrentUser();
            // 下行同步：从云端获取数据
            await this.syncFromCloud(user.id);
            // 上行同步：处理本地队列
            await this.processSyncQueue();
            this.lastSyncTime = new Date();
            console.log('Full sync completed successfully');
        }
        catch (error) {
            console.error('Full sync failed:', error);
        }
        finally {
            this.syncInProgress = false;
            this.notifyStatusChange();
        }
    }
    // 从云端同步数据
    async syncFromCloud(userId) {
        // 获取本地最后同步时间
        const lastSync = this.lastSyncTime || new Date(0);
        // 同步卡片
        const { data: cards } = await supabase_1.supabase
            .from('cards')
            .select('*')
            .eq('user_id', userId)
            .gte('updated_at', lastSync.toISOString());
        if (cards) {
            for (const card of cards) {
                await this.mergeCloudCard(card);
            }
        }
        // 同步文件夹
        const { data: folders } = await supabase_1.supabase
            .from('folders')
            .select('*')
            .eq('user_id', userId)
            .gte('updated_at', lastSync.toISOString());
        if (folders) {
            for (const folder of folders) {
                await this.mergeCloudFolder(folder);
            }
        }
        // 同步标签
        const { data: tags } = await supabase_1.supabase
            .from('tags')
            .select('*')
            .eq('user_id', userId)
            .gte('updated_at', lastSync.toISOString());
        if (tags) {
            for (const tag of tags) {
                await this.mergeCloudTag(tag);
            }
        }
    }
    // 合并云端卡片数据 - 使用"最后写入获胜"策略
    async mergeCloudCard(cloudCard) {
        const localCard = await database_1.db.cards?.get(cloudCard.id);
        if (!localCard) {
            // 本地不存在，直接插入
            await database_1.db.cards?.add({
                id: cloudCard.id,
                frontContent: cloudCard.front_content,
                backContent: cloudCard.back_content,
                style: cloudCard.style,
                folderId: cloudCard.folder_id || undefined,
                isFlipped: false,
                createdAt: new Date(cloudCard.created_at),
                updatedAt: new Date(cloudCard.updated_at),
                syncVersion: cloudCard.sync_version,
                pendingSync: false
            });
        }
        else {
            // 比较更新时间，采用"最后写入获胜"策略
            const localUpdateTime = new Date(localCard.updatedAt).getTime();
            const cloudUpdateTime = new Date(cloudCard.updated_at).getTime();
            if (cloudUpdateTime > localUpdateTime) {
                // 云端数据更新，使用云端数据
                await database_1.db.cards?.update(cloudCard.id, {
                    frontContent: cloudCard.front_content,
                    backContent: cloudCard.back_content,
                    style: cloudCard.style,
                    folderId: cloudCard.folder_id || undefined,
                    updatedAt: new Date(cloudCard.updated_at),
                    syncVersion: cloudCard.sync_version,
                    pendingSync: false
                });
            }
            else if (localUpdateTime > cloudUpdateTime && localCard.pendingSync) {
                // 本地数据更新，上传到云端
                await this.queueOperation({
                    type: 'update',
                    table: 'cards',
                    data: localCard,
                    localId: localCard.id
                });
            }
            // 如果时间相同，认为是同步的，不做任何操作
        }
    }
    // 合并云端文件夹数据 - 使用"最后写入获胜"策略
    async mergeCloudFolder(cloudFolder) {
        const localFolder = await database_1.db.folders?.get(cloudFolder.id);
        if (!localFolder) {
            await database_1.db.folders?.add({
                id: cloudFolder.id,
                name: cloudFolder.name,
                color: '#3b82f6',
                icon: 'Folder',
                cardIds: [],
                parentId: cloudFolder.parent_id || undefined,
                isExpanded: true,
                createdAt: new Date(cloudFolder.created_at),
                updatedAt: new Date(cloudFolder.updated_at),
                syncVersion: cloudFolder.sync_version,
                pendingSync: false
            });
        }
        else {
            // 比较更新时间，采用"最后写入获胜"策略
            const localUpdateTime = new Date(localFolder.updatedAt).getTime();
            const cloudUpdateTime = new Date(cloudFolder.updated_at).getTime();
            if (cloudUpdateTime > localUpdateTime) {
                await database_1.db.folders?.update(cloudFolder.id, {
                    name: cloudFolder.name,
                    parentId: cloudFolder.parent_id || undefined,
                    updatedAt: new Date(cloudFolder.updated_at),
                    syncVersion: cloudFolder.sync_version,
                    pendingSync: false
                });
            }
            else if (localUpdateTime > cloudUpdateTime && localFolder.pendingSync) {
                // 本地数据更新，上传到云端
                await this.queueOperation({
                    type: 'update',
                    table: 'folders',
                    data: localFolder,
                    localId: localFolder.id
                });
            }
        }
    }
    // 合并云端标签数据 - 使用"最后写入获胜"策略
    async mergeCloudTag(cloudTag) {
        const localTag = await database_1.db.tags?.get(cloudTag.id);
        if (!localTag) {
            await database_1.db.tags?.add({
                id: cloudTag.id,
                name: cloudTag.name,
                color: cloudTag.color,
                count: 0, // 云端同步下来的标签初始计数为0，后续会通过syncTagsWithCards更新
                createdAt: new Date(cloudTag.created_at),
                updatedAt: new Date(cloudTag.updated_at),
                syncVersion: cloudTag.sync_version,
                pendingSync: false
            });
        }
        else {
            // 比较更新时间，采用"最后写入获胜"策略
            const localUpdateTime = new Date(localTag.updatedAt).getTime();
            const cloudUpdateTime = new Date(cloudTag.updatedAt).getTime();
            if (cloudUpdateTime > localUpdateTime) {
                await database_1.db.tags?.update(cloudTag.id, {
                    name: cloudTag.name,
                    color: cloudTag.color,
                    updatedAt: new Date(cloudTag.updated_at),
                    syncVersion: cloudTag.sync_version,
                    pendingSync: false
                });
            }
            else if (localUpdateTime > cloudUpdateTime && localTag.pendingSync) {
                // 本地数据更新，上传到云端
                await this.queueOperation({
                    type: 'update',
                    table: 'tags',
                    data: localTag,
                    localId: localTag.id
                });
            }
        }
    }
    // 持久化同步队列
    async persistSyncQueue() {
        try {
            localStorage.setItem('cardall_sync_queue', JSON.stringify(this.syncQueue));
        }
        catch (error) {
            console.error('Failed to persist sync queue:', error);
        }
    }
    // 恢复同步队列
    async restoreSyncQueue() {
        try {
            const stored = localStorage.getItem('cardall_sync_queue');
            if (stored) {
                this.syncQueue = JSON.parse(stored);
                this.notifyStatusChange();
            }
        }
        catch (error) {
            console.error('Failed to restore sync queue:', error);
        }
    }
    // 清除同步队列
    async clearSyncQueue() {
        this.syncQueue = [];
        await this.persistSyncQueue();
        this.notifyStatusChange();
    }
    // 获取冲突列表
    getConflicts() {
        return [...this.conflicts];
    }
    // 解决冲突
    async resolveConflict(conflictId, resolution) {
        const conflict = this.conflicts.find(c => c.id === conflictId);
        if (!conflict)
            return;
        // 根据解决方案处理冲突
        switch (resolution) {
            case 'local':
                // 使用本地数据，上传到云端
                await this.queueOperation({
                    type: 'update',
                    table: conflict.table,
                    data: conflict.localData,
                    localId: conflict.localData.id
                });
                break;
            case 'cloud':
                // 使用云端数据，更新本地
                // 这里需要根据具体表类型处理
                break;
            case 'merge':
                // 合并数据（需要具体实现）
                break;
        }
        // 移除已解决的冲突
        const index = this.conflicts.findIndex(c => c.id === conflictId);
        if (index > -1) {
            this.conflicts.splice(index, 1);
            this.notifyStatusChange();
        }
    }
}
// 导出单例实例
exports.cloudSyncService = new CloudSyncService();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXGNsb3VkLXN5bmMudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQUEseUNBQXNEO0FBQ3RELHlDQUErQjtBQUMvQixxRUFBK0Q7QUF3Qi9ELE1BQU0sZ0JBQWdCO0lBU3BCO1FBUlE7Ozs7bUJBQTZCLEVBQUU7V0FBQTtRQUMvQjs7OzttQkFBaUIsS0FBSztXQUFBO1FBQ3RCOzs7O21CQUE0QixJQUFJO1dBQUE7UUFDaEM7Ozs7bUJBQWtDLEVBQUU7V0FBQTtRQUNwQzs7OzttQkFBOEMsRUFBRTtXQUFBO1FBQ2hEOzs7O21CQUFtQixJQUFJO1dBQUEsQ0FBQyxRQUFRO1FBQ2hDOzs7O21CQUFxQixLQUFLO1dBQUE7UUE0RzFCOzs7O21CQUFzQyxJQUFJO1dBQUE7UUF6R2hELElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQTtJQUNuQixDQUFDO0lBRUQsVUFBVTtJQUNGLFVBQVU7UUFDaEIsb0JBQW9CO1FBQ3BCLElBQUksQ0FBQyw0QkFBNEIsRUFBRSxDQUFBO1FBRW5DLDJCQUEyQjtRQUMzQixJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQTtJQUMxQixDQUFDO0lBRUQsVUFBVTtJQUNGLDRCQUE0QjtRQUNsQyxJQUFJLElBQUksQ0FBQyxrQkFBa0I7WUFBRSxPQUFNO1FBRW5DLFlBQVk7UUFDWiw2Q0FBb0IsQ0FBQyxXQUFXLENBQUM7WUFDL0IscUJBQXFCLEVBQUUsSUFBSSxDQUFDLHdCQUF3QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7WUFDL0QsY0FBYyxFQUFFLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1lBQ2xELGVBQWUsRUFBRSxJQUFJLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztZQUNwRCxxQkFBcUIsRUFBRSxJQUFJLENBQUMseUJBQXlCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztTQUNqRSxDQUFDLENBQUE7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LE1BQUs7UUFDVCxDQUFDO1FBRUQsV0FBVztRQUNYLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxVQUFVLENBQUMsQ0FBQTtRQUNoRSxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQ2YsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFBO1lBQy9CLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFBO1FBQzNCLENBQUM7SUFDSCxDQUFDO0NBQ0Y7QUFFRCxTQUFTO0FBQ0ksUUFBQSxnQkFBZ0IsR0FBRyxJQUFJLGdCQUFnQixFQUFFLENBQUEiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcc2VydmljZXNcXGNsb3VkLXN5bmMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3VwYWJhc2UsIHR5cGUgU3luY1N0YXR1cyB9IGZyb20gJy4vc3VwYWJhc2UnXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4vZGF0YWJhc2UnXG5pbXBvcnQgeyBuZXR3b3JrU3RhdGVEZXRlY3RvciB9IGZyb20gJy4vbmV0d29yay1zdGF0ZS1kZXRlY3RvcidcbmltcG9ydCB7IGVycm9yUmVjb3ZlcnlTdHJhdGVneSB9IGZyb20gJy4vbmV0d29yay1lcnJvci1oYW5kbGVyJ1xuaW1wb3J0IHsgZGF0YWJhc2VOZXR3b3JrQWRhcHRlciB9IGZyb20gJy4vZGF0YWJhc2UtbmV0d29yay1hZGFwdGVyJ1xuaW1wb3J0IHR5cGUgeyBEYkNhcmQsIERiRm9sZGVyLCBEYlRhZyB9IGZyb20gJy4vZGF0YWJhc2UnXG5cbmV4cG9ydCBpbnRlcmZhY2UgU3luY09wZXJhdGlvbiB7XG4gIGlkOiBzdHJpbmdcbiAgdHlwZTogJ2NyZWF0ZScgfCAndXBkYXRlJyB8ICdkZWxldGUnXG4gIHRhYmxlOiAnY2FyZHMnIHwgJ2ZvbGRlcnMnIHwgJ3RhZ3MnIHwgJ2ltYWdlcydcbiAgZGF0YTogYW55XG4gIGxvY2FsSWQ6IHN0cmluZ1xuICB0aW1lc3RhbXA6IERhdGVcbiAgcmV0cnlDb3VudDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmxpY3RSZXNvbHV0aW9uIHtcbiAgaWQ6IHN0cmluZ1xuICB0YWJsZTogc3RyaW5nXG4gIGxvY2FsRGF0YTogYW55XG4gIGNsb3VkRGF0YTogYW55XG4gIHJlc29sdXRpb246ICdsb2NhbCcgfCAnY2xvdWQnIHwgJ21lcmdlJyB8ICdtYW51YWwnXG4gIHRpbWVzdGFtcDogRGF0ZVxufVxuXG5jbGFzcyBDbG91ZFN5bmNTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBzeW5jUXVldWU6IFN5bmNPcGVyYXRpb25bXSA9IFtdXG4gIHByaXZhdGUgc3luY0luUHJvZ3Jlc3MgPSBmYWxzZVxuICBwcml2YXRlIGxhc3RTeW5jVGltZTogRGF0ZSB8IG51bGwgPSBudWxsXG4gIHByaXZhdGUgY29uZmxpY3RzOiBDb25mbGljdFJlc29sdXRpb25bXSA9IFtdXG4gIHByaXZhdGUgbGlzdGVuZXJzOiAoKHN0YXR1czogU3luY1N0YXR1cykgPT4gdm9pZClbXSA9IFtdXG4gIHByaXZhdGUgYXV0aFNlcnZpY2U6IGFueSA9IG51bGwgLy8g5bu26L+f5Yid5aeL5YyWXG4gIHByaXZhdGUgbmV0d29ya0luaXRpYWxpemVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUoKVxuICB9XG5cbiAgLy8g5Yid5aeL5YyW5ZCM5q2l5pyN5YqhXG4gIHByaXZhdGUgaW5pdGlhbGl6ZSgpIHtcbiAgICAvLyDkvb/nlKjnvZHnu5znirbmgIHmo4DmtYvlmajmm7/ku6Pljp/nlJ/kuovku7bnm5HlkKxcbiAgICB0aGlzLmluaXRpYWxpemVOZXR3b3JrSW50ZWdyYXRpb24oKVxuICAgIFxuICAgIC8vIOWumuacn+WQjOatpe+8iOavjzXliIbpkp/vvIktIOeOsOWcqOWfuuS6jue9kee7nOi0qOmHj+WKqOaAgeiwg+aVtFxuICAgIHRoaXMuc3RhcnRBZGFwdGl2ZVN5bmMoKVxuICB9XG5cbiAgLy8g5Yid5aeL5YyW572R57uc6ZuG5oiQXG4gIHByaXZhdGUgaW5pdGlhbGl6ZU5ldHdvcmtJbnRlZ3JhdGlvbigpIHtcbiAgICBpZiAodGhpcy5uZXR3b3JrSW5pdGlhbGl6ZWQpIHJldHVyblxuICAgIFxuICAgIC8vIOebkeWQrOe9kee7nOeKtuaAgeajgOa1i+WZqFxuICAgIG5ldHdvcmtTdGF0ZURldGVjdG9yLmFkZExpc3RlbmVyKHtcbiAgICAgIG9uTmV0d29ya1N0YXRlQ2hhbmdlZDogdGhpcy5oYW5kbGVOZXR3b3JrU3RhdGVDaGFuZ2UuYmluZCh0aGlzKSxcbiAgICAgIG9uTmV0d29ya0Vycm9yOiB0aGlzLmhhbmRsZU5ldHdvcmtFcnJvci5iaW5kKHRoaXMpLFxuICAgICAgb25TeW5jQ29tcGxldGVkOiB0aGlzLmhhbmRsZVN5bmNDb21wbGV0ZWQuYmluZCh0aGlzKSxcbiAgICAgIG9uU3luY1N0cmF0ZWd5Q2hhbmdlZDogdGhpcy5oYW5kbGVTeW5jU3RyYXRlZ3lDaGFuZ2VkLmJpbmQodGhpcylcbiAgICB9KVxuICAgIFxuICAgIHRoaXMubmV0d29ya0luaXRpYWxpemVkID0gdHJ1ZVxuICAgIGNvbnNvbGUubG9nKCdDbG91ZCBzeW5jIHNlcnZpY2UgaW50ZWdyYXRlZCB3aXRoIG5ldHdvcmsgc3RhdGUgZGV0ZWN0b3InKVxuICB9XG5cbiAgLy8g5aSE55CG572R57uc54q25oCB5Y+Y5YyWXG4gIHByaXZhdGUgaGFuZGxlTmV0d29ya1N0YXRlQ2hhbmdlKHN0YXRlOiBhbnkpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygnTmV0d29yayBzdGF0ZSBjaGFuZ2VkOicsIHN0YXRlLmlzT25saW5lLCBzdGF0ZS5xdWFsaXR5KVxuICAgIFxuICAgIC8vIOWmguaenOe9kee7nOaBouWkjeS4lOWPr+mdoO+8jOeri+WNs+WwneivleWQjOatpVxuICAgIGlmIChzdGF0ZS5pc09ubGluZSAmJiBzdGF0ZS5pc1JlbGlhYmxlICYmIHN0YXRlLmNhblN5bmMpIHtcbiAgICAgIHRoaXMucHJvY2Vzc1N5bmNRdWV1ZSgpXG4gICAgfVxuICAgIFxuICAgIHRoaXMubm90aWZ5U3RhdHVzQ2hhbmdlKClcbiAgfVxuXG4gIC8vIOWkhOeQhue9kee7nOmUmeivr1xuICBwcml2YXRlIGhhbmRsZU5ldHdvcmtFcnJvcihlcnJvcjogYW55LCBjb250ZXh0Pzogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc29sZS53YXJuKCdOZXR3b3JrIGVycm9yIGluIHN5bmMgc2VydmljZTonLCBlcnJvci5tZXNzYWdlLCBjb250ZXh0KVxuICAgIFxuICAgIC8vIOagueaNrumUmeivr+exu+Wei+iwg+aVtOWQjOatpeetlueVpVxuICAgIGlmIChlcnJvci50eXBlID09PSAnY29ubmVjdGlvbl9sb3N0JyB8fCBlcnJvci50eXBlID09PSAnbmV0d29ya19zbG93Jykge1xuICAgICAgLy8g572R57uc6Zeu6aKY77yM5pqC5YGc5ZCM5q2l6Zif5YiXXG4gICAgICB0aGlzLnBhdXNlU3luY1F1ZXVlKClcbiAgICB9XG4gIH1cblxuICAvLyDlpITnkIblkIzmraXlrozmiJBcbiAgcHJpdmF0ZSBoYW5kbGVTeW5jQ29tcGxldGVkKHJlcXVlc3Q6IGFueSwgcmVzcG9uc2U6IGFueSk6IHZvaWQge1xuICAgIGlmIChyZXNwb25zZS5zdWNjZXNzKSB7XG4gICAgICAvLyDlkIzmraXmiJDlip/vvIzmm7TmlrDnm7jlhbPnirbmgIFcbiAgICAgIHRoaXMubGFzdFN5bmNUaW1lID0gbmV3IERhdGUoKVxuICAgIH1cbiAgICBcbiAgICB0aGlzLm5vdGlmeVN0YXR1c0NoYW5nZSgpXG4gIH1cblxuICAvLyDlpITnkIblkIzmraXnrZbnlaXlj5jljJZcbiAgcHJpdmF0ZSBoYW5kbGVTeW5jU3RyYXRlZ3lDaGFuZ2VkKHN0cmF0ZWd5OiBhbnkpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygnU3luYyBzdHJhdGVneSBjaGFuZ2VkOicsIHN0cmF0ZWd5KVxuICAgIFxuICAgIC8vIOagueaNruaWsOeahOetlueVpeiwg+aVtOWQjOatpeihjOS4ulxuICAgIGlmIChzdHJhdGVneS5iYWNrZ3JvdW5kU3luY0VuYWJsZWQpIHtcbiAgICAgIHRoaXMuc3RhcnRBZGFwdGl2ZVN5bmMoKVxuICAgIH1cbiAgfVxuXG4gIC8vIOWQr+WKqOiHqumAguW6lOWQjOatpVxuICBwcml2YXRlIHN0YXJ0QWRhcHRpdmVTeW5jKCk6IHZvaWQge1xuICAgIC8vIOa4hemZpOeOsOacieWumuaXtuWZqFxuICAgIGlmICh0aGlzLnN5bmNJbnRlcnZhbCkge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnN5bmNJbnRlcnZhbClcbiAgICB9XG4gICAgXG4gICAgLy8g6I635Y+W5b2T5YmN5ZCM5q2l562W55WlXG4gICAgY29uc3Qgc3luY1N0cmF0ZWd5ID0gbmV0d29ya1N0YXRlRGV0ZWN0b3IuZ2V0U3luY1N0cmF0ZWd5KClcbiAgICBcbiAgICAvLyDln7rkuo7nvZHnu5zotKjph4/liqjmgIHosIPmlbTlkIzmraXpl7TpmpRcbiAgICBjb25zdCBuZXR3b3JrU3RhdGUgPSBuZXR3b3JrU3RhdGVEZXRlY3Rvci5nZXRDdXJyZW50U3RhdGUoKVxuICAgIGxldCBzeW5jSW50ZXJ2YWwgPSA1ICogNjAgKiAxMDAwIC8vIOm7mOiupDXliIbpkp9cbiAgICBcbiAgICBpZiAobmV0d29ya1N0YXRlLnF1YWxpdHkgPT09ICdleGNlbGxlbnQnKSB7XG4gICAgICBzeW5jSW50ZXJ2YWwgPSAxICogNjAgKiAxMDAwIC8vIDHliIbpkp9cbiAgICB9IGVsc2UgaWYgKG5ldHdvcmtTdGF0ZS5xdWFsaXR5ID09PSAnZ29vZCcpIHtcbiAgICAgIHN5bmNJbnRlcnZhbCA9IDIgKiA2MCAqIDEwMDAgLy8gMuWIhumSn1xuICAgIH0gZWxzZSBpZiAobmV0d29ya1N0YXRlLnF1YWxpdHkgPT09ICdmYWlyJykge1xuICAgICAgc3luY0ludGVydmFsID0gNSAqIDYwICogMTAwMCAvLyA15YiG6ZKfXG4gICAgfSBlbHNlIGlmIChuZXR3b3JrU3RhdGUucXVhbGl0eSA9PT0gJ3Bvb3InKSB7XG4gICAgICBzeW5jSW50ZXJ2YWwgPSAxMCAqIDYwICogMTAwMCAvLyAxMOWIhumSn1xuICAgIH1cbiAgICBcbiAgICB0aGlzLnN5bmNJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRTdGF0ZSA9IG5ldHdvcmtTdGF0ZURldGVjdG9yLmdldEN1cnJlbnRTdGF0ZSgpXG4gICAgICBpZiAoY3VycmVudFN0YXRlLmNhblN5bmMgJiYgdGhpcy5hdXRoU2VydmljZT8uaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgdGhpcy5wcm9jZXNzU3luY1F1ZXVlKClcbiAgICAgIH1cbiAgICB9LCBzeW5jSW50ZXJ2YWwpXG4gICAgXG4gICAgY29uc29sZS5sb2coYEFkYXB0aXZlIHN5bmMgc3RhcnRlZCB3aXRoIGludGVydmFsOiAke3N5bmNJbnRlcnZhbCAvIDEwMDB9c2ApXG4gIH1cblxuICBwcml2YXRlIHN5bmNJbnRlcnZhbDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbFxuXG4gIC8vIOiuvue9ruiupOivgeacjeWKoe+8iOino+WGs+W+queOr+S+nei1lu+8iVxuICBzZXRBdXRoU2VydmljZShhdXRoU2VydmljZTogYW55KSB7XG4gICAgdGhpcy5hdXRoU2VydmljZSA9IGF1dGhTZXJ2aWNlXG4gICAgXG4gICAgLy8g55uR5ZCs6K6k6K+B54q25oCB5Y+Y5YyWIC0g546w5Zyo5L2/55So572R57uc54q25oCB5qOA5rWL5ZmoXG4gICAgYXV0aFNlcnZpY2Uub25BdXRoU3RhdGVDaGFuZ2UoKGF1dGhTdGF0ZTogYW55KSA9PiB7XG4gICAgICBpZiAoYXV0aFN0YXRlLnVzZXIpIHtcbiAgICAgICAgY29uc3QgbmV0d29ya1N0YXRlID0gbmV0d29ya1N0YXRlRGV0ZWN0b3IuZ2V0Q3VycmVudFN0YXRlKClcbiAgICAgICAgaWYgKG5ldHdvcmtTdGF0ZS5jYW5TeW5jKSB7XG4gICAgICAgICAgdGhpcy5wZXJmb3JtRnVsbFN5bmMoKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIC8vIOa3u+WKoOeKtuaAgeebkeWQrOWZqFxuICBvblN0YXR1c0NoYW5nZShjYWxsYmFjazogKHN0YXR1czogU3luY1N0YXR1cykgPT4gdm9pZCk6ICgpID0+IHZvaWQge1xuICAgIHRoaXMubGlzdGVuZXJzLnB1c2goY2FsbGJhY2spXG4gICAgY2FsbGJhY2sodGhpcy5nZXRDdXJyZW50U3RhdHVzKCkpXG4gICAgXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5saXN0ZW5lcnMuaW5kZXhPZihjYWxsYmFjaylcbiAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSlcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyDpgJrnn6XnirbmgIHlj5jljJZcbiAgcHJpdmF0ZSBub3RpZnlTdGF0dXNDaGFuZ2UoKSB7XG4gICAgY29uc3Qgc3RhdHVzID0gdGhpcy5nZXRDdXJyZW50U3RhdHVzKClcbiAgICB0aGlzLmxpc3RlbmVycy5mb3JFYWNoKGxpc3RlbmVyID0+IGxpc3RlbmVyKHN0YXR1cykpXG4gIH1cblxuICAvLyDojrflj5blvZPliY3lkIzmraXnirbmgIEgLSDnjrDlnKjkvb/nlKjnvZHnu5znirbmgIHmo4DmtYvlmahcbiAgZ2V0Q3VycmVudFN0YXR1cygpOiBTeW5jU3RhdHVzIHtcbiAgICBjb25zdCBuZXR3b3JrU3RhdGUgPSBuZXR3b3JrU3RhdGVEZXRlY3Rvci5nZXRDdXJyZW50U3RhdGUoKVxuICAgIHJldHVybiB7XG4gICAgICBpc09ubGluZTogbmV0d29ya1N0YXRlLmlzT25saW5lLFxuICAgICAgbGFzdFN5bmNUaW1lOiB0aGlzLmxhc3RTeW5jVGltZSxcbiAgICAgIHBlbmRpbmdPcGVyYXRpb25zOiB0aGlzLnN5bmNRdWV1ZS5sZW5ndGgsXG4gICAgICBzeW5jSW5Qcm9ncmVzczogdGhpcy5zeW5jSW5Qcm9ncmVzcyxcbiAgICAgIGhhc0NvbmZsaWN0czogdGhpcy5jb25mbGljdHMubGVuZ3RoID4gMFxuICAgIH1cbiAgfVxuXG4gIC8vIOa3u+WKoOWQjOatpeaTjeS9nOWIsOmYn+WIl1xuICBhc3luYyBxdWV1ZU9wZXJhdGlvbihvcGVyYXRpb246IE9taXQ8U3luY09wZXJhdGlvbiwgJ2lkJyB8ICd0aW1lc3RhbXAnIHwgJ3JldHJ5Q291bnQnPikge1xuICAgIGNvbnN0IHN5bmNPcDogU3luY09wZXJhdGlvbiA9IHtcbiAgICAgIC4uLm9wZXJhdGlvbixcbiAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgcmV0cnlDb3VudDogMFxuICAgIH1cblxuICAgIHRoaXMuc3luY1F1ZXVlLnB1c2goc3luY09wKVxuICAgIFxuICAgIC8vIOS/neWtmOWIsOacrOWcsOWtmOWCqFxuICAgIGF3YWl0IHRoaXMucGVyc2lzdFN5bmNRdWV1ZSgpXG4gICAgXG4gICAgLy8g5aaC5p6c5Zyo57q/5LiU5bey6K6k6K+B77yM56uL5Y2z5bCd6K+V5ZCM5q2lXG4gICAgaWYgKHRoaXMuaXNPbmxpbmUgJiYgdGhpcy5hdXRoU2VydmljZT8uaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgIHRoaXMucHJvY2Vzc1N5bmNRdWV1ZSgpXG4gICAgfVxuXG4gICAgdGhpcy5ub3RpZnlTdGF0dXNDaGFuZ2UoKVxuICB9XG5cbiAgLy8g5aSE55CG5ZCM5q2l6Zif5YiXXG4gIHByaXZhdGUgYXN5bmMgcHJvY2Vzc1N5bmNRdWV1ZSgpIHtcbiAgICBpZiAodGhpcy5zeW5jSW5Qcm9ncmVzcyB8fCAhdGhpcy5pc09ubGluZSB8fCAhdGhpcy5hdXRoU2VydmljZT8uaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRoaXMuc3luY0luUHJvZ3Jlc3MgPSB0cnVlXG4gICAgdGhpcy5ub3RpZnlTdGF0dXNDaGFuZ2UoKVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBbLi4udGhpcy5zeW5jUXVldWVdXG4gICAgICBcbiAgICAgIGZvciAoY29uc3Qgb3BlcmF0aW9uIG9mIG9wZXJhdGlvbnMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVPcGVyYXRpb24ob3BlcmF0aW9uKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIOaIkOWKn+WQjuS7jumYn+WIl+S4reenu+mZpFxuICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5zeW5jUXVldWUuZmluZEluZGV4KG9wID0+IG9wLmlkID09PSBvcGVyYXRpb24uaWQpXG4gICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuc3luY1F1ZXVlLnNwbGljZShpbmRleCwgMSlcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignU3luYyBvcGVyYXRpb24gZmFpbGVkOicsIGVycm9yKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIOWinuWKoOmHjeivleasoeaVsFxuICAgICAgICAgIG9wZXJhdGlvbi5yZXRyeUNvdW50KytcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDlpoLmnpzph43or5XmrKHmlbDov4flpJrvvIznp7vpmaTmk43kvZxcbiAgICAgICAgICBpZiAob3BlcmF0aW9uLnJldHJ5Q291bnQgPiAzKSB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuc3luY1F1ZXVlLmZpbmRJbmRleChvcCA9PiBvcC5pZCA9PT0gb3BlcmF0aW9uLmlkKVxuICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgdGhpcy5zeW5jUXVldWUuc3BsaWNlKGluZGV4LCAxKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBhd2FpdCB0aGlzLnBlcnNpc3RTeW5jUXVldWUoKVxuICAgICAgdGhpcy5sYXN0U3luY1RpbWUgPSBuZXcgRGF0ZSgpXG4gICAgICBcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5zeW5jSW5Qcm9ncmVzcyA9IGZhbHNlXG4gICAgICB0aGlzLm5vdGlmeVN0YXR1c0NoYW5nZSgpXG4gICAgfVxuICB9XG5cbiAgLy8g5omn6KGM5Y2V5Liq5ZCM5q2l5pON5L2cXG4gIHByaXZhdGUgYXN5bmMgZXhlY3V0ZU9wZXJhdGlvbihvcGVyYXRpb246IFN5bmNPcGVyYXRpb24pIHtcbiAgICBjb25zdCB1c2VyID0gdGhpcy5hdXRoU2VydmljZT8uZ2V0Q3VycmVudFVzZXIoKVxuICAgIGlmICghdXNlcikgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBhdXRoZW50aWNhdGVkJylcblxuICAgIHN3aXRjaCAob3BlcmF0aW9uLnRhYmxlKSB7XG4gICAgICBjYXNlICdjYXJkcyc6XG4gICAgICAgIGF3YWl0IHRoaXMuc3luY0NhcmQob3BlcmF0aW9uLCB1c2VyLmlkKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnZm9sZGVycyc6XG4gICAgICAgIGF3YWl0IHRoaXMuc3luY0ZvbGRlcihvcGVyYXRpb24sIHVzZXIuaWQpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICd0YWdzJzpcbiAgICAgICAgYXdhaXQgdGhpcy5zeW5jVGFnKG9wZXJhdGlvbiwgdXNlci5pZClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ2ltYWdlcyc6XG4gICAgICAgIGF3YWl0IHRoaXMuc3luY0ltYWdlKG9wZXJhdGlvbiwgdXNlci5pZClcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICAvLyDlkIzmraXljaHniYdcbiAgcHJpdmF0ZSBhc3luYyBzeW5jQ2FyZChvcGVyYXRpb246IFN5bmNPcGVyYXRpb24sIHVzZXJJZDogc3RyaW5nKSB7XG4gICAgY29uc3QgeyB0eXBlLCBkYXRhLCBsb2NhbElkIH0gPSBvcGVyYXRpb25cblxuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAnY3JlYXRlJzpcbiAgICAgIGNhc2UgJ3VwZGF0ZSc6XG4gICAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgLmZyb20oJ2NhcmRzJylcbiAgICAgICAgICAudXBzZXJ0KHtcbiAgICAgICAgICAgIGlkOiBsb2NhbElkLFxuICAgICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICAgICAgZnJvbnRfY29udGVudDogZGF0YS5mcm9udENvbnRlbnQsXG4gICAgICAgICAgICBiYWNrX2NvbnRlbnQ6IGRhdGEuYmFja0NvbnRlbnQsXG4gICAgICAgICAgICBzdHlsZTogZGF0YS5zdHlsZSxcbiAgICAgICAgICAgIGZvbGRlcl9pZDogZGF0YS5mb2xkZXJJZCxcbiAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIHN5bmNfdmVyc2lvbjogZGF0YS5zeW5jVmVyc2lvbiArIDFcbiAgICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgICAgICBicmVha1xuXG4gICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICBjb25zdCB7IGVycm9yOiBkZWxldGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAuZnJvbSgnY2FyZHMnKVxuICAgICAgICAgIC51cGRhdGUoeyBcbiAgICAgICAgICAgIGlzX2RlbGV0ZWQ6IHRydWUsXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5lcSgnaWQnLCBsb2NhbElkKVxuICAgICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgICAgXG4gICAgICAgIGlmIChkZWxldGVFcnJvcikgdGhyb3cgZGVsZXRlRXJyb3JcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICAvLyDlkIzmraXmlofku7blpLlcbiAgcHJpdmF0ZSBhc3luYyBzeW5jRm9sZGVyKG9wZXJhdGlvbjogU3luY09wZXJhdGlvbiwgdXNlcklkOiBzdHJpbmcpIHtcbiAgICBjb25zdCB7IHR5cGUsIGRhdGEsIGxvY2FsSWQgfSA9IG9wZXJhdGlvblxuXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdjcmVhdGUnOlxuICAgICAgY2FzZSAndXBkYXRlJzpcbiAgICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAuZnJvbSgnZm9sZGVycycpXG4gICAgICAgICAgLnVwc2VydCh7XG4gICAgICAgICAgICBpZDogbG9jYWxJZCxcbiAgICAgICAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgICAgIHBhcmVudF9pZDogZGF0YS5wYXJlbnRJZCxcbiAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIHN5bmNfdmVyc2lvbjogZGF0YS5zeW5jVmVyc2lvbiArIDFcbiAgICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgICAgICBicmVha1xuXG4gICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICBjb25zdCB7IGVycm9yOiBkZWxldGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAuZnJvbSgnZm9sZGVycycpXG4gICAgICAgICAgLnVwZGF0ZSh7IFxuICAgICAgICAgICAgaXNfZGVsZXRlZDogdHJ1ZSxcbiAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVxKCdpZCcsIGxvY2FsSWQpXG4gICAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxuICAgICAgICBcbiAgICAgICAgaWYgKGRlbGV0ZUVycm9yKSB0aHJvdyBkZWxldGVFcnJvclxuICAgICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIC8vIOWQjOatpeagh+etvlxuICBwcml2YXRlIGFzeW5jIHN5bmNUYWcob3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uLCB1c2VySWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHsgdHlwZSwgZGF0YSwgbG9jYWxJZCB9ID0gb3BlcmF0aW9uXG5cbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2NyZWF0ZSc6XG4gICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKCd0YWdzJylcbiAgICAgICAgICAudXBzZXJ0KHtcbiAgICAgICAgICAgIGlkOiBsb2NhbElkLFxuICAgICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICAgICAgY29sb3I6IGRhdGEuY29sb3IsXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBzeW5jX3ZlcnNpb246IGRhdGEuc3luY1ZlcnNpb24gKyAxXG4gICAgICAgICAgfSlcbiAgICAgICAgXG4gICAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICAgICAgYnJlYWtcblxuICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgY29uc3QgeyBlcnJvcjogZGVsZXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgLmZyb20oJ3RhZ3MnKVxuICAgICAgICAgIC51cGRhdGUoeyBcbiAgICAgICAgICAgIGlzX2RlbGV0ZWQ6IHRydWUsXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5lcSgnaWQnLCBsb2NhbElkKVxuICAgICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgICAgXG4gICAgICAgIGlmIChkZWxldGVFcnJvcikgdGhyb3cgZGVsZXRlRXJyb3JcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICAvLyDlkIzmraXlm77niYdcbiAgcHJpdmF0ZSBhc3luYyBzeW5jSW1hZ2Uob3BlcmF0aW9uOiBTeW5jT3BlcmF0aW9uLCB1c2VySWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHsgdHlwZSwgZGF0YSwgbG9jYWxJZCB9ID0gb3BlcmF0aW9uXG5cbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2NyZWF0ZSc6XG4gICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKCdpbWFnZXMnKVxuICAgICAgICAgIC51cHNlcnQoe1xuICAgICAgICAgICAgaWQ6IGxvY2FsSWQsXG4gICAgICAgICAgICB1c2VyX2lkOiB1c2VySWQsXG4gICAgICAgICAgICBjYXJkX2lkOiBkYXRhLmNhcmRJZCxcbiAgICAgICAgICAgIGZpbGVfbmFtZTogZGF0YS5maWxlTmFtZSxcbiAgICAgICAgICAgIGZpbGVfcGF0aDogZGF0YS5maWxlUGF0aCxcbiAgICAgICAgICAgIGNsb3VkX3VybDogZGF0YS5jbG91ZFVybCxcbiAgICAgICAgICAgIG1ldGFkYXRhOiBkYXRhLm1ldGFkYXRhLFxuICAgICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgc3luY192ZXJzaW9uOiBkYXRhLnN5bmNWZXJzaW9uICsgMVxuICAgICAgICAgIH0pXG4gICAgICAgIFxuICAgICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgICAgIGJyZWFrXG5cbiAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgIGNvbnN0IHsgZXJyb3I6IGRlbGV0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKCdpbWFnZXMnKVxuICAgICAgICAgIC51cGRhdGUoeyBcbiAgICAgICAgICAgIGlzX2RlbGV0ZWQ6IHRydWUsXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5lcSgnaWQnLCBsb2NhbElkKVxuICAgICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgICAgXG4gICAgICAgIGlmIChkZWxldGVFcnJvcikgdGhyb3cgZGVsZXRlRXJyb3JcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICAvLyDmiafooYzlrozmlbTlkIzmraVcbiAgYXN5bmMgcGVyZm9ybUZ1bGxTeW5jKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5hdXRoU2VydmljZT8uaXNBdXRoZW50aWNhdGVkKCkgfHwgIXRoaXMuaXNPbmxpbmUpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICB0aGlzLnN5bmNJblByb2dyZXNzID0gdHJ1ZVxuICAgICAgdGhpcy5ub3RpZnlTdGF0dXNDaGFuZ2UoKVxuXG4gICAgICBjb25zdCB1c2VyID0gdGhpcy5hdXRoU2VydmljZS5nZXRDdXJyZW50VXNlcigpIVxuICAgICAgXG4gICAgICAvLyDkuIvooYzlkIzmraXvvJrku47kupHnq6/ojrflj5bmlbDmja5cbiAgICAgIGF3YWl0IHRoaXMuc3luY0Zyb21DbG91ZCh1c2VyLmlkKVxuICAgICAgXG4gICAgICAvLyDkuIrooYzlkIzmraXvvJrlpITnkIbmnKzlnLDpmJ/liJdcbiAgICAgIGF3YWl0IHRoaXMucHJvY2Vzc1N5bmNRdWV1ZSgpXG4gICAgICBcbiAgICAgIHRoaXMubGFzdFN5bmNUaW1lID0gbmV3IERhdGUoKVxuICAgICAgY29uc29sZS5sb2coJ0Z1bGwgc3luYyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5JylcbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGdWxsIHN5bmMgZmFpbGVkOicsIGVycm9yKVxuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLnN5bmNJblByb2dyZXNzID0gZmFsc2VcbiAgICAgIHRoaXMubm90aWZ5U3RhdHVzQ2hhbmdlKClcbiAgICB9XG4gIH1cblxuICAvLyDku47kupHnq6/lkIzmraXmlbDmja5cbiAgcHJpdmF0ZSBhc3luYyBzeW5jRnJvbUNsb3VkKHVzZXJJZDogc3RyaW5nKSB7XG4gICAgLy8g6I635Y+W5pys5Zyw5pyA5ZCO5ZCM5q2l5pe26Ze0XG4gICAgY29uc3QgbGFzdFN5bmMgPSB0aGlzLmxhc3RTeW5jVGltZSB8fCBuZXcgRGF0ZSgwKVxuICAgIFxuICAgIC8vIOWQjOatpeWNoeeJh1xuICAgIGNvbnN0IHsgZGF0YTogY2FyZHMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnY2FyZHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgICAuZ3RlKCd1cGRhdGVkX2F0JywgbGFzdFN5bmMudG9JU09TdHJpbmcoKSlcbiAgICBcbiAgICBpZiAoY2FyZHMpIHtcbiAgICAgIGZvciAoY29uc3QgY2FyZCBvZiBjYXJkcykge1xuICAgICAgICBhd2FpdCB0aGlzLm1lcmdlQ2xvdWRDYXJkKGNhcmQpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8g5ZCM5q2l5paH5Lu25aS5XG4gICAgY29uc3QgeyBkYXRhOiBmb2xkZXJzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2ZvbGRlcnMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgICAuZ3RlKCd1cGRhdGVkX2F0JywgbGFzdFN5bmMudG9JU09TdHJpbmcoKSlcbiAgICBcbiAgICBpZiAoZm9sZGVycykge1xuICAgICAgZm9yIChjb25zdCBmb2xkZXIgb2YgZm9sZGVycykge1xuICAgICAgICBhd2FpdCB0aGlzLm1lcmdlQ2xvdWRGb2xkZXIoZm9sZGVyKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIOWQjOatpeagh+etvlxuICAgIGNvbnN0IHsgZGF0YTogdGFncyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0YWdzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxuICAgICAgLmd0ZSgndXBkYXRlZF9hdCcsIGxhc3RTeW5jLnRvSVNPU3RyaW5nKCkpXG4gICAgXG4gICAgaWYgKHRhZ3MpIHtcbiAgICAgIGZvciAoY29uc3QgdGFnIG9mIHRhZ3MpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5tZXJnZUNsb3VkVGFnKHRhZylcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyDlkIjlubbkupHnq6/ljaHniYfmlbDmja4gLSDkvb/nlKhcIuacgOWQjuWGmeWFpeiOt+iDnFwi562W55WlXG4gIHByaXZhdGUgYXN5bmMgbWVyZ2VDbG91ZENhcmQoY2xvdWRDYXJkOiBhbnkpIHtcbiAgICBjb25zdCBsb2NhbENhcmQgPSBhd2FpdCBkYi5jYXJkcz8uZ2V0KGNsb3VkQ2FyZC5pZClcbiAgICBcbiAgICBpZiAoIWxvY2FsQ2FyZCkge1xuICAgICAgLy8g5pys5Zyw5LiN5a2Y5Zyo77yM55u05o6l5o+S5YWlXG4gICAgICBhd2FpdCBkYi5jYXJkcz8uYWRkKHtcbiAgICAgICAgaWQ6IGNsb3VkQ2FyZC5pZCxcbiAgICAgICAgZnJvbnRDb250ZW50OiBjbG91ZENhcmQuZnJvbnRfY29udGVudCxcbiAgICAgICAgYmFja0NvbnRlbnQ6IGNsb3VkQ2FyZC5iYWNrX2NvbnRlbnQsXG4gICAgICAgIHN0eWxlOiBjbG91ZENhcmQuc3R5bGUsXG4gICAgICAgIGZvbGRlcklkOiBjbG91ZENhcmQuZm9sZGVyX2lkIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgaXNGbGlwcGVkOiBmYWxzZSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShjbG91ZENhcmQuY3JlYXRlZF9hdCksXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoY2xvdWRDYXJkLnVwZGF0ZWRfYXQpLFxuICAgICAgICBzeW5jVmVyc2lvbjogY2xvdWRDYXJkLnN5bmNfdmVyc2lvbixcbiAgICAgICAgcGVuZGluZ1N5bmM6IGZhbHNlXG4gICAgICB9IGFzIERiQ2FyZClcbiAgICB9IGVsc2Uge1xuICAgICAgLy8g5q+U6L6D5pu05paw5pe26Ze077yM6YeH55SoXCLmnIDlkI7lhpnlhaXojrfog5xcIuetlueVpVxuICAgICAgY29uc3QgbG9jYWxVcGRhdGVUaW1lID0gbmV3IERhdGUobG9jYWxDYXJkLnVwZGF0ZWRBdCkuZ2V0VGltZSgpXG4gICAgICBjb25zdCBjbG91ZFVwZGF0ZVRpbWUgPSBuZXcgRGF0ZShjbG91ZENhcmQudXBkYXRlZF9hdCkuZ2V0VGltZSgpXG4gICAgICBcbiAgICAgIGlmIChjbG91ZFVwZGF0ZVRpbWUgPiBsb2NhbFVwZGF0ZVRpbWUpIHtcbiAgICAgICAgLy8g5LqR56uv5pWw5o2u5pu05paw77yM5L2/55So5LqR56uv5pWw5o2uXG4gICAgICAgIGF3YWl0IGRiLmNhcmRzPy51cGRhdGUoY2xvdWRDYXJkLmlkLCB7XG4gICAgICAgICAgZnJvbnRDb250ZW50OiBjbG91ZENhcmQuZnJvbnRfY29udGVudCxcbiAgICAgICAgICBiYWNrQ29udGVudDogY2xvdWRDYXJkLmJhY2tfY29udGVudCxcbiAgICAgICAgICBzdHlsZTogY2xvdWRDYXJkLnN0eWxlLFxuICAgICAgICAgIGZvbGRlcklkOiBjbG91ZENhcmQuZm9sZGVyX2lkIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKGNsb3VkQ2FyZC51cGRhdGVkX2F0KSxcbiAgICAgICAgICBzeW5jVmVyc2lvbjogY2xvdWRDYXJkLnN5bmNfdmVyc2lvbixcbiAgICAgICAgICBwZW5kaW5nU3luYzogZmFsc2VcbiAgICAgICAgfSlcbiAgICAgIH0gZWxzZSBpZiAobG9jYWxVcGRhdGVUaW1lID4gY2xvdWRVcGRhdGVUaW1lICYmIGxvY2FsQ2FyZC5wZW5kaW5nU3luYykge1xuICAgICAgICAvLyDmnKzlnLDmlbDmja7mm7TmlrDvvIzkuIrkvKDliLDkupHnq69cbiAgICAgICAgYXdhaXQgdGhpcy5xdWV1ZU9wZXJhdGlvbih7XG4gICAgICAgICAgdHlwZTogJ3VwZGF0ZScsXG4gICAgICAgICAgdGFibGU6ICdjYXJkcycsXG4gICAgICAgICAgZGF0YTogbG9jYWxDYXJkLFxuICAgICAgICAgIGxvY2FsSWQ6IGxvY2FsQ2FyZC5pZFxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgLy8g5aaC5p6c5pe26Ze055u45ZCM77yM6K6k5Li65piv5ZCM5q2l55qE77yM5LiN5YGa5Lu75L2V5pON5L2cXG4gICAgfVxuICB9XG5cbiAgLy8g5ZCI5bm25LqR56uv5paH5Lu25aS55pWw5o2uIC0g5L2/55SoXCLmnIDlkI7lhpnlhaXojrfog5xcIuetlueVpVxuICBwcml2YXRlIGFzeW5jIG1lcmdlQ2xvdWRGb2xkZXIoY2xvdWRGb2xkZXI6IGFueSkge1xuICAgIGNvbnN0IGxvY2FsRm9sZGVyID0gYXdhaXQgZGIuZm9sZGVycz8uZ2V0KGNsb3VkRm9sZGVyLmlkKVxuICAgIFxuICAgIGlmICghbG9jYWxGb2xkZXIpIHtcbiAgICAgIGF3YWl0IGRiLmZvbGRlcnM/LmFkZCh7XG4gICAgICAgIGlkOiBjbG91ZEZvbGRlci5pZCxcbiAgICAgICAgbmFtZTogY2xvdWRGb2xkZXIubmFtZSxcbiAgICAgICAgY29sb3I6ICcjM2I4MmY2JyxcbiAgICAgICAgaWNvbjogJ0ZvbGRlcicsXG4gICAgICAgIGNhcmRJZHM6IFtdLFxuICAgICAgICBwYXJlbnRJZDogY2xvdWRGb2xkZXIucGFyZW50X2lkIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgaXNFeHBhbmRlZDogdHJ1ZSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShjbG91ZEZvbGRlci5jcmVhdGVkX2F0KSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZShjbG91ZEZvbGRlci51cGRhdGVkX2F0KSxcbiAgICAgICAgc3luY1ZlcnNpb246IGNsb3VkRm9sZGVyLnN5bmNfdmVyc2lvbixcbiAgICAgICAgcGVuZGluZ1N5bmM6IGZhbHNlXG4gICAgICB9IGFzIERiRm9sZGVyKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyDmr5TovoPmm7TmlrDml7bpl7TvvIzph4fnlKhcIuacgOWQjuWGmeWFpeiOt+iDnFwi562W55WlXG4gICAgICBjb25zdCBsb2NhbFVwZGF0ZVRpbWUgPSBuZXcgRGF0ZShsb2NhbEZvbGRlci51cGRhdGVkQXQpLmdldFRpbWUoKVxuICAgICAgY29uc3QgY2xvdWRVcGRhdGVUaW1lID0gbmV3IERhdGUoY2xvdWRGb2xkZXIudXBkYXRlZF9hdCkuZ2V0VGltZSgpXG4gICAgICBcbiAgICAgIGlmIChjbG91ZFVwZGF0ZVRpbWUgPiBsb2NhbFVwZGF0ZVRpbWUpIHtcbiAgICAgICAgYXdhaXQgZGIuZm9sZGVycz8udXBkYXRlKGNsb3VkRm9sZGVyLmlkLCB7XG4gICAgICAgICAgbmFtZTogY2xvdWRGb2xkZXIubmFtZSxcbiAgICAgICAgICBwYXJlbnRJZDogY2xvdWRGb2xkZXIucGFyZW50X2lkIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKGNsb3VkRm9sZGVyLnVwZGF0ZWRfYXQpLFxuICAgICAgICAgIHN5bmNWZXJzaW9uOiBjbG91ZEZvbGRlci5zeW5jX3ZlcnNpb24sXG4gICAgICAgICAgcGVuZGluZ1N5bmM6IGZhbHNlXG4gICAgICAgIH0pXG4gICAgICB9IGVsc2UgaWYgKGxvY2FsVXBkYXRlVGltZSA+IGNsb3VkVXBkYXRlVGltZSAmJiBsb2NhbEZvbGRlci5wZW5kaW5nU3luYykge1xuICAgICAgICAvLyDmnKzlnLDmlbDmja7mm7TmlrDvvIzkuIrkvKDliLDkupHnq69cbiAgICAgICAgYXdhaXQgdGhpcy5xdWV1ZU9wZXJhdGlvbih7XG4gICAgICAgICAgdHlwZTogJ3VwZGF0ZScsXG4gICAgICAgICAgdGFibGU6ICdmb2xkZXJzJyxcbiAgICAgICAgICBkYXRhOiBsb2NhbEZvbGRlcixcbiAgICAgICAgICBsb2NhbElkOiBsb2NhbEZvbGRlci5pZFxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIOWQiOW5tuS6keerr+agh+etvuaVsOaNriAtIOS9v+eUqFwi5pyA5ZCO5YaZ5YWl6I636IOcXCLnrZbnlaVcbiAgcHJpdmF0ZSBhc3luYyBtZXJnZUNsb3VkVGFnKGNsb3VkVGFnOiBhbnkpIHtcbiAgICBjb25zdCBsb2NhbFRhZyA9IGF3YWl0IGRiLnRhZ3M/LmdldChjbG91ZFRhZy5pZClcbiAgICBcbiAgICBpZiAoIWxvY2FsVGFnKSB7XG4gICAgICBhd2FpdCBkYi50YWdzPy5hZGQoe1xuICAgICAgICBpZDogY2xvdWRUYWcuaWQsXG4gICAgICAgIG5hbWU6IGNsb3VkVGFnLm5hbWUsXG4gICAgICAgIGNvbG9yOiBjbG91ZFRhZy5jb2xvcixcbiAgICAgICAgY291bnQ6IDAsIC8vIOS6keerr+WQjOatpeS4i+adpeeahOagh+etvuWIneWni+iuoeaVsOS4ujDvvIzlkI7nu63kvJrpgJrov4dzeW5jVGFnc1dpdGhDYXJkc+abtOaWsFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKGNsb3VkVGFnLmNyZWF0ZWRfYXQpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKGNsb3VkVGFnLnVwZGF0ZWRfYXQpLFxuICAgICAgICBzeW5jVmVyc2lvbjogY2xvdWRUYWcuc3luY192ZXJzaW9uLFxuICAgICAgICBwZW5kaW5nU3luYzogZmFsc2VcbiAgICAgIH0gYXMgRGJUYWcpXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOavlOi+g+abtOaWsOaXtumXtO+8jOmHh+eUqFwi5pyA5ZCO5YaZ5YWl6I636IOcXCLnrZbnlaVcbiAgICAgIGNvbnN0IGxvY2FsVXBkYXRlVGltZSA9IG5ldyBEYXRlKGxvY2FsVGFnLnVwZGF0ZWRBdCkuZ2V0VGltZSgpXG4gICAgICBjb25zdCBjbG91ZFVwZGF0ZVRpbWUgPSBuZXcgRGF0ZShjbG91ZFRhZy51cGRhdGVkQXQpLmdldFRpbWUoKVxuICAgICAgXG4gICAgICBpZiAoY2xvdWRVcGRhdGVUaW1lID4gbG9jYWxVcGRhdGVUaW1lKSB7XG4gICAgICAgIGF3YWl0IGRiLnRhZ3M/LnVwZGF0ZShjbG91ZFRhZy5pZCwge1xuICAgICAgICAgIG5hbWU6IGNsb3VkVGFnLm5hbWUsXG4gICAgICAgICAgY29sb3I6IGNsb3VkVGFnLmNvbG9yLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoY2xvdWRUYWcudXBkYXRlZF9hdCksXG4gICAgICAgICAgc3luY1ZlcnNpb246IGNsb3VkVGFnLnN5bmNfdmVyc2lvbixcbiAgICAgICAgICBwZW5kaW5nU3luYzogZmFsc2VcbiAgICAgICAgfSlcbiAgICAgIH0gZWxzZSBpZiAobG9jYWxVcGRhdGVUaW1lID4gY2xvdWRVcGRhdGVUaW1lICYmIGxvY2FsVGFnLnBlbmRpbmdTeW5jKSB7XG4gICAgICAgIC8vIOacrOWcsOaVsOaNruabtOaWsO+8jOS4iuS8oOWIsOS6keerr1xuICAgICAgICBhd2FpdCB0aGlzLnF1ZXVlT3BlcmF0aW9uKHtcbiAgICAgICAgICB0eXBlOiAndXBkYXRlJyxcbiAgICAgICAgICB0YWJsZTogJ3RhZ3MnLFxuICAgICAgICAgIGRhdGE6IGxvY2FsVGFnLFxuICAgICAgICAgIGxvY2FsSWQ6IGxvY2FsVGFnLmlkXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8g5oyB5LmF5YyW5ZCM5q2l6Zif5YiXXG4gIHByaXZhdGUgYXN5bmMgcGVyc2lzdFN5bmNRdWV1ZSgpIHtcbiAgICB0cnkge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcmRhbGxfc3luY19xdWV1ZScsIEpTT04uc3RyaW5naWZ5KHRoaXMuc3luY1F1ZXVlKSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBlcnNpc3Qgc3luYyBxdWV1ZTonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyDmgaLlpI3lkIzmraXpmJ/liJdcbiAgYXN5bmMgcmVzdG9yZVN5bmNRdWV1ZSgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RvcmVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NhcmRhbGxfc3luY19xdWV1ZScpXG4gICAgICBpZiAoc3RvcmVkKSB7XG4gICAgICAgIHRoaXMuc3luY1F1ZXVlID0gSlNPTi5wYXJzZShzdG9yZWQpXG4gICAgICAgIHRoaXMubm90aWZ5U3RhdHVzQ2hhbmdlKClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHJlc3RvcmUgc3luYyBxdWV1ZTonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyDmuIXpmaTlkIzmraXpmJ/liJdcbiAgYXN5bmMgY2xlYXJTeW5jUXVldWUoKSB7XG4gICAgdGhpcy5zeW5jUXVldWUgPSBbXVxuICAgIGF3YWl0IHRoaXMucGVyc2lzdFN5bmNRdWV1ZSgpXG4gICAgdGhpcy5ub3RpZnlTdGF0dXNDaGFuZ2UoKVxuICB9XG5cbiAgLy8g6I635Y+W5Yay56qB5YiX6KGoXG4gIGdldENvbmZsaWN0cygpOiBDb25mbGljdFJlc29sdXRpb25bXSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLmNvbmZsaWN0c11cbiAgfVxuXG4gIC8vIOino+WGs+WGsueqgVxuICBhc3luYyByZXNvbHZlQ29uZmxpY3QoY29uZmxpY3RJZDogc3RyaW5nLCByZXNvbHV0aW9uOiAnbG9jYWwnIHwgJ2Nsb3VkJyB8ICdtZXJnZScpIHtcbiAgICBjb25zdCBjb25mbGljdCA9IHRoaXMuY29uZmxpY3RzLmZpbmQoYyA9PiBjLmlkID09PSBjb25mbGljdElkKVxuICAgIGlmICghY29uZmxpY3QpIHJldHVyblxuXG4gICAgLy8g5qC55o2u6Kej5Yaz5pa55qGI5aSE55CG5Yay56qBXG4gICAgc3dpdGNoIChyZXNvbHV0aW9uKSB7XG4gICAgICBjYXNlICdsb2NhbCc6XG4gICAgICAgIC8vIOS9v+eUqOacrOWcsOaVsOaNru+8jOS4iuS8oOWIsOS6keerr1xuICAgICAgICBhd2FpdCB0aGlzLnF1ZXVlT3BlcmF0aW9uKHtcbiAgICAgICAgICB0eXBlOiAndXBkYXRlJyxcbiAgICAgICAgICB0YWJsZTogY29uZmxpY3QudGFibGUgYXMgYW55LFxuICAgICAgICAgIGRhdGE6IGNvbmZsaWN0LmxvY2FsRGF0YSxcbiAgICAgICAgICBsb2NhbElkOiBjb25mbGljdC5sb2NhbERhdGEuaWRcbiAgICAgICAgfSlcbiAgICAgICAgYnJlYWtcbiAgICAgIFxuICAgICAgY2FzZSAnY2xvdWQnOlxuICAgICAgICAvLyDkvb/nlKjkupHnq6/mlbDmja7vvIzmm7TmlrDmnKzlnLBcbiAgICAgICAgLy8g6L+Z6YeM6ZyA6KaB5qC55o2u5YW35L2T6KGo57G75Z6L5aSE55CGXG4gICAgICAgIGJyZWFrXG4gICAgICBcbiAgICAgIGNhc2UgJ21lcmdlJzpcbiAgICAgICAgLy8g5ZCI5bm25pWw5o2u77yI6ZyA6KaB5YW35L2T5a6e546w77yJXG4gICAgICAgIGJyZWFrXG4gICAgfVxuXG4gICAgLy8g56e76Zmk5bey6Kej5Yaz55qE5Yay56qBXG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmNvbmZsaWN0cy5maW5kSW5kZXgoYyA9PiBjLmlkID09PSBjb25mbGljdElkKVxuICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICB0aGlzLmNvbmZsaWN0cy5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICB0aGlzLm5vdGlmeVN0YXR1c0NoYW5nZSgpXG4gICAgfVxuICB9XG59XG5cbi8vIOWvvOWHuuWNleS+i+WunuS+i1xuZXhwb3J0IGNvbnN0IGNsb3VkU3luY1NlcnZpY2UgPSBuZXcgQ2xvdWRTeW5jU2VydmljZSgpIl0sInZlcnNpb24iOjN9