f6cbafa0bc59d89ddd1a37dcae6084f9
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useFolders = useFolders;
const react_1 = require("react");
// Mock data for development
const mockFolders = [
    {
        id: 'folder-1',
        name: 'Development',
        color: '#3b82f6',
        icon: 'Code',
        cardIds: ['1'],
        isExpanded: true,
        createdAt: new Date('2024-01-10'),
        updatedAt: new Date('2024-01-15')
    },
    {
        id: 'folder-2',
        name: 'Design Resources',
        color: '#8b5cf6',
        icon: 'Palette',
        cardIds: [],
        isExpanded: false,
        createdAt: new Date('2024-01-12'),
        updatedAt: new Date('2024-01-12')
    },
    {
        id: 'folder-3',
        name: 'Learning Notes',
        color: '#10b981',
        icon: 'BookOpen',
        cardIds: ['2'],
        parentId: 'folder-1',
        isExpanded: true,
        createdAt: new Date('2024-01-14'),
        updatedAt: new Date('2024-01-16')
    }
];
function useFolders() {
    const [folders, setFolders] = (0, react_1.useState)(mockFolders);
    const [selectedFolderId, setSelectedFolderId] = (0, react_1.useState)(null);
    // Get folder tree structure
    const getFolderTree = (0, react_1.useCallback)(() => {
        const rootFolders = folders.filter(folder => !folder.parentId);
        const buildTree = (parentFolders) => {
            return parentFolders.map(folder => ({
                ...folder,
                children: buildTree(folders.filter(f => f.parentId === folder.id))
            }));
        };
        return buildTree(rootFolders);
    }, [folders]);
    // Folder actions
    const dispatch = (0, react_1.useCallback)((action) => {
        setFolders(prevFolders => {
            switch (action.type) {
                case 'CREATE_FOLDER':
                    const newFolder = {
                        ...action.payload,
                        id: `folder-${Date.now()}`,
                        cardIds: [],
                        createdAt: new Date(),
                        updatedAt: new Date()
                    };
                    return [...prevFolders, newFolder];
                case 'UPDATE_FOLDER':
                    return prevFolders.map(folder => folder.id === action.payload.id
                        ? { ...folder, ...action.payload.updates, updatedAt: new Date() }
                        : folder);
                case 'DELETE_FOLDER':
                    const folderToDelete = prevFolders.find(f => f.id === action.payload);
                    if (folderToDelete) {
                        // Get all child folders recursively
                        const getAllChildFolders = (parentId) => {
                            const children = prevFolders.filter(f => f.parentId === parentId);
                            const childIds = children.map(f => f.id);
                            const grandChildIds = children.flatMap(child => getAllChildFolders(child.id));
                            return [...childIds, ...grandChildIds];
                        };
                        const allChildFolderIds = getAllChildFolders(action.payload);
                        const allFoldersToDelete = [action.payload, ...allChildFolderIds];
                        // Get all card IDs from folders to be deleted
                        const allCardIdsToDelete = prevFolders
                            .filter(folder => allFoldersToDelete.includes(folder.id))
                            .flatMap(folder => folder.cardIds);
                        // Trigger card deletion through callback if provided
                        if ('onDeleteCards' in action && action.onDeleteCards && allCardIdsToDelete.length > 0) {
                            action.onDeleteCards(allCardIdsToDelete);
                        }
                        return prevFolders.filter(folder => !allFoldersToDelete.includes(folder.id));
                    }
                    return prevFolders.filter(folder => folder.id !== action.payload);
                case 'TOGGLE_FOLDER':
                    return prevFolders.map(folder => folder.id === action.payload
                        ? { ...folder, isExpanded: !folder.isExpanded, updatedAt: new Date() }
                        : folder);
                default:
                    return prevFolders;
            }
        });
    }, []);
    // Utility functions
    const getFolderById = (0, react_1.useCallback)((id) => {
        return folders.find(folder => folder.id === id);
    }, [folders]);
    const getFolderPath = (0, react_1.useCallback)((folderId) => {
        const path = [];
        let currentFolder = getFolderById(folderId);
        while (currentFolder) {
            path.unshift(currentFolder);
            currentFolder = currentFolder.parentId ? getFolderById(currentFolder.parentId) : null;
        }
        return path;
    }, [folders, getFolderById]);
    const addCardToFolder = (0, react_1.useCallback)((cardId, folderId) => {
        dispatch({
            type: 'UPDATE_FOLDER',
            payload: {
                id: folderId,
                updates: {
                    cardIds: [...(getFolderById(folderId)?.cardIds || []), cardId]
                }
            }
        });
    }, [dispatch, getFolderById]);
    const removeCardFromFolder = (0, react_1.useCallback)((cardId, folderId) => {
        const folder = getFolderById(folderId);
        if (folder) {
            dispatch({
                type: 'UPDATE_FOLDER',
                payload: {
                    id: folderId,
                    updates: {
                        cardIds: folder.cardIds.filter(id => id !== cardId)
                    }
                }
            });
        }
    }, [dispatch, getFolderById]);
    const moveCardBetweenFolders = (0, react_1.useCallback)((cardId, fromFolderId, toFolderId) => {
        if (fromFolderId) {
            removeCardFromFolder(cardId, fromFolderId);
        }
        if (toFolderId) {
            addCardToFolder(cardId, toFolderId);
        }
    }, [addCardToFolder, removeCardFromFolder]);
    const canMoveFolder = (0, react_1.useCallback)((folderId, targetParentId) => {
        // Can't move folder to itself or its descendants
        if (folderId === targetParentId)
            return false;
        let currentParent = targetParentId;
        while (currentParent) {
            if (currentParent === folderId)
                return false;
            const parentFolder = getFolderById(currentParent);
            currentParent = parentFolder?.parentId ?? null;
        }
        return true;
    }, [getFolderById]);
    // Auto-save to localStorage
    (0, react_1.useEffect)(() => {
        const saveTimer = setTimeout(() => {
            localStorage.setItem('cardall-folders', JSON.stringify(folders));
        }, 1000);
        return () => clearTimeout(saveTimer);
    }, [folders]);
    // Load from localStorage on mount
    (0, react_1.useEffect)(() => {
        const saved = localStorage.getItem('cardall-folders');
        if (saved) {
            try {
                const parsedFolders = JSON.parse(saved);
                setFolders(parsedFolders);
            }
            catch (error) {
                console.error('Failed to load saved folders:', error);
            }
        }
    }, []);
    return {
        folders,
        folderTree: getFolderTree(),
        selectedFolderId,
        setSelectedFolderId,
        dispatch,
        getFolderById,
        getFolderPath,
        addCardToFolder,
        removeCardFromFolder,
        moveCardBetweenFolders,
        canMoveFolder
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcaG9va3NcXHVzZS1mb2xkZXJzLnRzIiwibWFwcGluZ3MiOiI7O0FBc0NBLGdDQXNMQztBQTVORCxpQ0FBd0Q7QUFHeEQsNEJBQTRCO0FBQzVCLE1BQU0sV0FBVyxHQUFhO0lBQzVCO1FBQ0UsRUFBRSxFQUFFLFVBQVU7UUFDZCxJQUFJLEVBQUUsYUFBYTtRQUNuQixLQUFLLEVBQUUsU0FBUztRQUNoQixJQUFJLEVBQUUsTUFBTTtRQUNaLE9BQU8sRUFBRSxDQUFDLEdBQUcsQ0FBQztRQUNkLFVBQVUsRUFBRSxJQUFJO1FBQ2hCLFNBQVMsRUFBRSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDakMsU0FBUyxFQUFFLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQztLQUNsQztJQUNEO1FBQ0UsRUFBRSxFQUFFLFVBQVU7UUFDZCxJQUFJLEVBQUUsa0JBQWtCO1FBQ3hCLEtBQUssRUFBRSxTQUFTO1FBQ2hCLElBQUksRUFBRSxTQUFTO1FBQ2YsT0FBTyxFQUFFLEVBQUU7UUFDWCxVQUFVLEVBQUUsS0FBSztRQUNqQixTQUFTLEVBQUUsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDO1FBQ2pDLFNBQVMsRUFBRSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUM7S0FDbEM7SUFDRDtRQUNFLEVBQUUsRUFBRSxVQUFVO1FBQ2QsSUFBSSxFQUFFLGdCQUFnQjtRQUN0QixLQUFLLEVBQUUsU0FBUztRQUNoQixJQUFJLEVBQUUsVUFBVTtRQUNoQixPQUFPLEVBQUUsQ0FBQyxHQUFHLENBQUM7UUFDZCxRQUFRLEVBQUUsVUFBVTtRQUNwQixVQUFVLEVBQUUsSUFBSTtRQUNoQixTQUFTLEVBQUUsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDO1FBQ2pDLFNBQVMsRUFBRSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUM7S0FDbEM7Q0FDRixDQUFBO0FBRUQsU0FBZ0IsVUFBVTtJQUN4QixNQUFNLENBQUMsT0FBTyxF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QU8sQ0FBQyxLQUFLLENBQUMsK0JBQStCLEVBQUUsS0FBSyxDQUFDLENBQUE7WUFDdkQsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUE7SUFFTixPQUFPO1FBQ0wsT0FBTztRQUNQLFVBQVUsRUFBRSxhQUFhLEVBQUU7UUFDM0IsZ0JBQWdCO1FBQ2hCLG1CQUFtQjtRQUNuQixRQUFRO1FBQ1IsYUFBYTtRQUNiLGFBQWE7UUFDYixlQUFlO1FBQ2Ysb0JBQW9CO1FBQ3BCLHNCQUFzQjtRQUN0QixhQUFhO0tBQ2QsQ0FBQTtBQUNILENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRDpcXFByb2plY3RzXFxDYXJkRXZlcnl0aGluZ1xcY2FyZGFsbC1wcm90b3R5cGVcXHNyY1xcaG9va3NcXHVzZS1mb2xkZXJzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VDYWxsYmFjaywgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnXHJcbmltcG9ydCB7IEZvbGRlciwgRm9sZGVyQWN0aW9uIH0gZnJvbSAnQC90eXBlcy9jYXJkJ1xyXG5cclxuLy8gTW9jayBkYXRhIGZvciBkZXZlbG9wbWVudFxyXG5jb25zdCBtb2NrRm9sZGVyczogRm9sZGVyW10gPSBbXHJcbiAge1xyXG4gICAgaWQ6ICdmb2xkZXItMScsXHJcbiAgICBuYW1lOiAnRGV2ZWxvcG1lbnQnLFxyXG4gICAgY29sb3I6ICcjM2I4MmY2JyxcclxuICAgIGljb246ICdDb2RlJyxcclxuICAgIGNhcmRJZHM6IFsnMSddLFxyXG4gICAgaXNFeHBhbmRlZDogdHJ1ZSxcclxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTAnKSxcclxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTUnKVxyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdmb2xkZXItMicsXHJcbiAgICBuYW1lOiAnRGVzaWduIFJlc291cmNlcycsXHJcbiAgICBjb2xvcjogJyM4YjVjZjYnLFxyXG4gICAgaWNvbjogJ1BhbGV0dGUnLFxyXG4gICAgY2FyZElkczogW10sXHJcbiAgICBpc0V4cGFuZGVkOiBmYWxzZSxcclxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTInKSxcclxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTInKVxyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdmb2xkZXItMycsXHJcbiAgICBuYW1lOiAnTGVhcm5pbmcgTm90ZXMnLFxyXG4gICAgY29sb3I6ICcjMTBiOTgxJyxcclxuICAgIGljb246ICdCb29rT3BlbicsXHJcbiAgICBjYXJkSWRzOiBbJzInXSxcclxuICAgIHBhcmVudElkOiAnZm9sZGVyLTEnLFxyXG4gICAgaXNFeHBhbmRlZDogdHJ1ZSxcclxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTQnKSxcclxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoJzIwMjQtMDEtMTYnKVxyXG4gIH1cclxuXVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVzZUZvbGRlcnMoKSB7XHJcbiAgY29uc3QgW2ZvbGRlcnMsIHNldEZvbGRlcnNdID0gdXNlU3RhdGU8Rm9sZGVyW10+KG1vY2tGb2xkZXJzKVxyXG4gIGNvbnN0IFtzZWxlY3RlZEZvbGRlcklkLCBzZXRTZWxlY3RlZEZvbGRlcklkXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpXHJcblxyXG4gIC8vIEdldCBmb2xkZXIgdHJlZSBzdHJ1Y3R1cmVcclxuICBjb25zdCBnZXRGb2xkZXJUcmVlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgY29uc3Qgcm9vdEZvbGRlcnMgPSBmb2xkZXJzLmZpbHRlcihmb2xkZXIgPT4gIWZvbGRlci5wYXJlbnRJZClcclxuICAgIFxyXG4gICAgY29uc3QgYnVpbGRUcmVlID0gKHBhcmVudEZvbGRlcnM6IEZvbGRlcltdKTogKEZvbGRlciAmIHsgY2hpbGRyZW46IEZvbGRlcltdIH0pW10gPT4ge1xyXG4gICAgICByZXR1cm4gcGFyZW50Rm9sZGVycy5tYXAoZm9sZGVyID0+ICh7XHJcbiAgICAgICAgLi4uZm9sZGVyLFxyXG4gICAgICAgIGNoaWxkcmVuOiBidWlsZFRyZWUoZm9sZGVycy5maWx0ZXIoZiA9PiBmLnBhcmVudElkID09PSBmb2xkZXIuaWQpKVxyXG4gICAgICB9KSlcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYnVpbGRUcmVlKHJvb3RGb2xkZXJzKVxyXG4gIH0sIFtmb2xkZXJzXSlcclxuXHJcbiAgLy8gRm9sZGVyIGFjdGlvbnNcclxuICBjb25zdCBkaXNwYXRjaCA9IHVzZUNhbGxiYWNrKChhY3Rpb246IEZvbGRlckFjdGlvbikgPT4ge1xyXG4gICAgc2V0Rm9sZGVycyhwcmV2Rm9sZGVycyA9PiB7XHJcbiAgICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcclxuICAgICAgICBjYXNlICdDUkVBVEVfRk9MREVSJzpcclxuICAgICAgICAgIGNvbnN0IG5ld0ZvbGRlcjogRm9sZGVyID0ge1xyXG4gICAgICAgICAgICAuLi5hY3Rpb24ucGF5bG9hZCxcclxuICAgICAgICAgICAgaWQ6IGBmb2xkZXItJHtEYXRlLm5vdygpfWAsXHJcbiAgICAgICAgICAgIGNhcmRJZHM6IFtdLFxyXG4gICAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIFsuLi5wcmV2Rm9sZGVycywgbmV3Rm9sZGVyXVxyXG5cclxuICAgICAgICBjYXNlICdVUERBVEVfRk9MREVSJzpcclxuICAgICAgICAgIHJldHVybiBwcmV2Rm9sZGVycy5tYXAoZm9sZGVyID0+XHJcbiAgICAgICAgICAgIGZvbGRlci5pZCA9PT0gYWN0aW9uLnBheWxvYWQuaWRcclxuICAgICAgICAgICAgICA/IHsgLi4uZm9sZGVyLCAuLi5hY3Rpb24ucGF5bG9hZC51cGRhdGVzLCB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkgfVxyXG4gICAgICAgICAgICAgIDogZm9sZGVyXHJcbiAgICAgICAgICApXHJcblxyXG4gICAgICAgIGNhc2UgJ0RFTEVURV9GT0xERVInOlxyXG4gICAgICAgICAgY29uc3QgZm9sZGVyVG9EZWxldGUgPSBwcmV2Rm9sZGVycy5maW5kKGYgPT4gZi5pZCA9PT0gYWN0aW9uLnBheWxvYWQpXHJcbiAgICAgICAgICBpZiAoZm9sZGVyVG9EZWxldGUpIHtcclxuICAgICAgICAgICAgLy8gR2V0IGFsbCBjaGlsZCBmb2xkZXJzIHJlY3Vyc2l2ZWx5XHJcbiAgICAgICAgICAgIGNvbnN0IGdldEFsbENoaWxkRm9sZGVycyA9IChwYXJlbnRJZDogc3RyaW5nKTogc3RyaW5nW10gPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gcHJldkZvbGRlcnMuZmlsdGVyKGYgPT4gZi5wYXJlbnRJZCA9PT0gcGFyZW50SWQpXHJcbiAgICAgICAgICAgICAgY29uc3QgY2hpbGRJZHMgPSBjaGlsZHJlbi5tYXAoZiA9PiBmLmlkKVxyXG4gICAgICAgICAgICAgIGNvbnN0IGdyYW5kQ2hpbGRJZHMgPSBjaGlsZHJlbi5mbGF0TWFwKGNoaWxkID0+IGdldEFsbENoaWxkRm9sZGVycyhjaGlsZC5pZCkpXHJcbiAgICAgICAgICAgICAgcmV0dXJuIFsuLi5jaGlsZElkcywgLi4uZ3JhbmRDaGlsZElkc11cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgYWxsQ2hpbGRGb2xkZXJJZHMgPSBnZXRBbGxDaGlsZEZvbGRlcnMoYWN0aW9uLnBheWxvYWQpXHJcbiAgICAgICAgICAgIGNvbnN0IGFsbEZvbGRlcnNUb0RlbGV0ZSA9IFthY3Rpb24ucGF5bG9hZCwgLi4uYWxsQ2hpbGRGb2xkZXJJZHNdXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBHZXQgYWxsIGNhcmQgSURzIGZyb20gZm9sZGVycyB0byBiZSBkZWxldGVkXHJcbiAgICAgICAgICAgIGNvbnN0IGFsbENhcmRJZHNUb0RlbGV0ZSA9IHByZXZGb2xkZXJzXHJcbiAgICAgICAgICAgICAgLmZpbHRlcihmb2xkZXIgPT4gYWxsRm9sZGVyc1RvRGVsZXRlLmluY2x1ZGVzKGZvbGRlci5pZCkpXHJcbiAgICAgICAgICAgICAgLmZsYXRNYXAoZm9sZGVyID0+IGZvbGRlci5jYXJkSWRzKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVHJpZ2dlciBjYXJkIGRlbGV0aW9uIHRocm91Z2ggY2FsbGJhY2sgaWYgcHJvdmlkZWRcclxuICAgICAgICAgICAgaWYgKCdvbkRlbGV0ZUNhcmRzJyBpbiBhY3Rpb24gJiYgYWN0aW9uLm9uRGVsZXRlQ2FyZHMgJiYgYWxsQ2FyZElkc1RvRGVsZXRlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICBhY3Rpb24ub25EZWxldGVDYXJkcyhhbGxDYXJkSWRzVG9EZWxldGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBwcmV2Rm9sZGVycy5maWx0ZXIoZm9sZGVyID0+ICFhbGxGb2xkZXJzVG9EZWxldGUuaW5jbHVkZXMoZm9sZGVyLmlkKSlcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBwcmV2Rm9sZGVycy5maWx0ZXIoZm9sZGVyID0+IGZvbGRlci5pZCAhPT0gYWN0aW9uLnBheWxvYWQpXHJcblxyXG4gICAgICAgIGNhc2UgJ1RPR0dMRV9GT0xERVInOlxyXG4gICAgICAgICAgcmV0dXJuIHByZXZGb2xkZXJzLm1hcChmb2xkZXIgPT5cclxuICAgICAgICAgICAgZm9sZGVyLmlkID09PSBhY3Rpb24ucGF5bG9hZFxyXG4gICAgICAgICAgICAgID8geyAuLi5mb2xkZXIsIGlzRXhwYW5kZWQ6ICFmb2xkZXIuaXNFeHBhbmRlZCwgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpIH1cclxuICAgICAgICAgICAgICA6IGZvbGRlclxyXG4gICAgICAgICAgKVxyXG5cclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgcmV0dXJuIHByZXZGb2xkZXJzXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfSwgW10pXHJcblxyXG4gIC8vIFV0aWxpdHkgZnVuY3Rpb25zXHJcbiAgY29uc3QgZ2V0Rm9sZGVyQnlJZCA9IHVzZUNhbGxiYWNrKChpZDogc3RyaW5nKSA9PiB7XHJcbiAgICByZXR1cm4gZm9sZGVycy5maW5kKGZvbGRlciA9PiBmb2xkZXIuaWQgPT09IGlkKVxyXG4gIH0sIFtmb2xkZXJzXSlcclxuXHJcbiAgY29uc3QgZ2V0Rm9sZGVyUGF0aCA9IHVzZUNhbGxiYWNrKChmb2xkZXJJZDogc3RyaW5nKTogRm9sZGVyW10gPT4ge1xyXG4gICAgY29uc3QgcGF0aDogRm9sZGVyW10gPSBbXVxyXG4gICAgbGV0IGN1cnJlbnRGb2xkZXIgPSBnZXRGb2xkZXJCeUlkKGZvbGRlcklkKVxyXG4gICAgXHJcbiAgICB3aGlsZSAoY3VycmVudEZvbGRlcikge1xyXG4gICAgICBwYXRoLnVuc2hpZnQoY3VycmVudEZvbGRlcilcclxuICAgICAgY3VycmVudEZvbGRlciA9IGN1cnJlbnRGb2xkZXIucGFyZW50SWQgPyBnZXRGb2xkZXJCeUlkKGN1cnJlbnRGb2xkZXIucGFyZW50SWQpIDogbnVsbFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gcGF0aFxyXG4gIH0sIFtmb2xkZXJzLCBnZXRGb2xkZXJCeUlkXSlcclxuXHJcbiAgY29uc3QgYWRkQ2FyZFRvRm9sZGVyID0gdXNlQ2FsbGJhY2soKGNhcmRJZDogc3RyaW5nLCBmb2xkZXJJZDogc3RyaW5nKSA9PiB7XHJcbiAgICBkaXNwYXRjaCh7XHJcbiAgICAgIHR5cGU6ICdVUERBVEVfRk9MREVSJyxcclxuICAgICAgcGF5bG9hZDoge1xyXG4gICAgICAgIGlkOiBmb2xkZXJJZCxcclxuICAgICAgICB1cGRhdGVzOiB7XHJcbiAgICAgICAgICBjYXJkSWRzOiBbLi4uKGdldEZvbGRlckJ5SWQoZm9sZGVySWQpPy5jYXJkSWRzIHx8IFtdKSwgY2FyZElkXVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9LCBbZGlzcGF0Y2gsIGdldEZvbGRlckJ5SWRdKVxyXG5cclxuICBjb25zdCByZW1vdmVDYXJkRnJvbUZvbGRlciA9IHVzZUNhbGxiYWNrKChjYXJkSWQ6IHN0cmluZywgZm9sZGVySWQ6IHN0cmluZykgPT4ge1xyXG4gICAgY29uc3QgZm9sZGVyID0gZ2V0Rm9sZGVyQnlJZChmb2xkZXJJZClcclxuICAgIGlmIChmb2xkZXIpIHtcclxuICAgICAgZGlzcGF0Y2goe1xyXG4gICAgICAgIHR5cGU6ICdVUERBVEVfRk9MREVSJyxcclxuICAgICAgICBwYXlsb2FkOiB7XHJcbiAgICAgICAgICBpZDogZm9sZGVySWQsXHJcbiAgICAgICAgICB1cGRhdGVzOiB7XHJcbiAgICAgICAgICAgIGNhcmRJZHM6IGZvbGRlci5jYXJkSWRzLmZpbHRlcihpZCA9PiBpZCAhPT0gY2FyZElkKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuICB9LCBbZGlzcGF0Y2gsIGdldEZvbGRlckJ5SWRdKVxyXG5cclxuICBjb25zdCBtb3ZlQ2FyZEJldHdlZW5Gb2xkZXJzID0gdXNlQ2FsbGJhY2soKGNhcmRJZDogc3RyaW5nLCBmcm9tRm9sZGVySWQ6IHN0cmluZyB8IG51bGwsIHRvRm9sZGVySWQ6IHN0cmluZyB8IG51bGwpID0+IHtcclxuICAgIGlmIChmcm9tRm9sZGVySWQpIHtcclxuICAgICAgcmVtb3ZlQ2FyZEZyb21Gb2xkZXIoY2FyZElkLCBmcm9tRm9sZGVySWQpXHJcbiAgICB9XHJcbiAgICBpZiAodG9Gb2xkZXJJZCkge1xyXG4gICAgICBhZGRDYXJkVG9Gb2xkZXIoY2FyZElkLCB0b0ZvbGRlcklkKVxyXG4gICAgfVxyXG4gIH0sIFthZGRDYXJkVG9Gb2xkZXIsIHJlbW92ZUNhcmRGcm9tRm9sZGVyXSlcclxuXHJcbiAgY29uc3QgY2FuTW92ZUZvbGRlciA9IHVzZUNhbGxiYWNrKChmb2xkZXJJZDogc3RyaW5nLCB0YXJnZXRQYXJlbnRJZDogc3RyaW5nIHwgbnVsbCk6IGJvb2xlYW4gPT4ge1xyXG4gICAgLy8gQ2FuJ3QgbW92ZSBmb2xkZXIgdG8gaXRzZWxmIG9yIGl0cyBkZXNjZW5kYW50c1xyXG4gICAgaWYgKGZvbGRlcklkID09PSB0YXJnZXRQYXJlbnRJZCkgcmV0dXJuIGZhbHNlXHJcbiAgICBcclxuICAgIGxldCBjdXJyZW50UGFyZW50ID0gdGFyZ2V0UGFyZW50SWRcclxuICAgIHdoaWxlIChjdXJyZW50UGFyZW50KSB7XHJcbiAgICAgIGlmIChjdXJyZW50UGFyZW50ID09PSBmb2xkZXJJZCkgcmV0dXJuIGZhbHNlXHJcbiAgICAgIGNvbnN0IHBhcmVudEZvbGRlciA9IGdldEZvbGRlckJ5SWQoY3VycmVudFBhcmVudClcclxuICAgICAgY3VycmVudFBhcmVudCA9IHBhcmVudEZvbGRlcj8ucGFyZW50SWQgPz8gbnVsbFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gdHJ1ZVxyXG4gIH0sIFtnZXRGb2xkZXJCeUlkXSlcclxuXHJcbiAgLy8gQXV0by1zYXZlIHRvIGxvY2FsU3RvcmFnZVxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBjb25zdCBzYXZlVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcmRhbGwtZm9sZGVycycsIEpTT04uc3RyaW5naWZ5KGZvbGRlcnMpKVxyXG4gICAgfSwgMTAwMClcclxuXHJcbiAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KHNhdmVUaW1lcilcclxuICB9LCBbZm9sZGVyc10pXHJcblxyXG4gIC8vIExvYWQgZnJvbSBsb2NhbFN0b3JhZ2Ugb24gbW91bnRcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgY29uc3Qgc2F2ZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2FyZGFsbC1mb2xkZXJzJylcclxuICAgIGlmIChzYXZlZCkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHBhcnNlZEZvbGRlcnMgPSBKU09OLnBhcnNlKHNhdmVkKVxyXG4gICAgICAgIHNldEZvbGRlcnMocGFyc2VkRm9sZGVycylcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBzYXZlZCBmb2xkZXJzOicsIGVycm9yKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSwgW10pXHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBmb2xkZXJzLFxyXG4gICAgZm9sZGVyVHJlZTogZ2V0Rm9sZGVyVHJlZSgpLFxyXG4gICAgc2VsZWN0ZWRGb2xkZXJJZCxcclxuICAgIHNldFNlbGVjdGVkRm9sZGVySWQsXHJcbiAgICBkaXNwYXRjaCxcclxuICAgIGdldEZvbGRlckJ5SWQsXHJcbiAgICBnZXRGb2xkZXJQYXRoLFxyXG4gICAgYWRkQ2FyZFRvRm9sZGVyLFxyXG4gICAgcmVtb3ZlQ2FyZEZyb21Gb2xkZXIsXHJcbiAgICBtb3ZlQ2FyZEJldHdlZW5Gb2xkZXJzLFxyXG4gICAgY2FuTW92ZUZvbGRlclxyXG4gIH1cclxufSJdLCJ2ZXJzaW9uIjozfQ==