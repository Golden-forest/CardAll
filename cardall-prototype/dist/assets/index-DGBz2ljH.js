import{j as e,S as or,a as Xs,b as Js,P as ir,C as Qs,I as Zs,c as ea,d as ta,R as sa,L as aa,e as na,f as lr,T as cr,g as ra,V as dr,h as mr,i as oa,k as ur,O as ia,l as fr,m as la,n as hr,o as ca,D as da,p as gr,q as ma,r as pr,s as xr,t as yr,u as ua,v as fa,w as br,x as ha,y as wr,z as vr,A as ga,B as pa,F as xa,E as ya,G as ba,H as jr,J as wa,K as va,M as ja,N as Na,Q as Ca,U as Sa,W as ka,X as Nr,Y as Cr,Z as Ta,_ as Sr,$ as Ea,a0 as Ra,a1 as kr,a2 as Da,a3 as Tr,a4 as Aa,a5 as _a,a6 as Er,a7 as Rr,a8 as Pa,a9 as Dr,aa as Ar,ab as Fa,ac as _r,ad as Ia,ae as Ma,af as La,ag as za,ah as Oa,ai as Pr,aj as $a,ak as Fr,al as Ua,am as Ba,an as Va,ao as Ir}from"./radix-w2nuJgPN.js";import{a as Ot,r as l,R as L,v as Mr}from"./vendor-DBpFvjuy.js";import{u as ae,a as Oe,c as Lr}from"./sync-CNPALQtE.js";import{t as zr,c as Or,a as $t}from"./utils--BulIq_u.js";import{C as Ut,a as Fe,b as Wa,S as $r,I as Ha,X as Be,c as Ur,E as Br,P as Vr,d as Wr,e as ds,f as Hr,g as Ga,T as Ya,F as Ka,h as ys,i as _e,H as Rs,j as Ze,D as et,k as Ds,l as qa,m as ms,n as bs,o as Gr,p as Yr,B as Kr,q as qr,r as Xr,Z as Xa,s as Jr,L as Qr,t as Zr,u as ye,v as xe,w as Ft,x as As,R as ve,y as Ja,z as eo,A as to,G as wt,J as vt,K as jt,W as ws,M as Bt,N as so,O as ao,Q as no,U as Lt,V as us,Y as ro,_ as _s,$ as oo,a0 as io,a1 as lo,a2 as co,a3 as ht,a4 as mo,a5 as gt,a6 as Ps,a7 as as,a8 as ns,a9 as uo,aa as fo}from"./icons-DKLFDR3M.js";import{u as ho,i as go,M as po,a as xo,b as yo,c as bo,d as wo,e as vo,f as jo,g as No,h as Co,j as So,E as ko}from"./editor-yCnBQ_u8.js";import"./supabase-BJjf9Ixn.js";import"./database-CD-G83dI.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();var fs={},Fs=Ot;fs.createRoot=Fs.createRoot,fs.hydrateRoot=Fs.hydrateRoot;class pt{static PREFIX="cardall_";static VERSION="1.0";static setItem(s,a,n={}){try{const r=this.PREFIX+s,o={version:this.VERSION,timestamp:Date.now(),data:a,meta:{ttl:n.ttl,encrypted:n.encrypt||!1,compressed:n.compress||!1}};if(n.validate){const c=this.validateData(a);if(!c.isValid)return console.warn("Storage validation failed:",c.errors),!1}let i;try{i=this.serializeData(o)}catch(c){return console.error("Data serialization failed:",c),!1}return n.encrypt&&(i=this.encryptData(i)),n.compress&&(i=this.compressData(i)),localStorage.setItem(r,i),!0}catch(r){return console.error("Failed to store data securely:",r),!1}}static getItem(s,a={}){try{const n=this.PREFIX+s,r=localStorage.getItem(n);if(!r)return null;let o=r;a.compress&&(o=this.decompressData(o)),a.encrypt&&(o=this.decryptData(o));const i=this.deserializeData(o);if(i.version!==this.VERSION)return console.warn("Storage data version mismatch"),null;if(i.meta.ttl&&Date.now()-i.timestamp>i.meta.ttl)return console.log("Storage data expired, removing"),this.removeItem(s),null;if(a.validate){const c=this.validateData(i.data);if(!c.isValid)return console.warn("Retrieved data validation failed:",c.errors),null}return i.data}catch(n){return console.error("Failed to retrieve data securely:",n),null}}static removeItem(s){try{const a=this.PREFIX+s;localStorage.removeItem(a)}catch(a){console.error("Failed to remove storage item:",a)}}static clearAppData(){try{Object.keys(localStorage).forEach(a=>{a.startsWith(this.PREFIX)&&localStorage.removeItem(a)})}catch(s){console.error("Failed to clear app data:",s)}}static validateData(s){const a={isValid:!0,errors:[],warnings:[],sanitized:s};return s==null?a:this.hasPrototypePollution(s)?(a.isValid=!1,a.errors.push("Potential prototype pollution detected"),a):(this.hasCircularReference(s)&&(a.warnings.push("Circular reference detected in data"),a.sanitized=this.removeCircularReferences(s)),this.hasDangerousFunctions(s)?(a.isValid=!1,a.errors.push("Dangerous functions detected in data"),a):(this.estimateDataSize(s)>5*1024*1024&&a.warnings.push("Large data size may impact performance"),a))}static hasPrototypePollution(s){if(typeof s!="object"||s===null)return!1;const a=s;return["__proto__","constructor","prototype"].some(r=>r in a)}static hasCircularReference(s,a=new WeakSet){return typeof s!="object"||s===null?!1:a.has(s)?!0:(a.add(s),Array.isArray(s)?s.some(n=>this.hasCircularReference(n,a)):Object.values(s).some(n=>typeof n=="object"&&this.hasCircularReference(n,a)))}static removeCircularReferences(s,a=new WeakSet){if(typeof s!="object"||s===null)return s;if(a.has(s))return"[Circular]";if(a.add(s),Array.isArray(s))return s.map(r=>this.removeCircularReferences(r,a));const n={};for(const[r,o]of Object.entries(s))n[r]=this.removeCircularReferences(o,a);return n}static hasDangerousFunctions(s){if(typeof s!="object"||s===null)return!1;const a=s;if(Object.values(a).some(o=>typeof o=="function"))return!0;const n=["eval","Function","setTimeout","setInterval","document","window","global","process"],r=JSON.stringify(a).toLowerCase();return n.some(o=>r.includes(o.toLowerCase()))}static estimateDataSize(s){return new Blob([JSON.stringify(s)]).size}static serializeData(s){return JSON.stringify(s,(n,r)=>{if(typeof r!="function")return r===void 0?null:r instanceof Date?{__type:"Date",value:r.toISOString()}:r instanceof RegExp?{__type:"RegExp",value:r.toString()}:r})}static deserializeData(s){return JSON.parse(s,(n,r)=>{if(typeof r=="object"&&r!==null){const o=r;if(o.__type==="Date"&&typeof o.value=="string")return new Date(o.value);if(o.__type==="RegExp"&&typeof o.value=="string"){const i=o.value.match(/^\/(.*)\/([gim]*)$/);if(i)return new RegExp(i[1],i[2])}}return r})}static encryptData(s){const a="cardall-secure-key";let n="";for(let r=0;r<s.length;r++){const o=s.charCodeAt(r)^a.charCodeAt(r%a.length);n+=String.fromCharCode(o)}return btoa(n)}static decryptData(s){const a="cardall-secure-key",n=atob(s);let r="";for(let o=0;o<n.length;o++){const i=n.charCodeAt(o)^a.charCodeAt(o%a.length);r+=String.fromCharCode(i)}return r}static compressData(s){return s}static decompressData(s){return s}static getStorageStats(){try{const a=Object.keys(localStorage).filter(o=>o.startsWith(this.PREFIX));let n=0;const r=[];return a.forEach(o=>{const i=localStorage.getItem(o);if(i){const c=new Blob([i]).size;n+=c,r.push({key:o.replace(this.PREFIX,""),size:c,lastModified:Date.now()})}}),{totalSize:n,itemCount:a.length,items:r}}catch(s){return console.error("Failed to get storage stats:",s),{totalSize:0,itemCount:0,items:[]}}}}const Ae={set:(t,s,a)=>pt.setItem(t,s,a),get:(t,s)=>pt.getItem(t,s),remove:t=>pt.removeItem(t),clear:()=>pt.clearAppData(),getStats:()=>pt.getStorageStats()},To=[{id:"1",frontContent:{title:"React Best Practices",text:"Key principles for writing maintainable React code including component composition, state management, and performance optimization.",images:[],tags:["react","frontend","best-practices"],lastModified:new Date},backContent:{title:"Implementation Details",text:"Use functional components with hooks, implement proper error boundaries, optimize with React.memo and useMemo for expensive calculations.",images:[],tags:["react","frontend","best-practices"],lastModified:new Date},style:{type:"solid",backgroundColor:"#f8fafc",fontFamily:"system-ui",fontSize:"base",fontWeight:"normal",textColor:"#1f2937",borderRadius:"xl",shadow:"md",borderWidth:0},isFlipped:!1,createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15")},{id:"2",frontContent:{title:"TypeScript Tips",text:"Advanced TypeScript patterns for better type safety and developer experience in large applications.",images:[],tags:["typescript","types","development"],lastModified:new Date},backContent:{title:"Advanced Patterns",text:"Utility types, conditional types, mapped types, and template literal types for complex type transformations.",images:[],tags:["typescript","types","development"],lastModified:new Date},style:{type:"gradient",gradientColors:["#667eea","#764ba2"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"xl",shadow:"lg",borderWidth:0},isFlipped:!1,createdAt:new Date("2024-01-16"),updatedAt:new Date("2024-01-16")}];function Eo(){const[t,s]=l.useState(To),[a,n]=l.useState({searchTerm:"",tags:[]}),[r,o]=l.useState({layout:"grid",cardSize:"medium",showTags:!0,showDates:!1,sortBy:"updated",sortOrder:"desc"}),[i,c]=l.useState([]),u=l.useCallback(()=>{const y=t.filter(g=>{if(a.searchTerm){const x=a.searchTerm.toLowerCase(),p=g.frontContent.title.toLowerCase().includes(x)||g.backContent.title.toLowerCase().includes(x),j=g.frontContent.text.toLowerCase().includes(x)||g.backContent.text.toLowerCase().includes(x),C=[...g.frontContent.tags,...g.backContent.tags].some(F=>F.toLowerCase().includes(x));if(!p&&!j&&!C)return!1}if(a.tags.length>0){const x=[...g.frontContent.tags,...g.backContent.tags];if(!a.tags.some(p=>x.includes(p)))return!1}if(a.folderId&&g.folderId!==a.folderId)return!1;if(a.dateRange){const x=new Date(g.updatedAt);if(x<a.dateRange.start||x>a.dateRange.end)return!1}return!(a.styleType&&g.style.type!==a.styleType||a.hasImages!==void 0&&(g.frontContent.images.length>0||g.backContent.images.length>0)!==a.hasImages)});return y.sort((g,x)=>{let p=0;switch(r.sortBy){case"created":p=new Date(g.createdAt).getTime()-new Date(x.createdAt).getTime();break;case"updated":p=new Date(g.updatedAt).getTime()-new Date(x.updatedAt).getTime();break;case"title":p=g.frontContent.title.localeCompare(x.frontContent.title);break;default:p=0}return r.sortOrder==="desc"?-p:p}),y},[t,a,r]),f=l.useCallback(y=>{s(g=>{switch(y.type){case"CREATE_CARD":const x={...y.payload,id:Date.now().toString(),createdAt:new Date,updatedAt:new Date};return[...g,x];case"UPDATE_CARD":return g.map(C=>C.id===y.payload.id?{...C,...y.payload.updates,updatedAt:new Date}:C);case"DELETE_CARD":return g.filter(C=>C.id!==y.payload);case"FLIP_CARD":return g.map(C=>C.id===y.payload?{...C,isFlipped:!C.isFlipped,updatedAt:new Date}:C);case"SELECT_CARD":return c(C=>C.includes(y.payload)?C.filter(F=>F!==y.payload):[...C,y.payload]),g;case"DESELECT_ALL":return c([]),g;case"DUPLICATE_CARD":const p=g.find(C=>C.id===y.payload);if(!p)return g;const j={...p,id:Date.now().toString(),createdAt:new Date,updatedAt:new Date};return[...g,j];case"MOVE_TO_FOLDER":return g.map(C=>C.id===y.payload.cardId?{...C,folderId:y.payload.folderId,updatedAt:new Date}:C);default:return g}})},[]),m=l.useCallback(y=>t.find(g=>g.id===y),[t]),b=l.useCallback(()=>t.filter(y=>i.includes(y.id)),[t,i]),h=l.useCallback(()=>{const y=new Set;return t.forEach(g=>{g.frontContent.tags.forEach(x=>y.add(x)),g.backContent.tags.forEach(x=>y.add(x))}),Array.from(y).sort()},[t]),d=l.useCallback((y,g)=>{s(x=>x.map(p=>{const j=A=>g?A.map(v=>v===y?g:v):A.filter(v=>v!==y),C=j(p.frontContent.tags),F=j(p.backContent.tags);return JSON.stringify(C)!==JSON.stringify(p.frontContent.tags)||JSON.stringify(F)!==JSON.stringify(p.backContent.tags)?{...p,frontContent:{...p.frontContent,tags:C,lastModified:new Date},backContent:{...p.backContent,tags:F,lastModified:new Date},updatedAt:new Date}:p}))},[]),w=l.useCallback(y=>t.filter(g=>g.frontContent.tags.includes(y)||g.backContent.tags.includes(y)),[t]);return l.useEffect(()=>{const y=setTimeout(()=>{Ae.set("cards",t,{validate:!0,encrypt:!0})},1e3);return()=>clearTimeout(y)},[t]),l.useEffect(()=>{const y=Ae.get("cards",{validate:!0,encrypt:!0});y&&s(y)},[]),{cards:u(),allCards:t,filter:a,setFilter:n,viewSettings:r,setViewSettings:o,selectedCardIds:i,dispatch:f,getCardById:m,getSelectedCards:b,getAllTags:h,updateTagsInAllCards:d,getCardsWithTag:w}}const Ro=[{id:"folder-1",name:"Development",color:"#3b82f6",icon:"Code",cardIds:["1"],isExpanded:!0,createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-15")},{id:"folder-2",name:"Design Resources",color:"#8b5cf6",icon:"Palette",cardIds:[],isExpanded:!1,createdAt:new Date("2024-01-12"),updatedAt:new Date("2024-01-12")},{id:"folder-3",name:"Learning Notes",color:"#10b981",icon:"BookOpen",cardIds:["2"],parentId:"folder-1",isExpanded:!0,createdAt:new Date("2024-01-14"),updatedAt:new Date("2024-01-16")}];function Do(){const[t,s]=l.useState(Ro),[a,n]=l.useState(null),r=l.useCallback(()=>{const h=t.filter(w=>!w.parentId),d=w=>w.map(y=>({...y,children:d(t.filter(g=>g.parentId===y.id))}));return d(h)},[t]),o=l.useCallback(h=>{s(d=>{switch(h.type){case"CREATE_FOLDER":const w={...h.payload,id:`folder-${Date.now()}`,cardIds:[],createdAt:new Date,updatedAt:new Date};return[...d,w];case"UPDATE_FOLDER":return d.map(g=>g.id===h.payload.id?{...g,...h.payload.updates,updatedAt:new Date}:g);case"DELETE_FOLDER":if(d.find(g=>g.id===h.payload)){const g=C=>{const F=d.filter(N=>N.parentId===C),A=F.map(N=>N.id),v=F.flatMap(N=>g(N.id));return[...A,...v]},x=g(h.payload),p=[h.payload,...x],j=d.filter(C=>p.includes(C.id)).flatMap(C=>C.cardIds);return"onDeleteCards"in h&&h.onDeleteCards&&j.length>0&&h.onDeleteCards(j),d.filter(C=>!p.includes(C.id))}return d.filter(g=>g.id!==h.payload);case"TOGGLE_FOLDER":return d.map(g=>g.id===h.payload?{...g,isExpanded:!g.isExpanded,updatedAt:new Date}:g);default:return d}})},[]),i=l.useCallback(h=>t.find(d=>d.id===h),[t]),c=l.useCallback(h=>{const d=[];let w=i(h);for(;w;)d.unshift(w),w=w.parentId?i(w.parentId):null;return d},[t,i]),u=l.useCallback((h,d)=>{o({type:"UPDATE_FOLDER",payload:{id:d,updates:{cardIds:[...i(d)?.cardIds||[],h]}}})},[o,i]),f=l.useCallback((h,d)=>{const w=i(d);w&&o({type:"UPDATE_FOLDER",payload:{id:d,updates:{cardIds:w.cardIds.filter(y=>y!==h)}}})},[o,i]),m=l.useCallback((h,d,w)=>{d&&f(h,d),w&&u(h,w)},[u,f]),b=l.useCallback((h,d)=>{if(h===d)return!1;let w=d;for(;w;){if(w===h)return!1;w=i(w)?.parentId??null}return!0},[i]);return l.useEffect(()=>{const h=setTimeout(()=>{Ae.set("folders",t,{validate:!0,encrypt:!0})},1e3);return()=>clearTimeout(h)},[t]),l.useEffect(()=>{const h=Ae.get("folders",{validate:!0,encrypt:!0});h&&s(h)},[]),{folders:t,folderTree:r(),selectedFolderId:a,setSelectedFolderId:n,dispatch:o,getFolderById:i,getFolderPath:c,addCardToFolder:u,removeCardFromFolder:f,moveCardBetweenFolders:m,canMoveFolder:b}}const Ao=[{id:"tag-1",name:"react",color:"#3b82f6",count:1,createdAt:new Date("2024-01-15")},{id:"tag-2",name:"frontend",color:"#8b5cf6",count:1,createdAt:new Date("2024-01-15")},{id:"tag-3",name:"best-practices",color:"#10b981",count:1,createdAt:new Date("2024-01-15")},{id:"tag-4",name:"typescript",color:"#f59e0b",count:1,createdAt:new Date("2024-01-16")},{id:"tag-5",name:"types",color:"#ef4444",count:1,createdAt:new Date("2024-01-16")},{id:"tag-6",name:"development",color:"#06b6d4",count:1,createdAt:new Date("2024-01-16")}],Ye=["#3b82f6","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4","#8b5a2b","#6b7280","#ec4899","#84cc16","#f97316","#6366f1"];function _o(){const[t,s]=l.useState(Ao),[a,n]=l.useState([]),r=l.useCallback(()=>t.filter(x=>!a.includes(x.id)),[t,a]),o=l.useCallback(x=>{const p=[...r()].sort((j,C)=>C.count-j.count);return x?p.slice(0,x):p},[r]),i=l.useCallback(x=>{s(p=>{switch(x.type){case"CREATE_TAG":const j=p.find(F=>F.name.toLowerCase()===x.payload.name.toLowerCase());if(j)return p.map(F=>F.id===j.id?{...F,count:F.count+1}:F);const C={...x.payload,id:`tag-${Date.now()}`,count:1,color:x.payload.color||Ye[p.length%Ye.length],createdAt:new Date};return[...p,C];case"UPDATE_TAG":return p.map(F=>F.id===x.payload.id?{...F,...x.payload.updates}:F);case"DELETE_TAG":return p.filter(F=>F.id!==x.payload);case"TOGGLE_TAG_VISIBILITY":return n(F=>F.includes(x.payload)?F.filter(A=>A!==x.payload):[...F,x.payload]),p;default:return p}})},[]),c=l.useCallback(x=>t.find(p=>p.id===x),[t]),u=l.useCallback(x=>t.find(p=>p.name.toLowerCase()===x.toLowerCase()),[t]),f=l.useCallback((x,p)=>{const j=u(x);return j||(i({type:"CREATE_TAG",payload:{name:x,color:p||Ye[t.length%Ye.length]}}),null)},[i,u,t.length]),m=l.useCallback((x,p)=>{const j=u(x);if(j){const C=Math.max(0,j.count+p);i(C===0?{type:"DELETE_TAG",payload:j.id}:{type:"UPDATE_TAG",payload:{id:j.id,updates:{count:C}}})}},[i,u]),b=l.useCallback(x=>{const p=x.reduce((A,v)=>(A[v]=(A[v]||0)+1,A),{}),j=t.map(A=>({...A,count:p[A.name]||0})),C=new Set(t.map(A=>A.name));Object.entries(p).forEach(([A,v])=>{if(!C.has(A)){const N={id:`tag-${Date.now()}-${Math.random()}`,name:A,color:Ye[j.length%Ye.length],count:v,createdAt:new Date};j.push(N)}});const F=j.filter(A=>A.count>0);s(F)},[t]),h=l.useCallback(x=>{if(!x.trim())return r();const p=x.toLowerCase();return r().filter(j=>j.name.toLowerCase().includes(p))},[r]),d=l.useCallback((x,p=5)=>x.trim()?h(x).slice(0,p):o(p),[h,o]),w=l.useCallback((x,p)=>{const j=u(x);if(!j)return!1;const C=u(p);return C&&C.id!==j.id?!1:(i({type:"UPDATE_TAG",payload:{id:j.id,updates:{name:p.trim()}}}),!0)},[i,u]),y=l.useCallback(x=>{const p=u(x);return p?(i({type:"DELETE_TAG",payload:p.id}),!0):!1},[i,u]),g=l.useCallback(()=>t.map(x=>x.name),[t]);return l.useEffect(()=>{const x=setTimeout(()=>{Ae.set("tags",t,{validate:!0,encrypt:!0}),Ae.set("hidden-tags",a,{validate:!0,encrypt:!0})},1e3);return()=>clearTimeout(x)},[t,a]),l.useEffect(()=>{const x=Ae.get("tags",{validate:!0,encrypt:!0});x&&s(x);const p=Ae.get("hidden-tags",{validate:!0,encrypt:!0});p&&n(p)},[]),{tags:r(),allTags:t,hiddenTags:a,popularTags:o,dispatch:i,getTagById:c,getTagByName:u,createTagIfNotExists:f,updateTagCount:m,syncTagsWithCards:b,searchTags:h,getTagSuggestions:d,renameTag:w,deleteTagByName:y,getAllTagNames:g}}const Qa=l.createContext(null);function Po({children:t}){const s=Eo(),a=Do(),n=_o();L.useEffect(()=>{const o=[];s.allCards.forEach(i=>{o.push(...i.frontContent.tags,...i.backContent.tags)}),n.syncTagsWithCards(o)},[s.allCards,n.syncTagsWithCards]);const r={cards:s,folders:a,tags:n};return e.jsx(Qa.Provider,{value:r,children:t})}function vs(){const t=l.useContext(Qa);if(!t)throw new Error("useCardAll must be used within a CardAllProvider");return t}function Fo(){return vs().cards}function Za(){return vs().folders}function en(){return vs().tags}const tn=l.createContext(void 0);function Io({children:t}){const[s,a]=l.useState(!1),n=()=>a(!0),r=()=>a(!1);return e.jsx(tn.Provider,{value:{isOpen:s,openModal:n,closeModal:r},children:t})}function sn(){const t=l.useContext(tn);if(t===void 0)throw new Error("useAuthModal must be used within an AuthModalProvider");return t}function S(...t){return zr(Or(t))}const js=$t("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),P=l.forwardRef(({className:t,variant:s,size:a,asChild:n=!1,...r},o)=>{const i=n?or:"button";return e.jsx(i,{className:S(js({variant:s,size:a,className:t})),ref:o,...r})});P.displayName="Button";const Mo=lr,Lo=cr,zo=l.forwardRef(({className:t,inset:s,children:a,...n},r)=>e.jsxs(Xs,{ref:r,className:S("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",t),...n,children:[a,e.jsx(Ut,{className:"ml-auto"})]}));zo.displayName=Xs.displayName;const Oo=l.forwardRef(({className:t,...s},a)=>e.jsx(Js,{ref:a,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));Oo.displayName=Js.displayName;const an=l.forwardRef(({className:t,sideOffset:s=4,...a},n)=>e.jsx(ir,{children:e.jsx(Qs,{ref:n,sideOffset:s,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})}));an.displayName=Qs.displayName;const Te=l.forwardRef(({className:t,inset:s,...a},n)=>e.jsx(Zs,{ref:n,className:S("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",t),...a}));Te.displayName=Zs.displayName;const $o=l.forwardRef(({className:t,children:s,checked:a,...n},r)=>e.jsxs(ea,{ref:r,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:a,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ta,{children:e.jsx(Fe,{className:"h-4 w-4"})})}),s]}));$o.displayName=ea.displayName;const Uo=l.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(sa,{ref:n,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ta,{children:e.jsx(Wa,{className:"h-2 w-2 fill-current"})})}),s]}));Uo.displayName=sa.displayName;const Bo=l.forwardRef(({className:t,inset:s,...a},n)=>e.jsx(aa,{ref:n,className:S("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...a}));Bo.displayName=aa.displayName;const hs=l.forwardRef(({className:t,...s},a)=>e.jsx(na,{ref:a,className:S("-mx-1 my-1 h-px bg-muted",t),...s}));hs.displayName=na.displayName;const rs=[{emoji:"😀",name:"grinning"},{emoji:"😃",name:"smiley"},{emoji:"😄",name:"smile"},{emoji:"😁",name:"grin"},{emoji:"😆",name:"laughing"},{emoji:"😅",name:"sweat_smile"},{emoji:"🤣",name:"rofl"},{emoji:"😂",name:"joy"},{emoji:"🙂",name:"slightly_smiling_face"},{emoji:"🙃",name:"upside_down_face"},{emoji:"😉",name:"wink"},{emoji:"😊",name:"blush"},{emoji:"😇",name:"innocent"},{emoji:"🥰",name:"smiling_face_with_hearts"},{emoji:"😍",name:"heart_eyes"},{emoji:"🤩",name:"star_struck"},{emoji:"😘",name:"kissing_heart"},{emoji:"😗",name:"kissing"},{emoji:"😚",name:"kissing_closed_eyes"},{emoji:"😙",name:"kissing_smiling_eyes"},{emoji:"🥲",name:"smiling_face_with_tear"},{emoji:"😋",name:"yum"},{emoji:"😛",name:"stuck_out_tongue"},{emoji:"😜",name:"stuck_out_tongue_winking_eye"},{emoji:"🤪",name:"zany_face"},{emoji:"😝",name:"stuck_out_tongue_closed_eyes"},{emoji:"🤑",name:"money_mouth_face"},{emoji:"🤗",name:"hugs"},{emoji:"🤭",name:"hand_over_mouth"},{emoji:"🤫",name:"shushing_face"},{emoji:"🤔",name:"thinking"},{emoji:"🤐",name:"zipper_mouth_face"},{emoji:"🤨",name:"raised_eyebrow"},{emoji:"😐",name:"neutral_face"},{emoji:"😑",name:"expressionless"},{emoji:"😶",name:"no_mouth"},{emoji:"😏",name:"smirk"},{emoji:"😒",name:"unamused"},{emoji:"🙄",name:"roll_eyes"},{emoji:"😬",name:"grimacing"},{emoji:"🤥",name:"lying_face"},{emoji:"😔",name:"pensive"},{emoji:"😪",name:"sleepy"},{emoji:"🤤",name:"drooling_face"},{emoji:"😴",name:"sleeping"},{emoji:"😷",name:"mask"},{emoji:"🤒",name:"face_with_thermometer"},{emoji:"🤕",name:"face_with_head_bandage"},{emoji:"🤢",name:"nauseated_face"},{emoji:"🤮",name:"vomiting_face"},{emoji:"🤧",name:"sneezing_face"},{emoji:"🥵",name:"hot_face"},{emoji:"🥶",name:"cold_face"},{emoji:"🥴",name:"woozy_face"},{emoji:"😵",name:"dizzy_face"},{emoji:"🤯",name:"exploding_head"},{emoji:"🤠",name:"cowboy_hat_face"},{emoji:"🥳",name:"partying_face"},{emoji:"🥸",name:"disguised_face"},{emoji:"😎",name:"sunglasses"},{emoji:"🤓",name:"nerd_face"},{emoji:"🧐",name:"monocle_face"},{emoji:"😕",name:"confused"},{emoji:"😟",name:"worried"},{emoji:"🙁",name:"slightly_frowning_face"},{emoji:"☹️",name:"frowning_face"},{emoji:"😮",name:"open_mouth"},{emoji:"😯",name:"hushed"},{emoji:"😲",name:"astonished"},{emoji:"😳",name:"flushed"},{emoji:"🥺",name:"pleading_face"},{emoji:"😦",name:"frowning"},{emoji:"😧",name:"anguished"},{emoji:"😨",name:"fearful"},{emoji:"😰",name:"cold_sweat"},{emoji:"😥",name:"disappointed_relieved"},{emoji:"😢",name:"cry"},{emoji:"😭",name:"sob"},{emoji:"😱",name:"scream"},{emoji:"😖",name:"confounded"},{emoji:"😣",name:"persevere"},{emoji:"😞",name:"disappointed"},{emoji:"😓",name:"sweat"},{emoji:"😩",name:"weary"},{emoji:"😫",name:"tired_face"},{emoji:"🥱",name:"yawning_face"},{emoji:"😤",name:"triumph"},{emoji:"😡",name:"rage"},{emoji:"😠",name:"angry"},{emoji:"🤬",name:"cursing_face"},{emoji:"😈",name:"smiling_imp"},{emoji:"👿",name:"imp"},{emoji:"💀",name:"skull"},{emoji:"☠️",name:"skull_and_crossbones"},{emoji:"💩",name:"poop"},{emoji:"🤡",name:"clown_face"},{emoji:"👹",name:"ogre"},{emoji:"👺",name:"goblin"},{emoji:"👻",name:"ghost"},{emoji:"👽",name:"alien"},{emoji:"👾",name:"space_invader"},{emoji:"🤖",name:"robot"},{emoji:"😺",name:"smiley_cat"},{emoji:"😸",name:"smile_cat"},{emoji:"😹",name:"joy_cat"},{emoji:"😻",name:"heart_eyes_cat"},{emoji:"😼",name:"smirk_cat"},{emoji:"😽",name:"kissing_cat"},{emoji:"🙀",name:"scream_cat"},{emoji:"😿",name:"crying_cat_face"},{emoji:"😾",name:"pouting_cat"},{emoji:"👋",name:"wave"},{emoji:"🤚",name:"raised_back_of_hand"},{emoji:"🖐️",name:"raised_hand_with_fingers_splayed"},{emoji:"✋",name:"hand"},{emoji:"🖖",name:"vulcan_salute"},{emoji:"👌",name:"ok_hand"},{emoji:"🤌",name:"pinched_fingers"},{emoji:"🤏",name:"pinching_hand"},{emoji:"✌️",name:"v"},{emoji:"🤞",name:"crossed_fingers"},{emoji:"🤟",name:"love_you_gesture"},{emoji:"🤘",name:"metal"},{emoji:"🤙",name:"call_me_hand"},{emoji:"👈",name:"point_left"},{emoji:"👉",name:"point_right"},{emoji:"👆",name:"point_up_2"},{emoji:"🖕",name:"middle_finger"},{emoji:"👇",name:"point_down"},{emoji:"☝️",name:"point_up"},{emoji:"👍",name:"thumbsup"},{emoji:"👎",name:"thumbsdown"},{emoji:"✊",name:"fist"},{emoji:"👊",name:"facepunch"},{emoji:"🤛",name:"fist_left"},{emoji:"🤜",name:"fist_right"},{emoji:"👏",name:"clap"},{emoji:"🙌",name:"raised_hands"},{emoji:"👐",name:"open_hands"},{emoji:"🤲",name:"palms_up_together"},{emoji:"🤝",name:"handshake"},{emoji:"🙏",name:"pray"},{emoji:"❤️",name:"heart"},{emoji:"🧡",name:"orange_heart"},{emoji:"💛",name:"yellow_heart"},{emoji:"💚",name:"green_heart"},{emoji:"💙",name:"blue_heart"},{emoji:"💜",name:"purple_heart"},{emoji:"🖤",name:"black_heart"},{emoji:"🤍",name:"white_heart"},{emoji:"🤎",name:"brown_heart"},{emoji:"💔",name:"broken_heart"},{emoji:"❣️",name:"heavy_heart_exclamation"},{emoji:"💕",name:"two_hearts"},{emoji:"💞",name:"revolving_hearts"},{emoji:"💓",name:"heartbeat"},{emoji:"💗",name:"heartpulse"},{emoji:"💖",name:"sparkling_heart"},{emoji:"💘",name:"cupid"},{emoji:"💝",name:"gift_heart"},{emoji:"💟",name:"heart_decoration"},{emoji:"☮️",name:"peace_symbol"},{emoji:"✝️",name:"latin_cross"},{emoji:"☪️",name:"star_and_crescent"},{emoji:"🕉️",name:"om"},{emoji:"☸️",name:"wheel_of_dharma"},{emoji:"✡️",name:"star_of_david"},{emoji:"🔯",name:"six_pointed_star"},{emoji:"🕎",name:"menorah"},{emoji:"☯️",name:"yin_yang"},{emoji:"☦️",name:"orthodox_cross"},{emoji:"🛐",name:"place_of_worship"},{emoji:"⛎",name:"ophiuchus"},{emoji:"♈",name:"aries"},{emoji:"♉",name:"taurus"},{emoji:"♊",name:"gemini"},{emoji:"♋",name:"cancer"},{emoji:"♌",name:"leo"},{emoji:"♍",name:"virgo"},{emoji:"♎",name:"libra"},{emoji:"♏",name:"scorpius"},{emoji:"♐",name:"sagittarius"},{emoji:"♑",name:"capricorn"},{emoji:"♒",name:"aquarius"},{emoji:"♓",name:"pisces"},{emoji:"🆔",name:"id"},{emoji:"⚡",name:"zap"},{emoji:"💥",name:"boom"},{emoji:"💫",name:"dizzy"},{emoji:"💦",name:"sweat_drops"},{emoji:"💨",name:"dash"},{emoji:"🕳️",name:"hole"},{emoji:"💣",name:"bomb"},{emoji:"💬",name:"speech_balloon"},{emoji:"👁️‍🗨️",name:"eye_speech_bubble"},{emoji:"🗨️",name:"left_speech_bubble"},{emoji:"🗯️",name:"right_anger_bubble"},{emoji:"💭",name:"thought_balloon"},{emoji:"💤",name:"zzz"}];function Vo({onEmojiSelect:t,onClose:s,query:a="",position:n}){const[r,o]=l.useState(rs);l.useEffect(()=>{if(a&&a.trim()){const m=a.toLowerCase().trim(),b=rs.filter(h=>h.name.toLowerCase().includes(m)||h.emoji.includes(a)||h.name.toLowerCase().startsWith(m));o(b.slice(0,20))}else o(rs.slice(0,40))},[a]);const i=m=>{t(m),s()},c=m=>{m.key==="Escape"&&s()},u=()=>{if(!n)return{};const m=window.innerWidth,b=window.innerHeight,h=320,d=240;let w=n.x,y=n.y;return w+h>m&&(w=m-h-20),y+d>b&&(y=n.y-d-10),{left:Math.max(10,w),top:Math.max(10,y)}},f=e.jsxs("div",{className:"fixed bg-white border border-border rounded-lg shadow-xl p-3 w-80",style:{...u(),zIndex:2147483647},onKeyDown:c,children:[a&&e.jsxs("div",{className:"text-xs text-blue-600 mb-2 font-medium",children:['"',a,'"']}),e.jsx("div",{className:"grid grid-cols-10 gap-1 max-h-52 overflow-y-auto",children:r.map((m,b)=>e.jsx(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-blue-50 text-lg transition-colors",onClick:()=>i(m.emoji),title:m.name,children:m.emoji},`${m.emoji}-${b}`))}),r.length===0&&a&&e.jsx("div",{className:"text-center text-muted-foreground text-sm py-6",children:"No emojis found"})]});return Ot.createPortal(f,document.body)}function Wo({content:t,placeholder:s="Start typing...",onUpdate:a,onSave:n,onCancel:r,className:o,autoFocus:i=!1}){const[c,u]=l.useState(!1),[f,m]=l.useState(""),[b,h]=l.useState(null),d=l.useRef(null),w=ho({extensions:[go.configure({strike:!1,code:!1,blockquote:!1}),po.configure({html:!0,transformPastedText:!0,transformCopiedText:!1}),xo,yo.configure({nested:!0}),bo.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 underline hover:text-blue-800 cursor-pointer",target:"_blank",rel:"noopener noreferrer"},protocols:["http","https","ftp","mailto"],validate:p=>/^https?:\/\//.test(p)}),wo.configure({HTMLAttributes:{class:"border-l-4 border-gray-300 pl-4 italic"}}),vo.configure({HTMLAttributes:{class:"inline-code"}}),jo.configure({HTMLAttributes:{class:"code-block"}}),No.configure({HTMLAttributes:{class:"line-through"}}),Co.configure({inline:!0,allowBase64:!0,HTMLAttributes:{class:"rounded-md max-w-full h-auto"}}),So.configure({placeholder:s})],content:t,onUpdate:({editor:p})=>{a(p.getHTML())},editorProps:{attributes:{class:"tiptap-editor text-sm leading-relaxed focus:outline-none min-h-[100px] w-full"},handleKeyDown:(p,j)=>{if(j.key==="/"&&!c){const{selection:C}=p.state,{from:F}=C,A=p.state.doc.resolve(F),v=A.parent.textBetween(0,A.parentOffset);if(!v.trim()||v.endsWith(" ")){const R=p.coordsAtPos(F);return h({x:R.left,y:R.bottom+5}),u(!0),m(""),j.preventDefault(),!0}}if(c){if(j.key==="Escape")return u(!1),m(""),!0;if(j.key==="Backspace")return f.length>0?m(C=>C.slice(0,-1)):u(!1),!0;if(j.key.length===1&&!j.ctrlKey&&!j.metaKey&&j.key!==" ")return m(C=>C+j.key),!0;if(j.key===" ")return u(!1),m(""),!0}return!1}}}),y=l.useCallback(()=>{const p=document.createElement("input");p.type="file",p.accept="image/*",p.onchange=j=>{const C=j.target.files?.[0];if(C&&w){const F=new FileReader;F.onload=A=>{const v=A.target?.result;w.chain().focus().setImage({src:v}).run()},F.readAsDataURL(C)}},p.click()},[w]);l.useEffect(()=>{if(!w)return;const p=C=>{const F=C.clipboardData?.items;if(F)for(let A=0;A<F.length;A++){const v=F[A];if(v.type.indexOf("image")!==-1){C.preventDefault();const N=v.getAsFile();if(N){const R=new FileReader;R.onload=B=>{const _=B.target?.result;w.chain().focus().setImage({src:_}).run()},R.readAsDataURL(N)}}}},j=w.view.dom;return j.addEventListener("paste",p),()=>{j.removeEventListener("paste",p)}},[w]);const g=l.useCallback(p=>{w&&w.chain().focus().insertContent(p).run(),u(!1),m("")},[w]),x=l.useCallback(()=>{u(!1),m("")},[]);return l.useEffect(()=>{if(!w)return;const p=C=>{C.key==="Escape"?c?(u(!1),m("")):r():C.key==="Enter"&&(C.ctrlKey||C.metaKey)&&n()},j=w.view.dom;return j.addEventListener("keydown",p),()=>{j.removeEventListener("keydown",p)}},[w,n,r,c]),l.useEffect(()=>{w&&i&&w.commands.focus()},[w,i]),w?e.jsxs("div",{className:S("relative z-20",o),ref:d,children:[e.jsxs("div",{className:"relative p-2 -m-2",children:[e.jsx(ko,{editor:w,className:"min-h-[100px]"}),e.jsxs("div",{className:"absolute top-0 right-0 flex gap-1 opacity-60 hover:opacity-100 transition-opacity",children:[e.jsx(P,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 bg-white/90 hover:bg-white shadow-sm rounded",onClick:()=>u(!c),title:"Insert Emoji (Press / to open)",children:e.jsx($r,{className:"h-3 w-3"})}),e.jsx(P,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 bg-white/90 hover:bg-white shadow-sm rounded",onClick:y,title:"Insert Image",children:e.jsx(Ha,{className:"h-3 w-3"})})]})]}),c&&e.jsx(Vo,{onEmojiSelect:g,onClose:x,query:f,position:b||void 0}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2 pt-2 border-t border-border/30",children:[e.jsxs(P,{size:"sm",variant:"ghost",onClick:r,className:"h-7 px-3 text-xs",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),"Cancel"]}),e.jsxs(P,{size:"sm",onClick:n,className:"h-7 px-3 text-xs",children:[e.jsx(Fe,{className:"h-3 w-3 mr-1"}),"Accept"]})]}),w&&e.jsxs("div",{className:"absolute top-0 right-0 text-xs text-muted-foreground bg-white/90 px-2 py-1 rounded shadow-sm opacity-0 hover:opacity-100 transition-opacity pointer-events-none z-10 max-w-xs",children:["**bold** *italic* # heading - list ",">"," quote `code` ~~strike~~ [link](url) [] task / emoji"]})]}):null}function Ho({content:t,onUpdate:s,onSave:a,onCancel:n,className:r,autoFocus:o=!1}){const[i,c]=l.useState(t),u=l.useRef(null);l.useEffect(()=>{c(t)},[t]),l.useEffect(()=>{o&&u.current&&(u.current.focus(),u.current.select())},[o]);const f=b=>{c(b.target.value),s(b.target.value)},m=b=>{b.key==="Enter"?a():b.key==="Escape"&&n()};return e.jsxs("div",{className:S("relative",r),children:[e.jsx("input",{ref:u,type:"text",value:i,onChange:f,onKeyDown:m,className:"w-full bg-transparent border-none outline-none text-lg font-semibold resize-none pr-16",placeholder:"Card title..."}),e.jsxs("div",{className:"absolute right-0 top-0 flex gap-1",children:[e.jsx(P,{size:"sm",variant:"ghost",onClick:n,className:"h-6 w-6 p-0 bg-white/80 hover:bg-white shadow-sm",children:e.jsx(Be,{className:"h-3 w-3"})}),e.jsx(P,{size:"sm",onClick:a,className:"h-6 w-6 p-0 bg-white/80 hover:bg-white shadow-sm",children:e.jsx(Fe,{className:"h-3 w-3"})})]})]})}const Go=t=>{const s=["#3b82f6","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4","#8b5a2b","#6b7280","#ec4899","#84cc16","#f97316","#6366f1"];let a=0;for(let n=0;n<t.length;n++)a=t.charCodeAt(n)+((a<<5)-a);return s[Math.abs(a)%s.length]},Yo=({tags:t,className:s,maxTags:a=5,size:n="sm"})=>{if(!t||t.length===0)return null;const r=t.slice(0,a),o=t.length-a,i={sm:"text-xs px-2 py-1",md:"text-sm px-2.5 py-1.5",lg:"text-base px-3 py-2"};return e.jsxs("div",{className:S("flex flex-wrap gap-1.5 mt-3",s),children:[r.map((c,u)=>e.jsx("span",{className:S("inline-flex items-center rounded-full font-medium text-white","shadow-sm transition-all duration-200 hover:scale-105",i[n]),style:{backgroundColor:Go(c),fontSize:n==="sm"?"0.75rem":n==="md"?"0.875rem":"1rem"},children:c},`${c}-${u}`)),o>0&&e.jsxs("span",{className:S("inline-flex items-center rounded-full bg-gray-500 text-white font-medium",i[n]),children:["+",o]})]})};function Ko({card:t,onFlip:s,onUpdate:a,onCopy:n,onScreenshot:r,onShare:o,onDelete:i,onStyleChange:c,onTagsChange:u,onMoveToFolder:f,className:m,size:b="md"}){const[h,d]=l.useState(!1),[w,y]=l.useState(!1),[g,x]=l.useState(null),[p,j]=l.useState(null),[C,F]=l.useState(null),[A,v]=l.useState(!1),N=l.useRef(null),R=t.isFlipped?t.backContent:t.frontContent,B={sm:"w-full",md:"w-full",lg:"w-full"},_={sm:"p-3",md:"p-4",lg:"p-5"},U=()=>{const{style:I}=t,V={borderRadius:"1rem",fontFamily:I.fontFamily,fontSize:I.fontSize==="sm"?"0.875rem":I.fontSize==="lg"?"1.125rem":"1rem",fontWeight:I.fontWeight,color:I.textColor,borderWidth:I.borderWidth||0,borderColor:I.borderColor};let ne="";return I.type==="gradient"&&I.gradientColors?(V.background=`linear-gradient(135deg, ${I.gradientColors.join(", ")})`,I.gradientColors.includes("#8a2be2")&&I.gradientColors.includes("#00ffff")?(ne="gradient-wave-animation",V.position="relative"):I.gradientColors.includes("#ee7752")&&I.gradientColors.includes("#23d5ab")?ne="moving-gradient-animation":I.gradientColors.includes("#667eea")&&(ne="gradient-mesh-animation")):I.type==="glass"?(V.background=I.backgroundColor||"rgba(255, 255, 255, 0.15)",V.backdropFilter="blur(20px) saturate(180%)",V.WebkitBackdropFilter="blur(20px) saturate(180%)",V.border=`1px solid ${I.borderColor||"rgba(255, 255, 255, 0.18)"}`,ne="glass-morphism"):I.backgroundColor&&I.backgroundColor.includes("linear-gradient")?(V.background=I.backgroundColor,V.backgroundSize="400% 400%",I.backgroundColor.includes("#667eea")&&(ne="gradient-mesh-animation")):(V.backgroundColor=I.backgroundColor,I.backgroundColor==="#1a1a2e"&&I.borderColor==="#4361ee"?ne="pulse-border-animation":I.backgroundColor==="#0f172a"&&(ne="glow-hover-animation")),{style:V,shadowClass:{sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg",xl:"shadow-xl",none:"","2xl":"shadow-2xl",glass:"shadow-lg"}[I.shadow||"md"]||"shadow-md",specialClasses:ne}},{style:J,shadowClass:$,specialClasses:q}=U(),ee=l.useCallback(I=>{I.stopPropagation(),I.preventDefault(),!A&&(v(!0),s(t.id),setTimeout(()=>{v(!1)},600))},[t.id,s,A]),Z=I=>{I.stopPropagation(),M("content")},le=I=>{M(I)},M=I=>{j(R),F(R),x(I),y(!0)},H=(I,V)=>{C&&F({...C,[I]:V,lastModified:new Date})},E=()=>{if(C){const V={[t.isFlipped?"backContent":"frontContent"]:C};a(t.id,V)}y(!1),x(null),j(null),F(null)},T=()=>{y(!1),x(null),j(null),F(null)},k=I=>{H("title",I.target.value)},z=I=>{H("text",I.target.value)},W=I=>{I.key==="Escape"&&T(),I.key==="Enter"&&I.ctrlKey&&E()};return e.jsx("div",{className:S("relative group",m),"data-card-id":t.id,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:e.jsx("div",{className:"flip-card-container",style:{perspective:"1000px",width:"100%",minHeight:"fit-content"},children:e.jsxs("div",{ref:N,className:S("flip-card-inner relative transition-all duration-700 ease-in-out",B[b]),style:{minHeight:"fit-content",width:"100%",transformStyle:"preserve-3d",transform:t.isFlipped?"rotateY(180deg)":"rotateY(0deg)"},children:[e.jsx("div",{className:S("flip-card-face flip-card-front w-full flex flex-col transition-all duration-300 relative",$,q,_[b]),style:{...J,borderRadius:J.borderRadius,backfaceVisibility:"hidden",position:t.isFlipped?"absolute":"relative",opacity:t.isFlipped?0:1},children:e.jsx(Is,{content:C||t.frontContent,isEditing:w&&!t.isFlipped,editingField:g,onTitleChange:k,onTextChange:z,onTempContentUpdate:H,onSaveEdit:E,onCancelEdit:T,onDoubleClick:le,onKeyDown:W,sideLabel:"Front",isHovered:h,onEdit:Z,onFlip:ee,onCopy:()=>n(t.id),onScreenshot:()=>r(t.id),onShare:()=>o(t.id),onDelete:()=>i(t.id),onStyleChange:c?()=>c(t.id):void 0,onTagsChange:u?()=>u(t.id):void 0,onMoveToFolder:f,card:t,isFlipping:A})}),e.jsx("div",{className:S("flip-card-face flip-card-back w-full flex flex-col transition-all duration-300 relative",$,q,_[b]),style:{...J,borderRadius:J.borderRadius,backfaceVisibility:"hidden",transform:"rotateY(180deg)",position:t.isFlipped?"relative":"absolute",top:t.isFlipped?"auto":"0",opacity:t.isFlipped?1:0},children:e.jsx(Is,{content:C||t.backContent,isEditing:w&&t.isFlipped,editingField:g,onTitleChange:k,onTextChange:z,onTempContentUpdate:H,onSaveEdit:E,onCancelEdit:T,onDoubleClick:le,onKeyDown:W,sideLabel:"Back",isHovered:h,onEdit:Z,onFlip:ee,onCopy:()=>n(t.id),onScreenshot:()=>r(t.id),onShare:()=>o(t.id),onDelete:()=>i(t.id),onStyleChange:c?()=>c(t.id):void 0,onTagsChange:u?()=>u(t.id):void 0,onMoveToFolder:f,card:t,isFlipping:A})})]})})})}function qo({images:t}){const s=t.slice(0,4),a=s.length,n=o=>{switch(o){case 1:return"flex justify-center";case 2:return"grid grid-cols-2 gap-2";case 3:return"grid grid-cols-2 gap-2";case 4:default:return"grid grid-cols-2 gap-2"}},r=(o,i)=>{const c="relative aspect-video rounded-md overflow-hidden bg-muted transition-all duration-200 hover:scale-[1.02]";return o===1?`${c} max-w-xs w-full`:o===3&&i===2?`${c} col-span-2 max-w-xs mx-auto`:c};return e.jsx("div",{className:n(a),children:s.map((o,i)=>e.jsx("div",{className:r(a,i),children:e.jsx("img",{src:o.url,alt:o.alt||`Image ${i+1}`,className:"w-full h-full object-cover transition-transform duration-200",loading:"lazy"})},i))})}function Is({content:t,isEditing:s,editingField:a,onTitleChange:n,onTextChange:r,onTempContentUpdate:o,onSaveEdit:i,onCancelEdit:c,onDoubleClick:u,onKeyDown:f,sideLabel:m,isHovered:b,onEdit:h,onFlip:d,onCopy:w,onScreenshot:y,onShare:g,onDelete:x,onStyleChange:p,onTagsChange:j,onMoveToFolder:C,card:F,isFlipping:A}){return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex-1 mr-2",children:s&&a==="title"?e.jsx(Ho,{content:t.title,onUpdate:v=>o("title",v),onSave:i,onCancel:c,autoFocus:!0}):e.jsx("h3",{className:"text-lg font-semibold text-left cursor-pointer hover:bg-black/5 rounded px-1 py-0.5 -mx-1 transition-colors",onDoubleClick:()=>u("title"),children:t.title||"Untitled Card"})}),e.jsxs("div",{className:S("flex gap-1 transition-all duration-200 flex-shrink-0",b||s?"opacity-100":"opacity-60"),children:[e.jsx(P,{size:"sm",variant:"ghost",className:S("h-7 w-7 p-0 rounded-md hover:bg-black/10 transition-all duration-200",A&&"animate-pulse"),onClick:d,title:`Flip to ${F.isFlipped?"Front":"Back"}`,disabled:A,children:e.jsx(Ur,{className:S("h-3.5 w-3.5 transition-transform duration-200",A&&"scale-110")})}),e.jsxs(Mo,{modal:!1,children:[e.jsx(Lo,{asChild:!0,children:e.jsx("div",{className:"h-7 w-7 rounded-md hover:bg-black/10 flex items-center justify-center cursor-pointer transition-colors group",onMouseEnter:v=>{v.stopPropagation();const N=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});v.currentTarget.dispatchEvent(N)},onClick:v=>v.stopPropagation(),children:e.jsx(Br,{className:"h-3.5 w-3.5"})})}),e.jsxs(an,{align:"end",className:"w-48",children:[e.jsxs(Te,{onClick:h,children:[e.jsx(Vr,{className:"h-4 w-4 mr-2"}),"Edit Content"]}),e.jsxs(Te,{onClick:w,children:[e.jsx(Wr,{className:"h-4 w-4 mr-2"}),"Copy Text"]}),e.jsxs(Te,{onClick:y,children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Screenshot"]}),e.jsxs(Te,{onClick:g,children:[e.jsx(Hr,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsx(hs,{}),p&&e.jsxs(Te,{onClick:p,children:[e.jsx(Ga,{className:"h-4 w-4 mr-2"}),"Change Style"]}),j&&e.jsxs(Te,{onClick:j,children:[e.jsx(Ya,{className:"h-4 w-4 mr-2"}),"Manage Tags"]}),C&&e.jsxs(Te,{onClick:C,children:[e.jsx(Ka,{className:"h-4 w-4 mr-2"}),"Move to Folder"]}),e.jsx(hs,{}),e.jsxs(Te,{onClick:x,className:"text-destructive focus:text-destructive",children:[e.jsx(ys,{className:"h-4 w-4 mr-2"}),"Delete Card"]})]})]})]})]}),t.images.length>0&&e.jsxs("div",{className:"mb-3 flex-shrink-0",children:[e.jsx(qo,{images:t.images}),t.images.length>4&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-center",children:["+",t.images.length-4," more images"]})]}),e.jsx("div",{className:"flex-1 mb-3 relative z-10",children:s&&a==="content"?e.jsx(Wo,{content:t.text,placeholder:"Add your content here...",onUpdate:v=>o("text",v),onSave:i,onCancel:c,autoFocus:!0}):e.jsx("div",{className:"text-sm leading-relaxed text-left cursor-pointer hover:bg-black/5 rounded p-2 -m-2 transition-colors min-h-[100px] tiptap-editor relative z-10",onDoubleClick:v=>{v.target.tagName!=="A"&&u("content")},onClick:v=>{const N=v.target;if(N.tagName==="A"){v.stopPropagation();const R=N.getAttribute("href");R&&window.open(R,"_blank","noopener,noreferrer")}},children:e.jsx("div",{className:"whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:t.text||'<span class="text-muted-foreground">Click to add content...</span>'}})})}),e.jsxs("div",{className:"mt-auto",children:[e.jsx(Yo,{tags:t.tags,size:"sm"}),t.images.length>0&&e.jsx("div",{className:"flex items-center justify-end text-xs text-muted-foreground mt-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ha,{className:"h-3 w-3"}),e.jsx("span",{children:t.images.length})]})})]})]})}const ge=({title:t="Sample Card",content:s="This is a preview of how your card will look with this style.",style:a,isSelected:n=!1,onClick:r,className:o})=>{console.log("Rendering StylePreviewCard (Simplified):",{title:t,isSelected:n,style:a});const i=()=>{const c={minHeight:"60px",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"8px",borderRadius:"8px",cursor:"pointer",border:n?"2px solid #3b82f6":"1px solid #e5e7eb",position:"relative",fontSize:"10px",textAlign:"center",boxShadow:n?"0 4px 12px rgba(59, 130, 246, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.1)",transition:"all 0.2s ease",backgroundColor:"#ffffff"};if(typeof a=="object"&&a!==null){if("background"in a||"backgroundColor"in a)return{...c,...a,cursor:"pointer",border:n?"3px solid #3b82f6":a.border||"2px solid #e5e7eb",boxShadow:n?"0 4px 12px rgba(59, 130, 246, 0.3)":a.boxShadow||"0 2px 4px rgba(0, 0, 0, 0.1)",transition:"all 0.2s ease"};if("type"in a){if(a.type==="solid")return{...c,backgroundColor:a.backgroundColor||"#ffffff",color:a.textColor||"#374151"};if(a.type==="gradient"&&a.gradientColors){const f=`linear-gradient(${a.gradientDirection||"to bottom right"}, ${a.gradientColors.join(", ")})`;return{...c,background:f,color:a.textColor||"#ffffff"}}}}return c};return e.jsxs("div",{style:i(),onClick:r,className:o,children:[e.jsx("div",{style:{fontWeight:"600",marginBottom:"2px",fontSize:"11px"},children:t}),e.jsx("div",{style:{fontSize:"9px",opacity:.8,lineHeight:"1.1"},children:s})]})},Xo=({isSelected:t,onClick:s,className:a})=>{const n={background:"#ffffff",color:"#1f2937",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"400",borderRadius:"12px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",border:"1px solid #e5e7eb"};return e.jsx(ge,{title:"Classic White",content:"Clean and professional",style:n,isSelected:t,onClick:s,className:a})},Jo={id:"classic-white",name:"Classic White",category:"business",description:"Clean and professional white background with subtle shadows",style:{type:"solid",backgroundColor:"#ffffff",fontFamily:"system-ui",fontSize:"base",fontWeight:"normal",textColor:"#1f2937",borderRadius:"2xl",shadow:"md",borderWidth:1,borderColor:"#e5e7eb"},previewComponent:Xo},Qo=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #1f2937 0%, #111827 50%, #030712 100%)",color:"#f9fafb",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"600",borderRadius:"12px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.1)"};return e.jsx(ge,{title:"Deep Dark",content:"Bold and mysterious",style:n,isSelected:t,onClick:s,className:a})},Zo={id:"deep-dark",name:"Deep Dark",category:"personality",description:"Bold dark gradient with mysterious depth",style:{type:"gradient",gradientColors:["#1f2937","#111827","#030712"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"semibold",textColor:"#f9fafb",borderRadius:"2xl",shadow:"2xl",borderWidth:1,borderColor:"rgba(255, 255, 255, 0.1)"},previewComponent:Qo},ei=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #8b5cf6 0%, #a855f7 50%, #c084fc 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"20px",boxShadow:"0 20px 25px -5px rgba(139, 92, 246, 0.25), 0 10px 10px -5px rgba(139, 92, 246, 0.1)",border:"none"};return e.jsx(ge,{title:"Elegant Purple",content:"Artistic and inspiring",style:n,isSelected:t,onClick:s,className:a})},ti={id:"elegant-purple",name:"Elegant Purple",category:"creative",description:"Artistic purple gradient with elegant curves and shadows",style:{type:"gradient",gradientColors:["#8b5cf6","#a855f7","#c084fc"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:ei},si=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"16px",boxShadow:"0 20px 25px -5px rgba(16, 185, 129, 0.2), 0 10px 10px -5px rgba(16, 185, 129, 0.1)",border:"none"};return e.jsx(ge,{title:"Fresh Green",content:"Natural and harmonious",style:n,isSelected:t,onClick:s,className:a})},ai={id:"fresh-green",name:"Fresh Green",category:"natural",description:"Natural green gradient with organic harmony",style:{type:"gradient",gradientColors:["#10b981","#059669","#047857"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:si},ni=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)",backgroundSize:"400% 400%",animation:"gradientShift 8s ease infinite",color:"#ffffff",fontFamily:'"Inter", system-ui, -apple-system, sans-serif',fontSize:"14px",fontWeight:"500",borderRadius:"12px",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.3), 0 4px 16px rgba(118, 75, 162, 0.2)",border:"none",position:"relative",overflow:"hidden"},r={position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",pointerEvents:"none"};return e.jsxs("div",{style:{position:"relative"},children:[e.jsx(ge,{title:"Gradient Mesh",content:"Dynamic gradient background",style:n,isSelected:t,onClick:s,className:a}),e.jsx("div",{style:r}),e.jsx("style",{jsx:!0,children:`
        @keyframes gradientShift {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
        }
      `})]})},ri={id:"gradient-mesh",name:"Gradient Mesh",category:"creative",description:"Dynamic gradient background with animated mesh effect",style:{type:"solid",backgroundColor:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)",fontFamily:"Inter",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"xl",borderWidth:0,borderColor:"transparent"},previewComponent:ni},oi=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(90deg, #fb923c 0%, #8b5cf6 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"600",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(251, 146, 60, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"none"};return e.jsx(ge,{title:"Gradient Sunset",content:"Vibrant and expressive",style:n,isSelected:t,onClick:s,className:a})},ii={id:"gradient-sunset",name:"Gradient Sunset",category:"personality",description:"Warm orange to violet gradient with magical sunset vibes",style:{type:"gradient",gradientColors:["#fb923c","#8b5cf6"],gradientDirection:"to-r",fontFamily:"system-ui",fontSize:"base",fontWeight:"semibold",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:oi},li=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #8a2be2 0%, #4b0082 25%, #9370db 50%, #00ffff 75%, #00bfff 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"600",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(138, 43, 226, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"none",position:"relative",overflow:"hidden"};return e.jsx("div",{className:"relative",children:e.jsx(ge,{title:"Gradient Wave",content:"Dynamic wave effect",style:n,isSelected:t,onClick:s,className:`${a} gradient-wave-animation`})})},ci={id:"gradient-wave",name:"Gradient Wave",category:"creative",description:"Purple to cyan gradient with dynamic wave effect",style:{type:"gradient",gradientColors:["#8a2be2","#4b0082","#9370db","#00ffff","#00bfff"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"semibold",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:li},di=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"16px",boxShadow:"0 10px 15px -3px rgba(59, 130, 246, 0.3), 0 4px 6px -2px rgba(59, 130, 246, 0.1)",border:"none"};return e.jsx(ge,{title:"Modern Blue",content:"Contemporary gradient design",style:n,isSelected:t,onClick:s,className:a})},mi={id:"modern-blue",name:"Modern Blue",category:"business",description:"Contemporary blue gradient with professional appeal",style:{type:"gradient",gradientColors:["#3b82f6","#1d4ed8","#1e40af"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"lg",borderWidth:0},previewComponent:di},ui=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab)",backgroundSize:"400% 400%",color:"#ffffff",fontFamily:'"Poppins", system-ui, sans-serif',fontSize:"14px",fontWeight:"600",borderRadius:"16px",boxShadow:"0 15px 30px -10px rgba(0, 0, 0, 0.25)",border:"none",position:"relative",overflow:"hidden"};return e.jsx("div",{className:"relative",children:e.jsx(ge,{title:"Moving Gradient",content:"Flowing color effect",style:n,isSelected:t,onClick:s,className:`${a} moving-gradient-animation`})})},fi={id:"moving-gradient",name:"Moving Gradient",category:"creative",description:"Colorful gradient with flowing animation effect",style:{type:"gradient",gradientColors:["#ee7752","#e73c7e","#23a6d5","#23d5ab"],gradientDirection:"to-br",fontFamily:"Poppins",fontSize:"base",fontWeight:"semibold",textColor:"#ffffff",borderRadius:"xl",shadow:"xl",borderWidth:0},previewComponent:ui},hi=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(90deg, #34d399 0%, #0d9488 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"20px",boxShadow:"0 10px 15px -3px rgba(52, 211, 153, 0.3), 0 4px 6px -2px rgba(13, 148, 136, 0.1)",border:"1px solid rgba(52, 211, 153, 0.3)"};return e.jsx(ge,{title:"Ocean Breeze",content:"Fresh and refreshing",style:n,isSelected:t,onClick:s,className:a})},gi={id:"ocean-breeze",name:"Ocean Breeze",category:"natural",description:"Fresh emerald to teal gradient with tropical vibes",style:{type:"gradient",gradientColors:["#34d399","#0d9488"],gradientDirection:"to-r",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"lg",borderWidth:1,borderColor:"rgba(52, 211, 153, 0.3)"},previewComponent:hi},pi=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(90deg, #fda4af 0%, #f87171 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"20px",boxShadow:"0 10px 15px -3px rgba(253, 164, 175, 0.3), 0 4px 6px -2px rgba(248, 113, 113, 0.1)",border:"1px solid rgba(253, 164, 175, 0.3)"};return e.jsx(ge,{title:"Soft Pink",content:"Gentle and soothing",style:n,isSelected:t,onClick:s,className:a})},xi={id:"soft-pink",name:"Soft Pink",category:"natural",description:"Warm pink to red gradient with romantic tones",style:{type:"gradient",gradientColors:["#fda4af","#f87171"],gradientDirection:"to-r",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"lg",borderWidth:1,borderColor:"rgba(253, 164, 175, 0.3)"},previewComponent:pi},yi=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"600",borderRadius:"18px",boxShadow:"0 25px 50px -12px rgba(255, 126, 95, 0.25), 0 0 0 1px rgba(255, 126, 95, 0.1)",border:"none"};return e.jsx(ge,{title:"Warm Orange",content:"Energetic and vibrant",style:n,isSelected:t,onClick:s,className:a})},bi={id:"warm-orange",name:"Warm Orange",category:"creative",description:"Energetic warm orange gradient with peachy tones",style:{type:"gradient",gradientColors:["#ff7e5f","#feb47b"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"semibold",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:yi};class qe{static instance;presets=new Map;categories=new Map;constructor(){this.initializeCategories()}static getInstance(){return qe.instance||(qe.instance=new qe),qe.instance}initializeCategories(){["business","creative","natural","personality"].forEach(a=>{this.categories.set(a,[])})}register(s){this.presets.set(s.id,s);const a=this.categories.get(s.category)||[];a.push(s),this.categories.set(s.category,a)}unregister(s){const a=this.presets.get(s);if(a){this.presets.delete(s);const r=(this.categories.get(a.category)||[]).filter(o=>o.id!==s);this.categories.set(a.category,r)}}getByCategory(s){return this.categories.get(s)||[]}getById(s){return this.presets.get(s)}getAll(){return Array.from(this.presets.values())}getAllByOrder(){const s=[];return["business","creative","natural","personality"].forEach(n=>{const r=this.getByCategory(n);s.push(...r)}),s}getCategoryCount(s){return this.categories.get(s)?.length||0}getTotalCount(){return this.presets.size}clear(){this.presets.clear(),this.initializeCategories()}}const Ns=qe.getInstance(),wi=()=>Ns.getAllByOrder();class Xe{static instance;STORAGE_KEYS={USER_PREFERENCES:"cardall_style_preferences",RECENT_STYLES:"cardall_recent_styles",DEFAULT_STYLE:"cardall_default_style"};constructor(){}static getInstance(){return Xe.instance||(Xe.instance=new Xe),Xe.instance}saveUserPreference(s,a){try{const n=this.getUserPreferences();n[s]={styleId:a,appliedAt:new Date().toISOString()},localStorage.setItem(this.STORAGE_KEYS.USER_PREFERENCES,JSON.stringify(n)),this.addToRecentStyles(a)}catch(n){console.error("Failed to save user style preference:",n)}}getUserPreference(s){try{return this.getUserPreferences()[s]?.styleId||null}catch(a){return console.error("Failed to get user style preference:",a),null}}getRecentStyles(s=10){try{const a=localStorage.getItem(this.STORAGE_KEYS.RECENT_STYLES);return a?JSON.parse(a).slice(0,s):[]}catch(a){return console.error("Failed to get recent styles:",a),[]}}clearPreferences(){try{localStorage.removeItem(this.STORAGE_KEYS.USER_PREFERENCES),localStorage.removeItem(this.STORAGE_KEYS.RECENT_STYLES)}catch(s){console.error("Failed to clear style preferences:",s)}}setDefaultStyle(s){try{localStorage.setItem(this.STORAGE_KEYS.DEFAULT_STYLE,s)}catch(a){console.error("Failed to set default style:",a)}}getDefaultStyle(){try{return localStorage.getItem(this.STORAGE_KEYS.DEFAULT_STYLE)}catch(s){return console.error("Failed to get default style:",s),null}}getUserPreferences(){try{const s=localStorage.getItem(this.STORAGE_KEYS.USER_PREFERENCES);return s?JSON.parse(s):{}}catch(s){return console.error("Failed to parse user preferences:",s),{}}}addToRecentStyles(s){try{const n=this.getRecentStyles().filter(o=>o!==s),r=[s,...n].slice(0,10);localStorage.setItem(this.STORAGE_KEYS.RECENT_STYLES,JSON.stringify(r))}catch(a){console.error("Failed to update recent styles:",a)}}getStyleUsageStats(){try{const s=this.getUserPreferences(),a={};return Object.values(s).forEach(({styleId:n})=>{a[n]=(a[n]||0)+1}),a}catch(s){return console.error("Failed to get style usage stats:",s),{}}}getMostUsedStyles(s=5){try{const a=this.getStyleUsageStats();return Object.entries(a).sort(([,n],[,r])=>r-n).slice(0,s).map(([n])=>n)}catch(a){return console.error("Failed to get most used styles:",a),[]}}}const Ms=Xe.getInstance(),vi=()=>{const t=[Jo,mi,ti,bi,ai,xi,gi,Zo,ii,ri,ci,fi];t.forEach(s=>{Ns.register(s)}),console.log(`Registered ${t.length} card style presets`)};vi();const ji=({isOpen:t,onClose:s,context:a})=>{const[n,r]=l.useState(null),[o,i]=l.useState([]);l.useEffect(()=>{const f=wi();console.log("Loaded style presets:",f.length,f),i(f);const m=Ms.getUserPreference(a.targetCardId);m&&r(m)},[a.targetCardId]);const c=f=>{const m=Ns.getById(f);m&&(r(f),a.onStyleApply(m.style),Ms.saveUserPreference(a.targetCardId,f))},u=()=>{r(null),s()};return t?e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.1)",backdropFilter:"blur(2px)"},children:[e.jsx("div",{className:"absolute inset-0",onClick:u}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl border border-gray-200 p-6 w-full max-w-md sm:max-w-2xl lg:max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Card Styles"}),e.jsx("button",{onClick:u,className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(Be,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3 mb-6",style:{minHeight:"300px",maxHeight:"70vh",overflowY:"auto"},children:o.map(f=>{const m=f.previewComponent;return console.log("Rendering preset:",f.id,f.name,m),e.jsxs("div",{className:"relative",children:[e.jsx(m,{isSelected:n===f.id,onClick:()=>c(f.id),className:"w-full"}),e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 truncate",children:f.name}),e.jsx("div",{className:"text-xs text-gray-500 capitalize",children:f.category})]})]},f.id)})}),e.jsxs("div",{className:"text-xs text-gray-400 text-center mb-2",children:["Loaded ",o.length," presets"]}),e.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Click any style to apply it instantly to your card"})]})]}):null},nn=l.createContext(void 0),Ni=()=>{const t=l.useContext(nn);if(!t)throw new Error("useStylePanel must be used within a StylePanelProvider");return t},Ci=({children:t})=>{const[s,a]=l.useState({isOpen:!1,context:null}),n=i=>{a({isOpen:!0,context:i})},r=()=>{a({isOpen:!1,context:null})},o={openStylePanel:n,closeStylePanel:r,isOpen:s.isOpen};return e.jsxs(nn.Provider,{value:o,children:[t,typeof window<"u"&&s.isOpen&&s.context&&Ot.createPortal(e.jsx(ji,{isOpen:s.isOpen,onClose:r,context:s.context}),document.body)]})},rn=l.createContext(void 0);function Si({children:t}){const[s,a]=l.useState(!1),[n,r]=l.useState(null),[o,i]=l.useState([]),[c,u]=l.useState(null),b={isOpen:s,currentCardId:n,currentCardTags:o,onTagsChange:c,openTagPanel:h=>{r(h.targetCardId),i(h.currentTags),u(()=>h.onTagsApply),a(!0)},closeTagPanel:()=>{a(!1),r(null),i([]),u(null)}};return e.jsx(rn.Provider,{value:b,children:t})}function on(){const t=l.useContext(rn);if(t===void 0)throw new Error("useTagPanel must be used within a TagPanelProvider");return t}const me=l.forwardRef(({className:t,type:s,...a},n)=>e.jsx("input",{type:s,className:S("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...a}));me.displayName="Input";const Pe=l.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(ra,{ref:n,className:S("relative overflow-hidden",t),...a,children:[e.jsx(dr,{className:"h-full w-full rounded-[inherit]",children:s}),e.jsx(ln,{}),e.jsx(mr,{})]}));Pe.displayName=ra.displayName;const ln=l.forwardRef(({className:t,orientation:s="vertical",...a},n)=>e.jsx(oa,{ref:n,orientation:s,className:S("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...a,children:e.jsx(ur,{className:"relative flex-1 rounded-full bg-border"})}));ln.displayName=oa.displayName;const ki=$t("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Y({className:t,variant:s,...a}){return e.jsx("div",{className:S(ki({variant:s}),t),...a})}const Ue=gr,Ti=fr,cn=l.forwardRef(({className:t,...s},a)=>e.jsx(ia,{ref:a,className:S("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));cn.displayName=ia.displayName;const Ie=l.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(Ti,{children:[e.jsx(cn,{}),e.jsxs(la,{ref:n,className:S("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a,children:[s,e.jsxs(hr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ie.displayName=la.displayName;const nt=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});nt.displayName="DialogHeader";const rt=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});rt.displayName="DialogFooter";const ot=l.forwardRef(({className:t,...s},a)=>e.jsx(ca,{ref:a,className:S("text-lg font-semibold leading-none tracking-tight",t),...s}));ot.displayName=ca.displayName;const Vt=l.forwardRef(({className:t,...s},a)=>e.jsx(da,{ref:a,className:S("text-sm text-muted-foreground",t),...s}));Vt.displayName=da.displayName;function Ei({isOpen:t,onClose:s,currentCardId:a,currentFolderId:n,onFolderSelect:r}){const{folders:o,getFolderById:i}=Za(),[c,u]=l.useState(""),[f,m]=l.useState(n);l.useEffect(()=>{t&&(m(n),u(""))},[t,n]);const b=o.filter(x=>x.name.toLowerCase().includes(c.toLowerCase())),h=n?i(n):null,d=x=>{m(x)},w=()=>{r&&r(f),s()},y=()=>{m(n),s()},g=f!==n;return e.jsx(Ue,{open:t,onOpenChange:s,children:e.jsxs(Ie,{className:"sm:max-w-md",children:[e.jsx(nt,{children:e.jsxs(ot,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"Move Card to Folder"]})}),e.jsxs("div",{className:"space-y-4",children:[h&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(Ka,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Currently in:"}),e.jsx(Y,{variant:"secondary",children:h.name})]}),!h&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(Rs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Currently in: Root"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(me,{placeholder:"Search folders...",value:c,onChange:x=>u(x.target.value),className:"pl-10"})]}),e.jsx(Pe,{className:"h-64 w-full border rounded-md",children:e.jsxs("div",{className:"p-2 space-y-1",children:[e.jsxs("div",{className:S("flex items-center gap-3 p-2 rounded-md cursor-pointer transition-colors",f===null?"bg-primary text-primary-foreground":"hover:bg-muted"),onClick:()=>d(null),children:[e.jsx(Rs,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"flex-1",children:"Root"}),f===null&&e.jsx(Fe,{className:"h-4 w-4 flex-shrink-0"}),n===null&&e.jsx(Y,{variant:"outline",className:"text-xs",children:"Current"})]}),b.map(x=>e.jsxs("div",{className:S("flex items-center gap-3 p-2 rounded-md cursor-pointer transition-colors",f===x.id?"bg-primary text-primary-foreground":"hover:bg-muted",n===x.id&&"opacity-60"),onClick:()=>d(x.id),children:[e.jsx(_e,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"flex-1",children:x.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{variant:"outline",className:"text-xs",children:x.cardIds.length}),f===x.id&&e.jsx(Fe,{className:"h-4 w-4 flex-shrink-0"}),n===x.id&&e.jsx(Y,{variant:"outline",className:"text-xs",children:"Current"})]})]},x.id)),b.length===0&&c&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(_e,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No folders found"})]})]})})]}),e.jsxs(rt,{children:[e.jsx(P,{variant:"outline",onClick:y,children:"Cancel"}),e.jsx(P,{onClick:w,disabled:!g,children:g?"Move Card":"No Change"})]})]})})}const dn=l.createContext(void 0);function Ri({children:t}){const[s,a]=l.useState(!1),[n,r]=l.useState(null),[o,i]=l.useState(null),[c,u]=l.useState(null),f=h=>{r(h.targetCardId),i(h.currentFolderId||null),u(()=>h.onFolderApply),a(!0)},m=()=>{a(!1),r(null),i(null),u(null)},b={isOpen:s,currentCardId:n,currentFolderId:o,onFolderSelect:c,openFolderPanel:f,closeFolderPanel:m};return e.jsxs(dn.Provider,{value:b,children:[t,typeof window<"u"&&s&&n&&Ot.createPortal(e.jsx(Ei,{isOpen:s,onClose:m,currentCardId:n,currentFolderId:o,onFolderSelect:c}),document.body)]})}function Di(){const t=l.useContext(dn);if(t===void 0)throw new Error("useFolderPanel must be used within a FolderPanelProvider");return t}function Ai({card:t,onFlip:s,onUpdate:a,onCopy:n,onScreenshot:r,onShare:o,onDelete:i,onMoveToFolder:c,className:u,size:f="md"}){const{openStylePanel:m}=Ni(),{openTagPanel:b}=on(),{openFolderPanel:h}=Di(),d=(p,j)=>{a(p,{style:j,updatedAt:new Date})},w=()=>{m({targetCardId:t.id,currentStyle:t.style,onStyleApply:p=>d(t.id,p),onPanelClose:()=>{}})},y=(p,j)=>{const C=t.isFlipped?t.backContent:t.frontContent,F=t.isFlipped?"backContent":"frontContent";a(p,{[F]:{...C,tags:j,lastModified:new Date},updatedAt:new Date})},g=()=>{const p=t.isFlipped?t.backContent:t.frontContent;b({targetCardId:t.id,currentTags:p.tags,onTagsApply:j=>y(t.id,j),onPanelClose:()=>{}})},x=()=>{c&&h({targetCardId:t.id,currentFolderId:t.folderId,onFolderApply:p=>c(t.id,p),onPanelClose:()=>{}})};return e.jsx(Ko,{card:t,onFlip:s,onUpdate:a,onCopy:n,onScreenshot:r,onShare:o,onDelete:i,onStyleChange:w,onTagsChange:g,onMoveToFolder:c?x:void 0,className:u,size:f})}function _i({items:t,gap:s=16,minColumnWidth:a=280,maxColumns:n=5,breakpoints:r={sm:640,md:768,lg:1024,xl:1280,"2xl":1536}}){const o=l.useRef(null),[i,c]=l.useState(new Map),[u,f]=l.useState(0),[m,b]=l.useState({columns:1,gap:s,containerWidth:0}),h=l.useCallback(x=>{if(x===0)return 1;let p=n;x<r.sm?p=1:x<r.md?p=2:x<r.lg?p=3:x<r.xl&&(p=4);const j=x-s,C=Math.floor(j/(a+s));return Math.min(Math.max(1,C),p)},[s,a,n,r]),d=l.useCallback((x,p,j,C)=>{if(p===0||j===0)return{positions:new Map,totalHeight:0};const F=C*(p-1),A=j-F,v=Math.floor(A/p),N=new Array(p).fill(0),R=new Map;x.forEach(_=>{const U=N.indexOf(Math.min(...N)),J=U*(v+C),$=N[U];R.set(_.id,{x:J,y:$,width:v,height:_.height}),N[U]+=_.height+C});const B=Math.max(...N)-C;return{positions:R,totalHeight:B}},[]),w=l.useCallback(x=>{const p=x[0];if(!p)return;const j=p.contentRect.width,C=h(j);b(F=>({...F,columns:C,containerWidth:j}))},[h]);l.useEffect(()=>{const x=o.current;if(!x)return;const p=new ResizeObserver(j=>{w(j)});return p.observe(x),()=>{p.disconnect()}},[w]),l.useEffect(()=>{if(t.length===0||m.containerWidth===0){c(new Map),f(0);return}const{positions:x,totalHeight:p}=d(t,m.columns,m.containerWidth,s);c(x),f(p)},[t,m,s,d]);const y=l.useCallback(x=>i.get(x),[i]),g=l.useCallback((x,p)=>{const j=t.findIndex(v=>v.id===x);if(j===-1)return;const C=[...t];C[j]={...C[j],height:p};const{positions:F,totalHeight:A}=d(C,m.columns,m.containerWidth,s);c(F),f(A)},[t,m,s,d]);return{containerRef:o,positions:i,containerHeight:u,config:m,getItemPosition:y,updateItemHeight:g}}function Pi({cards:t,onCardFlip:s,onCardUpdate:a,onCardCopy:n,onCardScreenshot:r,onCardShare:o,onCardDelete:i,onMoveToFolder:c,onCardStyleChange:u,cardSize:f="md",className:m,gap:b=16,enableVirtualization:h=!0,overscan:d=5}){const[w,y]=l.useState(new Map),[g,x]=l.useState(!1),[p,j]=l.useState(0),[C,F]=l.useState(0),A=l.useRef(new Map),v=l.useRef(null),N=l.useMemo(()=>[...t].sort((M,H)=>new Date(H.createdAt).getTime()-new Date(M.createdAt).getTime()),[t]),R=l.useCallback(M=>{const E={sm:.8,md:1,lg:1.3}[f],T=200*E,k=Math.min(Math.ceil(M.frontContent.title.length/25),3)*24*E,z=Math.min(Math.ceil(M.frontContent.text.length/40),8)*18*E,W=M.frontContent.images.length>0?120*E:0,I=M.frontContent.tags.length>0?32*E:0,V=32*E;return Math.round(T+k+z+W+I+V)},[f]),B=l.useMemo(()=>N.map(M=>({id:M.id,height:w.get(M.id)||R(M)})),[N,w,R]),_=l.useMemo(()=>({sm:{minColumnWidth:240,maxColumns:5},md:{minColumnWidth:280,maxColumns:4},lg:{minColumnWidth:320,maxColumns:3}})[f],[f]),{containerRef:U,positions:J,containerHeight:$,updateItemHeight:q}=_i({items:B,gap:b,..._,breakpoints:{sm:640,md:768,lg:1024,xl:1280,"2xl":1536}}),ee=l.useMemo(()=>{if(!h||!v.current)return N;const M=v.current.clientHeight,H=p-d*100,E=p+M+d*100;return N.filter(T=>{const k=J.get(T.id);return k?k.y+k.height>=H&&k.y<=E:!0})},[N,J,p,h,d]);l.useCallback(M=>{h&&j(M.currentTarget.scrollTop)},[h]);const Z=l.useCallback(M=>{const H=A.current.get(M);if(!H)return;const E=new ResizeObserver(T=>{const k=T[0];if(k){const z=k.contentRect.height,W=w.get(M);Math.abs(z-(W||0))>3&&(y(I=>{const V=new Map(I);return V.set(M,z),V}),q(M,z))}});return E.observe(H),()=>E.disconnect()},[w,q]);l.useEffect(()=>{if(!g&&N.length>0){const M=new Map;N.forEach(H=>{M.set(H.id,R(H))}),y(M),x(!0)}},[N,R,g]),l.useEffect(()=>{const M=[];return ee.forEach(H=>{const E=Z(H.id);E&&M.push(E)}),()=>{M.forEach(H=>H())}},[ee,Z]);const le=l.useCallback((M,H)=>{H?A.current.set(M,H):A.current.delete(M)},[]);return l.useEffect(()=>{v.current&&F(v.current.clientHeight)},[]),N.length===0?e.jsx("div",{className:"flex-1 flex items-center justify-center p-12",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-24 h-24 mx-auto rounded-full bg-muted flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"+"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"No cards yet"}),e.jsx("p",{className:"text-muted-foreground max-w-sm",children:"Create your first knowledge card to get started. Click the + button to begin."})]})]})}):e.jsx("div",{ref:U,className:S("relative w-full",m),style:{height:$},children:ee.map(M=>{const H=J.get(M.id);return H?e.jsx("div",{ref:E=>le(M.id,E),className:"absolute transition-all duration-300 ease-out",style:{transform:`translate3d(${H.x}px, ${H.y}px, 0)`,width:H.width,willChange:"transform"},children:e.jsx(Ai,{card:M,onFlip:s,onUpdate:a,onCopy:n,onScreenshot:r,onShare:o,onDelete:i,onMoveToFolder:c,size:f,className:"w-full"})},M.id):null})})}const mn=l.forwardRef(({className:t,...s},a)=>e.jsxs(ma,{ref:a,className:S("relative flex w-full touch-none select-none items-center",t),...s,children:[e.jsx(pr,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(xr,{className:"absolute h-full bg-primary"})}),e.jsx(yr,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));mn.displayName=ma.displayName;const Fi=$t("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ue=l.forwardRef(({className:t,...s},a)=>e.jsx(ua,{ref:a,className:S(Fi(),t),...s}));ue.displayName=ua.displayName;const Je=l.forwardRef(({className:t,orientation:s="horizontal",decorative:a=!0,...n},r)=>e.jsx(fa,{ref:r,decorative:a,orientation:s,className:S("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));Je.displayName=fa.displayName;const un=wr,fn=vr,Cs=l.forwardRef(({className:t,align:s="center",sideOffset:a=4,...n},r)=>e.jsx(br,{children:e.jsx(ha,{ref:r,align:s,sideOffset:a,className:S("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));Cs.displayName=ha.displayName;function Ls(t){if(!t)return"";try{const s=new DOMParser().parseFromString(t,"text/html");s.querySelectorAll("img").forEach(i=>i.remove()),s.querySelectorAll("br").forEach(i=>{i.replaceWith(`
`)}),s.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, li, blockquote").forEach(i=>{i.insertAdjacentText("afterend",`
`)});let o=s.body.textContent||s.body.innerText||"";return o=o.replace(/[ \t]+/g," ").replace(/[ \t]*\n[ \t]*/g,`
`).replace(/\n{3,}/g,`

`).trim(),o}catch(s){return console.warn("Failed to parse HTML, falling back to regex cleanup:",s),t.replace(/<img[^>]*>/gi,"").replace(/<br\s*\/?>/gi,`
`).replace(/<\/?(p|div|h[1-6]|li|blockquote)[^>]*>/gi,`
`).replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/[ \t]+/g," ").replace(/[ \t]*\n[ \t]*/g,`
`).replace(/\n{3,}/g,`

`).trim()}}function Ii(t,s){const a=Ls(t),n=Ls(s);return`${a}

${n}`}async function Mi(t){try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(t),!0;{const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.left="-999999px",s.style.top="-999999px",document.body.appendChild(s),s.focus(),s.select();const a=document.execCommand("copy");return document.body.removeChild(s),a}}catch(s){return console.error("Failed to copy text to clipboard:",s),!1}}function Li(t,s){return t[13]=1,t[14]=s>>8,t[15]=s&255,t[16]=s>>8,t[17]=s&255,t}const hn=112,gn=72,pn=89,xn=115;let os;function zi(){const t=new Int32Array(256);for(let s=0;s<256;s++){let a=s;for(let n=0;n<8;n++)a=a&1?3988292384^a>>>1:a>>>1;t[s]=a}return t}function Oi(t){let s=-1;os||(os=zi());for(let a=0;a<t.length;a++)s=os[(s^t[a])&255]^s>>>8;return s^-1}function $i(t){const s=t.length-1;for(let a=s;a>=4;a--)if(t[a-4]===9&&t[a-3]===hn&&t[a-2]===gn&&t[a-1]===pn&&t[a]===xn)return a-3;return 0}function Ui(t,s,a=!1){const n=new Uint8Array(13);s*=39.3701,n[0]=hn,n[1]=gn,n[2]=pn,n[3]=xn,n[4]=s>>>24,n[5]=s>>>16,n[6]=s>>>8,n[7]=s&255,n[8]=n[4],n[9]=n[5],n[10]=n[6],n[11]=n[7],n[12]=1;const r=Oi(n),o=new Uint8Array(4);if(o[0]=r>>>24,o[1]=r>>>16,o[2]=r>>>8,o[3]=r&255,a){const i=$i(t);return t.set(n,i),t.set(o,i+13),t}else{const i=new Uint8Array(4);i[0]=0,i[1]=0,i[2]=0,i[3]=9;const c=new Uint8Array(54);return c.set(t,0),c.set(i,33),c.set(n,37),c.set(o,50),c}}const Bi="AAlwSFlz",Vi="AAAJcEhZ",Wi="AAAACXBI";function Hi(t){let s=t.indexOf(Bi);return s===-1&&(s=t.indexOf(Vi)),s===-1&&(s=t.indexOf(Wi)),s}const yn="[modern-screenshot]",Me=typeof window<"u",Gi=Me&&"Worker"in window,Yi=Me&&"atob"in window,Ki=Me&&"btoa"in window,Ss=Me?window.navigator?.userAgent:"",bn=Ss.includes("Chrome"),zt=Ss.includes("AppleWebKit")&&!bn,ks=Ss.includes("Firefox"),qi=t=>t&&"__CONTEXT__"in t,Xi=t=>t.constructor.name==="CSSFontFaceRule",Ji=t=>t.constructor.name==="CSSImportRule",je=t=>t.nodeType===1,kt=t=>typeof t.className=="object",wn=t=>t.tagName==="image",Qi=t=>t.tagName==="use",Nt=t=>je(t)&&typeof t.style<"u"&&!kt(t),Zi=t=>t.nodeType===8,el=t=>t.nodeType===3,at=t=>t.tagName==="IMG",Wt=t=>t.tagName==="VIDEO",tl=t=>t.tagName==="CANVAS",sl=t=>t.tagName==="TEXTAREA",al=t=>t.tagName==="INPUT",nl=t=>t.tagName==="STYLE",rl=t=>t.tagName==="SCRIPT",ol=t=>t.tagName==="SELECT",il=t=>t.tagName==="SLOT",ll=t=>t.tagName==="IFRAME",cl=(...t)=>console.warn(yn,...t);function dl(t){const s=t?.createElement?.("canvas");return s&&(s.height=s.width=1),!!s&&"toDataURL"in s&&!!s.toDataURL("image/webp").includes("image/webp")}const gs=t=>t.startsWith("data:");function vn(t,s){if(t.match(/^[a-z]+:\/\//i))return t;if(Me&&t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i)||!Me)return t;const a=Ht().implementation.createHTMLDocument(),n=a.createElement("base"),r=a.createElement("a");return a.head.appendChild(n),a.body.appendChild(r),s&&(n.href=s),r.href=t,r.href}function Ht(t){return(t&&je(t)?t?.ownerDocument:t)??window.document}const Gt="http://www.w3.org/2000/svg";function ml(t,s,a){const n=Ht(a).createElementNS(Gt,"svg");return n.setAttributeNS(null,"width",t.toString()),n.setAttributeNS(null,"height",s.toString()),n.setAttributeNS(null,"viewBox",`0 0 ${t} ${s}`),n}function ul(t,s){let a=new XMLSerializer().serializeToString(t);return s&&(a=a.replace(/[\u0000-\u0008\v\f\u000E-\u001F\uD800-\uDFFF\uFFFE\uFFFF]/gu,"")),`data:image/svg+xml;charset=utf-8,${encodeURIComponent(a)}`}function fl(t,s){return new Promise((a,n)=>{const r=new FileReader;r.onload=()=>a(r.result),r.onerror=()=>n(r.error),r.onabort=()=>n(new Error(`Failed read blob to ${s}`)),r.readAsDataURL(t)})}const hl=t=>fl(t,"dataUrl");function tt(t,s){const a=Ht(s).createElement("img");return a.decoding="sync",a.loading="eager",a.src=t,a}function Ct(t,s){return new Promise(a=>{const{timeout:n,ownerDocument:r,onError:o,onWarn:i}=s??{},c=typeof t=="string"?tt(t,Ht(r)):t;let u=null,f=null;function m(){a(c),u&&clearTimeout(u),f?.()}if(n&&(u=setTimeout(m,n)),Wt(c)){const b=c.currentSrc||c.src;if(!b)return c.poster?Ct(c.poster,s).then(a):m();if(c.readyState>=2)return m();const h=m,d=w=>{i?.("Failed video load",b,w),o?.(w),m()};f=()=>{c.removeEventListener("loadeddata",h),c.removeEventListener("error",d)},c.addEventListener("loadeddata",h,{once:!0}),c.addEventListener("error",d,{once:!0})}else{const b=wn(c)?c.href.baseVal:c.currentSrc||c.src;if(!b)return m();const h=async()=>{if(at(c)&&"decode"in c)try{await c.decode()}catch(w){i?.("Failed to decode image, trying to render anyway",c.dataset.originalSrc||b,w)}m()},d=w=>{i?.("Failed image load",c.dataset.originalSrc||b,w),m()};if(at(c)&&c.complete)return h();f=()=>{c.removeEventListener("load",h),c.removeEventListener("error",d)},c.addEventListener("load",h,{once:!0}),c.addEventListener("error",d,{once:!0})}})}async function gl(t,s){Nt(t)&&(at(t)||Wt(t)?await Ct(t,s):await Promise.all(["img","video"].flatMap(a=>Array.from(t.querySelectorAll(a)).map(n=>Ct(n,s)))))}const jn=function(){let s=0;const a=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(s+=1,`u${a()}${s}`)}();function Nn(t){return t?.split(",").map(s=>s.trim().replace(/"|'/g,"").toLowerCase()).filter(Boolean)}let zs=0;function pl(t){const s=`${yn}[#${zs}]`;return zs++,{time:a=>t&&console.time(`${s} ${a}`),timeEnd:a=>t&&console.timeEnd(`${s} ${a}`),warn:(...a)=>t&&cl(...a)}}function xl(t){return{cache:t?"no-cache":"force-cache"}}async function Yt(t,s){return qi(t)?t:yl(t,{...s,autoDestruct:!0})}async function yl(t,s){const{scale:a=1,workerUrl:n,workerNumber:r=1}=s||{},o=!!s?.debug,i=s?.features??!0,c=t.ownerDocument??(Me?window.document:void 0),u=t.ownerDocument?.defaultView??(Me?window:void 0),f=new Map,m={width:0,height:0,quality:1,type:"image/png",scale:a,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:o,fetch:{requestInit:xl(s?.fetch?.bypassingCache),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1,...s?.fetch},fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:r,onCloneEachNode:null,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1,...s,__CONTEXT__:!0,log:pl(o),node:t,ownerDocument:c,ownerWindow:u,dpi:a===1?null:96*a,svgStyleElement:Cn(c),svgDefsElement:c?.createElementNS(Gt,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...Array.from({length:Gi&&n&&r?r:0})].map(()=>{try{const d=new Worker(n);return d.onmessage=async w=>{const{url:y,result:g}=w.data;g?f.get(y)?.resolve?.(g):f.get(y)?.reject?.(new Error(`Error receiving message from worker: ${y}`))},d.onmessageerror=w=>{const{url:y}=w.data;f.get(y)?.reject?.(new Error(`Error receiving message from worker: ${y}`))},d}catch(d){return m.log.warn("Failed to new Worker",d),null}}).filter(Boolean),fontFamilies:new Map,fontCssTexts:new Map,acceptOfImage:`${[dl(c)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(",")};q=0.8`,requests:f,drawImageCount:0,tasks:[],features:i,isEnable:d=>d==="restoreScrollPosition"?typeof i=="boolean"?!1:i[d]??!1:typeof i=="boolean"?i:i[d]??!0,shadowRoots:[]};m.log.time("wait until load"),await gl(t,{timeout:m.timeout,onWarn:m.log.warn}),m.log.timeEnd("wait until load");const{width:b,height:h}=bl(t,m);return m.width=b,m.height=h,m}function Cn(t){if(!t)return;const s=t.createElement("style"),a=s.ownerDocument.createTextNode(`
.______background-clip--text {
  background-clip: text;
  -webkit-background-clip: text;
}
`);return s.appendChild(a),s}function bl(t,s){let{width:a,height:n}=s;if(je(t)&&(!a||!n)){const r=t.getBoundingClientRect();a=a||r.width||Number(t.getAttribute("width"))||0,n=n||r.height||Number(t.getAttribute("height"))||0}return{width:a,height:n}}async function wl(t,s){const{log:a,timeout:n,drawImageCount:r,drawImageInterval:o}=s;a.time("image to canvas");const i=await Ct(t,{timeout:n,onWarn:s.log.warn}),{canvas:c,context2d:u}=vl(t.ownerDocument,s),f=()=>{try{u?.drawImage(i,0,0,c.width,c.height)}catch(m){s.log.warn("Failed to drawImage",m)}};if(f(),s.isEnable("fixSvgXmlDecode"))for(let m=0;m<r;m++)await new Promise(b=>{setTimeout(()=>{u?.clearRect(0,0,c.width,c.height),f(),b()},m+o)});return s.drawImageCount=0,a.timeEnd("image to canvas"),c}function vl(t,s){const{width:a,height:n,scale:r,backgroundColor:o,maximumCanvasSize:i}=s,c=t.createElement("canvas");c.width=Math.floor(a*r),c.height=Math.floor(n*r),c.style.width=`${a}px`,c.style.height=`${n}px`,i&&(c.width>i||c.height>i)&&(c.width>i&&c.height>i?c.width>c.height?(c.height*=i/c.width,c.width=i):(c.width*=i/c.height,c.height=i):c.width>i?(c.height*=i/c.width,c.width=i):(c.width*=i/c.height,c.height=i));const u=c.getContext("2d");return u&&o&&(u.fillStyle=o,u.fillRect(0,0,c.width,c.height)),{canvas:c,context2d:u}}function Sn(t,s){if(t.ownerDocument)try{const o=t.toDataURL();if(o!=="data:,")return tt(o,t.ownerDocument)}catch(o){s.log.warn("Failed to clone canvas",o)}const a=t.cloneNode(!1),n=t.getContext("2d"),r=a.getContext("2d");try{return n&&r&&r.putImageData(n.getImageData(0,0,t.width,t.height),0,0),a}catch(o){s.log.warn("Failed to clone canvas",o)}return a}function jl(t,s){try{if(t?.contentDocument?.body)return Ts(t.contentDocument.body,s)}catch(a){s.log.warn("Failed to clone iframe",a)}return t.cloneNode(!1)}function Nl(t){const s=t.cloneNode(!1);return t.currentSrc&&t.currentSrc!==t.src&&(s.src=t.currentSrc,s.srcset=""),s.loading==="lazy"&&(s.loading="eager"),s}async function Cl(t,s){if(t.ownerDocument&&!t.currentSrc&&t.poster)return tt(t.poster,t.ownerDocument);const a=t.cloneNode(!1);a.crossOrigin="anonymous",t.currentSrc&&t.currentSrc!==t.src&&(a.src=t.currentSrc);const n=a.ownerDocument;if(n){let r=!0;if(await Ct(a,{onError:()=>r=!1,onWarn:s.log.warn}),!r)return t.poster?tt(t.poster,t.ownerDocument):a;a.currentTime=t.currentTime,await new Promise(i=>{a.addEventListener("seeked",i,{once:!0})});const o=n.createElement("canvas");o.width=t.offsetWidth,o.height=t.offsetHeight;try{const i=o.getContext("2d");i&&i.drawImage(a,0,0,o.width,o.height)}catch(i){return s.log.warn("Failed to clone video",i),t.poster?tt(t.poster,t.ownerDocument):a}return Sn(o,s)}return a}function Sl(t,s){return tl(t)?Sn(t,s):ll(t)?jl(t,s):at(t)?Nl(t):Wt(t)?Cl(t,s):t.cloneNode(!1)}function kl(t){let s=t.sandbox;if(!s){const{ownerDocument:a}=t;try{a&&(s=a.createElement("iframe"),s.id=`__SANDBOX__${jn()}`,s.width="0",s.height="0",s.style.visibility="hidden",s.style.position="fixed",a.body.appendChild(s),s.srcdoc='<!DOCTYPE html><meta charset="UTF-8"><title></title><body>',t.sandbox=s)}catch(n){t.log.warn("Failed to getSandBox",n)}}return s}const Tl=["width","height","-webkit-text-fill-color"],El=["stroke","fill"];function kn(t,s,a){const{defaultComputedStyles:n}=a,r=t.nodeName.toLowerCase(),o=kt(t)&&r!=="svg",i=o?El.map(y=>[y,t.getAttribute(y)]).filter(([,y])=>y!==null):[],c=[o&&"svg",r,i.map((y,g)=>`${y}=${g}`).join(","),s].filter(Boolean).join(":");if(n.has(c))return n.get(c);const f=kl(a)?.contentWindow;if(!f)return new Map;const m=f?.document;let b,h;o?(b=m.createElementNS(Gt,"svg"),h=b.ownerDocument.createElementNS(b.namespaceURI,r),i.forEach(([y,g])=>{h.setAttributeNS(null,y,g)}),b.appendChild(h)):b=h=m.createElement(r),h.textContent=" ",m.body.appendChild(b);const d=f.getComputedStyle(h,s),w=new Map;for(let y=d.length,g=0;g<y;g++){const x=d.item(g);Tl.includes(x)||w.set(x,d.getPropertyValue(x))}return m.body.removeChild(b),n.set(c,w),w}function Tn(t,s,a){const n=new Map,r=[],o=new Map;if(a)for(const c of a)i(c);else for(let c=t.length,u=0;u<c;u++){const f=t.item(u);i(f)}for(let c=r.length,u=0;u<c;u++)o.get(r[u])?.forEach((f,m)=>n.set(m,f));function i(c){const u=t.getPropertyValue(c),f=t.getPropertyPriority(c),m=c.lastIndexOf("-"),b=m>-1?c.substring(0,m):void 0;if(b){let h=o.get(b);h||(h=new Map,o.set(b,h)),h.set(c,[u,f])}s.get(c)===u&&!f||(b?r.push(b):n.set(c,[u,f]))}return n}function Rl(t,s,a,n){const{ownerWindow:r,includeStyleProperties:o,currentParentNodeStyle:i}=n,c=s.style,u=r.getComputedStyle(t),f=kn(t,null,n);i?.forEach((b,h)=>{f.delete(h)});const m=Tn(u,f,o);m.delete("transition-property"),m.delete("all"),m.delete("d"),m.delete("content"),a&&(m.delete("margin-top"),m.delete("margin-right"),m.delete("margin-bottom"),m.delete("margin-left"),m.delete("margin-block-start"),m.delete("margin-block-end"),m.delete("margin-inline-start"),m.delete("margin-inline-end"),m.set("box-sizing",["border-box",""])),m.get("background-clip")?.[0]==="text"&&s.classList.add("______background-clip--text"),bn&&(m.has("font-kerning")||m.set("font-kerning",["normal",""]),(m.get("overflow-x")?.[0]==="hidden"||m.get("overflow-y")?.[0]==="hidden")&&m.get("text-overflow")?.[0]==="ellipsis"&&t.scrollWidth===t.clientWidth&&m.set("text-overflow",["clip",""]));for(let b=c.length,h=0;h<b;h++)c.removeProperty(c.item(h));return m.forEach(([b,h],d)=>{c.setProperty(d,b,h)}),m}function Dl(t,s){(sl(t)||al(t)||ol(t))&&s.setAttribute("value",t.value)}const Al=[":before",":after"],_l=[":-webkit-scrollbar",":-webkit-scrollbar-button",":-webkit-scrollbar-thumb",":-webkit-scrollbar-track",":-webkit-scrollbar-track-piece",":-webkit-scrollbar-corner",":-webkit-resizer"];function Pl(t,s,a,n,r){const{ownerWindow:o,svgStyleElement:i,svgStyles:c,currentNodeStyle:u}=n;if(!i||!o)return;function f(m){const b=o.getComputedStyle(t,m);let h=b.getPropertyValue("content");if(!h||h==="none")return;r?.(h),h=h.replace(/(')|(")|(counter\(.+\))/g,"");const d=[jn()],w=kn(t,m,n);u?.forEach((j,C)=>{w.delete(C)});const y=Tn(b,w,n.includeStyleProperties);y.delete("content"),y.delete("-webkit-locale"),y.get("background-clip")?.[0]==="text"&&s.classList.add("______background-clip--text");const g=[`content: '${h}';`];if(y.forEach(([j,C],F)=>{g.push(`${F}: ${j}${C?" !important":""};`)}),g.length===1)return;try{s.className=[s.className,...d].join(" ")}catch(j){n.log.warn("Failed to copyPseudoClass",j);return}const x=g.join(`
  `);let p=c.get(x);p||(p=[],c.set(x,p)),p.push(`.${d[0]}:${m}`)}Al.forEach(f),a&&_l.forEach(f)}const Os=new Set(["symbol"]);async function $s(t,s,a,n,r){if(je(a)&&(nl(a)||rl(a))||n.filter&&!n.filter(a))return;Os.has(s.nodeName)||Os.has(a.nodeName)?n.currentParentNodeStyle=void 0:n.currentParentNodeStyle=n.currentNodeStyle;const o=await Ts(a,n,!1,r);n.isEnable("restoreScrollPosition")&&Fl(t,o),s.appendChild(o)}async function Us(t,s,a,n){let r=t.firstChild;je(t)&&t.shadowRoot&&(r=t.shadowRoot?.firstChild,a.shadowRoots.push(t.shadowRoot));for(let o=r;o;o=o.nextSibling)if(!Zi(o))if(je(o)&&il(o)&&typeof o.assignedNodes=="function"){const i=o.assignedNodes();for(let c=0;c<i.length;c++)await $s(t,s,i[c],a,n)}else await $s(t,s,o,a,n)}function Fl(t,s){if(!Nt(t)||!Nt(s))return;const{scrollTop:a,scrollLeft:n}=t;if(!a&&!n)return;const{transform:r}=s.style,o=new DOMMatrix(r),{a:i,b:c,c:u,d:f}=o;o.a=1,o.b=0,o.c=0,o.d=1,o.translateSelf(-n,-a),o.a=i,o.b=c,o.c=u,o.d=f,s.style.transform=o.toString()}function Il(t,s){const{backgroundColor:a,width:n,height:r,style:o}=s,i=t.style;if(a&&i.setProperty("background-color",a,"important"),n&&i.setProperty("width",`${n}px`,"important"),r&&i.setProperty("height",`${r}px`,"important"),o)for(const c in o)i[c]=o[c]}const Ml=/^[\w-:]+$/;async function Ts(t,s,a=!1,n){const{ownerDocument:r,ownerWindow:o,fontFamilies:i,onCloneEachNode:c}=s;if(r&&el(t))return n&&/\S/.test(t.data)&&n(t.data),r.createTextNode(t.data);if(r&&o&&je(t)&&(Nt(t)||kt(t))){const f=await Sl(t,s);if(s.isEnable("removeAbnormalAttributes")){const y=f.getAttributeNames();for(let g=y.length,x=0;x<g;x++){const p=y[x];Ml.test(p)||f.removeAttribute(p)}}const m=s.currentNodeStyle=Rl(t,f,a,s);a&&Il(f,s);let b=!1;if(s.isEnable("copyScrollbar")){const y=[m.get("overflow-x")?.[0],m.get("overflow-y")?.[0]];b=y.includes("scroll")||(y.includes("auto")||y.includes("overlay"))&&(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)}const h=m.get("text-transform")?.[0],d=Nn(m.get("font-family")?.[0]),w=d?y=>{h==="uppercase"?y=y.toUpperCase():h==="lowercase"?y=y.toLowerCase():h==="capitalize"&&(y=y[0].toUpperCase()+y.substring(1)),d.forEach(g=>{let x=i.get(g);x||i.set(g,x=new Set),y.split("").forEach(p=>x.add(p))})}:void 0;return Pl(t,f,b,s,w),Dl(t,f),Wt(t)||await Us(t,f,s,w),await c?.(f),f}const u=t.cloneNode(!1);return await Us(t,u,s),await c?.(u),u}function Ll(t){if(t.ownerDocument=void 0,t.ownerWindow=void 0,t.svgStyleElement=void 0,t.svgDefsElement=void 0,t.svgStyles.clear(),t.defaultComputedStyles.clear(),t.sandbox){try{t.sandbox.remove()}catch(s){t.log.warn("Failed to destroyContext",s)}t.sandbox=void 0}t.workers=[],t.fontFamilies.clear(),t.fontCssTexts.clear(),t.requests.clear(),t.tasks=[],t.shadowRoots=[]}function zl(t){const{url:s,timeout:a,responseType:n,...r}=t,o=new AbortController,i=a?setTimeout(()=>o.abort(),a):void 0;return fetch(s,{signal:o.signal,...r}).then(c=>{if(!c.ok)throw new Error("Failed fetch, not 2xx response",{cause:c});switch(n){case"arrayBuffer":return c.arrayBuffer();case"dataUrl":return c.blob().then(hl);case"text":default:return c.text()}}).finally(()=>clearTimeout(i))}function St(t,s){const{url:a,requestType:n="text",responseType:r="text",imageDom:o}=s;let i=a;const{timeout:c,acceptOfImage:u,requests:f,fetchFn:m,fetch:{requestInit:b,bypassingCache:h,placeholderImage:d},font:w,workers:y,fontFamilies:g}=t;n==="image"&&(zt||ks)&&t.drawImageCount++;let x=f.get(a);if(!x){h&&h instanceof RegExp&&h.test(i)&&(i+=(/\?/.test(i)?"&":"?")+new Date().getTime());const p=n.startsWith("font")&&w&&w.minify,j=new Set;p&&n.split(";")[1].split(",").forEach(v=>{g.has(v)&&g.get(v).forEach(N=>j.add(N))});const C=p&&j.size,F={url:i,timeout:c,responseType:C?"arrayBuffer":r,headers:n==="image"?{accept:u}:void 0,...b};x={type:n,resolve:void 0,reject:void 0,response:null},x.response=(async()=>{if(m&&n==="image"){const A=await m(a);if(A)return A}return!zt&&a.startsWith("http")&&y.length?new Promise((A,v)=>{y[f.size&y.length-1].postMessage({rawUrl:a,...F}),x.resolve=A,x.reject=v}):zl(F)})().catch(A=>{if(f.delete(a),n==="image"&&d)return t.log.warn("Failed to fetch image base64, trying to use placeholder image",i),typeof d=="string"?d:d(o);throw A}),f.set(a,x)}return x.response}async function En(t,s,a,n){if(!Rn(t))return t;for(const[r,o]of Ol(t,s))try{const i=await St(a,{url:o,requestType:n?"image":"text",responseType:"dataUrl"});t=t.replace($l(r),`$1${i}$3`)}catch(i){a.log.warn("Failed to fetch css data url",r,i)}return t}function Rn(t){return/url\((['"]?)([^'"]+?)\1\)/.test(t)}const Dn=/url\((['"]?)([^'"]+?)\1\)/g;function Ol(t,s){const a=[];return t.replace(Dn,(n,r,o)=>(a.push([o,vn(o,s)]),n)),a.filter(([n])=>!gs(n))}function $l(t){const s=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${s})(['"]?\\))`,"g")}const Ul=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function Bl(t,s){return Ul.map(a=>{const n=t.getPropertyValue(a);return!n||n==="none"?null:((zt||ks)&&s.drawImageCount++,En(n,null,s,!0).then(r=>{!r||n===r||t.setProperty(a,r,t.getPropertyPriority(a))}))}).filter(Boolean)}function Vl(t,s){if(at(t)){const a=t.currentSrc||t.src;if(!gs(a))return[St(s,{url:a,imageDom:t,requestType:"image",responseType:"dataUrl"}).then(n=>{n&&(t.srcset="",t.dataset.originalSrc=a,t.src=n||"")})];(zt||ks)&&s.drawImageCount++}else if(kt(t)&&!gs(t.href.baseVal)){const a=t.href.baseVal;return[St(s,{url:a,imageDom:t,requestType:"image",responseType:"dataUrl"}).then(n=>{n&&(t.dataset.originalSrc=a,t.href.baseVal=n||"")})]}return[]}function Wl(t,s){const{ownerDocument:a,svgDefsElement:n}=s,r=t.getAttribute("href")??t.getAttribute("xlink:href");if(!r)return[];const[o,i]=r.split("#");if(i){const c=`#${i}`,u=s.shadowRoots.reduce((f,m)=>f??m.querySelector(`svg ${c}`),a?.querySelector(`svg ${c}`));if(o&&t.setAttribute("href",c),n?.querySelector(c))return[];if(u)return n?.appendChild(u.cloneNode(!0)),[];if(o)return[St(s,{url:o,responseType:"text"}).then(f=>{n?.insertAdjacentHTML("beforeend",f)})]}return[]}function An(t,s){const{tasks:a}=s;je(t)&&((at(t)||wn(t))&&a.push(...Vl(t,s)),Qi(t)&&a.push(...Wl(t,s))),Nt(t)&&a.push(...Bl(t.style,s)),t.childNodes.forEach(n=>{An(n,s)})}async function Hl(t,s){const{ownerDocument:a,svgStyleElement:n,fontFamilies:r,fontCssTexts:o,tasks:i,font:c}=s;if(!(!a||!n||!r.size))if(c&&c.cssText){const u=Vs(c.cssText,s);n.appendChild(a.createTextNode(`${u}
`))}else{const u=Array.from(a.styleSheets).filter(m=>{try{return"cssRules"in m&&!!m.cssRules.length}catch(b){return s.log.warn(`Error while reading CSS rules from ${m.href}`,b),!1}});await Promise.all(u.flatMap(m=>Array.from(m.cssRules).map(async(b,h)=>{if(Ji(b)){let d=h+1;const w=b.href;let y="";try{y=await St(s,{url:w,requestType:"text",responseType:"text"})}catch(x){s.log.warn(`Error fetch remote css import from ${w}`,x)}const g=y.replace(Dn,(x,p,j)=>x.replace(j,vn(j,w)));for(const x of Yl(g))try{m.insertRule(x,x.startsWith("@import")?d+=1:m.cssRules.length)}catch(p){s.log.warn("Error inserting rule from remote css import",{rule:x,error:p})}}}))),u.flatMap(m=>Array.from(m.cssRules)).filter(m=>Xi(m)&&Rn(m.style.getPropertyValue("src"))&&Nn(m.style.getPropertyValue("font-family"))?.some(b=>r.has(b))).forEach(m=>{const b=m,h=o.get(b.cssText);h?n.appendChild(a.createTextNode(`${h}
`)):i.push(En(b.cssText,b.parentStyleSheet?b.parentStyleSheet.href:null,s).then(d=>{d=Vs(d,s),o.set(b.cssText,d),n.appendChild(a.createTextNode(`${d}
`))}))})}}const Gl=/(\/\*[\s\S]*?\*\/)/g,Bs=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi;function Yl(t){if(t==null)return[];const s=[];let a=t.replace(Gl,"");for(;;){const o=Bs.exec(a);if(!o)break;s.push(o[0])}a=a.replace(Bs,"");const n=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,r=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let o=n.exec(a);if(o)r.lastIndex=n.lastIndex;else if(o=r.exec(a),o)n.lastIndex=r.lastIndex;else break;s.push(o[0])}return s}const Kl=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ql=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Vs(t,s){const{font:a}=s,n=a?a?.preferredFormat:void 0;return n?t.replace(ql,r=>{for(;;){const[o,,i]=Kl.exec(r)||[];if(!i)return"";if(i===n)return`src: ${o};`}}):t}async function Xl(t,s){const a=await Yt(t,s);if(je(a.node)&&kt(a.node))return a.node;const{ownerDocument:n,log:r,tasks:o,svgStyleElement:i,svgDefsElement:c,svgStyles:u,font:f,progress:m,autoDestruct:b,onCloneNode:h,onEmbedNode:d,onCreateForeignObjectSvg:w}=a;r.time("clone node");const y=await Ts(a.node,a,!0);if(i&&n){let C="";u.forEach((F,A)=>{C+=`${F.join(`,
`)} {
  ${A}
}
`}),i.appendChild(n.createTextNode(C))}r.timeEnd("clone node"),await h?.(y),f!==!1&&je(y)&&(r.time("embed web font"),await Hl(y,a),r.timeEnd("embed web font")),r.time("embed node"),An(y,a);const g=o.length;let x=0;const p=async()=>{for(;;){const C=o.pop();if(!C)break;try{await C}catch(F){a.log.warn("Failed to run task",F)}m?.(++x,g)}};m?.(x,g),await Promise.all([...Array.from({length:4})].map(p)),r.timeEnd("embed node"),await d?.(y);const j=Jl(y,a);return c&&j.insertBefore(c,j.children[0]),i&&j.insertBefore(i,j.children[0]),b&&Ll(a),await w?.(j),j}function Jl(t,s){const{width:a,height:n}=s,r=ml(a,n,t.ownerDocument),o=r.ownerDocument.createElementNS(r.namespaceURI,"foreignObject");return o.setAttributeNS(null,"x","0%"),o.setAttributeNS(null,"y","0%"),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.append(t),r.appendChild(o),r}async function Ql(t,s){const a=await Yt(t,s),n=await Xl(a),r=ul(n,a.isEnable("removeControlCharacter"));a.autoDestruct||(a.svgStyleElement=Cn(a.ownerDocument),a.svgDefsElement=a.ownerDocument?.createElementNS(Gt,"defs"),a.svgStyles.clear());const o=tt(r,n.ownerDocument);return await wl(o,a)}async function Zl(t,s){const a=await Yt(t,s),{log:n,quality:r,type:o,dpi:i}=a,c=await Ql(a);n.time("canvas to data url");let u=c.toDataURL(o,r);if(["image/png","image/jpeg"].includes(o)&&i&&Yi&&Ki){const[f,m]=u.split(",");let b=0,h=!1;if(o==="image/png"){const j=Hi(m);j>=0?(b=Math.ceil((j+28)/3)*4,h=!0):b=33/3*4}else o==="image/jpeg"&&(b=18/3*4);const d=m.substring(0,b),w=m.substring(b),y=window.atob(d),g=new Uint8Array(y.length);for(let j=0;j<g.length;j++)g[j]=y.charCodeAt(j);const x=o==="image/png"?Ui(g,i,h):Li(g,i),p=window.btoa(String.fromCharCode(...x));u=[f,",",p,w].join("")}return n.timeEnd("canvas to data url"),u}async function ec(t,s){return Zl(await Yt(t,{...s,type:"image/png"}))}function tc(t,s=30){if(!t||t.trim()==="")return"untitled-card";let a=t.replace(/[^\w\s\u4e00-\u9fff\u3400-\u4dbf\u20000-\u2a6df\u2a700-\u2b73f\u2b740-\u2b81f\u2b820-\u2ceaf\uf900-\ufaff\u3300-\u33ff-]/g,"").replace(/\s+/g," ").trim();return a?(a.length>s&&(a=a.substring(0,s).trim()),a):"untitled-card"}async function sc(t,s={}){const{quality:a=1,pixelRatio:n=2,backgroundColor:r="transparent",includeStyles:o=!0}=s;try{const i=await ec(t,{quality:a,pixelRatio:n,backgroundColor:r,style:o?void 0:{},filter:u=>{if(u instanceof HTMLElement){const f=u.classList;return!f.contains("tooltip")&&!f.contains("dropdown-menu")&&!f.contains("popover")}return!0}});return await(await fetch(i)).blob()}catch(i){throw console.error("Screenshot capture failed:",i),new Error("Failed to capture screenshot")}}function ac(t,s){const a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=`${s}.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}async function nc(t,s,a={}){const n=tc(s);return{blob:await sc(t,{quality:1,pixelRatio:2,backgroundColor:"transparent",...a}),fileName:n}}function rc(t={}){const[s,a]=l.useState(!1),[n,r]=l.useState(!1),[o,i]=l.useState(null),[c,u]=l.useState(!1),[f,m]=l.useState(null),b=l.useCallback(async(y,g)=>{a(!0),m(null);try{const{blob:x,fileName:p}=await nc(y,g),j=URL.createObjectURL(x);i({blob:x,fileName:p,previewUrl:j}),u(!0)}catch(x){const p=x instanceof Error?x:new Error("Screenshot failed");m(p.message),t.onError?.(p)}finally{a(!1)}},[t]),h=l.useCallback(async()=>{if(o){r(!0);try{await new Promise(y=>setTimeout(y,500)),ac(o.blob,o.fileName),t.onSuccess?.(o.fileName),u(!1),setTimeout(()=>{o.previewUrl&&URL.revokeObjectURL(o.previewUrl),i(null)},100)}catch(y){const g=y instanceof Error?y:new Error("Download failed");m(g.message),t.onError?.(g)}finally{r(!1)}}},[o,t]),d=l.useCallback(()=>{u(!1),setTimeout(()=>{o?.previewUrl&&URL.revokeObjectURL(o.previewUrl),i(null)},100)},[o]),w=l.useCallback(()=>{m(null)},[]);return{isCapturing:s,isDownloading:n,showPreview:c,previewData:o,error:f,captureScreenshot:b,confirmDownload:h,cancelPreview:d,clearError:w}}function oc({isOpen:t,onClose:s,onConfirm:a,previewUrl:n,fileName:r,isDownloading:o=!1}){const[i,c]=l.useState(!1),u=()=>{c(!0),setTimeout(()=>{a(),c(!1)},800)};return e.jsx(Ue,{open:t,onOpenChange:s,children:e.jsxs(Ie,{className:"max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx(nt,{children:e.jsxs(ot,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-5 w-5"}),"Screenshot Preview"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Y,{variant:"secondary",className:"font-mono text-xs",children:[r,".png"]}),e.jsx(Y,{variant:"outline",className:"text-xs",children:"High Quality"})]})}),e.jsx("div",{className:"relative bg-checkered rounded-lg overflow-hidden border",children:n?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:n,alt:"Screenshot preview",className:S("w-full h-auto max-h-[60vh] object-contain transition-all duration-300",i&&"scale-95 opacity-80")}),i&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-purple-600/20 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-full p-6 shadow-lg animate-pulse",children:e.jsxs("div",{className:"relative",children:[e.jsx(et,{className:"h-8 w-8 text-blue-600 animate-bounce"}),e.jsx(Ds,{className:"h-4 w-4 text-purple-500 absolute -top-1 -right-1 animate-spin"})]})})})]}):e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(ds,{className:"h-12 w-12 mx-auto opacity-50"}),e.jsx("p",{children:"Loading preview..."})]})})}),o&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-500 border-t-transparent"}),"Preparing download..."]})]}),e.jsxs(rt,{className:"gap-2",children:[e.jsxs(P,{variant:"outline",onClick:s,disabled:i||o,children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsx(P,{onClick:u,disabled:i||o||!n,className:S("relative overflow-hidden",i&&"bg-gradient-to-r from-blue-500 to-purple-600"),children:i?e.jsxs(e.Fragment,{children:[e.jsx(Ds,{className:"h-4 w-4 mr-2 animate-spin"}),"Downloading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(et,{className:"h-4 w-4 mr-2"}),"Download PNG"]})})]})]})})}const ic=`
.bg-checkered {
  background-image: 
    linear-gradient(45deg, #f1f5f9 25%, transparent 25%), 
    linear-gradient(-45deg, #f1f5f9 25%, transparent 25%), 
    linear-gradient(45deg, transparent 75%, #f1f5f9 75%), 
    linear-gradient(-45deg, transparent 75%, #f1f5f9 75%);
  background-size: 20px 20px;
  background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
}
`;if(typeof document<"u"){const t=document.createElement("style");t.textContent=ic,document.head.appendChild(t)}const lc=1,cc=1e6;let is=0;function dc(){return is=(is+1)%Number.MAX_SAFE_INTEGER,is.toString()}const ls=new Map,Ws=t=>{if(ls.has(t))return;const s=setTimeout(()=>{ls.delete(t),bt({type:"REMOVE_TOAST",toastId:t})},cc);ls.set(t,s)},mc=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,lc)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(a=>a.id===s.toast.id?{...a,...s.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=s;return a?Ws(a):t.toasts.forEach(n=>{Ws(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==s.toastId)}}},It=[];let Mt={toasts:[]};function bt(t){Mt=mc(Mt,t),It.forEach(s=>{s(Mt)})}function uc({...t}){const s=dc(),a=r=>bt({type:"UPDATE_TOAST",toast:{...r,id:s}}),n=()=>bt({type:"DISMISS_TOAST",toastId:s});return bt({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:r=>{r||n()}}}),{id:s,dismiss:n,update:a}}function fc(){const[t,s]=l.useState(Mt);return l.useEffect(()=>(It.push(s),()=>{const a=It.indexOf(s);a>-1&&It.splice(a,1)}),[t]),{...t,toast:uc,dismiss:a=>bt({type:"DISMISS_TOAST",toastId:a})}}const _n=l.forwardRef(({className:t,...s},a)=>e.jsx(ga,{ref:a,className:S("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s}));_n.displayName=ga.displayName;const Pn=l.forwardRef(({className:t,...s},a)=>e.jsx(pa,{ref:a,className:S("aspect-square h-full w-full",t),...s}));Pn.displayName=pa.displayName;const Fn=l.forwardRef(({className:t,...s},a)=>e.jsx(xa,{ref:a,className:S("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...s}));Fn.displayName=xa.displayName;const In=["from-violet-500 to-pink-500","from-blue-500 to-purple-600","from-green-500 to-teal-600","from-orange-500 to-red-600","from-pink-500 to-rose-600","from-indigo-500 to-blue-600","from-yellow-500 to-orange-600","from-purple-500 to-pink-600","from-teal-500 to-green-600","from-red-500 to-pink-600","from-cyan-500 to-blue-600"];function hc(t){let s=0;for(let a=0;a<t.length;a++){const n=t.charCodeAt(a);s=(s<<5)-s+n,s=s&s}return Math.abs(s)%In.length}function gc(t){return t?t.username?t.username.charAt(0).toUpperCase():t.email?t.email.charAt(0).toUpperCase():"?":"?"}function pc(t){return t&&(t.username||t.email)||"anonymous"}function Mn({user:t,size:s="md",className:a,onClick:n,showHoverEffect:r=!0}){const o=gc(t),i=pc(t),c=hc(i),u=In[c],m=S({sm:"h-6 w-6 text-xs",md:"h-8 w-8 text-sm",lg:"h-10 w-10 text-base"}[s],r&&n&&"cursor-pointer transition-transform hover:scale-105",a),b=S("bg-gradient-to-br text-white font-semibold flex items-center justify-center",u,r&&n&&"transition-all duration-200 hover:shadow-md");return e.jsxs(_n,{className:m,onClick:n,children:[e.jsx(Pn,{src:t?.avatar_url,alt:t?.username||t?.email||"User"}),e.jsx(Fn,{className:b,children:o})]})}const Ln=Nr,zn=Cr,xc=l.forwardRef(({className:t,inset:s,children:a,...n},r)=>e.jsxs(ya,{ref:r,className:S("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",s&&"pl-8",t),...n,children:[a,e.jsx(Ut,{className:"ml-auto h-4 w-4"})]}));xc.displayName=ya.displayName;const yc=l.forwardRef(({className:t,...s},a)=>e.jsx(ba,{ref:a,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));yc.displayName=ba.displayName;const Es=l.forwardRef(({className:t,...s},a)=>e.jsx(jr,{children:e.jsx(wa,{ref:a,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));Es.displayName=wa.displayName;const st=l.forwardRef(({className:t,inset:s,...a},n)=>e.jsx(va,{ref:n,className:S("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",t),...a}));st.displayName=va.displayName;const bc=l.forwardRef(({className:t,children:s,checked:a,...n},r)=>e.jsxs(ja,{ref:r,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:a,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Na,{children:e.jsx(Fe,{className:"h-4 w-4"})})}),s]}));bc.displayName=ja.displayName;const wc=l.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(Ca,{ref:n,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Na,{children:e.jsx(Wa,{className:"h-2 w-2 fill-current"})})}),s]}));wc.displayName=Ca.displayName;const vc=l.forwardRef(({className:t,inset:s,...a},n)=>e.jsx(Sa,{ref:n,className:S("px-2 py-1.5 text-sm font-semibold text-foreground",s&&"pl-8",t),...a}));vc.displayName=Sa.displayName;const On=l.forwardRef(({className:t,...s},a)=>e.jsx(ka,{ref:a,className:S("-mx-1 my-1 h-px bg-border",t),...s}));On.displayName=ka.displayName;function Hs({children:t,folderId:s,folderName:a,onRename:n,onDelete:r,onCreateSubfolder:o,disabled:i=!1}){return i?e.jsx(e.Fragment,{children:t}):e.jsxs(Ln,{children:[e.jsx(zn,{asChild:!0,children:t}),e.jsxs(Es,{className:"w-48",children:[e.jsxs(st,{onClick:()=>n(s),children:[e.jsx(qa,{className:"h-4 w-4 mr-2"}),"Rename Folder"]}),e.jsxs(st,{onClick:()=>o(s),children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"New Subfolder"]}),e.jsx(On,{}),e.jsxs(st,{onClick:()=>r(s),className:"text-destructive focus:text-destructive",children:[e.jsx(ys,{className:"h-4 w-4 mr-2"}),"Delete Folder"]})]})]})}const jc=Dr,Nc=Ar,$n=l.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(Ta,{ref:n,className:S("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...a,children:[s,e.jsx(Sr,{asChild:!0,children:e.jsx(bs,{className:"h-4 w-4 opacity-50"})})]}));$n.displayName=Ta.displayName;const Un=l.forwardRef(({className:t,...s},a)=>e.jsx(Ea,{ref:a,className:S("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Gr,{className:"h-4 w-4"})}));Un.displayName=Ea.displayName;const Bn=l.forwardRef(({className:t,...s},a)=>e.jsx(Ra,{ref:a,className:S("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(bs,{className:"h-4 w-4"})}));Bn.displayName=Ra.displayName;const Vn=l.forwardRef(({className:t,children:s,position:a="popper",...n},r)=>e.jsx(kr,{children:e.jsxs(Da,{ref:r,className:S("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...n,children:[e.jsx(Un,{}),e.jsx(Tr,{className:S("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Bn,{})]})}));Vn.displayName=Da.displayName;const Cc=l.forwardRef(({className:t,...s},a)=>e.jsx(Aa,{ref:a,className:S("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));Cc.displayName=Aa.displayName;const Wn=l.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(_a,{ref:n,className:S("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Er,{children:e.jsx(Fe,{className:"h-4 w-4"})})}),e.jsx(Rr,{children:s})]}));Wn.displayName=_a.displayName;const Sc=l.forwardRef(({className:t,...s},a)=>e.jsx(Pa,{ref:a,className:S("-mx-1 my-1 h-px bg-muted",t),...s}));Sc.displayName=Pa.displayName;const kc=[{value:"#3b82f6",label:"Blue"},{value:"#8b5cf6",label:"Purple"},{value:"#10b981",label:"Green"},{value:"#f59e0b",label:"Orange"},{value:"#ef4444",label:"Red"},{value:"#06b6d4",label:"Cyan"},{value:"#84cc16",label:"Lime"},{value:"#f97316",label:"Orange"}],cs=[{value:"Folder",label:"Folder",icon:_e},{value:"Code",label:"Code",icon:Yr},{value:"Palette",label:"Design",icon:Ga},{value:"BookOpen",label:"Learning",icon:Kr},{value:"Star",label:"Favorites",icon:qr},{value:"Heart",label:"Personal",icon:Xr},{value:"Zap",label:"Quick",icon:Xa},{value:"Target",label:"Goals",icon:Jr},{value:"Lightbulb",label:"Ideas",icon:Qr},{value:"Coffee",label:"Work",icon:Zr}];function Tc({isOpen:t,onClose:s,onConfirm:a,parentId:n,initialData:r,mode:o="create"}){const[i,c]=l.useState(""),[u,f]=l.useState("#3b82f6"),[m,b]=l.useState("Folder");l.useEffect(()=>{t&&(r?(c(r.name),f(r.color),b(r.icon)):(c(""),f("#3b82f6"),b("Folder")))},[t]),l.useEffect(()=>{t&&r&&(c(r.name),f(r.color),b(r.icon))},[r,t]);const h=w=>{w.preventDefault(),i.trim()&&(a({name:i.trim(),color:u,icon:m,parentId:n}),s())},d=cs.find(w=>w.value===m)?.icon||_e;return e.jsx(Ue,{open:t,onOpenChange:s,children:e.jsxs(Ie,{className:"sm:max-w-md",children:[e.jsxs(nt,{children:[e.jsx(ot,{children:o==="create"?"Create New Folder":"Edit Folder"}),e.jsx(Vt,{children:o==="create"?"Create a new folder to organize your cards.":"Update folder details."})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"folder-name",children:"Folder Name"}),e.jsx(me,{id:"folder-name",value:i,onChange:w=>c(w.target.value),placeholder:"Enter folder name...",autoFocus:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{children:"Color"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:kc.map(w=>e.jsx("button",{type:"button",onClick:()=>f(w.value),className:`w-8 h-8 rounded-full border-2 transition-all ${u===w.value?"border-foreground scale-110":"border-muted hover:scale-105"}`,style:{backgroundColor:w.value},title:w.label},w.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{children:"Icon"}),e.jsxs(jc,{value:m,onValueChange:b,children:[e.jsx($n,{children:e.jsx(Nc,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[L.createElement(d,{className:"h-4 w-4",style:{color:u}}),cs.find(w=>w.value===m)?.label]})})}),e.jsx(Vn,{children:cs.map(w=>{const y=w.icon;return e.jsx(Wn,{value:w.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),w.label]})},w.value)})})]})]}),n&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Y,{variant:"secondary",children:"Subfolder"})}),e.jsxs(rt,{children:[e.jsx(P,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsx(P,{type:"submit",disabled:!i.trim(),children:o==="create"?"Create Folder":"Save Changes"})]})]})]})})}const Ec=Pr,Rc=_r,Hn=l.forwardRef(({className:t,...s},a)=>e.jsx(Fa,{className:S("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:a}));Hn.displayName=Fa.displayName;const Gn=l.forwardRef(({className:t,...s},a)=>e.jsxs(Rc,{children:[e.jsx(Hn,{}),e.jsx(Ia,{ref:a,className:S("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s})]}));Gn.displayName=Ia.displayName;const Yn=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col space-y-2 text-center sm:text-left",t),...s});Yn.displayName="AlertDialogHeader";const Kn=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Kn.displayName="AlertDialogFooter";const qn=l.forwardRef(({className:t,...s},a)=>e.jsx(Ma,{ref:a,className:S("text-lg font-semibold",t),...s}));qn.displayName=Ma.displayName;const Xn=l.forwardRef(({className:t,...s},a)=>e.jsx(La,{ref:a,className:S("text-sm text-muted-foreground",t),...s}));Xn.displayName=La.displayName;const Jn=l.forwardRef(({className:t,...s},a)=>e.jsx(za,{ref:a,className:S(js(),t),...s}));Jn.displayName=za.displayName;const Qn=l.forwardRef(({className:t,...s},a)=>e.jsx(Oa,{ref:a,className:S(js({variant:"outline"}),"mt-2 sm:mt-0",t),...s}));Qn.displayName=Oa.displayName;function Dc({isOpen:t,onClose:s,onConfirm:a,folderName:n,cardCount:r,hasSubfolders:o=!1,subfolderCount:i=0}){const c=()=>{a(),s()};return e.jsx(Ec,{open:t,onOpenChange:s,children:e.jsxs(Gn,{children:[e.jsxs(Yn,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5 text-destructive"}),e.jsx(qn,{children:"Delete Folder"})]}),e.jsxs(Xn,{className:"space-y-3",children:[e.jsxs("p",{children:["Are you sure you want to delete the folder ",e.jsxs("strong",{children:['"',n,'"']}),"?"]}),e.jsxs("div",{className:"bg-destructive/10 p-3 rounded-lg space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:"This action will permanently delete:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r>0&&e.jsxs(Y,{variant:"destructive",children:[r," card",r!==1?"s":""]}),o&&i>0&&e.jsxs(Y,{variant:"destructive",children:[i," subfolder",i!==1?"s":""]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This action cannot be undone."})]})]}),e.jsxs(Kn,{children:[e.jsx(Qn,{children:"Cancel"}),e.jsx(Jn,{onClick:c,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Forever"})]})]})})}function Ac({children:t,tagName:s,onRename:a,onDelete:n,disabled:r=!1}){const o=()=>{r||a(s)},i=()=>{r||n(s)};return r?e.jsx(e.Fragment,{children:t}):e.jsxs(Ln,{children:[e.jsx(zn,{asChild:!0,children:t}),e.jsxs(Es,{className:"w-48",children:[e.jsxs(st,{onClick:o,className:"flex items-center gap-2",children:[e.jsx(qa,{className:"h-4 w-4"}),"Rename Tag"]}),e.jsxs(st,{onClick:i,className:"flex items-center gap-2 text-destructive focus:text-destructive",children:[e.jsx(ys,{className:"h-4 w-4"}),"Delete Tag"]})]})]})}function _c({isOpen:t,onClose:s,onConfirm:a,tagName:n,existingTags:r}){const[o,i]=l.useState(""),[c,u]=l.useState("");l.useEffect(()=>{t&&(i(n),u(""))},[t,n]);const f=h=>{const d=h.trim();return d?d===n?"Please enter a different name":r.includes(d)?"A tag with this name already exists":d.length>50?"Tag name must be less than 50 characters":"":"Tag name cannot be empty"},m=()=>{const h=o.trim(),d=f(h);if(d){u(d);return}a(n,h),s()},b=h=>{h.key==="Enter"&&m()};return e.jsx(Ue,{open:t,onOpenChange:s,children:e.jsxs(Ie,{className:"sm:max-w-md",children:[e.jsxs(nt,{children:[e.jsx(ot,{children:"Rename Tag"}),e.jsxs(Vt,{children:['Enter a new name for the tag "',n,'". This will update all cards using this tag.']})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"tag-name",children:"Tag Name"}),e.jsx(me,{id:"tag-name",value:o,onChange:h=>{i(h.target.value),c&&u("")},onKeyPress:b,placeholder:"Enter tag name...",autoFocus:!0}),c&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive",children:[e.jsx(xe,{className:"h-4 w-4"}),c]})]})}),e.jsxs(rt,{children:[e.jsx(P,{variant:"outline",onClick:s,children:"Cancel"}),e.jsx(P,{onClick:m,disabled:!!c||!o.trim(),children:"Rename Tag"})]})]})})}function Pc({isOpen:t,onClose:s,onConfirm:a,tagName:n,cardCount:r}){return e.jsx(Ue,{open:t,onOpenChange:s,children:e.jsxs(Ie,{className:"sm:max-w-md",children:[e.jsxs(nt,{children:[e.jsxs(ot,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5 text-destructive"}),"Delete Tag"]}),e.jsxs(Vt,{children:['Are you sure you want to delete the tag "',n,'"?']})]}),e.jsx("div",{className:"py-4",children:e.jsxs("div",{className:"rounded-lg bg-destructive/10 p-4 border border-destructive/20",children:[e.jsx("p",{className:"text-sm text-destructive font-medium mb-2",children:"This action cannot be undone."}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["This tag will be removed from ",e.jsx("strong",{children:r})," ",r===1?"card":"cards","."]})]})}),e.jsxs(rt,{children:[e.jsx(P,{variant:"outline",onClick:s,children:"Cancel"}),e.jsx(P,{variant:"destructive",onClick:a,children:"Delete Tag"})]})]})})}const Fc=({tag:t,isSelected:s,onClick:a,className:n,showCount:r=!0})=>e.jsxs("button",{onClick:()=>a(t),className:S("relative flex items-center justify-between px-3 py-2 rounded-xl border transition-all duration-300 ease-out","hover:shadow-lg hover:shadow-black/10 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-blue-500/30","backdrop-blur-sm group",s?"bg-gradient-to-r from-blue-500 to-blue-600 border-blue-500 text-white shadow-md shadow-blue-500/25":"bg-white/80 border-gray-200/60 text-gray-700 hover:bg-white hover:border-gray-300/80",n),style:{boxShadow:s?"0 4px 20px -4px rgba(59, 130, 246, 0.3), 0 0 0 1px rgba(59, 130, 246, 0.1)":void 0},children:[e.jsxs("div",{className:"flex items-center gap-2.5 flex-1 min-w-0",children:[e.jsx("div",{className:S("w-2 h-2 rounded-full flex-shrink-0 transition-all duration-300",s?"bg-white/90 shadow-sm":"shadow-sm"),style:{backgroundColor:s?"rgba(255, 255, 255, 0.9)":t.color,boxShadow:s?"0 1px 3px rgba(0, 0, 0, 0.1)":`0 1px 3px ${t.color}40`}}),e.jsx("span",{className:S("text-sm font-medium truncate transition-all duration-300",s?"text-white":"text-gray-700 group-hover:text-gray-900"),children:t.name}),s&&e.jsx(Fe,{className:"w-3.5 h-3.5 text-white/90 flex-shrink-0 animate-in fade-in-0 zoom-in-95 duration-200"})]}),r&&e.jsx("span",{className:S("text-xs font-medium px-2 py-0.5 rounded-full ml-2 flex-shrink-0 transition-all duration-300",s?"text-blue-600 bg-white/90 shadow-sm":"text-gray-500 bg-gray-100/80 group-hover:bg-gray-200/80 group-hover:text-gray-600"),children:t.count})]}),Ic=({tags:t,selectedTags:s,onTagClick:a,className:n,emptyMessage:r="No tags found"})=>t.length===0?e.jsx("div",{className:S("text-center py-8 text-gray-500",n),children:e.jsx("p",{className:"text-sm",children:r})}):e.jsx("div",{className:S("grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",n),children:t.map(o=>e.jsx(Fc,{tag:o,isSelected:s.includes(o.name),onClick:a},o.id))}),Mc=({onSearch:t,onCreateTag:s,searchResults:a,searchQuery:n,className:r})=>{const[o,i]=l.useState(n);l.useEffect(()=>{i(n)},[n]);const c=m=>{const b=m.target.value;i(b),t(b)},u=()=>{o.trim()&&(s(o.trim()),i(""),t(""))},f=o.trim()&&a.length===0&&!a.some(m=>m.name.toLowerCase()===o.toLowerCase());return e.jsxs("div",{className:S("space-y-3",r),children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(me,{placeholder:"Search tags or create new...",value:o,onChange:c,className:"pl-11 pr-4 py-3 rounded-2xl border-gray-200/60 bg-gray-50/50 backdrop-blur-sm focus:bg-white focus:border-blue-300 transition-all duration-300"})]}),f&&e.jsxs(P,{onClick:u,variant:"outline",className:"w-full justify-start text-left rounded-xl border-dashed border-2 border-gray-300 hover:border-blue-400 hover:bg-blue-50/50 transition-all duration-300 py-3",children:[e.jsx(Ft,{className:"h-4 w-4 mr-2 text-blue-500"}),e.jsxs("span",{className:"text-gray-700",children:['Create tag "',e.jsx("span",{className:"font-medium text-blue-600",children:o}),'"']})]})]})},Lc=({isOpen:t,onClose:s,currentCardTags:a,onTagsChange:n})=>{const{tags:r,searchTags:o,dispatch:i,createTagIfNotExists:c}=en(),[u,f]=l.useState(""),[m,b]=l.useState([]),[h,d]=l.useState(a);l.useEffect(()=>{if(u.trim()){const p=o(u);b(p)}else{const p=[...r].sort((j,C)=>C.count-j.count);b(p)}},[u,r,o]),l.useEffect(()=>{d(a)},[a]);const w=p=>{f(p)},y=p=>{i({type:"CREATE_TAG",payload:{name:p,color:"#3b82f6"}});const j=[...h,p];d(j),n(j),f("")},g=p=>{const j=h.includes(p.name);let C;j?C=h.filter(F=>F!==p.name):C=[...h,p.name],d(C),n(C)},x=()=>{f(""),s()};return t?e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.15)",backdropFilter:"blur(8px)"},children:[e.jsx("div",{className:"absolute inset-0",onClick:x}),e.jsxs("div",{className:"relative bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl border border-gray-200/50 p-6 w-full max-w-sm sm:max-w-md lg:max-w-2xl max-h-[85vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Manage Tags"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Select tags for this card"})]}),e.jsx("button",{onClick:x,className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(Be,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx(Mc,{onSearch:w,onCreateTag:y,searchResults:m,searchQuery:u,className:"mb-4"}),h.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl border border-blue-100/50",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-700 mb-3",children:["Selected tags (",h.length,"):"]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:h.map(p=>e.jsx("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-sm",children:p},p))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(Ic,{tags:m,selectedTags:h,onTagClick:g,emptyMessage:u?`No tags found for "${u}"`:"No tags available"})}),e.jsx("div",{className:"text-xs text-gray-400 text-center mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-gray-300"}),e.jsx("span",{children:"Click tags to add/remove them from this card"}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-gray-300"})]})})]})]}):null},zc=()=>{const{isOpen:t,currentCardTags:s,onTagsChange:a,closeTagPanel:n}=on();return!t||!a?null:e.jsx(Lc,{isOpen:t,onClose:n,currentCardTags:s,onTagsChange:a})};class Oc{static generateSuggestions(s){const a=[];switch(s.type){case"card_content":a.push(...this.generateCardContentSuggestions(s));break;case"folder_name":a.push(...this.generateFolderNameSuggestions(s));break;case"tag_rename":a.push(...this.generateTagRenameSuggestions(s));break;default:a.push(this.getDefaultSuggestion())}return a.sort((n,r)=>r.confidence-n.confidence)}static generateCardContentSuggestions(s){const a=[],{localVersion:n,remoteVersion:r}=s,o=this.calculateSimilarity(n.content.frontContent.title,r.content.frontContent.title),i=this.calculateSimilarity(n.content.frontContent.text,r.content.frontContent.text),u=Math.abs(n.updatedAt.getTime()-r.updatedAt.getTime())<5*60*1e3,f=n.content.frontContent.text.length,m=r.content.frontContent.text.length,b=Math.max(f,m)/Math.min(f,m);o>.8&&i>.6&&u&&a.push({type:"merge",confidence:.9,reason:"内容高度相似，建议智能合并保留最佳内容",preview:{mergedTitle:this.mergeTitles(n.content.frontContent.title,r.content.frontContent.title),mergedLength:Math.max(f,m)}}),r.updatedAt.getTime()>n.updatedAt.getTime()&&b>2&&m>f&&a.push({type:"keep_remote",confidence:.8,reason:"远程版本内容更丰富且更新时间更近"});const h=new Set(n.content.frontContent.tags),d=new Set(r.content.frontContent.tags),w=[...h].filter(g=>!d.has(g));w.length>0&&w.length/h.size>.3&&a.push({type:"keep_local",confidence:.7,reason:"本地版本包含独特标签，可能包含重要分类信息"});const y=n.updatedAt.getTime()>r.updatedAt.getTime()?"local":"remote";return a.push({type:y==="local"?"keep_local":"keep_remote",confidence:.6,reason:`保留最新版本（${y==="local"?"本地":"远程"}设备）`}),a}static generateFolderNameSuggestions(s){const a=[],{localVersion:n,remoteVersion:r}=s,o=n.name.toLowerCase(),i=r.name.toLowerCase();if(o===i)return[];if(this.calculateSimilarity(n.name,r.name)>.8&&a.push({type:"merge",confidence:.9,reason:"文件夹名称相似，建议统一命名"}),o.includes(i)||i.includes(o)){const f=n.name.length>r.name.length?"local":"remote";a.push({type:f==="local"?"keep_local":"keep_remote",confidence:.8,reason:"保留更具描述性的文件夹名称"})}const u=n.updatedAt.getTime()>r.updatedAt.getTime()?"local":"remote";return a.push({type:u==="local"?"keep_local":"keep_remote",confidence:.6,reason:`保留最新修改的版本（${u==="local"?"本地":"远程"}）`}),a}static generateTagRenameSuggestions(s){const a=[],{localVersion:n,remoteVersion:r}=s,o=n.count/Math.max(r.count,1);o>2?a.push({type:"keep_local",confidence:.9,reason:`本地标签使用频率更高（${n.count}次 vs ${r.count}次）`}):o<.5&&a.push({type:"keep_remote",confidence:.9,reason:`远程标签使用频率更高（${r.count}次 vs ${n.count}次）`});const i=this.evaluateTagNameQuality(n.name),c=this.evaluateTagNameQuality(r.name);if(Math.abs(i-c)>.3){const f=i>c?"local":"remote";a.push({type:f==="local"?"keep_local":"keep_remote",confidence:.8,reason:`${f==="local"?"本地":"远程"}标签名称质量更好`})}const u=n.updatedAt.getTime()>r.updatedAt.getTime()?"local":"remote";return a.push({type:u==="local"?"keep_local":"keep_remote",confidence:.6,reason:"保留最新修改的版本"}),a}static calculateSimilarity(s,a){if(!s||!a)return 0;const n=s.toLowerCase().trim(),r=a.toLowerCase().trim();if(n===r)return 1;const o=Math.max(n.length,r.length);return o===0?1:1-this.levenshteinDistance(n,r)/o}static levenshteinDistance(s,a){const n=Array(a.length+1).fill(null).map(()=>Array(s.length+1).fill(null));for(let r=0;r<=s.length;r+=1)n[0][r]=r;for(let r=0;r<=a.length;r+=1)n[r][0]=r;for(let r=1;r<=a.length;r+=1)for(let o=1;o<=s.length;o+=1){const i=s[o-1]===a[r-1]?0:1;n[r][o]=Math.min(n[r][o-1]+1,n[r-1][o]+1,n[r-1][o-1]+i)}return n[a.length][s.length]}static mergeTitles(s,a){if(s===a||s.includes(a)&&s.length>a.length)return s;if(a.includes(s)&&a.length>s.length)return a;const n=new Set(s.toLowerCase().split(/\s+/)),r=new Set(a.toLowerCase().split(/\s+/)),o=new Set([...n,...r]),i=s.split(/\s+/),c=a.split(/\s+/),u=[];return i.forEach(f=>{!u.includes(f)&&o.has(f.toLowerCase())&&u.push(f)}),c.forEach(f=>{!u.includes(f)&&o.has(f.toLowerCase())&&u.push(f)}),u.join(" ")}static evaluateTagNameQuality(s){let a=.5;s.length>=3&&s.length<=20&&(a+=.2),s.length>30&&(a-=.1),/^[a-zA-Z0-9\u4e00-\u9fff\s\-_]+$/.test(s)&&(a+=.2),(s===s.toLowerCase()||/^[A-Z][a-z]+([A-Z][a-z]*)*$/.test(s))&&(a+=.1);const r=s.match(/[^a-zA-Z0-9\u4e00-\u9fff\s]/g);return r&&r.length>2&&(a-=.1),Math.max(0,Math.min(1,a))}static getDefaultSuggestion(){return{type:"manual",confidence:.5,reason:"无法自动确定最佳解决方案，建议手动处理"}}static applyResolution(s,a){switch(a.type){case"keep_local":return this.getLocalVersion(s);case"keep_remote":return this.getRemoteVersion(s);case"merge":return this.mergeVersions(s,a.mergedData);case"manual":return a.mergedData||a.manualChanges;default:throw new Error(`Unknown resolution type: ${a.type}`)}}static getLocalVersion(s){return s.entityType==="card",s.localVersion}static getRemoteVersion(s){return s.entityType==="card",s.remoteVersion}static mergeVersions(s,a){return a||this.smartMerge(s)}static smartMerge(s){if(s.entityType==="card"){const a=s,n=a.localVersion,r=a.remoteVersion;return{content:{frontContent:{title:this.mergeTitles(n.content.frontContent.title,r.content.frontContent.title),text:this.mergeText(n.content.frontContent.text,r.content.frontContent.text),tags:[...new Set([...n.content.frontContent.tags,...r.content.frontContent.tags])],lastModified:new Date},backContent:{title:this.mergeTitles(n.content.backContent.title,r.content.backContent.title),text:this.mergeText(n.content.backContent.text,r.content.backContent.text),tags:[...new Set([...n.content.backContent.tags,...r.content.backContent.tags])],lastModified:new Date}},style:n.style,folderId:n.folderId,isFlipped:n.isFlipped,updatedAt:new Date}}return this.getLocalVersion(s)}static mergeText(s,a){if(s===a)return s;const n=s.split(/[.!?]+/).filter(i=>i.trim()),r=a.split(/[.!?]+/).filter(i=>i.trim()),o=new Set([...n.map(i=>i.trim()),...r.map(i=>i.trim())]);return`${Array.from(o).filter(i=>i.length>0).join(". ")}.`}}function Kt(){const[t,s]=l.useState([]),[a,n]=l.useState(null),[r,o]=l.useState(!1),[i,c]=l.useState(!1),[u,f]=l.useState(null),[m,b]=l.useState(null),[h,d]=l.useState(null),w=l.useRef({totalConflicts:0,resolvedConflicts:0,pendingConflicts:0,conflictsByType:{},conflictsBySeverity:{},averageResolutionTime:0});l.useEffect(()=>{const E={totalConflicts:t.length,resolvedConflicts:t.filter(T=>T.status==="resolved").length,pendingConflicts:t.filter(T=>T.status==="pending").length,conflictsByType:{},conflictsBySeverity:{},averageResolutionTime:F()};t.forEach(T=>{E.conflictsByType[T.type]=(E.conflictsByType[T.type]||0)+1,E.conflictsBySeverity[T.severity]=(E.conflictsBySeverity[T.severity]||0)+1}),w.current=E},[t]),l.useEffect(()=>{y();const E=setInterval(()=>{A()},5e3);return()=>{clearInterval(E)}},[]);const y=async()=>{c(!0);try{await g(),await A(),f(null)}catch(E){console.error("Failed to initialize conflict management:",E),f(E instanceof Error?E.message:"Unknown error")}finally{c(!1)}},g=async()=>{try{const E=ae.getConflicts(),T=x(E);return s(T),T}catch(E){return console.error("Failed to load conflicts from service:",E),[]}},x=E=>E.map(T=>{const k={id:T.id,type:p(T.conflictType),entityType:T.entityType,entityId:T.entityId,timestamp:T.detectedAt||new Date,sourceDevice:T.sourceDevice||"Unknown",severity:T.severity,status:j(T.status),createdAt:T.detectedAt||new Date,resolvedAt:T.resolvedAt,resolvedBy:T.resolvedBy,resolution:T.resolution?C(T.resolution):void 0};switch(T.entityType){case"card":return{...k,type:"card_content",localVersion:T.localData,remoteVersion:T.cloudData,conflictFields:T.conflictFields||[],suggestions:T.suggestions?.map(z=>({type:z.type,confidence:z.confidence,reason:z.reasoning||z.reason,preview:z.preview}))};case"folder":return{...k,type:"folder_name",localVersion:T.localData,remoteVersion:T.cloudData,affectedCards:T.conflictDetails?.affectedEntities||[]};case"tag":return{...k,type:"tag_rename",localVersion:T.localData,remoteVersion:T.cloudData,affectedCards:T.conflictDetails?.affectedEntities||[]};default:throw new Error(`Unknown entity type: ${T.entityType}`)}}),p=E=>({content:"card_content",version:"card_content",structure:"folder_structure",delete:"tag_delete",field:"card_content"})[E]||"card_content",j=E=>({pending:"pending",resolving:"reviewing",resolved:"resolved",manual_required:"pending"})[E]||"pending",C=E=>({type:E.type,mergedData:E.mergedData,reason:E.reasoning,manualChanges:E.manualChanges}),F=()=>{const E=t.filter(k=>k.status==="resolved"&&k.resolvedAt);return E.length===0?0:E.reduce((k,z)=>k+(z.resolvedAt.getTime()-z.createdAt.getTime()),0)/E.length},A=async()=>{try{const E=ae.getStatus();d(E),E.isSyncing===!1&&E.networkStatus?.online&&await v()}catch(E){console.error("Failed to update sync status:",E)}},v=async()=>{try{const E=await g();E.filter(k=>k.status==="pending").length>t.filter(k=>k.status==="pending").length&&s(E)}catch(E){console.error("Failed to detect new conflicts:",E)}},N=l.useCallback(E=>t.find(T=>T.id===E),[t]),R=l.useCallback(()=>t.filter(E=>E.status==="pending"),[t]),B=l.useCallback(()=>t.filter(E=>E.severity==="high"||E.severity==="critical"),[t]),_=l.useCallback(()=>({...w.current}),[]),U=l.useCallback(async(E,T)=>{o(!0),f(null);try{if(await ae.resolveConflict(E,T.type,T.mergedData))return s(z=>z.map(W=>W.id===E?{...W,status:"resolved",resolvedAt:new Date,resolvedBy:"user",resolution:T}:W)),n(null),await A(),!0;throw new Error("Failed to resolve conflict via sync service")}catch(k){return console.error("Failed to resolve conflict:",k),f(k instanceof Error?k.message:"Unknown error"),!1}finally{o(!1)}},[]),J=l.useCallback(async E=>{try{if(!t.find(k=>k.id===E))return;s(k=>k.map(z=>z.id===E?{...z,status:"ignored"}:z)),n(null)}catch(T){console.error("Failed to ignore conflict:",T),f(T instanceof Error?T.message:"Unknown error")}},[t]),$=l.useCallback(async(E,T)=>{o(!0),f(null);try{const k=await Promise.allSettled(E.map(I=>ae.resolveConflict(I,T.type,T.mergedData))),z=k.filter(I=>I.status==="fulfilled").length,W=k.filter(I=>I.status==="rejected").length;if(z>0&&s(I=>I.map(V=>E.includes(V.id)?{...V,status:"resolved",resolvedAt:new Date,resolvedBy:"user",resolution:T}:V)),W>0)throw new Error(`${W} conflicts failed to resolve`);return await A(),!0}catch(k){return console.error("Failed to batch resolve conflicts:",k),f(k instanceof Error?k.message:"Unknown error"),!1}finally{o(!1)}},[]),q=l.useCallback(E=>{const T=N(E);if(!T)return[];const k=Oc.generateSuggestions(T),z=ae.getConflict(E)?.suggestions||[];return[...k,...z.map(I=>({type:I.type,confidence:I.confidence,reason:I.reasoning||I.reason,preview:I.preview}))].sort((I,V)=>V.confidence-I.confidence)},[N]),ee=l.useCallback(async()=>{c(!0);try{const E=await ae.sync({type:"incremental",direction:"bidirectional"}),T=await g(),k=T.filter(z=>z.status==="pending");return s(T),k}catch(E){return console.error("Failed to detect conflicts:",E),f(E instanceof Error?E.message:"Unknown error"),[]}finally{c(!1)}},[]),Z=l.useCallback(async()=>{o(!0);try{const E=await ae.autoResolveConflicts();return await g(),await A(),E}catch(E){return console.error("Failed to auto-resolve conflicts:",E),f(E instanceof Error?E.message:"Unknown error"),0}finally{o(!1)}},[]),le=l.useCallback(async E=>{try{const T=N(E);if(!T)return null;const k=ae.getConflict(E);return{...T,syncDetails:k,suggestions:q(E)}}catch(T){return console.error("Failed to get conflict details:",T),null}},[N,q]),M=l.useCallback(async()=>{c(!0);try{await g(),await A(),f(null)}catch(E){console.error("Failed to refresh conflicts:",E),f(E instanceof Error?E.message:"Unknown error")}finally{c(!1)}},[]),H=l.useCallback(()=>{f(null)},[]);return{conflicts:t,selectedConflict:a,setSelectedConflict:n,isResolving:r,isLoading:i,error:u,syncStatus:h,metrics:m,stats:{...w.current},getConflictById:N,getPendingConflicts:R,getHighPriorityConflicts:B,getStats:_,resolveConflict:U,ignoreConflict:J,batchResolveConflicts:$,getSuggestions:q,detectConflicts:ee,autoResolveConflicts:Z,getConflictDetails:le,refreshConflicts:M,clearError:H}}const $c=$t("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ps=l.forwardRef(({className:t,variant:s,...a},n)=>e.jsx("div",{ref:n,role:"alert",className:S($c({variant:s}),t),...a}));ps.displayName="Alert";const Zn=l.forwardRef(({className:t,...s},a)=>e.jsx("h5",{ref:a,className:S("mb-1 font-medium leading-none tracking-tight",t),...s}));Zn.displayName="AlertTitle";const er=l.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("text-sm [&_p]:leading-relaxed",t),...s}));er.displayName="AlertDescription";function Uc({className:t,onOpenConflictPanel:s}){const{stats:a,getHighPriorityConflicts:n,detectConflicts:r,setSelectedConflict:o}=Kt(),i=n();if(!(a.pendingConflicts>0))return null;const u=async()=>{await r()},f=b=>{o(b),s?.()},m=b=>{switch(b){case"critical":return"bg-red-500 text-white";case"high":return"bg-orange-500 text-white";case"medium":return"bg-yellow-500 text-white";case"low":return"bg-blue-500 text-white";default:return"bg-gray-500 text-white"}};return e.jsxs("div",{className:S("space-y-2",t),children:[e.jsxs(ps,{className:"border-orange-200 bg-orange-50",children:[e.jsx(ye,{className:"h-4 w-4 text-orange-600"}),e.jsx(Zn,{className:"text-orange-800",children:"检测到数据冲突"}),e.jsxs(er,{className:"text-orange-700",children:["发现 ",a.pendingConflicts," 个待解决的数据冲突，建议及时处理以避免数据丢失。",i.length>0&&e.jsxs("span",{className:"ml-2 font-medium",children:["其中 ",i.length," 个需要立即处理。"]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:s,className:"text-orange-700 border-orange-300 hover:bg-orange-100",children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),"查看所有冲突"]}),e.jsxs(P,{variant:"ghost",size:"sm",onClick:u,className:"text-orange-600 hover:bg-orange-100",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"刷新检测"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Y,{variant:"secondary",className:"text-orange-700 bg-orange-100",children:["总计: ",a.totalConflicts]}),e.jsxs(Y,{variant:"destructive",className:"bg-red-100 text-red-700",children:["待解决: ",a.pendingConflicts]})]})]})]}),i.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-red-700",children:"高优先级冲突"}),e.jsxs(Y,{variant:"destructive",className:"text-xs",children:[i.length," 个"]})]}),i.slice(0,3).map(b=>e.jsx(ps,{className:"border-red-200 bg-red-50 cursor-pointer hover:bg-red-100 transition-colors",onClick:()=>f(b.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Y,{variant:"outline",className:S("text-xs",m(b.severity)),children:b.severity}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:Bc(b)}),e.jsx("p",{className:"text-xs text-red-600",children:Vc(b)})]})]}),e.jsx(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:bg-red-100",onClick:h=>{h.stopPropagation(),f(b.id)},children:e.jsx(As,{className:"h-4 w-4"})})]})},b.id)),i.length>3&&e.jsxs(P,{variant:"ghost",size:"sm",onClick:s,className:"w-full text-red-600 hover:bg-red-100",children:["查看剩余 ",i.length-3," 个高优先级冲突"]})]})]})}function Bc(t){switch(t.type){case"card_content":return"卡片内容冲突";case"card_style":return"卡片样式冲突";case"card_tags":return"卡片标签冲突";case"card_folder":return"卡片文件夹冲突";case"folder_name":return"文件夹名称冲突";case"folder_structure":return"文件夹结构冲突";case"tag_rename":return"标签重命名冲突";case"tag_delete":return"标签删除冲突";case"tag_color":return"标签颜色冲突";default:return"数据冲突"}}function Vc(t){switch(t.type){case"card_content":return`卡片 "${t.localVersion.content.frontContent.title}" 在多设备上被同时编辑`;case"folder_name":return`文件夹 "${t.localVersion.name}" 与远程版本名称不一致`;case"tag_rename":return`标签 "${t.localVersion.name}" 重命名冲突`;default:return"数据版本不一致，需要手动解决"}}const te=l.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s}));te.displayName="Card";const Ee=l.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("flex flex-col space-y-1.5 p-6",t),...s}));Ee.displayName="CardHeader";const Re=l.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("text-2xl font-semibold leading-none tracking-tight",t),...s}));Re.displayName="CardTitle";const tr=l.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("text-sm text-muted-foreground",t),...s}));tr.displayName="CardDescription";const se=l.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("p-6 pt-0",t),...s}));se.displayName="CardContent";const Wc=l.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("flex items-center p-6 pt-0",t),...s}));Wc.displayName="CardFooter";const $e=l.forwardRef(({className:t,value:s,...a},n)=>e.jsx($a,{ref:n,className:S("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...a,children:e.jsx(Fr,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));$e.displayName=$a.displayName;class Qe{static instance;metrics=[];alerts=[];observers=[];sessionId;startTime;constructor(){this.sessionId=this.generateSessionId(),this.startTime=performance.now(),this.initializeObservers()}static getInstance(){return Qe.instance||(Qe.instance=new Qe),Qe.instance}initializeObservers(){"PerformanceObserver"in window&&(this.observePaintTiming(),this.observeLayoutShift(),this.observeInteraction()),this.observeMemoryUsage(),this.observeNetworkPerformance(),this.observeErrors(),this.startPeriodicCollection()}observePaintTiming(){try{const s=new PerformanceObserver(a=>{a.getEntries().forEach(r=>{r.name==="first-paint"?this.updateMetric("firstPaint",r.startTime):r.name==="first-contentful-paint"&&this.updateMetric("firstContentfulPaint",r.startTime)})});s.observe({entryTypes:["paint"]}),this.observers.push(s)}catch(s){console.warn("Failed to observe paint timing:",s)}}observeLayoutShift(){try{const s=new PerformanceObserver(a=>{const n=a.getEntries();let r=0;n.forEach(o=>{o instanceof LayoutShift&&(r+=o.value)}),this.updateMetric("cumulativeLayoutShift",r)});s.observe({entryTypes:["layout-shift"]}),this.observers.push(s)}catch(s){console.warn("Failed to observe layout shift:",s)}}observeInteraction(){try{const s=new PerformanceObserver(a=>{a.getEntries().forEach(r=>{r instanceof PerformanceEventTiming&&(this.updateMetric("interactionTime",r.duration),this.updateMetric("firstInputDelay",r.processingStart-r.startTime))})});s.observe({entryTypes:["first-input","event"]}),this.observers.push(s)}catch(s){console.warn("Failed to observe interactions:",s)}}observeMemoryUsage(){setInterval(()=>{if("memory"in performance){const s=performance.memory;this.updateMetric("memoryUsage",s.usedJSHeapSize),s.jsHeapSizeLimit-s.usedJSHeapSize<s.jsHeapSizeLimit*.1&&this.createAlert({type:"warning",category:"memory",message:"High memory usage detected",severity:"medium",suggestions:["Check for memory leaks","Consider garbage collection"]})}},5e3)}observeNetworkPerformance(){const s=window.fetch;window.fetch=async(...a)=>{const n=performance.now();try{const r=await s(...a),o=performance.now();return this.updateMetric("requestTime",o-n),r}catch(r){const o=performance.now();throw this.updateMetric("requestTime",o-n),r}}}observeErrors(){window.addEventListener("error",s=>{this.createAlert({type:"error",category:"performance",message:`JavaScript error: ${s.message}`,severity:"high",context:{filename:s.filename,lineno:s.lineno,colno:s.colno}})}),window.addEventListener("unhandledrejection",s=>{this.createAlert({type:"error",category:"performance",message:`Unhandled promise rejection: ${s.reason}`,severity:"high"})})}startPeriodicCollection(){setInterval(()=>{this.collectMetrics()},3e4)}collectMetrics(){const s={renderTime:this.calculateRenderTime(),firstPaint:this.getMetric("firstPaint")||0,firstContentfulPaint:this.getMetric("firstContentfulPaint")||0,largestContentfulPaint:this.getLCP(),cumulativeLayoutShift:this.getMetric("cumulativeLayoutShift")||0,firstInputDelay:this.getMetric("firstInputDelay")||0,interactionTime:this.getMetric("interactionTime")||0,clickLatency:this.measureClickLatency(),scrollPerformance:this.measureScrollPerformance(),inputResponsiveness:this.measureInputResponsiveness(),memoryUsage:this.getMemoryUsage(),memoryLeakDetected:this.detectMemoryLeak(),garbageCollectionTime:this.measureGarbageCollection(),networkLatency:this.measureNetworkLatency(),requestTime:this.getMetric("requestTime")||0,resourceLoadTime:this.measureResourceLoadTime(),conflictDetectionTime:this.getMetric("conflictDetectionTime")||0,conflictResolutionTime:this.getMetric("conflictResolutionTime")||0,batchOperationTime:this.getMetric("batchOperationTime")||0,perceivedPerformance:this.calculatePerceivedPerformance(),errorRate:this.calculateErrorRate(),crashRate:this.calculateCrashRate(),userSatisfaction:this.calculateUserSatisfaction(),timestamp:new Date,sessionId:this.sessionId};this.metrics.push(s),this.analyzeMetrics(s)}startConflictDetection(){const s=performance.now();return()=>{const a=performance.now();this.updateMetric("conflictDetectionTime",a-s)}}startConflictResolution(){const s=performance.now();return()=>{const a=performance.now();this.updateMetric("conflictResolutionTime",a-s)}}startBatchOperation(){const s=performance.now();return()=>{const a=performance.now();this.updateMetric("batchOperationTime",a-s)}}trackUserInteraction(s,a,n){this.updateMetric(`${s}Duration`,a),n||this.createAlert({type:"warning",category:"ux",message:`User interaction failed: ${s}`,severity:"medium"})}trackUserSatisfaction(s,a){this.updateMetric("userSatisfaction",s),a&&console.log("User feedback:",a)}analyzeMetrics(s){s.renderTime>100&&this.createAlert({type:"warning",category:"performance",message:"Slow render time detected",severity:"medium",suggestions:["Optimize component rendering","Consider virtualization"]}),s.memoryUsage>100*1024*1024&&this.createAlert({type:"warning",category:"memory",message:"High memory usage detected",severity:"medium",suggestions:["Check for memory leaks","Optimize data structures"]}),s.networkLatency>1e3&&this.createAlert({type:"warning",category:"network",message:"High network latency detected",severity:"medium",suggestions:["Check network connection","Optimize API calls"]}),s.conflictResolutionTime>5e3&&this.createAlert({type:"warning",category:"performance",message:"Slow conflict resolution detected",severity:"medium",suggestions:["Optimize conflict resolution algorithm","Consider caching"]})}generateReport(s=36e5){const a=new Date,n=new Date(a.getTime()-s),r=this.metrics.filter(i=>i.timestamp>=n&&i.timestamp<=a),o=this.calculateUserExperienceMetrics(r);return{period:{start:n,end:a},metrics:r,userExperience:o,alerts:this.alerts.filter(i=>i.timestamp>=n),summary:{averagePerformance:this.calculateAveragePerformance(r),performanceTrend:this.calculatePerformanceTrend(r),criticalIssues:this.alerts.filter(i=>i.severity==="critical").length,recommendations:this.generateRecommendations(r,o)}}}updateMetric(s,a){const n=this.metrics[this.metrics.length-1];n&&(n[s]=a)}getMetric(s){const a=this.metrics[this.metrics.length-1];return a?a[s]:null}calculateRenderTime(){const s=performance.getEntriesByType("navigation")[0];return s?s.loadEventEnd-s.loadEventStart:0}getLCP(){const s=performance.getEntriesByType("largest-contentful-paint")[0];return s?s.startTime:0}measureClickLatency(){return 0}measureScrollPerformance(){return 0}measureInputResponsiveness(){return 0}getMemoryUsage(){return"memory"in performance?performance.memory.usedJSHeapSize:0}detectMemoryLeak(){return!1}measureGarbageCollection(){return 0}measureNetworkLatency(){return 0}measureResourceLoadTime(){return 0}calculatePerceivedPerformance(){return 85}calculateErrorRate(){return .01}calculateCrashRate(){return .001}calculateUserSatisfaction(){return 85}calculateUserExperienceMetrics(s){return{averageTaskCompletionTime:0,taskSuccessRate:.95,clickCount:0,scrollDepth:0,timeOnPage:0,bounceRate:.1,conflictResolutionSuccess:.9,conflictResolutionAttempts:0,averageResolutionTime:0,userPreferredResolution:"auto",interfaceResponsiveness:85,loadingTime:0,errorEncounterRate:.02,satisfactionScore:85,feedbackCount:0,commonComplaints:[]}}calculateAveragePerformance(s){return s.length===0?0:s.reduce((n,r)=>n+r.perceivedPerformance,0)/s.length}calculatePerformanceTrend(s){if(s.length<2)return"stable";const a=s.slice(-10),n=s.slice(-20,-10),r=a.reduce((i,c)=>i+c.perceivedPerformance,0)/a.length,o=n.reduce((i,c)=>i+c.perceivedPerformance,0)/n.length;return r>o+5?"improving":r<o-5?"declining":"stable"}generateRecommendations(s,a){const n=[];return a.conflictResolutionSuccess<.8&&n.push("Improve conflict resolution algorithms"),a.interfaceResponsiveness<70&&n.push("Optimize UI responsiveness"),a.errorEncounterRate>.05&&n.push("Reduce error rates in user interactions"),n}createAlert(s){const a={...s,id:this.generateAlertId(),timestamp:new Date};this.alerts.push(a),console.warn("Performance Alert:",a)}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateAlertId(){return`alert_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}getMetrics(){return[...this.metrics]}getAlerts(){return[...this.alerts]}clearMetrics(){this.metrics=[],this.alerts=[]}getRealtimeMetrics(){return{renderTime:this.calculateRenderTime(),memoryUsage:this.getMemoryUsage(),networkLatency:this.measureNetworkLatency(),perceivedPerformance:this.calculatePerceivedPerformance()}}}const he=Qe.getInstance();function sr({className:t,showDetails:s=!1,compact:a=!1}){const[n,r]=l.useState(!0),[o,i]=l.useState(!1),[c,u]=l.useState(null),[f,m]=l.useState([]),[b,h]=l.useState({lastSyncTime:null,totalOperations:0,successfulOperations:0,failedOperations:0,averageSyncTime:0,networkLatency:0,serverResponseTime:0,dataTransferRate:0}),[d,w]=l.useState(!1);l.useEffect(()=>{const v=()=>r(!0),N=()=>r(!1);return window.addEventListener("online",v),window.addEventListener("offline",N),r(navigator.onLine),()=>{window.removeEventListener("online",v),window.removeEventListener("offline",N)}},[]),l.useEffect(()=>{const v=async()=>{try{const U=ae.getStatus();u(U),i(U.isSyncing),U.lastSyncTime&&h($=>({...$,lastSyncTime:new Date(U.lastSyncTime),totalOperations:U.totalSyncs||0,successfulOperations:U.successfulSyncs||0,failedOperations:U.failedSyncs||0}));const J=he.getRealtimeMetrics();h($=>({...$,networkLatency:J.networkLatency||0}))}catch(U){console.error("Failed to update sync status:",U)}};v();const N=setInterval(v,2e3),R=()=>{i(!0),y({type:"upload",entity:"批量同步",status:"in_progress",progress:0,startTime:new Date})},B=()=>{i(!1),g("completed"),v()},_=U=>{i(!1),g("failed",U.message)};return ae.on("sync:start",R),ae.on("sync:complete",B),ae.on("sync:error",_),()=>{clearInterval(N),ae.off("sync:start",R),ae.off("sync:complete",B),ae.off("sync:error",_)}},[]);const y=v=>{const N={...v,id:`op_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};m(R=>[N,...R.slice(0,9)]),h(R=>({...R,totalOperations:R.totalOperations+1}))},g=(v,N)=>{m(R=>R.map(B=>B.status==="in_progress"?{...B,status:v,endTime:new Date,error:N,progress:v==="completed"?100:B.progress}:B)),v==="completed"?h(R=>({...R,successfulOperations:R.successfulOperations+1})):v==="failed"&&h(R=>({...R,failedOperations:R.failedOperations+1}))},x=async()=>{try{i(!0),await ae.sync({type:"incremental",direction:"bidirectional"})}catch(v){console.error("Manual sync failed:",v)}finally{i(!1)}},p=()=>n?o?"text-yellow-500 animate-pulse":c?.hasConflicts?"text-orange-500":"text-green-500":"text-red-500",j=()=>n?o?e.jsx(ve,{className:"h-4 w-4 animate-spin"}):c?.hasConflicts?e.jsx(ye,{className:"h-4 w-4"}):e.jsx(Bt,{className:"h-4 w-4"}):e.jsx(ws,{className:"h-4 w-4"}),C=()=>n?o?"同步中...":c?.hasConflicts?"需要解决冲突":"已同步":"离线",F=v=>{if(!v)return"从未";const R=new Date().getTime()-v.getTime(),B=Math.floor(R/6e4);return B<1?"刚刚":B<60?`${B}分钟前`:B<1440?`${Math.floor(B/60)}小时前`:`${Math.floor(B/1440)}天前`},A=b.totalOperations>0?(b.successfulOperations/b.totalOperations*100).toFixed(1):"0.0";return a?e.jsxs("div",{className:S("flex items-center gap-2 text-sm",t),children:[e.jsxs("div",{className:S("flex items-center gap-1",p()),children:[j(),e.jsx("span",{children:C()})]}),c?.pendingOperations>0&&e.jsxs(Y,{variant:"secondary",className:"text-xs",children:[c.pendingOperations," 待同步"]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:x,disabled:o||!n,children:e.jsx(ve,{className:S("h-3 w-3",o&&"animate-spin")})})]}):e.jsxs(te,{className:S("w-full",t),children:[e.jsxs(Ee,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"text-lg",children:"同步状态"}),e.jsxs("div",{className:S("flex items-center gap-1 text-sm",p()),children:[j(),e.jsx("span",{children:C()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[c?.pendingOperations>0&&e.jsxs(Y,{variant:"outline",children:[c.pendingOperations," 待同步"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:x,disabled:o||!n,children:[e.jsx(ve,{className:S("h-4 w-4 mr-2",o&&"animate-spin")}),"立即同步"]}),s&&e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>w(!d),children:d?"收起":"详情"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"网络状态:"}),e.jsx("span",{className:"ml-2 font-medium",children:n?"在线":"离线"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"最后同步:"}),e.jsx("span",{className:"ml-2 font-medium",children:F(b.lastSyncTime)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"成功率:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[A,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"延迟:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[b.networkLatency,"ms"]})]})]}),o&&f.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"同步进度"}),e.jsxs("span",{children:[f.find(v=>v.status==="in_progress")?.progress||0,"%"]})]}),e.jsx($e,{value:f.find(v=>v.status==="in_progress")?.progress||0,className:"h-2"})]})]}),d&&s&&e.jsxs(se,{className:"space-y-4",children:[e.jsx(Je,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(te,{children:e.jsxs(se,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ja,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"font-medium",children:"操作统计"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"总操作数:"}),e.jsx("span",{children:b.totalOperations})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"成功:"}),e.jsx("span",{className:"text-green-600",children:b.successfulOperations})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"失败:"}),e.jsx("span",{className:"text-red-600",children:b.failedOperations})]})]})]})}),e.jsx(te,{children:e.jsxs(se,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(eo,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"font-medium",children:"性能指标"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"平均同步时间:"}),e.jsxs("span",{children:[b.averageSyncTime,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"服务器响应:"}),e.jsxs("span",{children:[b.serverResponseTime,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"传输速率:"}),e.jsxs("span",{children:[b.dataTransferRate,"KB/s"]})]})]})]})}),e.jsx(te,{children:e.jsxs(se,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(to,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{className:"font-medium",children:"同步状态"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"待同步操作:"}),e.jsx("span",{children:c?.pendingOperations||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"冲突数量:"}),e.jsx("span",{children:c?.conflicts?.length||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"同步模式:"}),e.jsx("span",{children:"自动"})]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"最近操作"}),e.jsx(Pe,{className:"h-48 border rounded-md p-2",children:e.jsx("div",{className:"space-y-2",children:f.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"暂无操作记录"}):f.map(v=>e.jsxs("div",{className:"flex items-center justify-between text-sm p-2 rounded border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[v.status==="completed"&&e.jsx(wt,{className:"h-3 w-3 text-green-500"}),v.status==="failed"&&e.jsx(vt,{className:"h-3 w-3 text-red-500"}),v.status==="in_progress"&&e.jsx(jt,{className:"h-3 w-3 text-yellow-500 animate-spin"}),v.status==="pending"&&e.jsx(jt,{className:"h-3 w-3 text-gray-500"}),e.jsx("span",{children:v.entity}),e.jsx(Y,{variant:"outline",className:"text-xs",children:v.type==="upload"?"上传":v.type==="download"?"下载":v.type==="conflict_resolution"?"冲突解决":"合并"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[v.status==="in_progress"&&e.jsx($e,{value:v.progress,className:"w-16 h-1"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:F(v.startTime)})]})]},v.id))})})]})]})]})}function Hc({isOpen:t,onClose:s,className:a}){const{conflicts:n,setSelectedConflict:r,getStats:o,getPendingConflicts:i,getHighPriorityConflicts:c,resolveConflict:u,ignoreConflict:f,batchResolveConflicts:m,refreshConflicts:b,isResolving:h,isLoading:d,error:w,syncStatus:y}=Kt(),[g,x]=l.useState("all"),[p,j]=l.useState(""),[C,F]=l.useState(new Set),[A,v]=l.useState(new Set),[N,R]=l.useState(!1),[B,_]=l.useState(null),U=o(),J=i(),$=c(),q=L.useMemo(()=>{let k=n;switch(g){case"pending":k=J;break;case"high":k=$;break;case"resolved":k=n.filter(z=>z.status==="resolved");break}if(p){const z=p.toLowerCase();k=k.filter(W=>{switch(W.entityType){case"card":return W.localVersion.content.frontContent.title.toLowerCase().includes(z);case"folder":return W.localVersion.name.toLowerCase().includes(z);case"tag":return W.localVersion.name.toLowerCase().includes(z);default:return!1}})}return k.sort((z,W)=>{const I={critical:4,high:3,medium:2,low:1},V=I[W.severity]-I[z.severity];return V!==0?-V:W.timestamp.getTime()-z.timestamp.getTime()})},[n,g,p,J,$]),ee=k=>{F(z=>{const W=new Set(z);return W.has(k)?W.delete(k):W.add(k),W})},Z=k=>{v(z=>{const W=new Set(z);return W.has(k)?W.delete(k):W.add(k),W})},le=k=>{_(k),R(!0)},M=()=>{A.size===q.length?v(new Set):v(new Set(q.map(k=>k.id)))},H=async k=>{if(A.size===0)return;const z=Array.from(A);await m(z,{type:k,reason:`批量选择${k==="keep_local"?"本地":"远程"}版本`}),v(new Set)},E=k=>{switch(k){case"critical":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},T=k=>{switch(k){case"resolved":return e.jsx(wt,{className:"h-4 w-4 text-green-500"});case"ignored":return e.jsx(vt,{className:"h-4 w-4 text-gray-500"});default:return e.jsx(jt,{className:"h-4 w-4 text-yellow-500"})}};return t?e.jsx("div",{className:S("fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",a),children:e.jsxs(te,{className:"w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs(Ee,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"h-5 w-5 text-orange-500"}),e.jsx(Re,{className:"text-xl",children:"冲突管理中心"}),e.jsxs(Y,{variant:"outline",className:"ml-2",children:[U.pendingConflicts," 待解决"]})]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:s,children:"×"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["总计: ",U.totalConflicts]}),e.jsxs("span",{children:["已解决: ",U.resolvedConflicts]}),e.jsxs("span",{children:["待处理: ",U.pendingConflicts]}),e.jsxs("span",{children:["高优先级: ",$.length]}),y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${y.isSyncing?"bg-yellow-500 animate-pulse":y.networkStatus?.online?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{children:y.isSyncing?"同步中...":y.networkStatus?.online?"在线":"离线"})]}),y.pendingOperations>0&&e.jsxs("span",{children:["待同步: ",y.pendingOperations]})]})]}),e.jsx(sr,{showDetails:!0,compact:!1,className:"mb-4"}),w&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-red-600",children:w}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>window.location.reload(),children:"重试"})]})})]}),e.jsxs(se,{className:"flex-1 flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"搜索冲突...",value:p,onChange:k=>j(k.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:g==="all"?"default":"outline",size:"sm",onClick:()=>x("all"),children:"全部"}),e.jsx(P,{variant:g==="pending"?"default":"outline",size:"sm",onClick:()=>x("pending"),children:"待解决"}),e.jsx(P,{variant:g==="high"?"default":"outline",size:"sm",onClick:()=>x("high"),children:"高优先级"}),e.jsx(P,{variant:g==="resolved"?"default":"outline",size:"sm",onClick:()=>x("resolved"),children:"已解决"})]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:b,disabled:d,children:[e.jsx(ve,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),"刷新"]})]}),A.size>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:["已选择 ",A.size," 个冲突"]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:M,children:A.size===q.length?"取消全选":"全选"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>H("keep_local"),disabled:h,children:"批量保留本地"}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>H("keep_remote"),disabled:h,children:"批量保留远程"})]})]}),e.jsx(Pe,{className:"flex-1",children:e.jsx("div",{className:"space-y-3",children:d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ve,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"加载冲突信息..."})]}):q.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:p?"没有找到匹配的冲突":"暂无冲突"}):q.map(k=>e.jsx(Gc,{conflict:k,isExpanded:C.has(k.id),isSelected:A.has(k.id),onToggleExpand:()=>ee(k.id),onToggleSelect:()=>Z(k.id),onSelect:()=>r(k.id),onViewDetail:()=>le(k.id),onResolve:z=>u(k.id,z),onIgnore:()=>f(k.id),getSeverityColor:E,getStatusIcon:T,isResolving:h},k.id))})})]})]})}):null}function Gc({conflict:t,isExpanded:s,isSelected:a,onToggleExpand:n,onToggleSelect:r,onSelect:o,onViewDetail:i,onResolve:c,onIgnore:u,getSeverityColor:f,getStatusIcon:m,isResolving:b}){return e.jsx(te,{className:S("transition-all duration-200 cursor-pointer hover:shadow-md",f(t.severity),a&&"ring-2 ring-blue-500"),onClick:o,children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("input",{type:"checkbox",checked:a,onChange:r,onClick:h=>h.stopPropagation(),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m(t.status),e.jsx(Y,{variant:"outline",className:"text-xs",children:t.severity}),e.jsx(Y,{variant:"secondary",className:"text-xs",children:Yc(t.type)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Gs(t.timestamp)})]}),e.jsx("h4",{className:"font-medium mb-1",children:Kc(t)}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:qc(t)}),s&&e.jsxs("div",{className:"mt-3 pt-3 border-t space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"来源设备:"}),e.jsx("span",{className:"ml-2",children:t.sourceDevice})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"冲突时间:"}),e.jsx("span",{className:"ml-2",children:Gs(t.timestamp)})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(P,{variant:"default",size:"sm",onClick:h=>{h.stopPropagation(),i()},children:"查看详情"}),e.jsx(P,{variant:"outline",size:"sm",onClick:h=>{h.stopPropagation(),c({type:"keep_local",reason:"保留本地版本"})},disabled:b,children:"保留本地"}),e.jsx(P,{variant:"outline",size:"sm",onClick:h=>{h.stopPropagation(),c({type:"keep_remote",reason:"保留远程版本"})},disabled:b,children:"保留远程"}),e.jsx(P,{variant:"ghost",size:"sm",onClick:h=>{h.stopPropagation(),u()},children:"忽略"})]})]})]})]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:h=>{h.stopPropagation(),n()},className:"ml-2",children:s?e.jsx(bs,{className:"h-4 w-4"}):e.jsx(Ut,{className:"h-4 w-4"})})]})})})}function Yc(t){return{card_content:"卡片内容",card_style:"卡片样式",card_tags:"卡片标签",card_folder:"卡片文件夹",folder_name:"文件夹名称",folder_structure:"文件夹结构",tag_rename:"标签重命名",tag_delete:"标签删除",tag_color:"标签颜色"}[t]||t}function Kc(t){switch(t.entityType){case"card":return t.localVersion.content.frontContent.title;case"folder":return t.localVersion.name;case"tag":return t.localVersion.name;default:return"未知冲突"}}function qc(t){switch(t.type){case"card_content":return"卡片内容在多设备上被同时编辑";case"folder_name":return"文件夹名称与远程版本不一致";case"tag_rename":return"标签重命名冲突";default:return"数据版本不一致"}}function Gs(t){const a=new Date().getTime()-t.getTime(),n=Math.floor(a/6e4);return n<1?"刚刚":n<60?`${n}分钟前`:n<1440?`${Math.floor(n/60)}小时前`:`${Math.floor(n/1440)}天前`}const Xc=Ir,ar=l.forwardRef(({className:t,...s},a)=>e.jsx(Ua,{ref:a,className:S("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s}));ar.displayName=Ua.displayName;const xt=l.forwardRef(({className:t,...s},a)=>e.jsx(Ba,{ref:a,className:S("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s}));xt.displayName=Ba.displayName;const yt=l.forwardRef(({className:t,...s},a)=>e.jsx(Va,{ref:a,className:S("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));yt.displayName=Va.displayName;const nr=l.forwardRef(({className:t,...s},a)=>e.jsx("textarea",{className:S("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...s}));nr.displayName="Textarea";function Jc({conflictId:t,onClose:s,className:a}){const{getConflictById:n,resolveConflict:r,ignoreConflict:o,getSuggestions:i,isResolving:c}=Kt(),[u,f]=l.useState("compare"),[m,b]=l.useState("local"),[h,d]=l.useState({}),[w,y]=l.useState(!0),g=n(t),x=i(t);if(!g)return e.jsx(te,{className:S("w-full max-w-6xl max-h-[90vh]",a),children:e.jsxs(se,{className:"p-8 text-center",children:[e.jsx(vt,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"冲突不存在"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"指定的冲突ID未找到或已被解决"}),e.jsx(P,{onClick:s,children:"关闭"})]})});const p=async()=>{let v;switch(m){case"local":v={type:"keep_local",reason:"用户选择保留本地版本"};break;case"remote":v={type:"keep_remote",reason:"用户选择保留远程版本"};break;case"merge":v={type:"merge",reason:"用户选择智能合并",mergedData:j()};break;case"manual":v={type:"manual",reason:"用户手动编辑",mergedData:h,manualChanges:Object.entries(h).map(([R,B])=>({field:R,value:B,source:"custom"}))};break}await r(t,v)&&s()},j=()=>g.entityType==="card"?{content:{frontContent:C(g.localVersion.content.frontContent,g.remoteVersion.content.frontContent),backContent:C(g.localVersion.content.backContent,g.remoteVersion.content.backContent)},style:g.localVersion.style}:g.localVersion,C=(v,N)=>({title:v.title.length>N.title.length?v.title:N.title,text:`${v.text}

${N.text}`,tags:[...new Set([...v.tags,...N.tags])],lastModified:new Date}),A=g.type==="card_content"?[{field:"title",label:"标题",local:g.localVersion.content.frontContent.title,remote:g.remoteVersion.content.frontContent.title},{field:"frontText",label:"正面内容",local:g.localVersion.content.frontContent.text,remote:g.remoteVersion.content.frontContent.text},{field:"backText",label:"背面内容",local:g.localVersion.content.backContent.text,remote:g.remoteVersion.content.backContent.text},{field:"tags",label:"标签",local:g.localVersion.content.frontContent.tags,remote:g.remoteVersion.content.frontContent.tags}]:[];return e.jsxs(te,{className:S("w-full max-w-6xl max-h-[90vh] flex flex-col",a),children:[e.jsxs(Ee,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:S("h-5 w-5",td(g.severity))}),e.jsxs("div",{children:[e.jsx(Re,{className:"text-xl",children:Qc(g)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Zc(g)})]})]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:s,children:"×"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["类型: ",ed(g.type)]}),e.jsxs("span",{children:["优先级: ",g.severity]}),e.jsxs("span",{children:["来源: ",g.sourceDevice]}),e.jsxs("span",{children:["时间: ",Ke(g.timestamp)]}),e.jsx(Y,{variant:"outline",children:g.status==="pending"?"待解决":g.status==="resolved"?"已解决":"已忽略"})]})]}),e.jsxs(se,{className:"flex-1 flex flex-col",children:[e.jsxs(Xc,{value:u,onValueChange:f,className:"flex-1 flex flex-col",children:[e.jsxs(ar,{className:"grid w-full grid-cols-4",children:[e.jsx(xt,{value:"compare",children:"对比视图"}),e.jsx(xt,{value:"suggestions",children:"智能建议"}),e.jsx(xt,{value:"history",children:"历史记录"}),e.jsx(xt,{value:"manual",children:"手动合并"})]}),e.jsxs("div",{className:"flex-1 mt-4",children:[e.jsx(yt,{value:"compare",className:"h-full",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[e.jsxs(te,{className:"border-green-200",children:[e.jsxs(Ee,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Re,{className:"text-base flex items-center gap-2",children:[e.jsx(so,{className:"h-4 w-4 text-green-600"}),"本地版本"]}),e.jsx(Y,{variant:"outline",className:"text-green-600 border-green-200",children:"本地设备"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["更新时间: ",Ke(g.localVersion.updatedAt)]})]}),e.jsx(se,{className:"p-4",children:e.jsx(Pe,{className:"h-96",children:Ys(g,"local")})})]}),e.jsxs(te,{className:"border-blue-200",children:[e.jsxs(Ee,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Re,{className:"text-base flex items-center gap-2",children:[e.jsx(ao,{className:"h-4 w-4 text-blue-600"}),"远程版本"]}),e.jsx(Y,{variant:"outline",className:"text-blue-600 border-blue-200",children:g.sourceDevice})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["更新时间: ",Ke(g.remoteVersion.updatedAt)]})]}),e.jsx(se,{className:"p-4",children:e.jsx(Pe,{className:"h-96",children:Ys(g,"remote")})})]})]})}),e.jsx(yt,{value:"suggestions",className:"h-full",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(no,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"智能解决建议"})]}),x.length>0?e.jsx("div",{className:"grid gap-3",children:x.map((v,N)=>e.jsx(te,{className:"cursor-pointer hover:shadow-md transition-shadow",children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Y,{variant:v.type==="merge"?"default":"secondary",children:sd(v.type)}),e.jsxs(Y,{variant:"outline",children:["置信度: ",Math.round(v.confidence*100),"%"]})]}),e.jsx("p",{className:"text-sm mb-2",children:v.reason}),v.preview&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-gray-50 p-2 rounded",children:["预览: ",JSON.stringify(v.preview)]})]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>b(v.type),children:"应用建议"})]})})},N))}):e.jsx(te,{children:e.jsxs(se,{className:"p-8 text-center",children:[e.jsx(vt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"暂无智能建议，请手动选择解决方案"})]})})]})}),e.jsx(yt,{value:"history",className:"h-full",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(jt,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"冲突历史"})]}),e.jsx(te,{children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"冲突检测"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Ke(g.timestamp)})]}),e.jsx(Y,{variant:"destructive",children:"冲突"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"本地版本更新"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Ke(g.localVersion.updatedAt)})]}),e.jsx(Y,{variant:"outline",children:"本地"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"远程版本更新"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Ke(g.remoteVersion.updatedAt)})]}),e.jsx(Y,{variant:"outline",children:"远程"})]})]})})})]})}),e.jsx(yt,{value:"manual",className:"h-full",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Lt,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"手动合并"}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>y(!w),children:[w?e.jsx(us,{className:"h-4 w-4 mr-1"}):e.jsx(Lt,{className:"h-4 w-4 mr-1"}),w?"隐藏差异":"显示差异"]})]}),e.jsx(Pe,{className:"h-96",children:e.jsx("div",{className:"space-y-4",children:A.map(v=>e.jsxs(te,{children:[e.jsx(Ee,{className:"pb-3",children:e.jsx(Re,{className:"text-base",children:v.label})}),e.jsxs(se,{className:"space-y-3",children:[w&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"p-2 bg-green-50 rounded text-sm",children:[e.jsx("p",{className:"font-medium text-green-700 mb-1",children:"本地:"}),e.jsx("p",{children:v.local})]}),e.jsxs("div",{className:"p-2 bg-blue-50 rounded text-sm",children:[e.jsx("p",{className:"font-medium text-blue-700 mb-1",children:"远程:"}),e.jsx("p",{children:v.remote})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"合并结果:"}),v.field==="tags"?e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Array.isArray(v.local)&&v.local.map(N=>e.jsx(Y,{variant:"secondary",children:N},N)),Array.isArray(v.remote)&&v.remote.map(N=>e.jsx(Y,{variant:"outline",children:N},N))]}):e.jsx(nr,{value:h[v.field]||v.local,onChange:N=>d(R=>({...R,[v.field]:N.target.value})),className:"min-h-[100px]"})]})]})]},v.field))})})]})})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"解决方案:"}),e.jsx("div",{className:"flex gap-2",children:["local","remote","merge","manual"].map(v=>e.jsx(P,{variant:m===v?"default":"outline",size:"sm",onClick:()=>b(v),children:ad(v)},v))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",onClick:s,children:"取消"}),e.jsx(P,{variant:"ghost",onClick:()=>o(t),children:"忽略冲突"}),e.jsx(P,{onClick:p,disabled:c,children:c?"解决中...":"应用解决方案"})]})]})})]})]})}function Ys(t,s){const a=s==="local"?t.localVersion:t.remoteVersion;return t.entityType==="card"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"正面内容"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsx("h5",{className:"font-semibold mb-2",children:a.content.frontContent.title}),e.jsx("p",{className:"text-sm text-gray-600",children:a.content.frontContent.text}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:a.content.frontContent.tags.map(n=>e.jsx(Y,{variant:"secondary",className:"text-xs",children:n},n))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"背面内容"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsx("h5",{className:"font-semibold mb-2",children:a.content.backContent.title}),e.jsx("p",{className:"text-sm text-gray-600",children:a.content.backContent.text}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:a.content.backContent.tags.map(n=>e.jsx(Y,{variant:"secondary",className:"text-xs",children:n},n))})]})]})]}):e.jsx("pre",{className:"text-sm",children:JSON.stringify(a,null,2)})}function Qc(t){switch(t.entityType){case"card":return t.localVersion.content.frontContent.title;case"folder":return t.localVersion.name;case"tag":return t.localVersion.name;default:return"未知冲突"}}function Zc(t){switch(t.type){case"card_content":return"卡片内容在多设备上被同时编辑，需要选择保留的版本";case"folder_name":return"文件夹名称与远程版本不一致";case"tag_rename":return"标签重命名冲突";default:return"数据版本不一致，需要手动解决"}}function ed(t){return{card_content:"卡片内容",card_style:"卡片样式",card_tags:"卡片标签",card_folder:"卡片文件夹",folder_name:"文件夹名称",folder_structure:"文件夹结构",tag_rename:"标签重命名",tag_delete:"标签删除",tag_color:"标签颜色"}[t]||t}function td(t){switch(t){case"critical":return"text-red-600";case"high":return"text-orange-600";case"medium":return"text-yellow-600";case"low":return"text-blue-600";default:return"text-gray-600"}}function sd(t){return{keep_local:"保留本地",keep_remote:"保留远程",merge:"智能合并",manual:"手动处理"}[t]||t}function ad(t){return{local:"保留本地",remote:"保留远程",merge:"智能合并",manual:"手动合并"}[t]||t}function Ke(t){const a=new Date().getTime()-t.getTime(),n=Math.floor(a/6e4);return n<1?"刚刚":n<60?`${n}分钟前`:n<1440?`${Math.floor(n/60)}小时前`:`${Math.floor(n/1440)}天前`}function nd({className:t,showLabel:s=!0,showDetails:a=!0,onSync:n}){const[r,o]=l.useState({isOnline:!0,isSyncing:!1,hasConflicts:!1,pendingOperations:0,lastSyncTime:null,conflicts:[]});l.useEffect(()=>{const d=()=>{o(y=>({...y,isOnline:!0}))},w=()=>{o(y=>({...y,isOnline:!1}))};return window.addEventListener("online",d),window.addEventListener("offline",w),o(y=>({...y,isOnline:navigator.onLine})),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",w)}},[]),l.useEffect(()=>{const d=async()=>{try{const p=ae.getStatus();o(j=>({...j,isSyncing:p.isSyncing,hasConflicts:p.hasConflicts,pendingOperations:p.pendingOperations||0,lastSyncTime:p.lastSyncTime?new Date(p.lastSyncTime):null,conflicts:p.conflicts||[]}))}catch(p){console.error("Failed to update sync status:",p)}};d();const w=setInterval(d,3e3),y=()=>{o(p=>({...p,isSyncing:!0}))},g=()=>{o(p=>({...p,isSyncing:!1})),d()},x=()=>{o(p=>({...p,isSyncing:!1}))};return ae.on("sync:start",y),ae.on("sync:complete",g),ae.on("sync:error",x),()=>{clearInterval(w),ae.off("sync:start",y),ae.off("sync:complete",g),ae.off("sync:error",x)}},[]);const i=()=>r.isOnline?r.isSyncing?"text-yellow-500 animate-pulse":r.hasConflicts?"text-orange-500":"text-green-500":"text-red-500",c=()=>r.isOnline?r.isSyncing?e.jsx(ve,{className:"h-4 w-4 animate-spin"}):r.hasConflicts?e.jsx(ye,{className:"h-4 w-4"}):e.jsx(Bt,{className:"h-4 w-4"}):e.jsx(ws,{className:"h-4 w-4"}),u=()=>r.isOnline?r.isSyncing?"同步中...":r.hasConflicts?"有冲突":"已同步":"离线",f=d=>{if(!d)return"从未";const y=new Date().getTime()-d.getTime(),g=Math.floor(y/6e4);return g<1?"刚刚":g<60?`${g}分钟前`:g<1440?`${Math.floor(g/60)}小时前`:`${Math.floor(g/1440)}天前`},m=async()=>{if(n){n();return}try{await ae.sync({type:"incremental",direction:"bidirectional"})}catch(d){console.error("Manual sync failed:",d)}},b=()=>e.jsxs("div",{className:S("flex items-center gap-2",t),children:[e.jsxs("div",{className:S("flex items-center gap-1",i()),children:[c(),s&&e.jsx("span",{className:"text-sm",children:u()})]}),r.pendingOperations>0&&e.jsx(Y,{variant:"secondary",className:"text-xs",children:r.pendingOperations}),r.conflicts.length>0&&e.jsx(Y,{variant:"destructive",className:"text-xs",children:r.conflicts.length}),e.jsx(P,{variant:"ghost",size:"sm",onClick:m,disabled:r.isSyncing||!r.isOnline,className:"h-6 w-6 p-0",children:e.jsx(ve,{className:S("h-3 w-3",r.isSyncing&&"animate-spin")})})]}),h=()=>e.jsxs(un,{children:[e.jsx(fn,{asChild:!0,children:e.jsxs("div",{className:S("flex items-center gap-2 cursor-pointer hover:bg-accent rounded-md p-2",t),children:[e.jsxs("div",{className:S("flex items-center gap-1",i()),children:[c(),s&&e.jsx("span",{className:"text-sm font-medium",children:u()})]}),r.pendingOperations>0&&e.jsxs(Y,{variant:"outline",className:"text-xs",children:[r.pendingOperations," 待同步"]}),r.conflicts.length>0&&e.jsxs(Y,{variant:"destructive",className:"text-xs",children:[r.conflicts.length," 冲突"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:f(r.lastSyncTime)}),e.jsx(P,{variant:"ghost",size:"sm",onClick:d=>{d.stopPropagation(),m()},disabled:r.isSyncing||!r.isOnline,className:"h-6 w-6 p-0 ml-auto",children:e.jsx(ve,{className:S("h-3 w-3",r.isSyncing&&"animate-spin")})})]})}),e.jsx(Cs,{className:"w-96 p-0",align:"end",children:e.jsx(sr,{showDetails:!0,compact:!1})})]});return a?e.jsx(h,{}):e.jsx(b,{})}function rd(t={}){const{enableMetricsCollection:s=!0,enableUserTracking:a=!0,enableConflictMonitoring:n=!0,reportInterval:r=3e4}=t,o=l.useRef({averageRenderTime:0,averageMemoryUsage:0,averageNetworkLatency:0,conflictResolutionTime:0,userSatisfaction:0,errorRate:0,totalOperations:0,successfulOperations:0}),i=l.useRef([]),c=l.useRef([]);l.useEffect(()=>{if(!s)return;he.clearMetrics();const N=setInterval(()=>{u()},r);return()=>{clearInterval(N)}},[s,r]);const u=l.useCallback(()=>{const N=he.getMetrics();if(N.length===0)return;const R=N.slice(-10),B=f(R);o.current={averageRenderTime:B.renderTime,averageMemoryUsage:B.memoryUsage,averageNetworkLatency:B.networkLatency,conflictResolutionTime:B.conflictResolutionTime,userSatisfaction:B.userSatisfaction,errorRate:m(R),totalOperations:R.length,successfulOperations:R.filter(_=>_.errorRate<.05).length},i.current=N},[]),f=l.useCallback(N=>N.length===0?{renderTime:0,memoryUsage:0,networkLatency:0,conflictResolutionTime:0,userSatisfaction:0,errorRate:0}:{renderTime:N.reduce((R,B)=>R+B.renderTime,0)/N.length,memoryUsage:N.reduce((R,B)=>R+B.memoryUsage,0)/N.length,networkLatency:N.reduce((R,B)=>R+B.networkLatency,0)/N.length,conflictResolutionTime:N.reduce((R,B)=>R+B.conflictResolutionTime,0)/N.length,userSatisfaction:N.reduce((R,B)=>R+B.userSatisfaction,0)/N.length,errorRate:N.reduce((R,B)=>R+B.errorRate,0)/N.length},[]),m=l.useCallback(N=>N.reduce((B,_)=>B+_.errorRate,0)/N.length,[]),b=l.useCallback(()=>n?he.startConflictDetection():()=>{},[n]),h=l.useCallback(()=>n?he.startConflictResolution():()=>{},[n]),d=l.useCallback(()=>n?he.startBatchOperation():()=>{},[n]),w=l.useCallback((N,R,B)=>{a&&(he.trackUserInteraction(N,R,B),c.current.push({action:N,duration:R,success:B,timestamp:new Date}),c.current.length>100&&(c.current=c.current.slice(-100)))},[a]),y=l.useCallback((N,R)=>{a&&he.trackUserSatisfaction(N,R)},[a]),g=l.useCallback((N=36e5)=>he.generateReport(N),[]),x=l.useCallback(()=>he.getRealtimeMetrics(),[]),p=l.useCallback(()=>he.getAlerts(),[]),j=l.useCallback((N=20)=>c.current.slice(-N),[]),C=l.useCallback(()=>({...o.current}),[]),F=l.useCallback(()=>{he.clearMetrics(),i.current=[],c.current=[],o.current={averageRenderTime:0,averageMemoryUsage:0,averageNetworkLatency:0,conflictResolutionTime:0,userSatisfaction:0,errorRate:0,totalOperations:0,successfulOperations:0}},[]),A=l.useCallback(()=>{const N=o.current;let R=100;return N.averageRenderTime>100&&(R-=20),N.averageRenderTime>200&&(R-=30),N.averageMemoryUsage>100*1024*1024&&(R-=15),N.averageMemoryUsage>200*1024*1024&&(R-=25),N.averageNetworkLatency>1e3&&(R-=10),N.averageNetworkLatency>2e3&&(R-=20),N.errorRate>.05&&(R-=15),N.errorRate>.1&&(R-=25),N.conflictResolutionTime>5e3&&(R-=10),N.conflictResolutionTime>1e4&&(R-=20),{healthScore:Math.max(0,R),status:R>=80?"good":R>=60?"warning":"critical",issues:v(N)}},[]),v=l.useCallback(N=>{const R=[];return N.averageRenderTime>100&&R.push("渲染时间过长，可能影响用户体验"),N.averageMemoryUsage>100*1024*1024&&R.push("内存使用较高，建议检查内存泄漏"),N.averageNetworkLatency>1e3&&R.push("网络延迟较高，可能影响同步性能"),N.errorRate>.05&&R.push("错误率较高，需要关注错误处理"),N.conflictResolutionTime>5e3&&R.push("冲突解决时间过长，建议优化算法"),R},[]);return{startConflictDetection:b,startConflictResolution:h,startBatchOperation:d,trackUserInteraction:w,trackUserSatisfaction:y,getPerformanceReport:g,getRealtimeMetrics:x,getPerformanceAlerts:p,getUserActionHistory:j,getPerformanceStats:C,clearPerformanceData:F,getPerformanceHealth:A,stats:o.current,isMonitoring:s}}function od({className:t,showDetails:s=!0,compact:a=!1,autoRefresh:n=!0}){const[r,o]=l.useState(!1),[i,c]=l.useState("overview"),[u,f]=l.useState(0),{stats:m,getRealtimeMetrics:b,getPerformanceAlerts:h,getUserActionHistory:d,getPerformanceHealth:w,getPerformanceReport:y,isMonitoring:g}=rd({enableMetricsCollection:!0,enableUserTracking:!0,enableConflictMonitoring:!0,reportInterval:1e4}),[x,p]=l.useState({}),[j,C]=l.useState([]),[F,A]=l.useState([]),[v,N]=l.useState(null),R=()=>{p(b()),C(h()),A(d(20)),N(w()),f($=>$+1)};l.useEffect(()=>{if(!n||!r)return;R();const $=setInterval(R,5e3);return()=>clearInterval($)},[n,r,u]),l.useEffect(()=>{r&&R()},[r]);const B=$=>{if($===0)return"0 B";const q=1024,ee=["B","KB","MB","GB"],Z=Math.floor(Math.log($)/Math.log(q));return`${parseFloat(($/Math.pow(q,Z)).toFixed(2))} ${ee[Z]}`},_=$=>$<1e3?`${$.toFixed(0)}ms`:$<6e4?`${($/1e3).toFixed(1)}s`:`${($/6e4).toFixed(1)}min`,U=$=>{switch($){case"good":return"text-green-500";case"warning":return"text-yellow-500";case"critical":return"text-red-500";default:return"text-gray-500"}},J=$=>{switch($){case"good":return e.jsx(wt,{className:"h-4 w-4 text-green-500"});case"warning":return e.jsx(ye,{className:"h-4 w-4 text-yellow-500"});case"critical":return e.jsx(vt,{className:"h-4 w-4 text-red-500"});default:return e.jsx(_s,{className:"h-4 w-4 text-gray-500"})}};return a?e.jsxs("div",{className:S("flex items-center gap-2",t),children:[e.jsxs("div",{className:S("flex items-center gap-1",U(v?.status||"unknown")),children:[J(v?.status||"unknown"),e.jsxs("span",{className:"text-sm font-medium",children:[v?.healthScore||0,"/100"]})]}),j.length>0&&e.jsx(Y,{variant:"destructive",className:"text-xs",children:j.length}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>o(!r),children:e.jsx(ro,{className:"h-4 w-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:S("flex items-center gap-2 cursor-pointer",t),onClick:()=>o(!r),children:[e.jsxs("div",{className:S("flex items-center gap-1",U(v?.status||"unknown")),children:[J(v?.status||"unknown"),e.jsxs("span",{className:"text-sm font-medium",children:["性能: ",v?.healthScore||0,"/100"]})]}),j.length>0&&e.jsxs(Y,{variant:"destructive",className:"text-xs",children:[j.length," 警报"]}),e.jsx(P,{variant:"ghost",size:"sm",children:r?"隐藏":"显示"})]}),r&&e.jsxs(te,{className:"w-full max-w-4xl max-h-[80vh]",children:[e.jsxs(Ee,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Re,{className:"text-lg flex items-center gap-2",children:[e.jsx(_s,{className:"h-5 w-5"}),"性能监控",e.jsx(Y,{variant:g?"default":"secondary",children:g?"监控中":"已停止"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:R,children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"刷新"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>{const $=y();console.log("Performance Report:",$)},children:[e.jsx(et,{className:"h-4 w-4 mr-2"}),"报告"]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>o(!1),children:"×"})]})]}),v&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"健康状态:"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[J(v.status),e.jsxs("span",{className:S("font-medium",U(v.status)),children:[v.healthScore,"/100 (",v.status,")"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"渲染时间:"}),e.jsx("span",{className:"ml-2 font-medium",children:_(x.renderTime||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"内存使用:"}),e.jsx("span",{className:"ml-2 font-medium",children:B(x.memoryUsage||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"网络延迟:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[x.networkLatency||0,"ms"]})]})]})]}),e.jsxs(se,{children:[e.jsx("div",{className:"flex gap-2 mb-4",children:["overview","metrics","alerts","actions"].map($=>e.jsxs(P,{variant:i===$?"default":"outline",size:"sm",onClick:()=>c($),children:[$==="overview"&&"概览",$==="metrics"&&"指标",$==="alerts"&&"警报",$==="actions"&&"用户行为"]},$))}),e.jsxs(Pe,{className:"h-96",children:[i==="overview"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(te,{children:e.jsxs(se,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Xa,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"font-medium",children:"渲染性能"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"平均渲染时间:"}),e.jsx("span",{children:_(m.averageRenderTime)})]}),e.jsx($e,{value:Math.min(100,m.averageRenderTime/100*100),className:"h-2"})]})]})}),e.jsx(te,{children:e.jsxs(se,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ja,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"font-medium",children:"内存使用"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"内存使用:"}),e.jsx("span",{children:B(m.averageMemoryUsage)})]}),e.jsx($e,{value:Math.min(100,m.averageMemoryUsage/(100*1024*1024)*100),className:"h-2"})]})]})}),e.jsx(te,{children:e.jsxs(se,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Bt,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"font-medium",children:"网络性能"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"平均延迟:"}),e.jsxs("span",{children:[m.averageNetworkLatency,"ms"]})]}),e.jsx($e,{value:Math.min(100,m.averageNetworkLatency/1e3*100),className:"h-2"})]})]})}),e.jsx(te,{children:e.jsxs(se,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(oo,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{className:"font-medium",children:"用户体验"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"满意度:"}),e.jsxs("span",{children:[m.userSatisfaction.toFixed(1),"%"]})]}),e.jsx($e,{value:m.userSatisfaction,className:"h-2"})]})]})})]}),v?.issues&&v.issues.length>0&&e.jsx(te,{children:e.jsxs(se,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:"font-medium",children:"性能问题"})]}),e.jsx("div",{className:"space-y-1 text-sm",children:v.issues.map(($,q)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1 h-1 bg-orange-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:$})]},q))})]})})]}),i==="metrics"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"实时性能指标"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"渲染时间:"}),e.jsx("span",{children:_(x.renderTime||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"首次绘制:"}),e.jsx("span",{children:_(x.firstPaint||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"内容绘制:"}),e.jsx("span",{children:_(x.firstContentfulPaint||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"最大内容绘制:"}),e.jsx("span",{children:_(x.largestContentfulPaint||0)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"内存使用:"}),e.jsx("span",{children:B(x.memoryUsage||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"网络延迟:"}),e.jsxs("span",{children:[x.networkLatency||0,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"冲突检测时间:"}),e.jsx("span",{children:_(x.conflictDetectionTime||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"冲突解决时间:"}),e.jsx("span",{children:_(x.conflictResolutionTime||0)})]})]})]})]}),i==="alerts"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"性能警报"}),j.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"暂无性能警报"}):e.jsx("div",{className:"space-y-2",children:j.map(($,q)=>e.jsx(te,{className:"border-l-4 border-l-red-500",children:e.jsxs(se,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"font-medium text-sm",children:$.type}),e.jsx(Y,{variant:"outline",className:"text-xs",children:$.severity})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date($.timestamp).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm mb-2",children:$.message}),$.suggestions&&$.suggestions.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium",children:"建议:"}),$.suggestions.map((ee,Z)=>e.jsxs("div",{className:"text-xs text-muted-foreground",children:["• ",ee]},Z))]})]})},q))})]}),i==="actions"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"用户行为历史"}),F.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"暂无用户行为记录"}):e.jsx("div",{className:"space-y-2",children:F.map(($,q)=>e.jsx(te,{children:e.jsx(se,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:$.action}),e.jsx(Y,{variant:$.success?"default":"destructive",className:"text-xs",children:$.success?"成功":"失败"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(jt,{className:"h-3 w-3"}),e.jsx("span",{children:new Date($.timestamp).toLocaleTimeString()}),e.jsxs("span",{children:["(",_($.duration),")"]})]})]})})},q))})]})]})]})]})]})}function id({className:t}){const[s,a]=l.useState({user:null,session:null,loading:!1,error:null}),{openModal:n}=sn(),{cards:r,filter:o,setFilter:i,viewSettings:c,setViewSettings:u,dispatch:f,getAllTags:m,updateTagsInAllCards:b,getCardsWithTag:h}=Fo(),{folderTree:d,selectedFolderId:w,setSelectedFolderId:y,dispatch:g,getFolderById:x,folders:p}=Za(),{tags:j,popularTags:C,renameTag:F,deleteTagByName:A,getAllTagNames:v}=en(),{toast:N}=fc(),[R,B]=l.useState(!1),[_,U]=l.useState(!1),[J,$]=l.useState({gap:16,showLayoutControls:!1}),{stats:q,selectedConflict:ee,setSelectedConflict:Z}=Kt(),[le,M]=l.useState(!1),[H,E]=l.useState(!1);l.useEffect(()=>Oe.onAuthStateChange(a),[]);const[T,k]=l.useState(!1),[z,W]=l.useState(!1),[I,V]=l.useState(null),[ne,Ne]=l.useState(null),[Ve,be]=l.useState(),[it,We]=l.useState(!1),[qt,lt]=l.useState(!1),[Tt,ct]=l.useState(""),[fe,dt]=l.useState(null),{isDownloading:Et,showPreview:Le,previewData:mt,captureScreenshot:Ce,confirmDownload:Xt,cancelPreview:Jt}=rc({onSuccess:D=>{N({title:"Screenshot saved!",description:`${D}.png has been downloaded successfully.`})},onError:D=>{N({title:"Screenshot failed",description:D.message,variant:"destructive"})}}),ce=D=>{f({type:"FLIP_CARD",payload:D})},De=(D,O)=>{f({type:"UPDATE_CARD",payload:{id:D,updates:O}})},Qt=async D=>{const O=r.find(K=>K.id===D);if(O){const K=O.isFlipped?O.backContent:O.frontContent,oe=Ii(K.title,K.text);await Mi(oe)?console.log("Card content copied to clipboard"):console.error("Failed to copy card content")}},Zt=async D=>{const O=r.find(re=>re.id===D);if(!O)return;const K=document.querySelector(`[data-card-id="${D}"]`);if(!K){N({title:"Screenshot failed",description:"Could not find card element. Please try again.",variant:"destructive"});return}const ie=(O.isFlipped?O.backContent:O.frontContent).title||"Untitled Card";await Ce(K,ie)},He=D=>{console.log("Share card:",D)},es=D=>{f({type:"DELETE_CARD",payload:D})},Rt=(D,O)=>{const K=r.find(re=>re.id===D);if(!K)return;const oe=K.folderId;if(f({type:"UPDATE_CARD",payload:{id:D,updates:{folderId:O||void 0}}}),oe){const re=x(oe);re&&g({type:"UPDATE_FOLDER",payload:{id:oe,updates:{cardIds:re.cardIds.filter(rr=>rr!==D)}}})}if(O){const re=x(O);re&&g({type:"UPDATE_FOLDER",payload:{id:O,updates:{cardIds:[...re.cardIds,D]}}})}const ie=O?x(O)?.name:"Root";N({title:"Card moved",description:`Card has been moved to "${ie}".`})},ze=()=>{f({type:"CREATE_CARD",payload:{frontContent:{title:"New Card",text:"Click to edit this card...",images:[],tags:[],lastModified:new Date},backContent:{title:"Back Side",text:"Add additional content here...",images:[],tags:[],lastModified:new Date},style:{type:"solid",backgroundColor:"#ffffff",fontFamily:"system-ui",fontSize:"base",fontWeight:"normal",textColor:"#1f2937",borderRadius:"xl",shadow:"md",borderWidth:0},isFlipped:!1,folderId:w||void 0}})},Se=()=>{be(void 0),V(null),k(!0)},ut=D=>{be(D),V(null),k(!0)},ke=D=>{const O=x(D);O&&(V({id:D,name:O.name,color:O.color,icon:O.icon||"Folder"}),be(void 0),k(!0))},Dt=D=>{const O=x(D);if(O){const K=p.filter(oe=>oe.parentId===D);Ne({id:D,name:O.name,cardCount:O.cardIds.length,hasSubfolders:K.length>0,subfolderCount:K.length}),W(!0)}},ts=D=>{I?(g({type:"UPDATE_FOLDER",payload:{id:I.id,updates:{name:D.name,color:D.color,icon:D.icon}}}),N({title:"Folder updated",description:`"${D.name}" has been updated successfully.`})):(g({type:"CREATE_FOLDER",payload:{name:D.name,color:D.color,icon:D.icon,cardIds:[],parentId:D.parentId,isExpanded:!0}}),N({title:"Folder created",description:`"${D.name}" has been created successfully.`}))},At=()=>{ne&&(g({type:"DELETE_FOLDER",payload:ne.id,onDeleteCards:D=>{D.forEach(O=>{f({type:"DELETE_CARD",payload:O})})}}),N({title:"Folder deleted",description:`"${ne.name}" and ${ne.cardCount} cards have been deleted.`}),w===ne.id&&Ge(null))},_t=D=>{const O=o.tags.includes(D);i({...o,tags:O?o.tags.filter(K=>K!==D):[...o.tags,D]})},Ge=D=>{y(D),i({...o,folderId:D||void 0})},ft=D=>{ct(D),We(!0)},we=D=>{const O=h(D);dt({name:D,cardCount:O.length}),lt(!0)},ss=(D,O)=>{F(D,O)?(b(D,O),N({title:"Tag renamed",description:`"${D}" has been renamed to "${O}".`}),We(!1),ct("")):N({title:"Rename failed",description:"A tag with this name already exists.",variant:"destructive"})},G=()=>{fe&&A(fe.name)&&(b(fe.name),o.tags.includes(fe.name)&&i({...o,tags:o.tags.filter(O=>O!==fe.name)}),N({title:"Tag deleted",description:`"${fe.name}" has been removed from ${fe.cardCount} cards.`}),lt(!1),dt(null))},X=(D,O=0)=>D.map(K=>e.jsxs("div",{style:{marginLeft:O*16},children:[e.jsx(Hs,{folderId:K.id,folderName:K.name,onRename:ke,onDelete:Dt,onCreateSubfolder:ut,children:e.jsxs(P,{variant:w===K.id?"secondary":"ghost",className:"w-full justify-start text-sm mb-1",onClick:()=>Ge(K.id),children:[e.jsx(_e,{className:"h-4 w-4 mr-2",style:{color:K.color}}),K.name,e.jsx(Y,{variant:"secondary",className:"ml-auto",children:K.cardIds.length})]})}),K.children&&K.children.length>0&&K.isExpanded&&e.jsx("div",{className:"ml-4",children:X(K.children,O+1)})]},K.id)),Q=D=>D.map(O=>e.jsxs("div",{children:[e.jsx(Hs,{folderId:O.id,folderName:O.name,onRename:ke,onDelete:Dt,onCreateSubfolder:ut,children:e.jsx(P,{variant:w===O.id?"secondary":"ghost",className:"w-full h-10 p-0 mb-1",onClick:()=>Ge(O.id),title:O.name,children:e.jsx(_e,{className:"h-4 w-4",style:{color:O.color}})})}),O.children&&O.children.length>0&&O.isExpanded&&e.jsx("div",{children:Q(O.children)})]},O.id));return e.jsx(Ri,{children:e.jsxs("div",{className:S("min-h-screen bg-background",t),children:[e.jsx("header",{className:"sticky top-0 z-40 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"container flex h-16 items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-lg bg-gradient-to-br from-violet-500 to-pink-500 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"CA"})}),e.jsxs("h1",{className:"text-xl font-bold",children:[e.jsx("span",{className:"text-violet-600",children:"Card"}),e.jsx("span",{className:"text-pink-500",children:"All"})]})]}),e.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 hidden md:block",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(me,{placeholder:"Search cards...",value:o.searchTerm,onChange:D=>i({...o,searchTerm:D.target.value}),className:"pl-10 rounded-full w-80"})]})}),e.jsx("div",{className:"md:hidden absolute left-1/2 transform -translate-x-1/2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(me,{placeholder:"Search...",value:o.searchTerm,onChange:D=>i({...o,searchTerm:D.target.value}),className:"pl-10 rounded-full w-60"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[q.pendingConflicts>0&&e.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>M(!0),className:"relative text-orange-600 hover:bg-orange-50",children:[e.jsx(ye,{className:"h-4 w-4"}),q.pendingConflicts>0&&e.jsx(Y,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 flex items-center justify-center p-0 text-xs",children:q.pendingConflicts>99?"99+":q.pendingConflicts}),e.jsx("span",{className:"sr-only",children:"Conflict Notifications"})]}),e.jsx(nd,{showDetails:!0,showLabel:!1,className:"mr-1"}),e.jsx(od,{compact:!0,autoRefresh:!0}),e.jsxs(un,{children:[e.jsx(fn,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",children:e.jsx(io,{className:"h-4 w-4"})})}),e.jsx(Cs,{className:"w-80",align:"end",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Layout Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Customize the masonry layout appearance"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ue,{children:["Gap Size: ",J.gap,"px"]}),e.jsx(mn,{value:[J.gap],onValueChange:([D])=>$(O=>({...O,gap:D})),max:32,min:8,step:4,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{children:"Card Size"}),e.jsx("div",{className:"flex gap-2",children:["small","medium","large"].map(D=>e.jsx(P,{variant:c.cardSize===D?"default":"outline",size:"sm",onClick:()=>u(O=>({...O,cardSize:D})),children:D.charAt(0).toUpperCase()+D.slice(1)},D))})]})]})})]}),e.jsxs(P,{onClick:ze,variant:"ghost",size:"sm",className:"text-black font-bold hover:bg-gray-100 rounded-full w-10 h-10 p-0 flex items-center justify-center",children:[e.jsx(Ft,{className:"h-6 w-6"}),e.jsx("span",{className:"sr-only",children:"Add Card"})]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:n,className:"flex items-center gap-2",children:s.user?e.jsxs(e.Fragment,{children:[e.jsx(Mn,{user:s.user,size:"sm",onClick:n,showHoverEffect:!0}),e.jsx("span",{className:"hidden sm:inline text-sm",children:s.user.username||"User"})]}):e.jsxs(e.Fragment,{children:[e.jsx(lo,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline text-sm",children:"Login"})]})})]})]})}),e.jsxs("main",{className:"flex h-[calc(100vh-4rem)]",children:[e.jsx("div",{className:"absolute top-16 left-0 right-0 z-30 bg-background border-b",children:e.jsx(Uc,{onOpenConflictPanel:()=>M(!0)})}),e.jsxs("aside",{className:S("border-r transition-all duration-300 ease-in-out flex flex-col",_?"w-16":"w-72"),children:[e.jsx("div",{className:"p-3 flex items-center justify-end",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>U(!_),className:"h-8 w-8 p-0",children:_?e.jsx(Ut,{className:"h-4 w-4"}):e.jsx(co,{className:"h-4 w-4"})})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-3 space-y-4",children:[!_&&e.jsxs("div",{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{className:"w-full justify-start",onClick:ze,children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"New Card"]}),e.jsxs(P,{variant:"outline",className:"w-full justify-start",onClick:Se,children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"New Folder"]})]}),e.jsx(Je,{className:"my-4"})]}),_&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{variant:"ghost",size:"sm",className:"w-full h-10 p-0",onClick:ze,title:"New Card",children:e.jsx(Ft,{className:"h-4 w-4"})}),e.jsx(P,{variant:"ghost",size:"sm",className:"w-full h-10 p-0",onClick:Se,title:"New Folder",children:e.jsx(ms,{className:"h-4 w-4"})}),e.jsx(Je,{className:"my-4"})]}),e.jsxs("div",{children:[!_&&e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Folders"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(P,{variant:w?"ghost":"secondary",className:S("w-full text-sm",_?"h-10 p-0":"justify-start"),onClick:()=>Ge(null),title:_?"All Cards":void 0,children:[e.jsx(_e,{className:"h-4 w-4"}),!_&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"ml-2",children:"All Cards"}),e.jsx(Y,{variant:"secondary",className:"ml-auto",children:r.length})]})]}),_?Q(d):X(d)]})]}),e.jsx(Je,{}),e.jsxs("div",{children:[!_&&e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Tags"}),o.tags.length>0&&e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>i({...o,tags:[]}),className:"h-6 px-2 text-xs",children:"Clear"})]}),e.jsx("div",{className:"space-y-1",children:C(_?5:10).map(D=>e.jsx(Ac,{tagName:D.name,onRename:ft,onDelete:we,disabled:_,children:e.jsxs(P,{variant:o.tags.includes(D.name)?"secondary":"ghost",className:S("w-full text-sm",_?"h-10 p-0":"justify-start"),onClick:()=>_t(D.name),title:_?`${D.name} (Right-click to expand sidebar for tag management)`:D.name,children:[e.jsx(Ya,{className:"h-3 w-3",style:{color:D.color}}),!_&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"ml-2",children:D.name}),e.jsx(Y,{variant:"secondary",className:"ml-auto",children:D.count})]})]})},D.id))})]}),!_&&(o.tags.length>0||o.searchTerm)&&e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Active Filters"}),e.jsxs("div",{className:"space-y-2",children:[o.searchTerm&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-3 w-3"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:['"',o.searchTerm,'"']})]}),o.tags.map(D=>e.jsx(Y,{variant:"secondary",className:"mr-1",children:D},D))]})]})]})]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"p-4",children:e.jsx(Pi,{cards:r,onCardFlip:ce,onCardUpdate:De,onCardCopy:Qt,onCardScreenshot:Zt,onCardShare:He,onCardDelete:es,onMoveToFolder:Rt,cardSize:c.cardSize==="small"?"sm":c.cardSize==="large"?"lg":"md",enableVirtualization:r.length>20,gap:J.gap,overscan:3})})})]}),e.jsx(oc,{isOpen:Le,onClose:Jt,onConfirm:Xt,previewUrl:mt?.previewUrl||null,fileName:mt?.fileName||"",isDownloading:Et}),e.jsx(Tc,{isOpen:T,onClose:()=>{k(!1),V(null),be(void 0)},onConfirm:ts,parentId:Ve,initialData:l.useMemo(()=>I?{name:I.name,color:I.color,icon:I.icon}:void 0,[I]),mode:I?"edit":"create"}),e.jsx(Dc,{isOpen:z,onClose:()=>{W(!1),Ne(null)},onConfirm:At,folderName:ne?.name||"",cardCount:ne?.cardCount||0,hasSubfolders:ne?.hasSubfolders||!1,subfolderCount:ne?.subfolderCount||0}),e.jsx(_c,{isOpen:it,onClose:()=>{We(!1),ct("")},onConfirm:ss,tagName:Tt,existingTags:v()}),e.jsx(Pc,{isOpen:qt,onClose:()=>{lt(!1),dt(null)},onConfirm:G,tagName:fe?.name||"",cardCount:fe?.cardCount||0}),e.jsx(zc,{}),e.jsx(Hc,{isOpen:le,onClose:()=>M(!1)}),ee&&e.jsx(Jc,{conflictId:ee,onClose:()=>{E(!1),Z(null)}})]})})}const ld={theme:"system",setTheme:()=>null},cd=l.createContext(ld);function dd({children:t,defaultTheme:s="system",storageKey:a="vite-ui-theme",...n}){const[r,o]=l.useState(()=>localStorage.getItem(a)||s);l.useEffect(()=>{const c=window.document.documentElement;if(c.classList.remove("light","dark"),r==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";c.classList.add(u);return}c.classList.add(r)},[r]);const i={theme:r,setTheme:c=>{localStorage.setItem(a,c),o(c)}};return e.jsx(cd.Provider,{...n,value:i,children:t})}var md=t=>{switch(t){case"success":return hd;case"info":return pd;case"warning":return gd;case"error":return xd;default:return null}},ud=Array(12).fill(0),fd=({visible:t,className:s})=>L.createElement("div",{className:["sonner-loading-wrapper",s].filter(Boolean).join(" "),"data-visible":t},L.createElement("div",{className:"sonner-spinner"},ud.map((a,n)=>L.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),hd=L.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},L.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),gd=L.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},L.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),pd=L.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},L.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),xd=L.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},L.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),yd=L.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},L.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),L.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),bd=()=>{let[t,s]=L.useState(document.hidden);return L.useEffect(()=>{let a=()=>{s(document.hidden)};return document.addEventListener("visibilitychange",a),()=>window.removeEventListener("visibilitychange",a)},[]),t},xs=1,wd=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let s=this.subscribers.indexOf(t);this.subscribers.splice(s,1)}),this.publish=t=>{this.subscribers.forEach(s=>s(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var s;let{message:a,...n}=t,r=typeof t?.id=="number"||((s=t.id)==null?void 0:s.length)>0?t.id:xs++,o=this.toasts.find(c=>c.id===r),i=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(r)&&this.dismissedToasts.delete(r),o?this.toasts=this.toasts.map(c=>c.id===r?(this.publish({...c,...t,id:r,title:a}),{...c,...t,id:r,dismissible:i,title:a}):c):this.addToast({title:a,...n,dismissible:i,id:r}),r},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(s=>{this.subscribers.forEach(a=>a({id:s.id,dismiss:!0}))}),this.subscribers.forEach(s=>s({id:t,dismiss:!0})),t),this.message=(t,s)=>this.create({...s,message:t}),this.error=(t,s)=>this.create({...s,message:t,type:"error"}),this.success=(t,s)=>this.create({...s,type:"success",message:t}),this.info=(t,s)=>this.create({...s,type:"info",message:t}),this.warning=(t,s)=>this.create({...s,type:"warning",message:t}),this.loading=(t,s)=>this.create({...s,type:"loading",message:t}),this.promise=(t,s)=>{if(!s)return;let a;s.loading!==void 0&&(a=this.create({...s,promise:t,type:"loading",message:s.loading,description:typeof s.description!="function"?s.description:void 0}));let n=t instanceof Promise?t:t(),r=a!==void 0,o,i=n.then(async u=>{if(o=["resolve",u],L.isValidElement(u))r=!1,this.create({id:a,type:"default",message:u});else if(jd(u)&&!u.ok){r=!1;let f=typeof s.error=="function"?await s.error(`HTTP error! status: ${u.status}`):s.error,m=typeof s.description=="function"?await s.description(`HTTP error! status: ${u.status}`):s.description;this.create({id:a,type:"error",message:f,description:m})}else if(s.success!==void 0){r=!1;let f=typeof s.success=="function"?await s.success(u):s.success,m=typeof s.description=="function"?await s.description(u):s.description;this.create({id:a,type:"success",message:f,description:m})}}).catch(async u=>{if(o=["reject",u],s.error!==void 0){r=!1;let f=typeof s.error=="function"?await s.error(u):s.error,m=typeof s.description=="function"?await s.description(u):s.description;this.create({id:a,type:"error",message:f,description:m})}}).finally(()=>{var u;r&&(this.dismiss(a),a=void 0),(u=s.finally)==null||u.call(s)}),c=()=>new Promise((u,f)=>i.then(()=>o[0]==="reject"?f(o[1]):u(o[1])).catch(f));return typeof a!="string"&&typeof a!="number"?{unwrap:c}:Object.assign(a,{unwrap:c})},this.custom=(t,s)=>{let a=s?.id||xs++;return this.create({jsx:t(a),id:a,...s}),a},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},de=new wd,vd=(t,s)=>{let a=s?.id||xs++;return de.addToast({title:t,...s,id:a}),a},jd=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",Nd=vd,Cd=()=>de.toasts,Sd=()=>de.getActiveToasts();Object.assign(Nd,{success:de.success,info:de.info,warning:de.warning,error:de.error,custom:de.custom,message:de.message,promise:de.promise,dismiss:de.dismiss,loading:de.loading},{getHistory:Cd,getToasts:Sd});function kd(t,{insertAt:s}={}){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",s==="top"&&a.firstChild?a.insertBefore(n,a.firstChild):a.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}kd(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Pt(t){return t.label!==void 0}var Td=3,Ed="32px",Rd="16px",Ks=4e3,Dd=356,Ad=14,_d=20,Pd=200;function pe(...t){return t.filter(Boolean).join(" ")}function Fd(t){let[s,a]=t.split("-"),n=[];return s&&n.push(s),a&&n.push(a),n}var Id=t=>{var s,a,n,r,o,i,c,u,f,m,b;let{invert:h,toast:d,unstyled:w,interacting:y,setHeights:g,visibleToasts:x,heights:p,index:j,toasts:C,expanded:F,removeToast:A,defaultRichColors:v,closeButton:N,style:R,cancelButtonStyle:B,actionButtonStyle:_,className:U="",descriptionClassName:J="",duration:$,position:q,gap:ee,loadingIcon:Z,expandByDefault:le,classNames:M,icons:H,closeButtonAriaLabel:E="Close toast",pauseWhenPageIsHidden:T}=t,[k,z]=L.useState(null),[W,I]=L.useState(null),[V,ne]=L.useState(!1),[Ne,Ve]=L.useState(!1),[be,it]=L.useState(!1),[We,qt]=L.useState(!1),[lt,Tt]=L.useState(!1),[ct,fe]=L.useState(0),[dt,Et]=L.useState(0),Le=L.useRef(d.duration||$||Ks),mt=L.useRef(null),Ce=L.useRef(null),Xt=j===0,Jt=j+1<=x,ce=d.type,De=d.dismissible!==!1,Qt=d.className||"",Zt=d.descriptionClassName||"",He=L.useMemo(()=>p.findIndex(G=>G.toastId===d.id)||0,[p,d.id]),es=L.useMemo(()=>{var G;return(G=d.closeButton)!=null?G:N},[d.closeButton,N]),Rt=L.useMemo(()=>d.duration||$||Ks,[d.duration,$]),ze=L.useRef(0),Se=L.useRef(0),ut=L.useRef(0),ke=L.useRef(null),[Dt,ts]=q.split("-"),At=L.useMemo(()=>p.reduce((G,X,Q)=>Q>=He?G:G+X.height,0),[p,He]),_t=bd(),Ge=d.invert||h,ft=ce==="loading";Se.current=L.useMemo(()=>He*ee+At,[He,At]),L.useEffect(()=>{Le.current=Rt},[Rt]),L.useEffect(()=>{ne(!0)},[]),L.useEffect(()=>{let G=Ce.current;if(G){let X=G.getBoundingClientRect().height;return Et(X),g(Q=>[{toastId:d.id,height:X,position:d.position},...Q]),()=>g(Q=>Q.filter(D=>D.toastId!==d.id))}},[g,d.id]),L.useLayoutEffect(()=>{if(!V)return;let G=Ce.current,X=G.style.height;G.style.height="auto";let Q=G.getBoundingClientRect().height;G.style.height=X,Et(Q),g(D=>D.find(O=>O.toastId===d.id)?D.map(O=>O.toastId===d.id?{...O,height:Q}:O):[{toastId:d.id,height:Q,position:d.position},...D])},[V,d.title,d.description,g,d.id]);let we=L.useCallback(()=>{Ve(!0),fe(Se.current),g(G=>G.filter(X=>X.toastId!==d.id)),setTimeout(()=>{A(d)},Pd)},[d,A,g,Se]);L.useEffect(()=>{if(d.promise&&ce==="loading"||d.duration===1/0||d.type==="loading")return;let G;return F||y||T&&_t?(()=>{if(ut.current<ze.current){let X=new Date().getTime()-ze.current;Le.current=Le.current-X}ut.current=new Date().getTime()})():Le.current!==1/0&&(ze.current=new Date().getTime(),G=setTimeout(()=>{var X;(X=d.onAutoClose)==null||X.call(d,d),we()},Le.current)),()=>clearTimeout(G)},[F,y,d,ce,T,_t,we]),L.useEffect(()=>{d.delete&&we()},[we,d.delete]);function ss(){var G,X,Q;return H!=null&&H.loading?L.createElement("div",{className:pe(M?.loader,(G=d?.classNames)==null?void 0:G.loader,"sonner-loader"),"data-visible":ce==="loading"},H.loading):Z?L.createElement("div",{className:pe(M?.loader,(X=d?.classNames)==null?void 0:X.loader,"sonner-loader"),"data-visible":ce==="loading"},Z):L.createElement(fd,{className:pe(M?.loader,(Q=d?.classNames)==null?void 0:Q.loader),visible:ce==="loading"})}return L.createElement("li",{tabIndex:0,ref:Ce,className:pe(U,Qt,M?.toast,(s=d?.classNames)==null?void 0:s.toast,M?.default,M?.[ce],(a=d?.classNames)==null?void 0:a[ce]),"data-sonner-toast":"","data-rich-colors":(n=d.richColors)!=null?n:v,"data-styled":!(d.jsx||d.unstyled||w),"data-mounted":V,"data-promise":!!d.promise,"data-swiped":lt,"data-removed":Ne,"data-visible":Jt,"data-y-position":Dt,"data-x-position":ts,"data-index":j,"data-front":Xt,"data-swiping":be,"data-dismissible":De,"data-type":ce,"data-invert":Ge,"data-swipe-out":We,"data-swipe-direction":W,"data-expanded":!!(F||le&&V),style:{"--index":j,"--toasts-before":j,"--z-index":C.length-j,"--offset":`${Ne?ct:Se.current}px`,"--initial-height":le?"auto":`${dt}px`,...R,...d.style},onDragEnd:()=>{it(!1),z(null),ke.current=null},onPointerDown:G=>{ft||!De||(mt.current=new Date,fe(Se.current),G.target.setPointerCapture(G.pointerId),G.target.tagName!=="BUTTON"&&(it(!0),ke.current={x:G.clientX,y:G.clientY}))},onPointerUp:()=>{var G,X,Q,D;if(We||!De)return;ke.current=null;let O=Number(((G=Ce.current)==null?void 0:G.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),K=Number(((X=Ce.current)==null?void 0:X.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),oe=new Date().getTime()-((Q=mt.current)==null?void 0:Q.getTime()),ie=k==="x"?O:K,re=Math.abs(ie)/oe;if(Math.abs(ie)>=_d||re>.11){fe(Se.current),(D=d.onDismiss)==null||D.call(d,d),I(k==="x"?O>0?"right":"left":K>0?"down":"up"),we(),qt(!0),Tt(!1);return}it(!1),z(null)},onPointerMove:G=>{var X,Q,D,O;if(!ke.current||!De||((X=window.getSelection())==null?void 0:X.toString().length)>0)return;let K=G.clientY-ke.current.y,oe=G.clientX-ke.current.x,ie=(Q=t.swipeDirections)!=null?Q:Fd(q);!k&&(Math.abs(oe)>1||Math.abs(K)>1)&&z(Math.abs(oe)>Math.abs(K)?"x":"y");let re={x:0,y:0};k==="y"?(ie.includes("top")||ie.includes("bottom"))&&(ie.includes("top")&&K<0||ie.includes("bottom")&&K>0)&&(re.y=K):k==="x"&&(ie.includes("left")||ie.includes("right"))&&(ie.includes("left")&&oe<0||ie.includes("right")&&oe>0)&&(re.x=oe),(Math.abs(re.x)>0||Math.abs(re.y)>0)&&Tt(!0),(D=Ce.current)==null||D.style.setProperty("--swipe-amount-x",`${re.x}px`),(O=Ce.current)==null||O.style.setProperty("--swipe-amount-y",`${re.y}px`)}},es&&!d.jsx?L.createElement("button",{"aria-label":E,"data-disabled":ft,"data-close-button":!0,onClick:ft||!De?()=>{}:()=>{var G;we(),(G=d.onDismiss)==null||G.call(d,d)},className:pe(M?.closeButton,(r=d?.classNames)==null?void 0:r.closeButton)},(o=H?.close)!=null?o:yd):null,d.jsx||l.isValidElement(d.title)?d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title:L.createElement(L.Fragment,null,ce||d.icon||d.promise?L.createElement("div",{"data-icon":"",className:pe(M?.icon,(i=d?.classNames)==null?void 0:i.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||ss():null,d.type!=="loading"?d.icon||H?.[ce]||md(ce):null):null,L.createElement("div",{"data-content":"",className:pe(M?.content,(c=d?.classNames)==null?void 0:c.content)},L.createElement("div",{"data-title":"",className:pe(M?.title,(u=d?.classNames)==null?void 0:u.title)},typeof d.title=="function"?d.title():d.title),d.description?L.createElement("div",{"data-description":"",className:pe(J,Zt,M?.description,(f=d?.classNames)==null?void 0:f.description)},typeof d.description=="function"?d.description():d.description):null),l.isValidElement(d.cancel)?d.cancel:d.cancel&&Pt(d.cancel)?L.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||B,onClick:G=>{var X,Q;Pt(d.cancel)&&De&&((Q=(X=d.cancel).onClick)==null||Q.call(X,G),we())},className:pe(M?.cancelButton,(m=d?.classNames)==null?void 0:m.cancelButton)},d.cancel.label):null,l.isValidElement(d.action)?d.action:d.action&&Pt(d.action)?L.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||_,onClick:G=>{var X,Q;Pt(d.action)&&((Q=(X=d.action).onClick)==null||Q.call(X,G),!G.defaultPrevented&&we())},className:pe(M?.actionButton,(b=d?.classNames)==null?void 0:b.actionButton)},d.action.label):null))};function qs(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function Md(t,s){let a={};return[t,s].forEach((n,r)=>{let o=r===1,i=o?"--mobile-offset":"--offset",c=o?Rd:Ed;function u(f){["top","right","bottom","left"].forEach(m=>{a[`${i}-${m}`]=typeof f=="number"?`${f}px`:f})}typeof n=="number"||typeof n=="string"?u(n):typeof n=="object"?["top","right","bottom","left"].forEach(f=>{n[f]===void 0?a[`${i}-${f}`]=c:a[`${i}-${f}`]=typeof n[f]=="number"?`${n[f]}px`:n[f]}):u(c)}),a}var Ld=l.forwardRef(function(t,s){let{invert:a,position:n="bottom-right",hotkey:r=["altKey","KeyT"],expand:o,closeButton:i,className:c,offset:u,mobileOffset:f,theme:m="light",richColors:b,duration:h,style:d,visibleToasts:w=Td,toastOptions:y,dir:g=qs(),gap:x=Ad,loadingIcon:p,icons:j,containerAriaLabel:C="Notifications",pauseWhenPageIsHidden:F}=t,[A,v]=L.useState([]),N=L.useMemo(()=>Array.from(new Set([n].concat(A.filter(T=>T.position).map(T=>T.position)))),[A,n]),[R,B]=L.useState([]),[_,U]=L.useState(!1),[J,$]=L.useState(!1),[q,ee]=L.useState(m!=="system"?m:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Z=L.useRef(null),le=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),M=L.useRef(null),H=L.useRef(!1),E=L.useCallback(T=>{v(k=>{var z;return(z=k.find(W=>W.id===T.id))!=null&&z.delete||de.dismiss(T.id),k.filter(({id:W})=>W!==T.id)})},[]);return L.useEffect(()=>de.subscribe(T=>{if(T.dismiss){v(k=>k.map(z=>z.id===T.id?{...z,delete:!0}:z));return}setTimeout(()=>{Mr.flushSync(()=>{v(k=>{let z=k.findIndex(W=>W.id===T.id);return z!==-1?[...k.slice(0,z),{...k[z],...T},...k.slice(z+1)]:[T,...k]})})})}),[]),L.useEffect(()=>{if(m!=="system"){ee(m);return}if(m==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ee("dark"):ee("light")),typeof window>"u")return;let T=window.matchMedia("(prefers-color-scheme: dark)");try{T.addEventListener("change",({matches:k})=>{ee(k?"dark":"light")})}catch{T.addListener(({matches:z})=>{try{ee(z?"dark":"light")}catch(W){console.error(W)}})}},[m]),L.useEffect(()=>{A.length<=1&&U(!1)},[A]),L.useEffect(()=>{let T=k=>{var z,W;r.every(I=>k[I]||k.code===I)&&(U(!0),(z=Z.current)==null||z.focus()),k.code==="Escape"&&(document.activeElement===Z.current||(W=Z.current)!=null&&W.contains(document.activeElement))&&U(!1)};return document.addEventListener("keydown",T),()=>document.removeEventListener("keydown",T)},[r]),L.useEffect(()=>{if(Z.current)return()=>{M.current&&(M.current.focus({preventScroll:!0}),M.current=null,H.current=!1)}},[Z.current]),L.createElement("section",{ref:s,"aria-label":`${C} ${le}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},N.map((T,k)=>{var z;let[W,I]=T.split("-");return A.length?L.createElement("ol",{key:T,dir:g==="auto"?qs():g,tabIndex:-1,ref:Z,className:c,"data-sonner-toaster":!0,"data-theme":q,"data-y-position":W,"data-lifted":_&&A.length>1&&!o,"data-x-position":I,style:{"--front-toast-height":`${((z=R[0])==null?void 0:z.height)||0}px`,"--width":`${Dd}px`,"--gap":`${x}px`,...d,...Md(u,f)},onBlur:V=>{H.current&&!V.currentTarget.contains(V.relatedTarget)&&(H.current=!1,M.current&&(M.current.focus({preventScroll:!0}),M.current=null))},onFocus:V=>{V.target instanceof HTMLElement&&V.target.dataset.dismissible==="false"||H.current||(H.current=!0,M.current=V.relatedTarget)},onMouseEnter:()=>U(!0),onMouseMove:()=>U(!0),onMouseLeave:()=>{J||U(!1)},onDragEnd:()=>U(!1),onPointerDown:V=>{V.target instanceof HTMLElement&&V.target.dataset.dismissible==="false"||$(!0)},onPointerUp:()=>$(!1)},A.filter(V=>!V.position&&k===0||V.position===T).map((V,ne)=>{var Ne,Ve;return L.createElement(Id,{key:V.id,icons:j,index:ne,toast:V,defaultRichColors:b,duration:(Ne=y?.duration)!=null?Ne:h,className:y?.className,descriptionClassName:y?.descriptionClassName,invert:a,visibleToasts:w,closeButton:(Ve=y?.closeButton)!=null?Ve:i,interacting:J,position:T,style:y?.style,unstyled:y?.unstyled,classNames:y?.classNames,cancelButtonStyle:y?.cancelButtonStyle,actionButtonStyle:y?.actionButtonStyle,removeToast:E,toasts:A.filter(be=>be.position==V.position),heights:R.filter(be=>be.position==V.position),setHeights:B,expandByDefault:o,gap:x,loadingIcon:p,expanded:_,pauseWhenPageIsHidden:F,swipeDirections:t.swipeDirections})})):null}))});const zd=({...t})=>e.jsx(Ld,{theme:"light",className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t});function Od({open:t,onOpenChange:s}){const[a,n]=l.useState({user:null,session:null,loading:!1,error:null}),[r,o]=l.useState("main"),[i,c]=l.useState(!1),[u,f]=l.useState({email:"",password:"",confirmPassword:"",name:""}),[m,b]=l.useState({}),[h,d]=l.useState(!1);l.useEffect(()=>Oe.onAuthStateChange(n),[]);const w=()=>{f({email:"",password:"",confirmPassword:"",name:""}),b({}),d(!1),c(!1)},y=_=>{const U={};return(_==="email-login"||_==="email-signup"||_==="forgot-password")&&(u.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)||(U.email="请输入有效的邮箱地址"):U.email="请输入邮箱地址"),(_==="email-login"||_==="email-signup")&&(u.password?u.password.length<6&&(U.password="密码至少需要6个字符"):U.password="请输入密码"),_==="email-signup"&&(u.name||(U.name="请输入姓名"),u.password!==u.confirmPassword&&(U.confirmPassword="两次输入的密码不一致")),b(U),Object.keys(U).length===0},g=async()=>{d(!0);const{error:_}=await Oe.signInWithGitHub();_&&console.error("GitHub登录失败:",_),d(!1)},x=async()=>{if(!y("email-login"))return;d(!0);const{error:_}=await Oe.signInWithEmail(u.email,u.password);_?b({general:_.message}):(s(!1),w(),o("main")),d(!1)},p=async()=>{if(!y("email-signup"))return;d(!0);const{error:_}=await Oe.signUpWithEmail(u.email,u.password,{name:u.name});_?b({general:_.message}):o("check-email"),d(!1)},j=async()=>{if(!y("forgot-password"))return;d(!0);const{error:_}=await Oe.resetPassword(u.email);_?b({general:_.message}):o("check-email"),d(!1)},C=async()=>{const{error:_}=await Oe.signOut();_&&console.error("登出失败:",_)},F=async()=>{await Lr.performFullSync()};if(a.user)return e.jsx(Ue,{open:t,onOpenChange:s,children:e.jsx(Ie,{className:"sm:max-w-md border-0 shadow-2xl",children:e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsx(te,{className:"border-0 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20",children:e.jsx(se,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Mn,{user:a.user,size:"lg",className:"h-16 w-16 shadow-lg",showHoverEffect:!1}),e.jsx("div",{className:"absolute -bottom-1 -right-1 h-5 w-5 bg-green-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:a.user.username||"用户"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.user.email}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(wt,{className:"h-3 w-3 text-green-500"}),e.jsx("span",{className:"text-xs text-green-600",children:"云端同步已启用"})]})]})]})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(P,{onClick:F,variant:"outline",className:"w-full h-12 rounded-2xl border-2 hover:bg-blue-50 transition-all duration-200",disabled:a.loading,children:[a.loading?e.jsx(ht,{className:"h-5 w-5 mr-2 animate-spin"}):e.jsx(wt,{className:"h-5 w-5 mr-2 text-blue-500"}),"立即同步数据"]}),e.jsx(P,{onClick:C,variant:"ghost",className:"w-full h-12 rounded-2xl hover:bg-red-50 hover:text-red-600 transition-all duration-200",disabled:a.loading,children:"退出登录"})]})]})})});const A=()=>e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"欢迎使用 CardAll"}),e.jsx("p",{className:"text-muted-foreground",children:"选择您的登录方式"})]}),e.jsxs(P,{onClick:g,disabled:h,className:"w-full h-14 rounded-2xl bg-gray-900 hover:bg-gray-800 text-white shadow-lg transition-all duration-200 transform hover:scale-[1.02]",size:"lg",children:[h?e.jsx(ht,{className:"h-5 w-5 mr-3 animate-spin"}):e.jsx(mo,{className:"h-5 w-5 mr-3"}),"使用 GitHub 登录"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-4 text-muted-foreground",children:"或"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(P,{onClick:()=>o("email-login"),variant:"outline",className:"w-full h-14 rounded-2xl border-2 hover:bg-blue-50 transition-all duration-200 transform hover:scale-[1.02]",size:"lg",children:[e.jsx(gt,{className:"h-5 w-5 mr-3 text-blue-500"}),"使用邮箱登录"]}),e.jsxs(P,{onClick:()=>o("email-signup"),variant:"ghost",className:"w-full h-12 rounded-2xl hover:bg-green-50 hover:text-green-600 transition-all duration-200",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"创建新账户"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center space-y-1 pt-4",children:[e.jsx("p",{children:"登录后可享受云端同步功能"}),e.jsx("p",{children:"即使不登录也可正常使用本地功能"})]})]}),v=()=>e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>o("main"),className:"rounded-full p-2",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"邮箱登录"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"email",children:"邮箱地址"}),e.jsxs("div",{className:"relative",children:[e.jsx(gt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(me,{id:"email",type:"email",placeholder:"输入您的邮箱地址",value:u.email,onChange:_=>f(U=>({...U,email:_.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.email&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),m.email]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"password",children:"密码"}),e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(me,{id:"password",type:i?"text":"password",placeholder:"输入您的密码",value:u.password,onChange:_=>f(U=>({...U,password:_.target.value})),className:"pl-10 pr-10 h-12 rounded-2xl border-2"}),e.jsx(P,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-10 w-10 rounded-xl",onClick:()=>c(!i),children:i?e.jsx(us,{className:"h-4 w-4"}):e.jsx(Lt,{className:"h-4 w-4"})})]}),m.password&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),m.password]})]}),e.jsx("div",{className:"text-right",children:e.jsx(P,{variant:"link",size:"sm",onClick:()=>o("forgot-password"),className:"text-blue-600 hover:text-blue-700 p-0 h-auto",children:"忘记密码？"})}),m.general&&e.jsxs("div",{className:"text-sm text-red-500 text-center bg-red-50 p-3 rounded-2xl flex items-center justify-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),m.general]}),e.jsxs(P,{onClick:x,disabled:h,className:"w-full h-12 rounded-2xl bg-blue-600 hover:bg-blue-700 transition-all duration-200",children:[h?e.jsx(ht,{className:"h-4 w-4 mr-2 animate-spin"}):null,"登录"]})]})]}),N=()=>e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>o("main"),className:"rounded-full p-2",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"创建账户"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"name",children:"姓名"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ps,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(me,{id:"name",type:"text",placeholder:"输入您的姓名",value:u.name,onChange:_=>f(U=>({...U,name:_.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.name&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),m.name]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"signup-email",children:"邮箱地址"}),e.jsxs("div",{className:"relative",children:[e.jsx(gt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(me,{id:"signup-email",type:"email",placeholder:"输入您的邮箱地址",value:u.email,onChange:_=>f(U=>({...U,email:_.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.email&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),m.email]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"signup-password",children:"密码"}),e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(me,{id:"signup-password",type:i?"text":"password",placeholder:"设置您的密码（至少6个字符）",value:u.password,onChange:_=>f(U=>({...U,password:_.target.value})),className:"pl-10 pr-10 h-12 rounded-2xl border-2"}),e.jsx(P,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-10 w-10 rounded-xl",onClick:()=>c(!i),children:i?e.jsx(us,{className:"h-4 w-4"}):e.jsx(Lt,{className:"h-4 w-4"})})]}),m.password&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),m.password]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"confirm-password",children:"确认密码"}),e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(me,{id:"confirm-password",type:i?"text":"password",placeholder:"再次输入密码",value:u.confirmPassword,onChange:_=>f(U=>({...U,confirmPassword:_.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.confirmPassword&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),m.confirmPassword]})]}),m.general&&e.jsxs("div",{className:"text-sm text-red-500 text-center bg-red-50 p-3 rounded-2xl flex items-center justify-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),m.general]}),e.jsxs(P,{onClick:p,disabled:h,className:"w-full h-12 rounded-2xl bg-green-600 hover:bg-green-700 transition-all duration-200",children:[h?e.jsx(ht,{className:"h-4 w-4 mr-2 animate-spin"}):null,"创建账户"]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:e.jsx("p",{children:"注册即表示您同意我们的服务条款和隐私政策"})})]})]}),R=()=>e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>o("email-login"),className:"rounded-full p-2",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"重置密码"})]}),e.jsx("div",{className:"text-center space-y-2",children:e.jsx("p",{className:"text-muted-foreground",children:"输入您的邮箱地址，我们将发送重置密码的链接"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ue,{htmlFor:"reset-email",children:"邮箱地址"}),e.jsxs("div",{className:"relative",children:[e.jsx(gt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(me,{id:"reset-email",type:"email",placeholder:"输入您的邮箱地址",value:u.email,onChange:_=>f(U=>({...U,email:_.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.email&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),m.email]})]}),m.general&&e.jsxs("div",{className:"text-sm text-red-500 text-center bg-red-50 p-3 rounded-2xl flex items-center justify-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),m.general]}),e.jsxs(P,{onClick:j,disabled:h,className:"w-full h-12 rounded-2xl bg-blue-600 hover:bg-blue-700 transition-all duration-200",children:[h?e.jsx(ht,{className:"h-4 w-4 mr-2 animate-spin"}):null,"发送重置链接"]})]})]}),B=()=>e.jsxs("div",{className:"space-y-6 p-2 text-center",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"h-16 w-16 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(gt,{className:"h-8 w-8 text-blue-600"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"检查您的邮箱"}),e.jsxs("p",{className:"text-muted-foreground",children:["我们已向 ",e.jsx("span",{className:"font-medium",children:u.email})," 发送了一封邮件"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["请点击邮件中的链接来完成",r==="check-email"?"账户激活":"密码重置"]})]}),e.jsx(P,{onClick:()=>{o("main"),w()},variant:"outline",className:"w-full h-12 rounded-2xl border-2",children:"返回登录"})]});return e.jsx(Ue,{open:t,onOpenChange:_=>{s(_),_||(o("main"),w())},children:e.jsxs(Ie,{className:"sm:max-w-md border-0 shadow-2xl rounded-3xl",children:[r==="main"&&A(),r==="email-login"&&v(),r==="email-signup"&&N(),r==="forgot-password"&&R(),r==="check-email"&&B()]})})}const $d=({onClose:t})=>{const[s,a]=l.useState(null),[n,r]=l.useState(!1),[o,i]=l.useState(!1),[c,u]=l.useState(navigator.onLine);l.useEffect(()=>{const b=()=>{window.matchMedia("(display-mode: standalone)").matches&&i(!0)},h=g=>{g.preventDefault(),a(g),setTimeout(()=>{o||r(!0)},3e3)},d=()=>{i(!0),r(!1),a(null),console.log("PWA was installed")},w=()=>u(!0),y=()=>u(!1);return b(),window.addEventListener("beforeinstallprompt",h),window.addEventListener("appinstalled",d),window.addEventListener("online",w),window.addEventListener("offline",y),()=>{window.removeEventListener("beforeinstallprompt",h),window.removeEventListener("appinstalled",d),window.removeEventListener("online",w),window.removeEventListener("offline",y)}},[o]);const f=async()=>{if(s)try{await s.prompt();const{outcome:b}=await s.userChoice;console.log(b==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),a(null),r(!1)}catch(b){console.error("Error during installation:",b)}},m=()=>{r(!1),t?.()};return!n||o?null:e.jsx("div",{className:"fixed bottom-4 right-4 z-50 max-w-sm",children:e.jsxs(te,{className:"shadow-lg border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-white",children:[e.jsxs(Ee,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{className:"h-5 w-5 text-blue-600"}),e.jsx(Re,{className:"text-lg",children:"安装 CardAll"})]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:m,className:"h-6 w-6 p-0",children:e.jsx(Be,{className:"h-4 w-4"})})]}),e.jsx(tr,{children:"将 CardAll 安装到您的设备上，享受更好的体验"})]}),e.jsxs(se,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[c?e.jsx(Bt,{className:"h-4 w-4"}):e.jsx(ws,{className:"h-4 w-4"}),e.jsx("span",{children:c?"在线使用":"离线可用"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(uo,{className:"h-4 w-4"}),e.jsx("span",{children:"移动优化"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-purple-600",children:[e.jsx(fo,{className:"h-4 w-4"}),e.jsx("span",{children:"桌面应用"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[e.jsx(et,{className:"h-4 w-4"}),e.jsx("span",{children:"快速启动"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"安装后您将获得："}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("li",{children:"• 完全离线功能"}),e.jsx("li",{children:"• 更快的加载速度"}),e.jsx("li",{children:"• 桌面快捷方式"}),e.jsx("li",{children:"• 推送通知支持"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{onClick:f,className:"flex-1 bg-blue-600 hover:bg-blue-700",disabled:!s,children:[e.jsx(et,{className:"h-4 w-4 mr-2"}),"立即安装"]}),e.jsx(P,{variant:"outline",onClick:m,className:"px-3",children:"稍后"})]})]})]})})};function Ud(){const{isOpen:t,closeModal:s}=sn();return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Po,{children:e.jsx(Ci,{children:e.jsx(Si,{children:e.jsx(id,{})})})}),e.jsx($d,{}),e.jsx(Od,{open:t,onOpenChange:s}),e.jsx(zd,{})]})}function Bd(){return e.jsx(dd,{defaultTheme:"light",storageKey:"cardall-theme",children:e.jsx(Io,{children:e.jsx(Ud,{})})})}fs.createRoot(document.getElementById("root")).render(e.jsx(L.StrictMode,{children:e.jsx(Bd,{})}));
