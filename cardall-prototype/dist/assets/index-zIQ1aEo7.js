import{j as e,S as Gn,a as Os,b as $s,P as Yn,C as Bs,I as Us,c as Ws,d as Vs,R as Hs,L as Gs,e as Ys,f as Kn,T as qn,g as Ks,V as Jn,h as Qn,i as qs,k as Xn,O as Js,l as Zn,m as Qs,n as er,o as Xs,D as Zs,p as tr,q as ea,r as sr,s as ar,t as nr,u as ta,v as sa,w as rr,x as aa,y as or,z as ir,A as na,B as ra,F as oa,E as ia,G as la,H as lr,J as ca,K as da,M as ma,N as ua,Q as fa,U as ha,W as ga,X as cr,Y as dr,Z as pa,_ as mr,$ as xa,a0 as ba,a1 as ur,a2 as ya,a3 as fr,a4 as wa,a5 as va,a6 as hr,a7 as gr,a8 as ja,a9 as pr,aa as xr,ab as Ca,ac as br,ad as Na,ae as Sa,af as ka,ag as Ta,ah as Ea,ai as yr,aj as Da,ak as _a,al as Ra,am as wr}from"./radix-KmCZJ_MJ.js";import{a as Dt,r as d,R as T,v as vr}from"./vendor-DBpFvjuy.js";import{a as Re,c as jr}from"./sync-CeErhn0y.js";import{t as Cr,c as Nr,a as _t}from"./utils--BulIq_u.js";import{C as Rt,a as ke,b as Aa,S as Sr,I as Fa,X as Ie,c as kr,E as Tr,P as Er,d as Dr,e as es,f as _r,g as Pa,T as Ia,F as Ma,h as ds,i as Se,H as ys,j as Ve,D as mt,k as ws,l as La,m as ts,n as ms,o as Rr,p as Ar,B as Fr,q as Pr,r as Ir,Z as Mr,s as Lr,L as zr,t as Or,u as qe,v as ge,w as Nt,x as vs,R as za,y as Oa,z as ss,A as as,G as $r,J as Br,K as Ur,M as Tt,N as ns,O as Wr,Q as Vr,U as Hr,V as ot,W as Gr,Y as it,_ as js,$ as Gt,a0 as Yt,a1 as Yr,a2 as Kr,a3 as qr,a4 as Jr}from"./icons-BgCIs8Fb.js";import{u as Qr,i as Xr,M as Zr,a as eo,b as to,c as so,d as ao,e as no,f as ro,g as oo,h as io,j as lo,E as co}from"./editor-DKFL_XTT.js";import"./supabase-BJjf9Ixn.js";import"./database-CD-G83dI.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();var rs={},Cs=Dt;rs.createRoot=Cs.createRoot,rs.hydrateRoot=Cs.hydrateRoot;const mo=[{id:"1",frontContent:{title:"React Best Practices",text:"Key principles for writing maintainable React code including component composition, state management, and performance optimization.",images:[],tags:["react","frontend","best-practices"],lastModified:new Date},backContent:{title:"Implementation Details",text:"Use functional components with hooks, implement proper error boundaries, optimize with React.memo and useMemo for expensive calculations.",images:[],tags:["react","frontend","best-practices"],lastModified:new Date},style:{type:"solid",backgroundColor:"#f8fafc",fontFamily:"system-ui",fontSize:"base",fontWeight:"normal",textColor:"#1f2937",borderRadius:"xl",shadow:"md",borderWidth:0},isFlipped:!1,createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15")},{id:"2",frontContent:{title:"TypeScript Tips",text:"Advanced TypeScript patterns for better type safety and developer experience in large applications.",images:[],tags:["typescript","types","development"],lastModified:new Date},backContent:{title:"Advanced Patterns",text:"Utility types, conditional types, mapped types, and template literal types for complex type transformations.",images:[],tags:["typescript","types","development"],lastModified:new Date},style:{type:"gradient",gradientColors:["#667eea","#764ba2"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"xl",shadow:"lg",borderWidth:0},isFlipped:!1,createdAt:new Date("2024-01-16"),updatedAt:new Date("2024-01-16")}];function uo(){const[t,s]=d.useState(mo),[a,n]=d.useState({searchTerm:"",tags:[]}),[r,o]=d.useState({layout:"grid",cardSize:"medium",showTags:!0,showDates:!1,sortBy:"updated",sortOrder:"desc"}),[i,l]=d.useState([]),u=d.useCallback(()=>{let b=t.filter(f=>{if(a.searchTerm){const g=a.searchTerm.toLowerCase(),p=f.frontContent.title.toLowerCase().includes(g)||f.backContent.title.toLowerCase().includes(g),v=f.frontContent.text.toLowerCase().includes(g)||f.backContent.text.toLowerCase().includes(g),j=[...f.frontContent.tags,...f.backContent.tags].some(k=>k.toLowerCase().includes(g));if(!p&&!v&&!j)return!1}if(a.tags.length>0){const g=[...f.frontContent.tags,...f.backContent.tags];if(!a.tags.some(p=>g.includes(p)))return!1}if(a.folderId&&f.folderId!==a.folderId)return!1;if(a.dateRange){const g=new Date(f.updatedAt);if(g<a.dateRange.start||g>a.dateRange.end)return!1}return!(a.styleType&&f.style.type!==a.styleType||a.hasImages!==void 0&&(f.frontContent.images.length>0||f.backContent.images.length>0)!==a.hasImages)});return b.sort((f,g)=>{let p=0;switch(r.sortBy){case"created":p=new Date(f.createdAt).getTime()-new Date(g.createdAt).getTime();break;case"updated":p=new Date(f.updatedAt).getTime()-new Date(g.updatedAt).getTime();break;case"title":p=f.frontContent.title.localeCompare(g.frontContent.title);break;default:p=0}return r.sortOrder==="desc"?-p:p}),b},[t,a,r]),h=d.useCallback(b=>{s(f=>{switch(b.type){case"CREATE_CARD":const g={...b.payload,id:Date.now().toString(),createdAt:new Date,updatedAt:new Date};return[...f,g];case"UPDATE_CARD":return f.map(j=>j.id===b.payload.id?{...j,...b.payload.updates,updatedAt:new Date}:j);case"DELETE_CARD":return f.filter(j=>j.id!==b.payload);case"FLIP_CARD":return f.map(j=>j.id===b.payload?{...j,isFlipped:!j.isFlipped,updatedAt:new Date}:j);case"SELECT_CARD":return l(j=>j.includes(b.payload)?j.filter(k=>k!==b.payload):[...j,b.payload]),f;case"DESELECT_ALL":return l([]),f;case"DUPLICATE_CARD":const p=f.find(j=>j.id===b.payload);if(!p)return f;const v={...p,id:Date.now().toString(),createdAt:new Date,updatedAt:new Date};return[...f,v];case"MOVE_TO_FOLDER":return f.map(j=>j.id===b.payload.cardId?{...j,folderId:b.payload.folderId,updatedAt:new Date}:j);default:return f}})},[]),m=d.useCallback(b=>t.find(f=>f.id===b),[t]),y=d.useCallback(()=>t.filter(b=>i.includes(b.id)),[t,i]),x=d.useCallback(()=>{const b=new Set;return t.forEach(f=>{f.frontContent.tags.forEach(g=>b.add(g)),f.backContent.tags.forEach(g=>b.add(g))}),Array.from(b).sort()},[t]),c=d.useCallback((b,f)=>{s(g=>g.map(p=>{const v=_=>f?_.map(N=>N===b?f:N):_.filter(N=>N!==b),j=v(p.frontContent.tags),k=v(p.backContent.tags);return JSON.stringify(j)!==JSON.stringify(p.frontContent.tags)||JSON.stringify(k)!==JSON.stringify(p.backContent.tags)?{...p,frontContent:{...p.frontContent,tags:j,lastModified:new Date},backContent:{...p.backContent,tags:k,lastModified:new Date},updatedAt:new Date}:p}))},[]),w=d.useCallback(b=>t.filter(f=>f.frontContent.tags.includes(b)||f.backContent.tags.includes(b)),[t]);return d.useEffect(()=>{const b=setTimeout(()=>{localStorage.setItem("cardall-cards",JSON.stringify(t))},1e3);return()=>clearTimeout(b)},[t]),d.useEffect(()=>{const b=localStorage.getItem("cardall-cards");if(b)try{const f=JSON.parse(b);s(f)}catch(f){console.error("Failed to load saved cards:",f)}},[]),{cards:u(),allCards:t,filter:a,setFilter:n,viewSettings:r,setViewSettings:o,selectedCardIds:i,dispatch:h,getCardById:m,getSelectedCards:y,getAllTags:x,updateTagsInAllCards:c,getCardsWithTag:w}}const fo=[{id:"folder-1",name:"Development",color:"#3b82f6",icon:"Code",cardIds:["1"],isExpanded:!0,createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-15")},{id:"folder-2",name:"Design Resources",color:"#8b5cf6",icon:"Palette",cardIds:[],isExpanded:!1,createdAt:new Date("2024-01-12"),updatedAt:new Date("2024-01-12")},{id:"folder-3",name:"Learning Notes",color:"#10b981",icon:"BookOpen",cardIds:["2"],parentId:"folder-1",isExpanded:!0,createdAt:new Date("2024-01-14"),updatedAt:new Date("2024-01-16")}];function ho(){const[t,s]=d.useState(fo),[a,n]=d.useState(null),r=d.useCallback(()=>{const x=t.filter(w=>!w.parentId),c=w=>w.map(b=>({...b,children:c(t.filter(f=>f.parentId===b.id))}));return c(x)},[t]),o=d.useCallback(x=>{s(c=>{switch(x.type){case"CREATE_FOLDER":const w={...x.payload,id:`folder-${Date.now()}`,cardIds:[],createdAt:new Date,updatedAt:new Date};return[...c,w];case"UPDATE_FOLDER":return c.map(f=>f.id===x.payload.id?{...f,...x.payload.updates,updatedAt:new Date}:f);case"DELETE_FOLDER":if(c.find(f=>f.id===x.payload)){const f=j=>{const k=c.filter(F=>F.parentId===j),_=k.map(F=>F.id),N=k.flatMap(F=>f(F.id));return[..._,...N]},g=f(x.payload),p=[x.payload,...g],v=c.filter(j=>p.includes(j.id)).flatMap(j=>j.cardIds);return"onDeleteCards"in x&&x.onDeleteCards&&v.length>0&&x.onDeleteCards(v),c.filter(j=>!p.includes(j.id))}return c.filter(f=>f.id!==x.payload);case"TOGGLE_FOLDER":return c.map(f=>f.id===x.payload?{...f,isExpanded:!f.isExpanded,updatedAt:new Date}:f);default:return c}})},[]),i=d.useCallback(x=>t.find(c=>c.id===x),[t]),l=d.useCallback(x=>{const c=[];let w=i(x);for(;w;)c.unshift(w),w=w.parentId?i(w.parentId):null;return c},[t,i]),u=d.useCallback((x,c)=>{o({type:"UPDATE_FOLDER",payload:{id:c,updates:{cardIds:[...i(c)?.cardIds||[],x]}}})},[o,i]),h=d.useCallback((x,c)=>{const w=i(c);w&&o({type:"UPDATE_FOLDER",payload:{id:c,updates:{cardIds:w.cardIds.filter(b=>b!==x)}}})},[o,i]),m=d.useCallback((x,c,w)=>{c&&h(x,c),w&&u(x,w)},[u,h]),y=d.useCallback((x,c)=>{if(x===c)return!1;let w=c;for(;w;){if(w===x)return!1;w=i(w)?.parentId??null}return!0},[i]);return d.useEffect(()=>{const x=setTimeout(()=>{localStorage.setItem("cardall-folders",JSON.stringify(t))},1e3);return()=>clearTimeout(x)},[t]),d.useEffect(()=>{const x=localStorage.getItem("cardall-folders");if(x)try{const c=JSON.parse(x);s(c)}catch(c){console.error("Failed to load saved folders:",c)}},[]),{folders:t,folderTree:r(),selectedFolderId:a,setSelectedFolderId:n,dispatch:o,getFolderById:i,getFolderPath:l,addCardToFolder:u,removeCardFromFolder:h,moveCardBetweenFolders:m,canMoveFolder:y}}const go=[{id:"tag-1",name:"react",color:"#3b82f6",count:1,createdAt:new Date("2024-01-15")},{id:"tag-2",name:"frontend",color:"#8b5cf6",count:1,createdAt:new Date("2024-01-15")},{id:"tag-3",name:"best-practices",color:"#10b981",count:1,createdAt:new Date("2024-01-15")},{id:"tag-4",name:"typescript",color:"#f59e0b",count:1,createdAt:new Date("2024-01-16")},{id:"tag-5",name:"types",color:"#ef4444",count:1,createdAt:new Date("2024-01-16")},{id:"tag-6",name:"development",color:"#06b6d4",count:1,createdAt:new Date("2024-01-16")}],$e=["#3b82f6","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4","#8b5a2b","#6b7280","#ec4899","#84cc16","#f97316","#6366f1"];function po(){const[t,s]=d.useState(go),[a,n]=d.useState([]),r=d.useCallback(()=>t.filter(g=>!a.includes(g.id)),[t,a]),o=d.useCallback(g=>{const p=[...r()].sort((v,j)=>j.count-v.count);return g?p.slice(0,g):p},[r]),i=d.useCallback(g=>{s(p=>{switch(g.type){case"CREATE_TAG":const v=p.find(k=>k.name.toLowerCase()===g.payload.name.toLowerCase());if(v)return p.map(k=>k.id===v.id?{...k,count:k.count+1}:k);const j={...g.payload,id:`tag-${Date.now()}`,count:1,color:g.payload.color||$e[p.length%$e.length],createdAt:new Date};return[...p,j];case"UPDATE_TAG":return p.map(k=>k.id===g.payload.id?{...k,...g.payload.updates}:k);case"DELETE_TAG":return p.filter(k=>k.id!==g.payload);case"TOGGLE_TAG_VISIBILITY":return n(k=>k.includes(g.payload)?k.filter(_=>_!==g.payload):[...k,g.payload]),p;default:return p}})},[]),l=d.useCallback(g=>t.find(p=>p.id===g),[t]),u=d.useCallback(g=>t.find(p=>p.name.toLowerCase()===g.toLowerCase()),[t]),h=d.useCallback((g,p)=>{const v=u(g);return v||(i({type:"CREATE_TAG",payload:{name:g,color:p||$e[t.length%$e.length]}}),null)},[i,u,t.length]),m=d.useCallback((g,p)=>{const v=u(g);if(v){const j=Math.max(0,v.count+p);i(j===0?{type:"DELETE_TAG",payload:v.id}:{type:"UPDATE_TAG",payload:{id:v.id,updates:{count:j}}})}},[i,u]),y=d.useCallback(g=>{const p=g.reduce((_,N)=>(_[N]=(_[N]||0)+1,_),{}),v=t.map(_=>({..._,count:p[_.name]||0})),j=new Set(t.map(_=>_.name));Object.entries(p).forEach(([_,N])=>{if(!j.has(_)){const F={id:`tag-${Date.now()}-${Math.random()}`,name:_,color:$e[v.length%$e.length],count:N,createdAt:new Date};v.push(F)}});const k=v.filter(_=>_.count>0);s(k)},[t]),x=d.useCallback(g=>{if(!g.trim())return r();const p=g.toLowerCase();return r().filter(v=>v.name.toLowerCase().includes(p))},[r]),c=d.useCallback((g,p=5)=>g.trim()?x(g).slice(0,p):o(p),[x,o]),w=d.useCallback((g,p)=>{const v=u(g);if(!v)return!1;const j=u(p);return j&&j.id!==v.id?!1:(i({type:"UPDATE_TAG",payload:{id:v.id,updates:{name:p.trim()}}}),!0)},[i,u]),b=d.useCallback(g=>{const p=u(g);return p?(i({type:"DELETE_TAG",payload:p.id}),!0):!1},[i,u]),f=d.useCallback(()=>t.map(g=>g.name),[t]);return d.useEffect(()=>{const g=setTimeout(()=>{localStorage.setItem("cardall-tags",JSON.stringify(t)),localStorage.setItem("cardall-hidden-tags",JSON.stringify(a))},1e3);return()=>clearTimeout(g)},[t,a]),d.useEffect(()=>{const g=localStorage.getItem("cardall-tags"),p=localStorage.getItem("cardall-hidden-tags");if(g)try{const v=JSON.parse(g);s(v)}catch(v){console.error("Failed to load saved tags:",v)}if(p)try{const v=JSON.parse(p);n(v)}catch(v){console.error("Failed to load hidden tags:",v)}},[]),{tags:r(),allTags:t,hiddenTags:a,popularTags:o,dispatch:i,getTagById:l,getTagByName:u,createTagIfNotExists:h,updateTagCount:m,syncTagsWithCards:y,searchTags:x,getTagSuggestions:c,renameTag:w,deleteTagByName:b,getAllTagNames:f}}const $a=d.createContext(null);function xo({children:t}){const s=uo(),a=ho(),n=po();T.useEffect(()=>{const o=[];s.allCards.forEach(i=>{o.push(...i.frontContent.tags,...i.backContent.tags)}),n.syncTagsWithCards(o)},[s.allCards,n.syncTagsWithCards]);const r={cards:s,folders:a,tags:n};return e.jsx($a.Provider,{value:r,children:t})}function us(){const t=d.useContext($a);if(!t)throw new Error("useCardAll must be used within a CardAllProvider");return t}function bo(){return us().cards}function Ba(){return us().folders}function Ua(){return us().tags}const Wa=d.createContext(void 0);function yo({children:t}){const[s,a]=d.useState(!1),n=()=>a(!0),r=()=>a(!1);return e.jsx(Wa.Provider,{value:{isOpen:s,openModal:n,closeModal:r},children:t})}function Va(){const t=d.useContext(Wa);if(t===void 0)throw new Error("useAuthModal must be used within an AuthModalProvider");return t}function S(...t){return Cr(Nr(t))}const fs=_t("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),D=d.forwardRef(({className:t,variant:s,size:a,asChild:n=!1,...r},o)=>{const i=n?Gn:"button";return e.jsx(i,{className:S(fs({variant:s,size:a,className:t})),ref:o,...r})});D.displayName="Button";const wo=Kn,vo=qn,jo=d.forwardRef(({className:t,inset:s,children:a,...n},r)=>e.jsxs(Os,{ref:r,className:S("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",t),...n,children:[a,e.jsx(Rt,{className:"ml-auto"})]}));jo.displayName=Os.displayName;const Co=d.forwardRef(({className:t,...s},a)=>e.jsx($s,{ref:a,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));Co.displayName=$s.displayName;const Ha=d.forwardRef(({className:t,sideOffset:s=4,...a},n)=>e.jsx(Yn,{children:e.jsx(Bs,{ref:n,sideOffset:s,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})}));Ha.displayName=Bs.displayName;const Ce=d.forwardRef(({className:t,inset:s,...a},n)=>e.jsx(Us,{ref:n,className:S("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",t),...a}));Ce.displayName=Us.displayName;const No=d.forwardRef(({className:t,children:s,checked:a,...n},r)=>e.jsxs(Ws,{ref:r,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:a,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Vs,{children:e.jsx(ke,{className:"h-4 w-4"})})}),s]}));No.displayName=Ws.displayName;const So=d.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(Hs,{ref:n,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Vs,{children:e.jsx(Aa,{className:"h-2 w-2 fill-current"})})}),s]}));So.displayName=Hs.displayName;const ko=d.forwardRef(({className:t,inset:s,...a},n)=>e.jsx(Gs,{ref:n,className:S("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...a}));ko.displayName=Gs.displayName;const os=d.forwardRef(({className:t,...s},a)=>e.jsx(Ys,{ref:a,className:S("-mx-1 my-1 h-px bg-muted",t),...s}));os.displayName=Ys.displayName;const Kt=[{emoji:"😀",name:"grinning"},{emoji:"😃",name:"smiley"},{emoji:"😄",name:"smile"},{emoji:"😁",name:"grin"},{emoji:"😆",name:"laughing"},{emoji:"😅",name:"sweat_smile"},{emoji:"🤣",name:"rofl"},{emoji:"😂",name:"joy"},{emoji:"🙂",name:"slightly_smiling_face"},{emoji:"🙃",name:"upside_down_face"},{emoji:"😉",name:"wink"},{emoji:"😊",name:"blush"},{emoji:"😇",name:"innocent"},{emoji:"🥰",name:"smiling_face_with_hearts"},{emoji:"😍",name:"heart_eyes"},{emoji:"🤩",name:"star_struck"},{emoji:"😘",name:"kissing_heart"},{emoji:"😗",name:"kissing"},{emoji:"😚",name:"kissing_closed_eyes"},{emoji:"😙",name:"kissing_smiling_eyes"},{emoji:"🥲",name:"smiling_face_with_tear"},{emoji:"😋",name:"yum"},{emoji:"😛",name:"stuck_out_tongue"},{emoji:"😜",name:"stuck_out_tongue_winking_eye"},{emoji:"🤪",name:"zany_face"},{emoji:"😝",name:"stuck_out_tongue_closed_eyes"},{emoji:"🤑",name:"money_mouth_face"},{emoji:"🤗",name:"hugs"},{emoji:"🤭",name:"hand_over_mouth"},{emoji:"🤫",name:"shushing_face"},{emoji:"🤔",name:"thinking"},{emoji:"🤐",name:"zipper_mouth_face"},{emoji:"🤨",name:"raised_eyebrow"},{emoji:"😐",name:"neutral_face"},{emoji:"😑",name:"expressionless"},{emoji:"😶",name:"no_mouth"},{emoji:"😏",name:"smirk"},{emoji:"😒",name:"unamused"},{emoji:"🙄",name:"roll_eyes"},{emoji:"😬",name:"grimacing"},{emoji:"🤥",name:"lying_face"},{emoji:"😔",name:"pensive"},{emoji:"😪",name:"sleepy"},{emoji:"🤤",name:"drooling_face"},{emoji:"😴",name:"sleeping"},{emoji:"😷",name:"mask"},{emoji:"🤒",name:"face_with_thermometer"},{emoji:"🤕",name:"face_with_head_bandage"},{emoji:"🤢",name:"nauseated_face"},{emoji:"🤮",name:"vomiting_face"},{emoji:"🤧",name:"sneezing_face"},{emoji:"🥵",name:"hot_face"},{emoji:"🥶",name:"cold_face"},{emoji:"🥴",name:"woozy_face"},{emoji:"😵",name:"dizzy_face"},{emoji:"🤯",name:"exploding_head"},{emoji:"🤠",name:"cowboy_hat_face"},{emoji:"🥳",name:"partying_face"},{emoji:"🥸",name:"disguised_face"},{emoji:"😎",name:"sunglasses"},{emoji:"🤓",name:"nerd_face"},{emoji:"🧐",name:"monocle_face"},{emoji:"😕",name:"confused"},{emoji:"😟",name:"worried"},{emoji:"🙁",name:"slightly_frowning_face"},{emoji:"☹️",name:"frowning_face"},{emoji:"😮",name:"open_mouth"},{emoji:"😯",name:"hushed"},{emoji:"😲",name:"astonished"},{emoji:"😳",name:"flushed"},{emoji:"🥺",name:"pleading_face"},{emoji:"😦",name:"frowning"},{emoji:"😧",name:"anguished"},{emoji:"😨",name:"fearful"},{emoji:"😰",name:"cold_sweat"},{emoji:"😥",name:"disappointed_relieved"},{emoji:"😢",name:"cry"},{emoji:"😭",name:"sob"},{emoji:"😱",name:"scream"},{emoji:"😖",name:"confounded"},{emoji:"😣",name:"persevere"},{emoji:"😞",name:"disappointed"},{emoji:"😓",name:"sweat"},{emoji:"😩",name:"weary"},{emoji:"😫",name:"tired_face"},{emoji:"🥱",name:"yawning_face"},{emoji:"😤",name:"triumph"},{emoji:"😡",name:"rage"},{emoji:"😠",name:"angry"},{emoji:"🤬",name:"cursing_face"},{emoji:"😈",name:"smiling_imp"},{emoji:"👿",name:"imp"},{emoji:"💀",name:"skull"},{emoji:"☠️",name:"skull_and_crossbones"},{emoji:"💩",name:"poop"},{emoji:"🤡",name:"clown_face"},{emoji:"👹",name:"ogre"},{emoji:"👺",name:"goblin"},{emoji:"👻",name:"ghost"},{emoji:"👽",name:"alien"},{emoji:"👾",name:"space_invader"},{emoji:"🤖",name:"robot"},{emoji:"😺",name:"smiley_cat"},{emoji:"😸",name:"smile_cat"},{emoji:"😹",name:"joy_cat"},{emoji:"😻",name:"heart_eyes_cat"},{emoji:"😼",name:"smirk_cat"},{emoji:"😽",name:"kissing_cat"},{emoji:"🙀",name:"scream_cat"},{emoji:"😿",name:"crying_cat_face"},{emoji:"😾",name:"pouting_cat"},{emoji:"👋",name:"wave"},{emoji:"🤚",name:"raised_back_of_hand"},{emoji:"🖐️",name:"raised_hand_with_fingers_splayed"},{emoji:"✋",name:"hand"},{emoji:"🖖",name:"vulcan_salute"},{emoji:"👌",name:"ok_hand"},{emoji:"🤌",name:"pinched_fingers"},{emoji:"🤏",name:"pinching_hand"},{emoji:"✌️",name:"v"},{emoji:"🤞",name:"crossed_fingers"},{emoji:"🤟",name:"love_you_gesture"},{emoji:"🤘",name:"metal"},{emoji:"🤙",name:"call_me_hand"},{emoji:"👈",name:"point_left"},{emoji:"👉",name:"point_right"},{emoji:"👆",name:"point_up_2"},{emoji:"🖕",name:"middle_finger"},{emoji:"👇",name:"point_down"},{emoji:"☝️",name:"point_up"},{emoji:"👍",name:"thumbsup"},{emoji:"👎",name:"thumbsdown"},{emoji:"✊",name:"fist"},{emoji:"👊",name:"facepunch"},{emoji:"🤛",name:"fist_left"},{emoji:"🤜",name:"fist_right"},{emoji:"👏",name:"clap"},{emoji:"🙌",name:"raised_hands"},{emoji:"👐",name:"open_hands"},{emoji:"🤲",name:"palms_up_together"},{emoji:"🤝",name:"handshake"},{emoji:"🙏",name:"pray"},{emoji:"❤️",name:"heart"},{emoji:"🧡",name:"orange_heart"},{emoji:"💛",name:"yellow_heart"},{emoji:"💚",name:"green_heart"},{emoji:"💙",name:"blue_heart"},{emoji:"💜",name:"purple_heart"},{emoji:"🖤",name:"black_heart"},{emoji:"🤍",name:"white_heart"},{emoji:"🤎",name:"brown_heart"},{emoji:"💔",name:"broken_heart"},{emoji:"❣️",name:"heavy_heart_exclamation"},{emoji:"💕",name:"two_hearts"},{emoji:"💞",name:"revolving_hearts"},{emoji:"💓",name:"heartbeat"},{emoji:"💗",name:"heartpulse"},{emoji:"💖",name:"sparkling_heart"},{emoji:"💘",name:"cupid"},{emoji:"💝",name:"gift_heart"},{emoji:"💟",name:"heart_decoration"},{emoji:"☮️",name:"peace_symbol"},{emoji:"✝️",name:"latin_cross"},{emoji:"☪️",name:"star_and_crescent"},{emoji:"🕉️",name:"om"},{emoji:"☸️",name:"wheel_of_dharma"},{emoji:"✡️",name:"star_of_david"},{emoji:"🔯",name:"six_pointed_star"},{emoji:"🕎",name:"menorah"},{emoji:"☯️",name:"yin_yang"},{emoji:"☦️",name:"orthodox_cross"},{emoji:"🛐",name:"place_of_worship"},{emoji:"⛎",name:"ophiuchus"},{emoji:"♈",name:"aries"},{emoji:"♉",name:"taurus"},{emoji:"♊",name:"gemini"},{emoji:"♋",name:"cancer"},{emoji:"♌",name:"leo"},{emoji:"♍",name:"virgo"},{emoji:"♎",name:"libra"},{emoji:"♏",name:"scorpius"},{emoji:"♐",name:"sagittarius"},{emoji:"♑",name:"capricorn"},{emoji:"♒",name:"aquarius"},{emoji:"♓",name:"pisces"},{emoji:"🆔",name:"id"},{emoji:"⚡",name:"zap"},{emoji:"💥",name:"boom"},{emoji:"💫",name:"dizzy"},{emoji:"💦",name:"sweat_drops"},{emoji:"💨",name:"dash"},{emoji:"🕳️",name:"hole"},{emoji:"💣",name:"bomb"},{emoji:"💬",name:"speech_balloon"},{emoji:"👁️‍🗨️",name:"eye_speech_bubble"},{emoji:"🗨️",name:"left_speech_bubble"},{emoji:"🗯️",name:"right_anger_bubble"},{emoji:"💭",name:"thought_balloon"},{emoji:"💤",name:"zzz"}];function To({onEmojiSelect:t,onClose:s,query:a="",position:n}){const[r,o]=d.useState(Kt);d.useEffect(()=>{if(a&&a.trim()){const m=a.toLowerCase().trim(),y=Kt.filter(x=>x.name.toLowerCase().includes(m)||x.emoji.includes(a)||x.name.toLowerCase().startsWith(m));o(y.slice(0,20))}else o(Kt.slice(0,40))},[a]);const i=m=>{t(m),s()},l=m=>{m.key==="Escape"&&s()},u=()=>{if(!n)return{};const m=window.innerWidth,y=window.innerHeight,x=320,c=240;let w=n.x,b=n.y;return w+x>m&&(w=m-x-20),b+c>y&&(b=n.y-c-10),{left:Math.max(10,w),top:Math.max(10,b)}},h=e.jsxs("div",{className:"fixed bg-white border border-border rounded-lg shadow-xl p-3 w-80",style:{...u(),zIndex:2147483647},onKeyDown:l,children:[a&&e.jsxs("div",{className:"text-xs text-blue-600 mb-2 font-medium",children:['"',a,'"']}),e.jsx("div",{className:"grid grid-cols-10 gap-1 max-h-52 overflow-y-auto",children:r.map((m,y)=>e.jsx(D,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-blue-50 text-lg transition-colors",onClick:()=>i(m.emoji),title:m.name,children:m.emoji},`${m.emoji}-${y}`))}),r.length===0&&a&&e.jsx("div",{className:"text-center text-muted-foreground text-sm py-6",children:"No emojis found"})]});return Dt.createPortal(h,document.body)}function Eo({content:t,placeholder:s="Start typing...",onUpdate:a,onSave:n,onCancel:r,className:o,autoFocus:i=!1}){const[l,u]=d.useState(!1),[h,m]=d.useState(""),[y,x]=d.useState(null),c=d.useRef(null),w=Qr({extensions:[Xr.configure({strike:!1,code:!1,blockquote:!1}),Zr.configure({html:!0,transformPastedText:!0,transformCopiedText:!1}),eo,to.configure({nested:!0}),so.configure({openOnClick:!1,HTMLAttributes:{class:"text-blue-600 underline hover:text-blue-800 cursor-pointer",target:"_blank",rel:"noopener noreferrer"},protocols:["http","https","ftp","mailto"],validate:p=>/^https?:\/\//.test(p)}),ao.configure({HTMLAttributes:{class:"border-l-4 border-gray-300 pl-4 italic"}}),no.configure({HTMLAttributes:{class:"inline-code"}}),ro.configure({HTMLAttributes:{class:"code-block"}}),oo.configure({HTMLAttributes:{class:"line-through"}}),io.configure({inline:!0,allowBase64:!0,HTMLAttributes:{class:"rounded-md max-w-full h-auto"}}),lo.configure({placeholder:s})],content:t,onUpdate:({editor:p})=>{a(p.getHTML())},editorProps:{attributes:{class:"tiptap-editor text-sm leading-relaxed focus:outline-none min-h-[100px] w-full"},handleKeyDown:(p,v)=>{if(v.key==="/"&&!l){const{selection:j}=p.state,{from:k}=j,_=p.state.doc.resolve(k),N=_.parent.textBetween(0,_.parentOffset);if(!N.trim()||N.endsWith(" ")){const W=p.coordsAtPos(k);return x({x:W.left,y:W.bottom+5}),u(!0),m(""),v.preventDefault(),!0}}if(l){if(v.key==="Escape")return u(!1),m(""),!0;if(v.key==="Backspace")return h.length>0?m(j=>j.slice(0,-1)):u(!1),!0;if(v.key.length===1&&!v.ctrlKey&&!v.metaKey&&v.key!==" ")return m(j=>j+v.key),!0;if(v.key===" ")return u(!1),m(""),!0}return!1}}}),b=d.useCallback(()=>{const p=document.createElement("input");p.type="file",p.accept="image/*",p.onchange=v=>{const j=v.target.files?.[0];if(j&&w){const k=new FileReader;k.onload=_=>{const N=_.target?.result;w.chain().focus().setImage({src:N}).run()},k.readAsDataURL(j)}},p.click()},[w]);d.useEffect(()=>{if(!w)return;const p=j=>{const k=j.clipboardData?.items;if(k)for(let _=0;_<k.length;_++){const N=k[_];if(N.type.indexOf("image")!==-1){j.preventDefault();const F=N.getAsFile();if(F){const W=new FileReader;W.onload=Z=>{const A=Z.target?.result;w.chain().focus().setImage({src:A}).run()},W.readAsDataURL(F)}}}},v=w.view.dom;return v.addEventListener("paste",p),()=>{v.removeEventListener("paste",p)}},[w]);const f=d.useCallback(p=>{w&&w.chain().focus().insertContent(p).run(),u(!1),m("")},[w]),g=d.useCallback(()=>{u(!1),m("")},[]);return d.useEffect(()=>{if(!w)return;const p=j=>{j.key==="Escape"?l?(u(!1),m("")):r():j.key==="Enter"&&(j.ctrlKey||j.metaKey)&&n()},v=w.view.dom;return v.addEventListener("keydown",p),()=>{v.removeEventListener("keydown",p)}},[w,n,r,l]),d.useEffect(()=>{w&&i&&w.commands.focus()},[w,i]),w?e.jsxs("div",{className:S("relative z-20",o),ref:c,children:[e.jsxs("div",{className:"relative p-2 -m-2",children:[e.jsx(co,{editor:w,className:"min-h-[100px]"}),e.jsxs("div",{className:"absolute top-0 right-0 flex gap-1 opacity-60 hover:opacity-100 transition-opacity",children:[e.jsx(D,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 bg-white/90 hover:bg-white shadow-sm rounded",onClick:()=>u(!l),title:"Insert Emoji (Press / to open)",children:e.jsx(Sr,{className:"h-3 w-3"})}),e.jsx(D,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 bg-white/90 hover:bg-white shadow-sm rounded",onClick:b,title:"Insert Image",children:e.jsx(Fa,{className:"h-3 w-3"})})]})]}),l&&e.jsx(To,{onEmojiSelect:f,onClose:g,query:h,position:y||void 0}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2 pt-2 border-t border-border/30",children:[e.jsxs(D,{size:"sm",variant:"ghost",onClick:r,className:"h-7 px-3 text-xs",children:[e.jsx(Ie,{className:"h-3 w-3 mr-1"}),"Cancel"]}),e.jsxs(D,{size:"sm",onClick:n,className:"h-7 px-3 text-xs",children:[e.jsx(ke,{className:"h-3 w-3 mr-1"}),"Accept"]})]}),w&&e.jsxs("div",{className:"absolute top-0 right-0 text-xs text-muted-foreground bg-white/90 px-2 py-1 rounded shadow-sm opacity-0 hover:opacity-100 transition-opacity pointer-events-none z-10 max-w-xs",children:["**bold** *italic* # heading - list ",">"," quote `code` ~~strike~~ [link](url) [] task / emoji"]})]}):null}function Do({content:t,onUpdate:s,onSave:a,onCancel:n,className:r,autoFocus:o=!1}){const[i,l]=d.useState(t),u=d.useRef(null);d.useEffect(()=>{l(t)},[t]),d.useEffect(()=>{o&&u.current&&(u.current.focus(),u.current.select())},[o]);const h=y=>{l(y.target.value),s(y.target.value)},m=y=>{y.key==="Enter"?a():y.key==="Escape"&&n()};return e.jsxs("div",{className:S("relative",r),children:[e.jsx("input",{ref:u,type:"text",value:i,onChange:h,onKeyDown:m,className:"w-full bg-transparent border-none outline-none text-lg font-semibold resize-none pr-16",placeholder:"Card title..."}),e.jsxs("div",{className:"absolute right-0 top-0 flex gap-1",children:[e.jsx(D,{size:"sm",variant:"ghost",onClick:n,className:"h-6 w-6 p-0 bg-white/80 hover:bg-white shadow-sm",children:e.jsx(Ie,{className:"h-3 w-3"})}),e.jsx(D,{size:"sm",onClick:a,className:"h-6 w-6 p-0 bg-white/80 hover:bg-white shadow-sm",children:e.jsx(ke,{className:"h-3 w-3"})})]})]})}const _o=t=>{const s=["#3b82f6","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4","#8b5a2b","#6b7280","#ec4899","#84cc16","#f97316","#6366f1"];let a=0;for(let n=0;n<t.length;n++)a=t.charCodeAt(n)+((a<<5)-a);return s[Math.abs(a)%s.length]},Ro=({tags:t,className:s,maxTags:a=5,size:n="sm"})=>{if(!t||t.length===0)return null;const r=t.slice(0,a),o=t.length-a,i={sm:"text-xs px-2 py-1",md:"text-sm px-2.5 py-1.5",lg:"text-base px-3 py-2"};return e.jsxs("div",{className:S("flex flex-wrap gap-1.5 mt-3",s),children:[r.map((l,u)=>e.jsx("span",{className:S("inline-flex items-center rounded-full font-medium text-white","shadow-sm transition-all duration-200 hover:scale-105",i[n]),style:{backgroundColor:_o(l),fontSize:n==="sm"?"0.75rem":n==="md"?"0.875rem":"1rem"},children:l},`${l}-${u}`)),o>0&&e.jsxs("span",{className:S("inline-flex items-center rounded-full bg-gray-500 text-white font-medium",i[n]),children:["+",o]})]})};function Ao({card:t,onFlip:s,onUpdate:a,onCopy:n,onScreenshot:r,onShare:o,onDelete:i,onStyleChange:l,onTagsChange:u,onMoveToFolder:h,className:m,size:y="md"}){const[x,c]=d.useState(!1),[w,b]=d.useState(!1),[f,g]=d.useState(null),[p,v]=d.useState(null),[j,k]=d.useState(null),[_,N]=d.useState(!1),F=d.useRef(null),W=t.isFlipped?t.backContent:t.frontContent,Z={sm:"w-full",md:"w-full",lg:"w-full"},A={sm:"p-3",md:"p-4",lg:"p-5"},E=()=>{const{style:I}=t,M={borderRadius:"1rem",fontFamily:I.fontFamily,fontSize:I.fontSize==="sm"?"0.875rem":I.fontSize==="lg"?"1.125rem":"1rem",fontWeight:I.fontWeight,color:I.textColor,borderWidth:I.borderWidth||0,borderColor:I.borderColor};let Q="";return I.type==="gradient"&&I.gradientColors?(M.background=`linear-gradient(135deg, ${I.gradientColors.join(", ")})`,I.gradientColors.includes("#8a2be2")&&I.gradientColors.includes("#00ffff")?(Q="gradient-wave-animation",M.position="relative"):I.gradientColors.includes("#ee7752")&&I.gradientColors.includes("#23d5ab")?Q="moving-gradient-animation":I.gradientColors.includes("#667eea")&&(Q="gradient-mesh-animation")):I.type==="glass"?(M.background=I.backgroundColor||"rgba(255, 255, 255, 0.15)",M.backdropFilter="blur(20px) saturate(180%)",M.WebkitBackdropFilter="blur(20px) saturate(180%)",M.border=`1px solid ${I.borderColor||"rgba(255, 255, 255, 0.18)"}`,Q="glass-morphism"):I.backgroundColor&&I.backgroundColor.includes("linear-gradient")?(M.background=I.backgroundColor,M.backgroundSize="400% 400%",I.backgroundColor.includes("#667eea")&&(Q="gradient-mesh-animation")):(M.backgroundColor=I.backgroundColor,I.backgroundColor==="#1a1a2e"&&I.borderColor==="#4361ee"?Q="pulse-border-animation":I.backgroundColor==="#0f172a"&&(Q="glow-hover-animation")),{style:M,shadowClass:{sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg",xl:"shadow-xl",none:"","2xl":"shadow-2xl",glass:"shadow-lg"}[I.shadow||"md"]||"shadow-md",specialClasses:Q}},{style:U,shadowClass:H,specialClasses:ee}=E(),X=d.useCallback(I=>{I.stopPropagation(),I.preventDefault(),!_&&(N(!0),s(t.id),setTimeout(()=>{N(!1)},600))},[t.id,s,_]),se=I=>{I.stopPropagation(),R("content")},fe=I=>{R(I)},R=I=>{v(W),k(W),g(I),b(!0)},O=(I,M)=>{j&&k({...j,[I]:M,lastModified:new Date})},q=()=>{if(j){const M={[t.isFlipped?"backContent":"frontContent"]:j};a(t.id,M)}b(!1),g(null),v(null),k(null)},$=()=>{b(!1),g(null),v(null),k(null)},z=I=>{O("title",I.target.value)},V=I=>{O("text",I.target.value)},J=I=>{I.key==="Escape"&&$(),I.key==="Enter"&&I.ctrlKey&&q()};return e.jsx("div",{className:S("relative group",m),"data-card-id":t.id,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:e.jsx("div",{className:"flip-card-container",style:{perspective:"1000px",width:"100%",minHeight:"fit-content"},children:e.jsxs("div",{ref:F,className:S("flip-card-inner relative transition-all duration-700 ease-in-out",Z[y]),style:{minHeight:"fit-content",width:"100%",transformStyle:"preserve-3d",transform:t.isFlipped?"rotateY(180deg)":"rotateY(0deg)"},children:[e.jsx("div",{className:S("flip-card-face flip-card-front w-full flex flex-col transition-all duration-300 relative",H,ee,A[y]),style:{...U,borderRadius:U.borderRadius,backfaceVisibility:"hidden",position:t.isFlipped?"absolute":"relative",opacity:t.isFlipped?0:1},children:e.jsx(Ns,{content:j||t.frontContent,isEditing:w&&!t.isFlipped,editingField:f,onTitleChange:z,onTextChange:V,onTempContentUpdate:O,onSaveEdit:q,onCancelEdit:$,onDoubleClick:fe,onKeyDown:J,sideLabel:"Front",isHovered:x,onEdit:se,onFlip:X,onCopy:()=>n(t.id),onScreenshot:()=>r(t.id),onShare:()=>o(t.id),onDelete:()=>i(t.id),onStyleChange:l?()=>l(t.id):void 0,onTagsChange:u?()=>u(t.id):void 0,onMoveToFolder:h,card:t,isFlipping:_})}),e.jsx("div",{className:S("flip-card-face flip-card-back w-full flex flex-col transition-all duration-300 relative",H,ee,A[y]),style:{...U,borderRadius:U.borderRadius,backfaceVisibility:"hidden",transform:"rotateY(180deg)",position:t.isFlipped?"relative":"absolute",top:t.isFlipped?"auto":"0",opacity:t.isFlipped?1:0},children:e.jsx(Ns,{content:j||t.backContent,isEditing:w&&t.isFlipped,editingField:f,onTitleChange:z,onTextChange:V,onTempContentUpdate:O,onSaveEdit:q,onCancelEdit:$,onDoubleClick:fe,onKeyDown:J,sideLabel:"Back",isHovered:x,onEdit:se,onFlip:X,onCopy:()=>n(t.id),onScreenshot:()=>r(t.id),onShare:()=>o(t.id),onDelete:()=>i(t.id),onStyleChange:l?()=>l(t.id):void 0,onTagsChange:u?()=>u(t.id):void 0,onMoveToFolder:h,card:t,isFlipping:_})})]})})})}function Fo({images:t}){const s=t.slice(0,4),a=s.length,n=o=>{switch(o){case 1:return"flex justify-center";case 2:return"grid grid-cols-2 gap-2";case 3:return"grid grid-cols-2 gap-2";case 4:default:return"grid grid-cols-2 gap-2"}},r=(o,i)=>{const l="relative aspect-video rounded-md overflow-hidden bg-muted transition-all duration-200 hover:scale-[1.02]";return o===1?`${l} max-w-xs w-full`:o===3&&i===2?`${l} col-span-2 max-w-xs mx-auto`:l};return e.jsx("div",{className:n(a),children:s.map((o,i)=>e.jsx("div",{className:r(a,i),children:e.jsx("img",{src:o.url,alt:o.alt||`Image ${i+1}`,className:"w-full h-full object-cover transition-transform duration-200",loading:"lazy"})},i))})}function Ns({content:t,isEditing:s,editingField:a,onTitleChange:n,onTextChange:r,onTempContentUpdate:o,onSaveEdit:i,onCancelEdit:l,onDoubleClick:u,onKeyDown:h,sideLabel:m,isHovered:y,onEdit:x,onFlip:c,onCopy:w,onScreenshot:b,onShare:f,onDelete:g,onStyleChange:p,onTagsChange:v,onMoveToFolder:j,card:k,isFlipping:_}){return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex-1 mr-2",children:s&&a==="title"?e.jsx(Do,{content:t.title,onUpdate:N=>o("title",N),onSave:i,onCancel:l,autoFocus:!0}):e.jsx("h3",{className:"text-lg font-semibold text-left cursor-pointer hover:bg-black/5 rounded px-1 py-0.5 -mx-1 transition-colors",onDoubleClick:()=>u("title"),children:t.title||"Untitled Card"})}),e.jsxs("div",{className:S("flex gap-1 transition-all duration-200 flex-shrink-0",y||s?"opacity-100":"opacity-60"),children:[e.jsx(D,{size:"sm",variant:"ghost",className:S("h-7 w-7 p-0 rounded-md hover:bg-black/10 transition-all duration-200",_&&"animate-pulse"),onClick:c,title:`Flip to ${k.isFlipped?"Front":"Back"}`,disabled:_,children:e.jsx(kr,{className:S("h-3.5 w-3.5 transition-transform duration-200",_&&"scale-110")})}),e.jsxs(wo,{modal:!1,children:[e.jsx(vo,{asChild:!0,children:e.jsx("div",{className:"h-7 w-7 rounded-md hover:bg-black/10 flex items-center justify-center cursor-pointer transition-colors group",onMouseEnter:N=>{N.stopPropagation();const F=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});N.currentTarget.dispatchEvent(F)},onClick:N=>N.stopPropagation(),children:e.jsx(Tr,{className:"h-3.5 w-3.5"})})}),e.jsxs(Ha,{align:"end",className:"w-48",children:[e.jsxs(Ce,{onClick:x,children:[e.jsx(Er,{className:"h-4 w-4 mr-2"}),"Edit Content"]}),e.jsxs(Ce,{onClick:w,children:[e.jsx(Dr,{className:"h-4 w-4 mr-2"}),"Copy Text"]}),e.jsxs(Ce,{onClick:b,children:[e.jsx(es,{className:"h-4 w-4 mr-2"}),"Screenshot"]}),e.jsxs(Ce,{onClick:f,children:[e.jsx(_r,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsx(os,{}),p&&e.jsxs(Ce,{onClick:p,children:[e.jsx(Pa,{className:"h-4 w-4 mr-2"}),"Change Style"]}),v&&e.jsxs(Ce,{onClick:v,children:[e.jsx(Ia,{className:"h-4 w-4 mr-2"}),"Manage Tags"]}),j&&e.jsxs(Ce,{onClick:j,children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),"Move to Folder"]}),e.jsx(os,{}),e.jsxs(Ce,{onClick:g,className:"text-destructive focus:text-destructive",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Delete Card"]})]})]})]})]}),t.images.length>0&&e.jsxs("div",{className:"mb-3 flex-shrink-0",children:[e.jsx(Fo,{images:t.images}),t.images.length>4&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-center",children:["+",t.images.length-4," more images"]})]}),e.jsx("div",{className:"flex-1 mb-3 relative z-10",children:s&&a==="content"?e.jsx(Eo,{content:t.text,placeholder:"Add your content here...",onUpdate:N=>o("text",N),onSave:i,onCancel:l,autoFocus:!0}):e.jsx("div",{className:"text-sm leading-relaxed text-left cursor-pointer hover:bg-black/5 rounded p-2 -m-2 transition-colors min-h-[100px] tiptap-editor relative z-10",onDoubleClick:N=>{N.target.tagName!=="A"&&u("content")},onClick:N=>{const F=N.target;if(F.tagName==="A"){N.stopPropagation();const W=F.getAttribute("href");W&&window.open(W,"_blank","noopener,noreferrer")}},children:e.jsx("div",{className:"whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:t.text||'<span class="text-muted-foreground">Click to add content...</span>'}})})}),e.jsxs("div",{className:"mt-auto",children:[e.jsx(Ro,{tags:t.tags,size:"sm"}),t.images.length>0&&e.jsx("div",{className:"flex items-center justify-end text-xs text-muted-foreground mt-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fa,{className:"h-3 w-3"}),e.jsx("span",{children:t.images.length})]})})]})]})}const ue=({title:t="Sample Card",content:s="This is a preview of how your card will look with this style.",style:a,isSelected:n=!1,onClick:r,className:o})=>{console.log("Rendering StylePreviewCard (Simplified):",{title:t,isSelected:n,style:a});const i=()=>{const l={minHeight:"60px",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"8px",borderRadius:"8px",cursor:"pointer",border:n?"2px solid #3b82f6":"1px solid #e5e7eb",position:"relative",fontSize:"10px",textAlign:"center",boxShadow:n?"0 4px 12px rgba(59, 130, 246, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.1)",transition:"all 0.2s ease",backgroundColor:"#ffffff"};if(typeof a=="object"&&a!==null){if("background"in a||"backgroundColor"in a)return{...l,...a,cursor:"pointer",border:n?"3px solid #3b82f6":a.border||"2px solid #e5e7eb",boxShadow:n?"0 4px 12px rgba(59, 130, 246, 0.3)":a.boxShadow||"0 2px 4px rgba(0, 0, 0, 0.1)",transition:"all 0.2s ease"};if("type"in a){if(a.type==="solid")return{...l,backgroundColor:a.backgroundColor||"#ffffff",color:a.textColor||"#374151"};if(a.type==="gradient"&&a.gradientColors){const h=`linear-gradient(${a.gradientDirection||"to bottom right"}, ${a.gradientColors.join(", ")})`;return{...l,background:h,color:a.textColor||"#ffffff"}}}}return l};return e.jsxs("div",{style:i(),onClick:r,className:o,children:[e.jsx("div",{style:{fontWeight:"600",marginBottom:"2px",fontSize:"11px"},children:t}),e.jsx("div",{style:{fontSize:"9px",opacity:.8,lineHeight:"1.1"},children:s})]})},Po=({isSelected:t,onClick:s,className:a})=>{const n={background:"#ffffff",color:"#1f2937",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"400",borderRadius:"12px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",border:"1px solid #e5e7eb"};return e.jsx(ue,{title:"Classic White",content:"Clean and professional",style:n,isSelected:t,onClick:s,className:a})},Io={id:"classic-white",name:"Classic White",category:"business",description:"Clean and professional white background with subtle shadows",style:{type:"solid",backgroundColor:"#ffffff",fontFamily:"system-ui",fontSize:"base",fontWeight:"normal",textColor:"#1f2937",borderRadius:"2xl",shadow:"md",borderWidth:1,borderColor:"#e5e7eb"},previewComponent:Po},Mo=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #1f2937 0%, #111827 50%, #030712 100%)",color:"#f9fafb",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"600",borderRadius:"12px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.1)"};return e.jsx(ue,{title:"Deep Dark",content:"Bold and mysterious",style:n,isSelected:t,onClick:s,className:a})},Lo={id:"deep-dark",name:"Deep Dark",category:"personality",description:"Bold dark gradient with mysterious depth",style:{type:"gradient",gradientColors:["#1f2937","#111827","#030712"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"semibold",textColor:"#f9fafb",borderRadius:"2xl",shadow:"2xl",borderWidth:1,borderColor:"rgba(255, 255, 255, 0.1)"},previewComponent:Mo},zo=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #8b5cf6 0%, #a855f7 50%, #c084fc 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"20px",boxShadow:"0 20px 25px -5px rgba(139, 92, 246, 0.25), 0 10px 10px -5px rgba(139, 92, 246, 0.1)",border:"none"};return e.jsx(ue,{title:"Elegant Purple",content:"Artistic and inspiring",style:n,isSelected:t,onClick:s,className:a})},Oo={id:"elegant-purple",name:"Elegant Purple",category:"creative",description:"Artistic purple gradient with elegant curves and shadows",style:{type:"gradient",gradientColors:["#8b5cf6","#a855f7","#c084fc"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:zo},$o=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"16px",boxShadow:"0 20px 25px -5px rgba(16, 185, 129, 0.2), 0 10px 10px -5px rgba(16, 185, 129, 0.1)",border:"none"};return e.jsx(ue,{title:"Fresh Green",content:"Natural and harmonious",style:n,isSelected:t,onClick:s,className:a})},Bo={id:"fresh-green",name:"Fresh Green",category:"natural",description:"Natural green gradient with organic harmony",style:{type:"gradient",gradientColors:["#10b981","#059669","#047857"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:$o},Uo=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)",backgroundSize:"400% 400%",animation:"gradientShift 8s ease infinite",color:"#ffffff",fontFamily:'"Inter", system-ui, -apple-system, sans-serif',fontSize:"14px",fontWeight:"500",borderRadius:"12px",boxShadow:"0 8px 32px rgba(102, 126, 234, 0.3), 0 4px 16px rgba(118, 75, 162, 0.2)",border:"none",position:"relative",overflow:"hidden"},r={position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",pointerEvents:"none"};return e.jsxs("div",{style:{position:"relative"},children:[e.jsx(ue,{title:"Gradient Mesh",content:"Dynamic gradient background",style:n,isSelected:t,onClick:s,className:a}),e.jsx("div",{style:r}),e.jsx("style",{jsx:!0,children:`
        @keyframes gradientShift {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
        }
      `})]})},Wo={id:"gradient-mesh",name:"Gradient Mesh",category:"creative",description:"Dynamic gradient background with animated mesh effect",style:{type:"solid",backgroundColor:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%)",fontFamily:"Inter",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"xl",borderWidth:0,borderColor:"transparent"},previewComponent:Uo},Vo=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(90deg, #fb923c 0%, #8b5cf6 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"600",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(251, 146, 60, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"none"};return e.jsx(ue,{title:"Gradient Sunset",content:"Vibrant and expressive",style:n,isSelected:t,onClick:s,className:a})},Ho={id:"gradient-sunset",name:"Gradient Sunset",category:"personality",description:"Warm orange to violet gradient with magical sunset vibes",style:{type:"gradient",gradientColors:["#fb923c","#8b5cf6"],gradientDirection:"to-r",fontFamily:"system-ui",fontSize:"base",fontWeight:"semibold",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:Vo},Go=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #8a2be2 0%, #4b0082 25%, #9370db 50%, #00ffff 75%, #00bfff 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"600",borderRadius:"24px",boxShadow:"0 25px 50px -12px rgba(138, 43, 226, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"none",position:"relative",overflow:"hidden"};return e.jsx("div",{className:"relative",children:e.jsx(ue,{title:"Gradient Wave",content:"Dynamic wave effect",style:n,isSelected:t,onClick:s,className:`${a} gradient-wave-animation`})})},Yo={id:"gradient-wave",name:"Gradient Wave",category:"creative",description:"Purple to cyan gradient with dynamic wave effect",style:{type:"gradient",gradientColors:["#8a2be2","#4b0082","#9370db","#00ffff","#00bfff"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"semibold",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:Go},Ko=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"16px",boxShadow:"0 10px 15px -3px rgba(59, 130, 246, 0.3), 0 4px 6px -2px rgba(59, 130, 246, 0.1)",border:"none"};return e.jsx(ue,{title:"Modern Blue",content:"Contemporary gradient design",style:n,isSelected:t,onClick:s,className:a})},qo={id:"modern-blue",name:"Modern Blue",category:"business",description:"Contemporary blue gradient with professional appeal",style:{type:"gradient",gradientColors:["#3b82f6","#1d4ed8","#1e40af"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"lg",borderWidth:0},previewComponent:Ko},Jo=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab)",backgroundSize:"400% 400%",color:"#ffffff",fontFamily:'"Poppins", system-ui, sans-serif',fontSize:"14px",fontWeight:"600",borderRadius:"16px",boxShadow:"0 15px 30px -10px rgba(0, 0, 0, 0.25)",border:"none",position:"relative",overflow:"hidden"};return e.jsx("div",{className:"relative",children:e.jsx(ue,{title:"Moving Gradient",content:"Flowing color effect",style:n,isSelected:t,onClick:s,className:`${a} moving-gradient-animation`})})},Qo={id:"moving-gradient",name:"Moving Gradient",category:"creative",description:"Colorful gradient with flowing animation effect",style:{type:"gradient",gradientColors:["#ee7752","#e73c7e","#23a6d5","#23d5ab"],gradientDirection:"to-br",fontFamily:"Poppins",fontSize:"base",fontWeight:"semibold",textColor:"#ffffff",borderRadius:"xl",shadow:"xl",borderWidth:0},previewComponent:Jo},Xo=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(90deg, #34d399 0%, #0d9488 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"20px",boxShadow:"0 10px 15px -3px rgba(52, 211, 153, 0.3), 0 4px 6px -2px rgba(13, 148, 136, 0.1)",border:"1px solid rgba(52, 211, 153, 0.3)"};return e.jsx(ue,{title:"Ocean Breeze",content:"Fresh and refreshing",style:n,isSelected:t,onClick:s,className:a})},Zo={id:"ocean-breeze",name:"Ocean Breeze",category:"natural",description:"Fresh emerald to teal gradient with tropical vibes",style:{type:"gradient",gradientColors:["#34d399","#0d9488"],gradientDirection:"to-r",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"lg",borderWidth:1,borderColor:"rgba(52, 211, 153, 0.3)"},previewComponent:Xo},ei=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(90deg, #fda4af 0%, #f87171 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"500",borderRadius:"20px",boxShadow:"0 10px 15px -3px rgba(253, 164, 175, 0.3), 0 4px 6px -2px rgba(248, 113, 113, 0.1)",border:"1px solid rgba(253, 164, 175, 0.3)"};return e.jsx(ue,{title:"Soft Pink",content:"Gentle and soothing",style:n,isSelected:t,onClick:s,className:a})},ti={id:"soft-pink",name:"Soft Pink",category:"natural",description:"Warm pink to red gradient with romantic tones",style:{type:"gradient",gradientColors:["#fda4af","#f87171"],gradientDirection:"to-r",fontFamily:"system-ui",fontSize:"base",fontWeight:"medium",textColor:"#ffffff",borderRadius:"2xl",shadow:"lg",borderWidth:1,borderColor:"rgba(253, 164, 175, 0.3)"},previewComponent:ei},si=({isSelected:t,onClick:s,className:a})=>{const n={background:"linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%)",color:"#ffffff",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",fontWeight:"600",borderRadius:"18px",boxShadow:"0 25px 50px -12px rgba(255, 126, 95, 0.25), 0 0 0 1px rgba(255, 126, 95, 0.1)",border:"none"};return e.jsx(ue,{title:"Warm Orange",content:"Energetic and vibrant",style:n,isSelected:t,onClick:s,className:a})},ai={id:"warm-orange",name:"Warm Orange",category:"creative",description:"Energetic warm orange gradient with peachy tones",style:{type:"gradient",gradientColors:["#ff7e5f","#feb47b"],gradientDirection:"to-br",fontFamily:"system-ui",fontSize:"base",fontWeight:"semibold",textColor:"#ffffff",borderRadius:"2xl",shadow:"2xl",borderWidth:0},previewComponent:si};class Ue{static instance;presets=new Map;categories=new Map;constructor(){this.initializeCategories()}static getInstance(){return Ue.instance||(Ue.instance=new Ue),Ue.instance}initializeCategories(){["business","creative","natural","personality"].forEach(a=>{this.categories.set(a,[])})}register(s){this.presets.set(s.id,s);const a=this.categories.get(s.category)||[];a.push(s),this.categories.set(s.category,a)}unregister(s){const a=this.presets.get(s);if(a){this.presets.delete(s);const r=(this.categories.get(a.category)||[]).filter(o=>o.id!==s);this.categories.set(a.category,r)}}getByCategory(s){return this.categories.get(s)||[]}getById(s){return this.presets.get(s)}getAll(){return Array.from(this.presets.values())}getAllByOrder(){const s=[];return["business","creative","natural","personality"].forEach(n=>{const r=this.getByCategory(n);s.push(...r)}),s}getCategoryCount(s){return this.categories.get(s)?.length||0}getTotalCount(){return this.presets.size}clear(){this.presets.clear(),this.initializeCategories()}}const hs=Ue.getInstance(),ni=()=>hs.getAllByOrder();class We{static instance;STORAGE_KEYS={USER_PREFERENCES:"cardall_style_preferences",RECENT_STYLES:"cardall_recent_styles",DEFAULT_STYLE:"cardall_default_style"};constructor(){}static getInstance(){return We.instance||(We.instance=new We),We.instance}saveUserPreference(s,a){try{const n=this.getUserPreferences();n[s]={styleId:a,appliedAt:new Date().toISOString()},localStorage.setItem(this.STORAGE_KEYS.USER_PREFERENCES,JSON.stringify(n)),this.addToRecentStyles(a)}catch(n){console.error("Failed to save user style preference:",n)}}getUserPreference(s){try{return this.getUserPreferences()[s]?.styleId||null}catch(a){return console.error("Failed to get user style preference:",a),null}}getRecentStyles(s=10){try{const a=localStorage.getItem(this.STORAGE_KEYS.RECENT_STYLES);return a?JSON.parse(a).slice(0,s):[]}catch(a){return console.error("Failed to get recent styles:",a),[]}}clearPreferences(){try{localStorage.removeItem(this.STORAGE_KEYS.USER_PREFERENCES),localStorage.removeItem(this.STORAGE_KEYS.RECENT_STYLES)}catch(s){console.error("Failed to clear style preferences:",s)}}setDefaultStyle(s){try{localStorage.setItem(this.STORAGE_KEYS.DEFAULT_STYLE,s)}catch(a){console.error("Failed to set default style:",a)}}getDefaultStyle(){try{return localStorage.getItem(this.STORAGE_KEYS.DEFAULT_STYLE)}catch(s){return console.error("Failed to get default style:",s),null}}getUserPreferences(){try{const s=localStorage.getItem(this.STORAGE_KEYS.USER_PREFERENCES);return s?JSON.parse(s):{}}catch(s){return console.error("Failed to parse user preferences:",s),{}}}addToRecentStyles(s){try{const n=this.getRecentStyles().filter(o=>o!==s),r=[s,...n].slice(0,10);localStorage.setItem(this.STORAGE_KEYS.RECENT_STYLES,JSON.stringify(r))}catch(a){console.error("Failed to update recent styles:",a)}}getStyleUsageStats(){try{const s=this.getUserPreferences(),a={};return Object.values(s).forEach(({styleId:n})=>{a[n]=(a[n]||0)+1}),a}catch(s){return console.error("Failed to get style usage stats:",s),{}}}getMostUsedStyles(s=5){try{const a=this.getStyleUsageStats();return Object.entries(a).sort(([,n],[,r])=>r-n).slice(0,s).map(([n])=>n)}catch(a){return console.error("Failed to get most used styles:",a),[]}}}const Ss=We.getInstance(),ri=()=>{const t=[Io,qo,Oo,ai,Bo,ti,Zo,Lo,Ho,Wo,Yo,Qo];t.forEach(s=>{hs.register(s)}),console.log(`Registered ${t.length} card style presets`)};ri();const oi=({isOpen:t,onClose:s,context:a})=>{const[n,r]=d.useState(null),[o,i]=d.useState([]);d.useEffect(()=>{const h=ni();console.log("Loaded style presets:",h.length,h),i(h);const m=Ss.getUserPreference(a.targetCardId);m&&r(m)},[a.targetCardId]);const l=h=>{const m=hs.getById(h);m&&(r(h),a.onStyleApply(m.style),Ss.saveUserPreference(a.targetCardId,h))},u=()=>{r(null),s()};return t?e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.1)",backdropFilter:"blur(2px)"},children:[e.jsx("div",{className:"absolute inset-0",onClick:u}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl border border-gray-200 p-6 w-full max-w-md sm:max-w-2xl lg:max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Card Styles"}),e.jsx("button",{onClick:u,className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(Ie,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3 mb-6",style:{minHeight:"300px",maxHeight:"70vh",overflowY:"auto"},children:o.map(h=>{const m=h.previewComponent;return console.log("Rendering preset:",h.id,h.name,m),e.jsxs("div",{className:"relative",children:[e.jsx(m,{isSelected:n===h.id,onClick:()=>l(h.id),className:"w-full"}),e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 truncate",children:h.name}),e.jsx("div",{className:"text-xs text-gray-500 capitalize",children:h.category})]})]},h.id)})}),e.jsxs("div",{className:"text-xs text-gray-400 text-center mb-2",children:["Loaded ",o.length," presets"]}),e.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Click any style to apply it instantly to your card"})]})]}):null},Ga=d.createContext(void 0),ii=()=>{const t=d.useContext(Ga);if(!t)throw new Error("useStylePanel must be used within a StylePanelProvider");return t},li=({children:t})=>{const[s,a]=d.useState({isOpen:!1,context:null}),n=i=>{a({isOpen:!0,context:i})},r=()=>{a({isOpen:!1,context:null})},o={openStylePanel:n,closeStylePanel:r,isOpen:s.isOpen};return e.jsxs(Ga.Provider,{value:o,children:[t,typeof window<"u"&&s.isOpen&&s.context&&Dt.createPortal(e.jsx(oi,{isOpen:s.isOpen,onClose:r,context:s.context}),document.body)]})},Ya=d.createContext(void 0);function ci({children:t}){const[s,a]=d.useState(!1),[n,r]=d.useState(null),[o,i]=d.useState([]),[l,u]=d.useState(null),y={isOpen:s,currentCardId:n,currentCardTags:o,onTagsChange:l,openTagPanel:x=>{r(x.targetCardId),i(x.currentTags),u(()=>x.onTagsApply),a(!0)},closeTagPanel:()=>{a(!1),r(null),i([]),u(null)}};return e.jsx(Ya.Provider,{value:y,children:t})}function Ka(){const t=d.useContext(Ya);if(t===void 0)throw new Error("useTagPanel must be used within a TagPanelProvider");return t}const ie=d.forwardRef(({className:t,type:s,...a},n)=>e.jsx("input",{type:s,className:S("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...a}));ie.displayName="Input";const He=d.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(Ks,{ref:n,className:S("relative overflow-hidden",t),...a,children:[e.jsx(Jn,{className:"h-full w-full rounded-[inherit]",children:s}),e.jsx(qa,{}),e.jsx(Qn,{})]}));He.displayName=Ks.displayName;const qa=d.forwardRef(({className:t,orientation:s="vertical",...a},n)=>e.jsx(qs,{ref:n,orientation:s,className:S("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...a,children:e.jsx(Xn,{className:"relative flex-1 rounded-full bg-border"})}));qa.displayName=qs.displayName;const di=_t("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function G({className:t,variant:s,...a}){return e.jsx("div",{className:S(di({variant:s}),t),...a})}const Pe=tr,mi=Zn,Ja=d.forwardRef(({className:t,...s},a)=>e.jsx(Js,{ref:a,className:S("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));Ja.displayName=Js.displayName;const Te=d.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(mi,{children:[e.jsx(Ja,{}),e.jsxs(Qs,{ref:n,className:S("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a,children:[s,e.jsxs(er,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Te.displayName=Qs.displayName;const Je=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});Je.displayName="DialogHeader";const Qe=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Qe.displayName="DialogFooter";const Xe=d.forwardRef(({className:t,...s},a)=>e.jsx(Xs,{ref:a,className:S("text-lg font-semibold leading-none tracking-tight",t),...s}));Xe.displayName=Xs.displayName;const At=d.forwardRef(({className:t,...s},a)=>e.jsx(Zs,{ref:a,className:S("text-sm text-muted-foreground",t),...s}));At.displayName=Zs.displayName;function ui({isOpen:t,onClose:s,currentCardId:a,currentFolderId:n,onFolderSelect:r}){const{folders:o,getFolderById:i}=Ba(),[l,u]=d.useState(""),[h,m]=d.useState(n);d.useEffect(()=>{t&&(m(n),u(""))},[t,n]);const y=o.filter(g=>g.name.toLowerCase().includes(l.toLowerCase())),x=n?i(n):null,c=g=>{m(g)},w=()=>{r&&r(h),s()},b=()=>{m(n),s()},f=h!==n;return e.jsx(Pe,{open:t,onOpenChange:s,children:e.jsxs(Te,{className:"sm:max-w-md",children:[e.jsx(Je,{children:e.jsxs(Xe,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5"}),"Move Card to Folder"]})}),e.jsxs("div",{className:"space-y-4",children:[x&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(Ma,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Currently in:"}),e.jsx(G,{variant:"secondary",children:x.name})]}),!x&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg",children:[e.jsx(ys,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Currently in: Root"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{placeholder:"Search folders...",value:l,onChange:g=>u(g.target.value),className:"pl-10"})]}),e.jsx(He,{className:"h-64 w-full border rounded-md",children:e.jsxs("div",{className:"p-2 space-y-1",children:[e.jsxs("div",{className:S("flex items-center gap-3 p-2 rounded-md cursor-pointer transition-colors",h===null?"bg-primary text-primary-foreground":"hover:bg-muted"),onClick:()=>c(null),children:[e.jsx(ys,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"flex-1",children:"Root"}),h===null&&e.jsx(ke,{className:"h-4 w-4 flex-shrink-0"}),n===null&&e.jsx(G,{variant:"outline",className:"text-xs",children:"Current"})]}),y.map(g=>e.jsxs("div",{className:S("flex items-center gap-3 p-2 rounded-md cursor-pointer transition-colors",h===g.id?"bg-primary text-primary-foreground":"hover:bg-muted",n===g.id&&"opacity-60"),onClick:()=>c(g.id),children:[e.jsx(Se,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"flex-1",children:g.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{variant:"outline",className:"text-xs",children:g.cardIds.length}),h===g.id&&e.jsx(ke,{className:"h-4 w-4 flex-shrink-0"}),n===g.id&&e.jsx(G,{variant:"outline",className:"text-xs",children:"Current"})]})]},g.id)),y.length===0&&l&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Se,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No folders found"})]})]})})]}),e.jsxs(Qe,{children:[e.jsx(D,{variant:"outline",onClick:b,children:"Cancel"}),e.jsx(D,{onClick:w,disabled:!f,children:f?"Move Card":"No Change"})]})]})})}const Qa=d.createContext(void 0);function fi({children:t}){const[s,a]=d.useState(!1),[n,r]=d.useState(null),[o,i]=d.useState(null),[l,u]=d.useState(null),h=x=>{r(x.targetCardId),i(x.currentFolderId||null),u(()=>x.onFolderApply),a(!0)},m=()=>{a(!1),r(null),i(null),u(null)},y={isOpen:s,currentCardId:n,currentFolderId:o,onFolderSelect:l,openFolderPanel:h,closeFolderPanel:m};return e.jsxs(Qa.Provider,{value:y,children:[t,typeof window<"u"&&s&&n&&Dt.createPortal(e.jsx(ui,{isOpen:s,onClose:m,currentCardId:n,currentFolderId:o,onFolderSelect:l}),document.body)]})}function hi(){const t=d.useContext(Qa);if(t===void 0)throw new Error("useFolderPanel must be used within a FolderPanelProvider");return t}function gi({card:t,onFlip:s,onUpdate:a,onCopy:n,onScreenshot:r,onShare:o,onDelete:i,onMoveToFolder:l,className:u,size:h="md"}){const{openStylePanel:m}=ii(),{openTagPanel:y}=Ka(),{openFolderPanel:x}=hi(),c=(p,v)=>{a(p,{style:v,updatedAt:new Date})},w=()=>{m({targetCardId:t.id,currentStyle:t.style,onStyleApply:p=>c(t.id,p),onPanelClose:()=>{}})},b=(p,v)=>{const j=t.isFlipped?t.backContent:t.frontContent,k=t.isFlipped?"backContent":"frontContent";a(p,{[k]:{...j,tags:v,lastModified:new Date},updatedAt:new Date})},f=()=>{const p=t.isFlipped?t.backContent:t.frontContent;y({targetCardId:t.id,currentTags:p.tags,onTagsApply:v=>b(t.id,v),onPanelClose:()=>{}})},g=()=>{l&&x({targetCardId:t.id,currentFolderId:t.folderId,onFolderApply:p=>l(t.id,p),onPanelClose:()=>{}})};return e.jsx(Ao,{card:t,onFlip:s,onUpdate:a,onCopy:n,onScreenshot:r,onShare:o,onDelete:i,onStyleChange:w,onTagsChange:f,onMoveToFolder:l?g:void 0,className:u,size:h})}function pi({items:t,gap:s=16,minColumnWidth:a=280,maxColumns:n=5,breakpoints:r={sm:640,md:768,lg:1024,xl:1280,"2xl":1536}}){const o=d.useRef(null),[i,l]=d.useState(new Map),[u,h]=d.useState(0),[m,y]=d.useState({columns:1,gap:s,containerWidth:0}),x=d.useCallback(g=>{if(g===0)return 1;let p=n;g<r.sm?p=1:g<r.md?p=2:g<r.lg?p=3:g<r.xl&&(p=4);const v=g-s,j=Math.floor(v/(a+s));return Math.min(Math.max(1,j),p)},[s,a,n,r]),c=d.useCallback((g,p,v,j)=>{if(p===0||v===0)return{positions:new Map,totalHeight:0};const k=j*(p-1),_=v-k,N=Math.floor(_/p),F=new Array(p).fill(0),W=new Map;g.forEach(A=>{const E=F.indexOf(Math.min(...F)),U=E*(N+j),H=F[E];W.set(A.id,{x:U,y:H,width:N,height:A.height}),F[E]+=A.height+j});const Z=Math.max(...F)-j;return{positions:W,totalHeight:Z}},[]),w=d.useCallback(g=>{const p=g[0];if(!p)return;const v=p.contentRect.width,j=x(v);y(k=>({...k,columns:j,containerWidth:v}))},[x]);d.useEffect(()=>{const g=o.current;if(!g)return;const p=new ResizeObserver(v=>{w(v)});return p.observe(g),()=>{p.disconnect()}},[w]),d.useEffect(()=>{if(t.length===0||m.containerWidth===0){l(new Map),h(0);return}const{positions:g,totalHeight:p}=c(t,m.columns,m.containerWidth,s);l(g),h(p)},[t,m,s,c]);const b=d.useCallback(g=>i.get(g),[i]),f=d.useCallback((g,p)=>{const v=t.findIndex(N=>N.id===g);if(v===-1)return;const j=[...t];j[v]={...j[v],height:p};const{positions:k,totalHeight:_}=c(j,m.columns,m.containerWidth,s);l(k),h(_)},[t,m,s,c]);return{containerRef:o,positions:i,containerHeight:u,config:m,getItemPosition:b,updateItemHeight:f}}function xi({cards:t,onCardFlip:s,onCardUpdate:a,onCardCopy:n,onCardScreenshot:r,onCardShare:o,onCardDelete:i,onMoveToFolder:l,onCardStyleChange:u,cardSize:h="md",className:m,gap:y=16,enableVirtualization:x=!0,overscan:c=5}){const[w,b]=d.useState(new Map),[f,g]=d.useState(!1),[p,v]=d.useState(0),[j,k]=d.useState(0),_=d.useRef(new Map),N=d.useRef(null),F=d.useMemo(()=>[...t].sort((R,O)=>new Date(O.createdAt).getTime()-new Date(R.createdAt).getTime()),[t]),W=d.useCallback(R=>{const q={sm:.8,md:1,lg:1.3}[h],$=200*q,z=Math.min(Math.ceil(R.frontContent.title.length/25),3)*24*q,V=Math.min(Math.ceil(R.frontContent.text.length/40),8)*18*q,J=R.frontContent.images.length>0?120*q:0,I=R.frontContent.tags.length>0?32*q:0,M=32*q;return Math.round($+z+V+J+I+M)},[h]),Z=d.useMemo(()=>F.map(R=>({id:R.id,height:w.get(R.id)||W(R)})),[F,w,W]),A=d.useMemo(()=>({sm:{minColumnWidth:240,maxColumns:5},md:{minColumnWidth:280,maxColumns:4},lg:{minColumnWidth:320,maxColumns:3}})[h],[h]),{containerRef:E,positions:U,containerHeight:H,updateItemHeight:ee}=pi({items:Z,gap:y,...A,breakpoints:{sm:640,md:768,lg:1024,xl:1280,"2xl":1536}}),X=d.useMemo(()=>{if(!x||!N.current)return F;const R=N.current.clientHeight,O=p-c*100,q=p+R+c*100;return F.filter($=>{const z=U.get($.id);return z?z.y+z.height>=O&&z.y<=q:!0})},[F,U,p,x,c]);d.useCallback(R=>{x&&v(R.currentTarget.scrollTop)},[x]);const se=d.useCallback(R=>{const O=_.current.get(R);if(!O)return;const q=new ResizeObserver($=>{const z=$[0];if(z){const V=z.contentRect.height,J=w.get(R);Math.abs(V-(J||0))>3&&(b(I=>{const M=new Map(I);return M.set(R,V),M}),ee(R,V))}});return q.observe(O),()=>q.disconnect()},[w,ee]);d.useEffect(()=>{if(!f&&F.length>0){const R=new Map;F.forEach(O=>{R.set(O.id,W(O))}),b(R),g(!0)}},[F,W,f]),d.useEffect(()=>{const R=[];return X.forEach(O=>{const q=se(O.id);q&&R.push(q)}),()=>{R.forEach(O=>O())}},[X,se]);const fe=d.useCallback((R,O)=>{O?_.current.set(R,O):_.current.delete(R)},[]);return d.useEffect(()=>{N.current&&k(N.current.clientHeight)},[]),F.length===0?e.jsx("div",{className:"flex-1 flex items-center justify-center p-12",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-24 h-24 mx-auto rounded-full bg-muted flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"+"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"No cards yet"}),e.jsx("p",{className:"text-muted-foreground max-w-sm",children:"Create your first knowledge card to get started. Click the + button to begin."})]})]})}):e.jsx("div",{ref:E,className:S("relative w-full",m),style:{height:H},children:X.map(R=>{const O=U.get(R.id);return O?e.jsx("div",{ref:q=>fe(R.id,q),className:"absolute transition-all duration-300 ease-out",style:{transform:`translate3d(${O.x}px, ${O.y}px, 0)`,width:O.width,willChange:"transform"},children:e.jsx(gi,{card:R,onFlip:s,onUpdate:a,onCopy:n,onScreenshot:r,onShare:o,onDelete:i,onMoveToFolder:l,size:h,className:"w-full"})},R.id):null})})}const Xa=d.forwardRef(({className:t,...s},a)=>e.jsxs(ea,{ref:a,className:S("relative flex w-full touch-none select-none items-center",t),...s,children:[e.jsx(sr,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(ar,{className:"absolute h-full bg-primary"})}),e.jsx(nr,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Xa.displayName=ea.displayName;const bi=_t("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),le=d.forwardRef(({className:t,...s},a)=>e.jsx(ta,{ref:a,className:S(bi(),t),...s}));le.displayName=ta.displayName;const lt=d.forwardRef(({className:t,orientation:s="horizontal",decorative:a=!0,...n},r)=>e.jsx(sa,{ref:r,decorative:a,orientation:s,className:S("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));lt.displayName=sa.displayName;const yi=or,wi=ir,Za=d.forwardRef(({className:t,align:s="center",sideOffset:a=4,...n},r)=>e.jsx(rr,{children:e.jsx(aa,{ref:r,align:s,sideOffset:a,className:S("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));Za.displayName=aa.displayName;function ks(t){if(!t)return"";try{const s=new DOMParser().parseFromString(t,"text/html");s.querySelectorAll("img").forEach(i=>i.remove()),s.querySelectorAll("br").forEach(i=>{i.replaceWith(`
`)}),s.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, li, blockquote").forEach(i=>{i.insertAdjacentText("afterend",`
`)});let o=s.body.textContent||s.body.innerText||"";return o=o.replace(/[ \t]+/g," ").replace(/[ \t]*\n[ \t]*/g,`
`).replace(/\n{3,}/g,`

`).trim(),o}catch(s){return console.warn("Failed to parse HTML, falling back to regex cleanup:",s),t.replace(/<img[^>]*>/gi,"").replace(/<br\s*\/?>/gi,`
`).replace(/<\/?(p|div|h[1-6]|li|blockquote)[^>]*>/gi,`
`).replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/[ \t]+/g," ").replace(/[ \t]*\n[ \t]*/g,`
`).replace(/\n{3,}/g,`

`).trim()}}function vi(t,s){const a=ks(t),n=ks(s);return`${a}

${n}`}async function ji(t){try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(t),!0;{const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.left="-999999px",s.style.top="-999999px",document.body.appendChild(s),s.focus(),s.select();const a=document.execCommand("copy");return document.body.removeChild(s),a}}catch(s){return console.error("Failed to copy text to clipboard:",s),!1}}function Ci(t,s){return t[13]=1,t[14]=s>>8,t[15]=s&255,t[16]=s>>8,t[17]=s&255,t}const en=112,tn=72,sn=89,an=115;let qt;function Ni(){const t=new Int32Array(256);for(let s=0;s<256;s++){let a=s;for(let n=0;n<8;n++)a=a&1?3988292384^a>>>1:a>>>1;t[s]=a}return t}function Si(t){let s=-1;qt||(qt=Ni());for(let a=0;a<t.length;a++)s=qt[(s^t[a])&255]^s>>>8;return s^-1}function ki(t){const s=t.length-1;for(let a=s;a>=4;a--)if(t[a-4]===9&&t[a-3]===en&&t[a-2]===tn&&t[a-1]===sn&&t[a]===an)return a-3;return 0}function Ti(t,s,a=!1){const n=new Uint8Array(13);s*=39.3701,n[0]=en,n[1]=tn,n[2]=sn,n[3]=an,n[4]=s>>>24,n[5]=s>>>16,n[6]=s>>>8,n[7]=s&255,n[8]=n[4],n[9]=n[5],n[10]=n[6],n[11]=n[7],n[12]=1;const r=Si(n),o=new Uint8Array(4);if(o[0]=r>>>24,o[1]=r>>>16,o[2]=r>>>8,o[3]=r&255,a){const i=ki(t);return t.set(n,i),t.set(o,i+13),t}else{const i=new Uint8Array(4);i[0]=0,i[1]=0,i[2]=0,i[3]=9;const l=new Uint8Array(54);return l.set(t,0),l.set(i,33),l.set(n,37),l.set(o,50),l}}const Ei="AAlwSFlz",Di="AAAJcEhZ",_i="AAAACXBI";function Ri(t){let s=t.indexOf(Ei);return s===-1&&(s=t.indexOf(Di)),s===-1&&(s=t.indexOf(_i)),s}const nn="[modern-screenshot]",Ee=typeof window<"u",Ai=Ee&&"Worker"in window,Fi=Ee&&"atob"in window,Pi=Ee&&"btoa"in window,gs=Ee?window.navigator?.userAgent:"",rn=gs.includes("Chrome"),Et=gs.includes("AppleWebKit")&&!rn,ps=gs.includes("Firefox"),Ii=t=>t&&"__CONTEXT__"in t,Mi=t=>t.constructor.name==="CSSFontFaceRule",Li=t=>t.constructor.name==="CSSImportRule",be=t=>t.nodeType===1,pt=t=>typeof t.className=="object",on=t=>t.tagName==="image",zi=t=>t.tagName==="use",ft=t=>be(t)&&typeof t.style<"u"&&!pt(t),Oi=t=>t.nodeType===8,$i=t=>t.nodeType===3,Ke=t=>t.tagName==="IMG",Ft=t=>t.tagName==="VIDEO",Bi=t=>t.tagName==="CANVAS",Ui=t=>t.tagName==="TEXTAREA",Wi=t=>t.tagName==="INPUT",Vi=t=>t.tagName==="STYLE",Hi=t=>t.tagName==="SCRIPT",Gi=t=>t.tagName==="SELECT",Yi=t=>t.tagName==="SLOT",Ki=t=>t.tagName==="IFRAME",qi=(...t)=>console.warn(nn,...t);function Ji(t){const s=t?.createElement?.("canvas");return s&&(s.height=s.width=1),!!s&&"toDataURL"in s&&!!s.toDataURL("image/webp").includes("image/webp")}const is=t=>t.startsWith("data:");function ln(t,s){if(t.match(/^[a-z]+:\/\//i))return t;if(Ee&&t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i)||!Ee)return t;const a=Pt().implementation.createHTMLDocument(),n=a.createElement("base"),r=a.createElement("a");return a.head.appendChild(n),a.body.appendChild(r),s&&(n.href=s),r.href=t,r.href}function Pt(t){return(t&&be(t)?t?.ownerDocument:t)??window.document}const It="http://www.w3.org/2000/svg";function Qi(t,s,a){const n=Pt(a).createElementNS(It,"svg");return n.setAttributeNS(null,"width",t.toString()),n.setAttributeNS(null,"height",s.toString()),n.setAttributeNS(null,"viewBox",`0 0 ${t} ${s}`),n}function Xi(t,s){let a=new XMLSerializer().serializeToString(t);return s&&(a=a.replace(/[\u0000-\u0008\v\f\u000E-\u001F\uD800-\uDFFF\uFFFE\uFFFF]/gu,"")),`data:image/svg+xml;charset=utf-8,${encodeURIComponent(a)}`}function Zi(t,s){return new Promise((a,n)=>{const r=new FileReader;r.onload=()=>a(r.result),r.onerror=()=>n(r.error),r.onabort=()=>n(new Error(`Failed read blob to ${s}`)),r.readAsDataURL(t)})}const el=t=>Zi(t,"dataUrl");function Ge(t,s){const a=Pt(s).createElement("img");return a.decoding="sync",a.loading="eager",a.src=t,a}function ht(t,s){return new Promise(a=>{const{timeout:n,ownerDocument:r,onError:o,onWarn:i}=s??{},l=typeof t=="string"?Ge(t,Pt(r)):t;let u=null,h=null;function m(){a(l),u&&clearTimeout(u),h?.()}if(n&&(u=setTimeout(m,n)),Ft(l)){const y=l.currentSrc||l.src;if(!y)return l.poster?ht(l.poster,s).then(a):m();if(l.readyState>=2)return m();const x=m,c=w=>{i?.("Failed video load",y,w),o?.(w),m()};h=()=>{l.removeEventListener("loadeddata",x),l.removeEventListener("error",c)},l.addEventListener("loadeddata",x,{once:!0}),l.addEventListener("error",c,{once:!0})}else{const y=on(l)?l.href.baseVal:l.currentSrc||l.src;if(!y)return m();const x=async()=>{if(Ke(l)&&"decode"in l)try{await l.decode()}catch(w){i?.("Failed to decode image, trying to render anyway",l.dataset.originalSrc||y,w)}m()},c=w=>{i?.("Failed image load",l.dataset.originalSrc||y,w),m()};if(Ke(l)&&l.complete)return x();h=()=>{l.removeEventListener("load",x),l.removeEventListener("error",c)},l.addEventListener("load",x,{once:!0}),l.addEventListener("error",c,{once:!0})}})}async function tl(t,s){ft(t)&&(Ke(t)||Ft(t)?await ht(t,s):await Promise.all(["img","video"].flatMap(a=>Array.from(t.querySelectorAll(a)).map(n=>ht(n,s)))))}const cn=function(){let s=0;const a=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(s+=1,`u${a()}${s}`)}();function dn(t){return t?.split(",").map(s=>s.trim().replace(/"|'/g,"").toLowerCase()).filter(Boolean)}let Ts=0;function sl(t){const s=`${nn}[#${Ts}]`;return Ts++,{time:a=>t&&console.time(`${s} ${a}`),timeEnd:a=>t&&console.timeEnd(`${s} ${a}`),warn:(...a)=>t&&qi(...a)}}function al(t){return{cache:t?"no-cache":"force-cache"}}async function Mt(t,s){return Ii(t)?t:nl(t,{...s,autoDestruct:!0})}async function nl(t,s){const{scale:a=1,workerUrl:n,workerNumber:r=1}=s||{},o=!!s?.debug,i=s?.features??!0,l=t.ownerDocument??(Ee?window.document:void 0),u=t.ownerDocument?.defaultView??(Ee?window:void 0),h=new Map,m={width:0,height:0,quality:1,type:"image/png",scale:a,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:o,fetch:{requestInit:al(s?.fetch?.bypassingCache),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1,...s?.fetch},fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:r,onCloneEachNode:null,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1,...s,__CONTEXT__:!0,log:sl(o),node:t,ownerDocument:l,ownerWindow:u,dpi:a===1?null:96*a,svgStyleElement:mn(l),svgDefsElement:l?.createElementNS(It,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...Array.from({length:Ai&&n&&r?r:0})].map(()=>{try{const c=new Worker(n);return c.onmessage=async w=>{const{url:b,result:f}=w.data;f?h.get(b)?.resolve?.(f):h.get(b)?.reject?.(new Error(`Error receiving message from worker: ${b}`))},c.onmessageerror=w=>{const{url:b}=w.data;h.get(b)?.reject?.(new Error(`Error receiving message from worker: ${b}`))},c}catch(c){return m.log.warn("Failed to new Worker",c),null}}).filter(Boolean),fontFamilies:new Map,fontCssTexts:new Map,acceptOfImage:`${[Ji(l)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(",")};q=0.8`,requests:h,drawImageCount:0,tasks:[],features:i,isEnable:c=>c==="restoreScrollPosition"?typeof i=="boolean"?!1:i[c]??!1:typeof i=="boolean"?i:i[c]??!0,shadowRoots:[]};m.log.time("wait until load"),await tl(t,{timeout:m.timeout,onWarn:m.log.warn}),m.log.timeEnd("wait until load");const{width:y,height:x}=rl(t,m);return m.width=y,m.height=x,m}function mn(t){if(!t)return;const s=t.createElement("style"),a=s.ownerDocument.createTextNode(`
.______background-clip--text {
  background-clip: text;
  -webkit-background-clip: text;
}
`);return s.appendChild(a),s}function rl(t,s){let{width:a,height:n}=s;if(be(t)&&(!a||!n)){const r=t.getBoundingClientRect();a=a||r.width||Number(t.getAttribute("width"))||0,n=n||r.height||Number(t.getAttribute("height"))||0}return{width:a,height:n}}async function ol(t,s){const{log:a,timeout:n,drawImageCount:r,drawImageInterval:o}=s;a.time("image to canvas");const i=await ht(t,{timeout:n,onWarn:s.log.warn}),{canvas:l,context2d:u}=il(t.ownerDocument,s),h=()=>{try{u?.drawImage(i,0,0,l.width,l.height)}catch(m){s.log.warn("Failed to drawImage",m)}};if(h(),s.isEnable("fixSvgXmlDecode"))for(let m=0;m<r;m++)await new Promise(y=>{setTimeout(()=>{u?.clearRect(0,0,l.width,l.height),h(),y()},m+o)});return s.drawImageCount=0,a.timeEnd("image to canvas"),l}function il(t,s){const{width:a,height:n,scale:r,backgroundColor:o,maximumCanvasSize:i}=s,l=t.createElement("canvas");l.width=Math.floor(a*r),l.height=Math.floor(n*r),l.style.width=`${a}px`,l.style.height=`${n}px`,i&&(l.width>i||l.height>i)&&(l.width>i&&l.height>i?l.width>l.height?(l.height*=i/l.width,l.width=i):(l.width*=i/l.height,l.height=i):l.width>i?(l.height*=i/l.width,l.width=i):(l.width*=i/l.height,l.height=i));const u=l.getContext("2d");return u&&o&&(u.fillStyle=o,u.fillRect(0,0,l.width,l.height)),{canvas:l,context2d:u}}function un(t,s){if(t.ownerDocument)try{const o=t.toDataURL();if(o!=="data:,")return Ge(o,t.ownerDocument)}catch(o){s.log.warn("Failed to clone canvas",o)}const a=t.cloneNode(!1),n=t.getContext("2d"),r=a.getContext("2d");try{return n&&r&&r.putImageData(n.getImageData(0,0,t.width,t.height),0,0),a}catch(o){s.log.warn("Failed to clone canvas",o)}return a}function ll(t,s){try{if(t?.contentDocument?.body)return xs(t.contentDocument.body,s)}catch(a){s.log.warn("Failed to clone iframe",a)}return t.cloneNode(!1)}function cl(t){const s=t.cloneNode(!1);return t.currentSrc&&t.currentSrc!==t.src&&(s.src=t.currentSrc,s.srcset=""),s.loading==="lazy"&&(s.loading="eager"),s}async function dl(t,s){if(t.ownerDocument&&!t.currentSrc&&t.poster)return Ge(t.poster,t.ownerDocument);const a=t.cloneNode(!1);a.crossOrigin="anonymous",t.currentSrc&&t.currentSrc!==t.src&&(a.src=t.currentSrc);const n=a.ownerDocument;if(n){let r=!0;if(await ht(a,{onError:()=>r=!1,onWarn:s.log.warn}),!r)return t.poster?Ge(t.poster,t.ownerDocument):a;a.currentTime=t.currentTime,await new Promise(i=>{a.addEventListener("seeked",i,{once:!0})});const o=n.createElement("canvas");o.width=t.offsetWidth,o.height=t.offsetHeight;try{const i=o.getContext("2d");i&&i.drawImage(a,0,0,o.width,o.height)}catch(i){return s.log.warn("Failed to clone video",i),t.poster?Ge(t.poster,t.ownerDocument):a}return un(o,s)}return a}function ml(t,s){return Bi(t)?un(t,s):Ki(t)?ll(t,s):Ke(t)?cl(t):Ft(t)?dl(t,s):t.cloneNode(!1)}function ul(t){let s=t.sandbox;if(!s){const{ownerDocument:a}=t;try{a&&(s=a.createElement("iframe"),s.id=`__SANDBOX__${cn()}`,s.width="0",s.height="0",s.style.visibility="hidden",s.style.position="fixed",a.body.appendChild(s),s.srcdoc='<!DOCTYPE html><meta charset="UTF-8"><title></title><body>',t.sandbox=s)}catch(n){t.log.warn("Failed to getSandBox",n)}}return s}const fl=["width","height","-webkit-text-fill-color"],hl=["stroke","fill"];function fn(t,s,a){const{defaultComputedStyles:n}=a,r=t.nodeName.toLowerCase(),o=pt(t)&&r!=="svg",i=o?hl.map(b=>[b,t.getAttribute(b)]).filter(([,b])=>b!==null):[],l=[o&&"svg",r,i.map((b,f)=>`${b}=${f}`).join(","),s].filter(Boolean).join(":");if(n.has(l))return n.get(l);const h=ul(a)?.contentWindow;if(!h)return new Map;const m=h?.document;let y,x;o?(y=m.createElementNS(It,"svg"),x=y.ownerDocument.createElementNS(y.namespaceURI,r),i.forEach(([b,f])=>{x.setAttributeNS(null,b,f)}),y.appendChild(x)):y=x=m.createElement(r),x.textContent=" ",m.body.appendChild(y);const c=h.getComputedStyle(x,s),w=new Map;for(let b=c.length,f=0;f<b;f++){const g=c.item(f);fl.includes(g)||w.set(g,c.getPropertyValue(g))}return m.body.removeChild(y),n.set(l,w),w}function hn(t,s,a){const n=new Map,r=[],o=new Map;if(a)for(const l of a)i(l);else for(let l=t.length,u=0;u<l;u++){const h=t.item(u);i(h)}for(let l=r.length,u=0;u<l;u++)o.get(r[u])?.forEach((h,m)=>n.set(m,h));function i(l){const u=t.getPropertyValue(l),h=t.getPropertyPriority(l),m=l.lastIndexOf("-"),y=m>-1?l.substring(0,m):void 0;if(y){let x=o.get(y);x||(x=new Map,o.set(y,x)),x.set(l,[u,h])}s.get(l)===u&&!h||(y?r.push(y):n.set(l,[u,h]))}return n}function gl(t,s,a,n){const{ownerWindow:r,includeStyleProperties:o,currentParentNodeStyle:i}=n,l=s.style,u=r.getComputedStyle(t),h=fn(t,null,n);i?.forEach((y,x)=>{h.delete(x)});const m=hn(u,h,o);m.delete("transition-property"),m.delete("all"),m.delete("d"),m.delete("content"),a&&(m.delete("margin-top"),m.delete("margin-right"),m.delete("margin-bottom"),m.delete("margin-left"),m.delete("margin-block-start"),m.delete("margin-block-end"),m.delete("margin-inline-start"),m.delete("margin-inline-end"),m.set("box-sizing",["border-box",""])),m.get("background-clip")?.[0]==="text"&&s.classList.add("______background-clip--text"),rn&&(m.has("font-kerning")||m.set("font-kerning",["normal",""]),(m.get("overflow-x")?.[0]==="hidden"||m.get("overflow-y")?.[0]==="hidden")&&m.get("text-overflow")?.[0]==="ellipsis"&&t.scrollWidth===t.clientWidth&&m.set("text-overflow",["clip",""]));for(let y=l.length,x=0;x<y;x++)l.removeProperty(l.item(x));return m.forEach(([y,x],c)=>{l.setProperty(c,y,x)}),m}function pl(t,s){(Ui(t)||Wi(t)||Gi(t))&&s.setAttribute("value",t.value)}const xl=[":before",":after"],bl=[":-webkit-scrollbar",":-webkit-scrollbar-button",":-webkit-scrollbar-thumb",":-webkit-scrollbar-track",":-webkit-scrollbar-track-piece",":-webkit-scrollbar-corner",":-webkit-resizer"];function yl(t,s,a,n,r){const{ownerWindow:o,svgStyleElement:i,svgStyles:l,currentNodeStyle:u}=n;if(!i||!o)return;function h(m){const y=o.getComputedStyle(t,m);let x=y.getPropertyValue("content");if(!x||x==="none")return;r?.(x),x=x.replace(/(')|(")|(counter\(.+\))/g,"");const c=[cn()],w=fn(t,m,n);u?.forEach((v,j)=>{w.delete(j)});const b=hn(y,w,n.includeStyleProperties);b.delete("content"),b.delete("-webkit-locale"),b.get("background-clip")?.[0]==="text"&&s.classList.add("______background-clip--text");const f=[`content: '${x}';`];if(b.forEach(([v,j],k)=>{f.push(`${k}: ${v}${j?" !important":""};`)}),f.length===1)return;try{s.className=[s.className,...c].join(" ")}catch(v){n.log.warn("Failed to copyPseudoClass",v);return}const g=f.join(`
  `);let p=l.get(g);p||(p=[],l.set(g,p)),p.push(`.${c[0]}:${m}`)}xl.forEach(h),a&&bl.forEach(h)}const Es=new Set(["symbol"]);async function Ds(t,s,a,n,r){if(be(a)&&(Vi(a)||Hi(a))||n.filter&&!n.filter(a))return;Es.has(s.nodeName)||Es.has(a.nodeName)?n.currentParentNodeStyle=void 0:n.currentParentNodeStyle=n.currentNodeStyle;const o=await xs(a,n,!1,r);n.isEnable("restoreScrollPosition")&&wl(t,o),s.appendChild(o)}async function _s(t,s,a,n){let r=t.firstChild;be(t)&&t.shadowRoot&&(r=t.shadowRoot?.firstChild,a.shadowRoots.push(t.shadowRoot));for(let o=r;o;o=o.nextSibling)if(!Oi(o))if(be(o)&&Yi(o)&&typeof o.assignedNodes=="function"){const i=o.assignedNodes();for(let l=0;l<i.length;l++)await Ds(t,s,i[l],a,n)}else await Ds(t,s,o,a,n)}function wl(t,s){if(!ft(t)||!ft(s))return;const{scrollTop:a,scrollLeft:n}=t;if(!a&&!n)return;const{transform:r}=s.style,o=new DOMMatrix(r),{a:i,b:l,c:u,d:h}=o;o.a=1,o.b=0,o.c=0,o.d=1,o.translateSelf(-n,-a),o.a=i,o.b=l,o.c=u,o.d=h,s.style.transform=o.toString()}function vl(t,s){const{backgroundColor:a,width:n,height:r,style:o}=s,i=t.style;if(a&&i.setProperty("background-color",a,"important"),n&&i.setProperty("width",`${n}px`,"important"),r&&i.setProperty("height",`${r}px`,"important"),o)for(const l in o)i[l]=o[l]}const jl=/^[\w-:]+$/;async function xs(t,s,a=!1,n){const{ownerDocument:r,ownerWindow:o,fontFamilies:i,onCloneEachNode:l}=s;if(r&&$i(t))return n&&/\S/.test(t.data)&&n(t.data),r.createTextNode(t.data);if(r&&o&&be(t)&&(ft(t)||pt(t))){const h=await ml(t,s);if(s.isEnable("removeAbnormalAttributes")){const b=h.getAttributeNames();for(let f=b.length,g=0;g<f;g++){const p=b[g];jl.test(p)||h.removeAttribute(p)}}const m=s.currentNodeStyle=gl(t,h,a,s);a&&vl(h,s);let y=!1;if(s.isEnable("copyScrollbar")){const b=[m.get("overflow-x")?.[0],m.get("overflow-y")?.[0]];y=b.includes("scroll")||(b.includes("auto")||b.includes("overlay"))&&(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)}const x=m.get("text-transform")?.[0],c=dn(m.get("font-family")?.[0]),w=c?b=>{x==="uppercase"?b=b.toUpperCase():x==="lowercase"?b=b.toLowerCase():x==="capitalize"&&(b=b[0].toUpperCase()+b.substring(1)),c.forEach(f=>{let g=i.get(f);g||i.set(f,g=new Set),b.split("").forEach(p=>g.add(p))})}:void 0;return yl(t,h,y,s,w),pl(t,h),Ft(t)||await _s(t,h,s,w),await l?.(h),h}const u=t.cloneNode(!1);return await _s(t,u,s),await l?.(u),u}function Cl(t){if(t.ownerDocument=void 0,t.ownerWindow=void 0,t.svgStyleElement=void 0,t.svgDefsElement=void 0,t.svgStyles.clear(),t.defaultComputedStyles.clear(),t.sandbox){try{t.sandbox.remove()}catch(s){t.log.warn("Failed to destroyContext",s)}t.sandbox=void 0}t.workers=[],t.fontFamilies.clear(),t.fontCssTexts.clear(),t.requests.clear(),t.tasks=[],t.shadowRoots=[]}function Nl(t){const{url:s,timeout:a,responseType:n,...r}=t,o=new AbortController,i=a?setTimeout(()=>o.abort(),a):void 0;return fetch(s,{signal:o.signal,...r}).then(l=>{if(!l.ok)throw new Error("Failed fetch, not 2xx response",{cause:l});switch(n){case"arrayBuffer":return l.arrayBuffer();case"dataUrl":return l.blob().then(el);case"text":default:return l.text()}}).finally(()=>clearTimeout(i))}function gt(t,s){const{url:a,requestType:n="text",responseType:r="text",imageDom:o}=s;let i=a;const{timeout:l,acceptOfImage:u,requests:h,fetchFn:m,fetch:{requestInit:y,bypassingCache:x,placeholderImage:c},font:w,workers:b,fontFamilies:f}=t;n==="image"&&(Et||ps)&&t.drawImageCount++;let g=h.get(a);if(!g){x&&x instanceof RegExp&&x.test(i)&&(i+=(/\?/.test(i)?"&":"?")+new Date().getTime());const p=n.startsWith("font")&&w&&w.minify,v=new Set;p&&n.split(";")[1].split(",").forEach(N=>{f.has(N)&&f.get(N).forEach(F=>v.add(F))});const j=p&&v.size,k={url:i,timeout:l,responseType:j?"arrayBuffer":r,headers:n==="image"?{accept:u}:void 0,...y};g={type:n,resolve:void 0,reject:void 0,response:null},g.response=(async()=>{if(m&&n==="image"){const _=await m(a);if(_)return _}return!Et&&a.startsWith("http")&&b.length?new Promise((_,N)=>{b[h.size&b.length-1].postMessage({rawUrl:a,...k}),g.resolve=_,g.reject=N}):Nl(k)})().catch(_=>{if(h.delete(a),n==="image"&&c)return t.log.warn("Failed to fetch image base64, trying to use placeholder image",i),typeof c=="string"?c:c(o);throw _}),h.set(a,g)}return g.response}async function gn(t,s,a,n){if(!pn(t))return t;for(const[r,o]of Sl(t,s))try{const i=await gt(a,{url:o,requestType:n?"image":"text",responseType:"dataUrl"});t=t.replace(kl(r),`$1${i}$3`)}catch(i){a.log.warn("Failed to fetch css data url",r,i)}return t}function pn(t){return/url\((['"]?)([^'"]+?)\1\)/.test(t)}const xn=/url\((['"]?)([^'"]+?)\1\)/g;function Sl(t,s){const a=[];return t.replace(xn,(n,r,o)=>(a.push([o,ln(o,s)]),n)),a.filter(([n])=>!is(n))}function kl(t){const s=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${s})(['"]?\\))`,"g")}const Tl=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function El(t,s){return Tl.map(a=>{const n=t.getPropertyValue(a);return!n||n==="none"?null:((Et||ps)&&s.drawImageCount++,gn(n,null,s,!0).then(r=>{!r||n===r||t.setProperty(a,r,t.getPropertyPriority(a))}))}).filter(Boolean)}function Dl(t,s){if(Ke(t)){const a=t.currentSrc||t.src;if(!is(a))return[gt(s,{url:a,imageDom:t,requestType:"image",responseType:"dataUrl"}).then(n=>{n&&(t.srcset="",t.dataset.originalSrc=a,t.src=n||"")})];(Et||ps)&&s.drawImageCount++}else if(pt(t)&&!is(t.href.baseVal)){const a=t.href.baseVal;return[gt(s,{url:a,imageDom:t,requestType:"image",responseType:"dataUrl"}).then(n=>{n&&(t.dataset.originalSrc=a,t.href.baseVal=n||"")})]}return[]}function _l(t,s){const{ownerDocument:a,svgDefsElement:n}=s,r=t.getAttribute("href")??t.getAttribute("xlink:href");if(!r)return[];const[o,i]=r.split("#");if(i){const l=`#${i}`,u=s.shadowRoots.reduce((h,m)=>h??m.querySelector(`svg ${l}`),a?.querySelector(`svg ${l}`));if(o&&t.setAttribute("href",l),n?.querySelector(l))return[];if(u)return n?.appendChild(u.cloneNode(!0)),[];if(o)return[gt(s,{url:o,responseType:"text"}).then(h=>{n?.insertAdjacentHTML("beforeend",h)})]}return[]}function bn(t,s){const{tasks:a}=s;be(t)&&((Ke(t)||on(t))&&a.push(...Dl(t,s)),zi(t)&&a.push(..._l(t,s))),ft(t)&&a.push(...El(t.style,s)),t.childNodes.forEach(n=>{bn(n,s)})}async function Rl(t,s){const{ownerDocument:a,svgStyleElement:n,fontFamilies:r,fontCssTexts:o,tasks:i,font:l}=s;if(!(!a||!n||!r.size))if(l&&l.cssText){const u=As(l.cssText,s);n.appendChild(a.createTextNode(`${u}
`))}else{const u=Array.from(a.styleSheets).filter(m=>{try{return"cssRules"in m&&!!m.cssRules.length}catch(y){return s.log.warn(`Error while reading CSS rules from ${m.href}`,y),!1}});await Promise.all(u.flatMap(m=>Array.from(m.cssRules).map(async(y,x)=>{if(Li(y)){let c=x+1;const w=y.href;let b="";try{b=await gt(s,{url:w,requestType:"text",responseType:"text"})}catch(g){s.log.warn(`Error fetch remote css import from ${w}`,g)}const f=b.replace(xn,(g,p,v)=>g.replace(v,ln(v,w)));for(const g of Fl(f))try{m.insertRule(g,g.startsWith("@import")?c+=1:m.cssRules.length)}catch(p){s.log.warn("Error inserting rule from remote css import",{rule:g,error:p})}}}))),u.flatMap(m=>Array.from(m.cssRules)).filter(m=>Mi(m)&&pn(m.style.getPropertyValue("src"))&&dn(m.style.getPropertyValue("font-family"))?.some(y=>r.has(y))).forEach(m=>{const y=m,x=o.get(y.cssText);x?n.appendChild(a.createTextNode(`${x}
`)):i.push(gn(y.cssText,y.parentStyleSheet?y.parentStyleSheet.href:null,s).then(c=>{c=As(c,s),o.set(y.cssText,c),n.appendChild(a.createTextNode(`${c}
`))}))})}}const Al=/(\/\*[\s\S]*?\*\/)/g,Rs=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi;function Fl(t){if(t==null)return[];const s=[];let a=t.replace(Al,"");for(;;){const o=Rs.exec(a);if(!o)break;s.push(o[0])}a=a.replace(Rs,"");const n=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,r=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let o=n.exec(a);if(o)r.lastIndex=n.lastIndex;else if(o=r.exec(a),o)n.lastIndex=r.lastIndex;else break;s.push(o[0])}return s}const Pl=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Il=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function As(t,s){const{font:a}=s,n=a?a?.preferredFormat:void 0;return n?t.replace(Il,r=>{for(;;){const[o,,i]=Pl.exec(r)||[];if(!i)return"";if(i===n)return`src: ${o};`}}):t}async function Ml(t,s){const a=await Mt(t,s);if(be(a.node)&&pt(a.node))return a.node;const{ownerDocument:n,log:r,tasks:o,svgStyleElement:i,svgDefsElement:l,svgStyles:u,font:h,progress:m,autoDestruct:y,onCloneNode:x,onEmbedNode:c,onCreateForeignObjectSvg:w}=a;r.time("clone node");const b=await xs(a.node,a,!0);if(i&&n){let j="";u.forEach((k,_)=>{j+=`${k.join(`,
`)} {
  ${_}
}
`}),i.appendChild(n.createTextNode(j))}r.timeEnd("clone node"),await x?.(b),h!==!1&&be(b)&&(r.time("embed web font"),await Rl(b,a),r.timeEnd("embed web font")),r.time("embed node"),bn(b,a);const f=o.length;let g=0;const p=async()=>{for(;;){const j=o.pop();if(!j)break;try{await j}catch(k){a.log.warn("Failed to run task",k)}m?.(++g,f)}};m?.(g,f),await Promise.all([...Array.from({length:4})].map(p)),r.timeEnd("embed node"),await c?.(b);const v=Ll(b,a);return l&&v.insertBefore(l,v.children[0]),i&&v.insertBefore(i,v.children[0]),y&&Cl(a),await w?.(v),v}function Ll(t,s){const{width:a,height:n}=s,r=Qi(a,n,t.ownerDocument),o=r.ownerDocument.createElementNS(r.namespaceURI,"foreignObject");return o.setAttributeNS(null,"x","0%"),o.setAttributeNS(null,"y","0%"),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.append(t),r.appendChild(o),r}async function zl(t,s){const a=await Mt(t,s),n=await Ml(a),r=Xi(n,a.isEnable("removeControlCharacter"));a.autoDestruct||(a.svgStyleElement=mn(a.ownerDocument),a.svgDefsElement=a.ownerDocument?.createElementNS(It,"defs"),a.svgStyles.clear());const o=Ge(r,n.ownerDocument);return await ol(o,a)}async function Ol(t,s){const a=await Mt(t,s),{log:n,quality:r,type:o,dpi:i}=a,l=await zl(a);n.time("canvas to data url");let u=l.toDataURL(o,r);if(["image/png","image/jpeg"].includes(o)&&i&&Fi&&Pi){const[h,m]=u.split(",");let y=0,x=!1;if(o==="image/png"){const v=Ri(m);v>=0?(y=Math.ceil((v+28)/3)*4,x=!0):y=33/3*4}else o==="image/jpeg"&&(y=18/3*4);const c=m.substring(0,y),w=m.substring(y),b=window.atob(c),f=new Uint8Array(b.length);for(let v=0;v<f.length;v++)f[v]=b.charCodeAt(v);const g=o==="image/png"?Ti(f,i,x):Ci(f,i),p=window.btoa(String.fromCharCode(...g));u=[h,",",p,w].join("")}return n.timeEnd("canvas to data url"),u}async function $l(t,s){return Ol(await Mt(t,{...s,type:"image/png"}))}function Bl(t,s=30){if(!t||t.trim()==="")return"untitled-card";let a=t.replace(/[^\w\s\u4e00-\u9fff\u3400-\u4dbf\u20000-\u2a6df\u2a700-\u2b73f\u2b740-\u2b81f\u2b820-\u2ceaf\uf900-\ufaff\u3300-\u33ff-]/g,"").replace(/\s+/g," ").trim();return a?(a.length>s&&(a=a.substring(0,s).trim()),a):"untitled-card"}async function Ul(t,s={}){const{quality:a=1,pixelRatio:n=2,backgroundColor:r="transparent",includeStyles:o=!0}=s;try{const i=await $l(t,{quality:a,pixelRatio:n,backgroundColor:r,style:o?void 0:{},filter:u=>{if(u instanceof HTMLElement){const h=u.classList;return!h.contains("tooltip")&&!h.contains("dropdown-menu")&&!h.contains("popover")}return!0}});return await(await fetch(i)).blob()}catch(i){throw console.error("Screenshot capture failed:",i),new Error("Failed to capture screenshot")}}function Wl(t,s){const a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=`${s}.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}async function Vl(t,s,a={}){const n=Bl(s);return{blob:await Ul(t,{quality:1,pixelRatio:2,backgroundColor:"transparent",...a}),fileName:n}}function Hl(t={}){const[s,a]=d.useState(!1),[n,r]=d.useState(!1),[o,i]=d.useState(null),[l,u]=d.useState(!1),[h,m]=d.useState(null),y=d.useCallback(async(b,f)=>{a(!0),m(null);try{const{blob:g,fileName:p}=await Vl(b,f),v=URL.createObjectURL(g);i({blob:g,fileName:p,previewUrl:v}),u(!0)}catch(g){const p=g instanceof Error?g:new Error("Screenshot failed");m(p.message),t.onError?.(p)}finally{a(!1)}},[t]),x=d.useCallback(async()=>{if(o){r(!0);try{await new Promise(b=>setTimeout(b,500)),Wl(o.blob,o.fileName),t.onSuccess?.(o.fileName),u(!1),setTimeout(()=>{o.previewUrl&&URL.revokeObjectURL(o.previewUrl),i(null)},100)}catch(b){const f=b instanceof Error?b:new Error("Download failed");m(f.message),t.onError?.(f)}finally{r(!1)}}},[o,t]),c=d.useCallback(()=>{u(!1),setTimeout(()=>{o?.previewUrl&&URL.revokeObjectURL(o.previewUrl),i(null)},100)},[o]),w=d.useCallback(()=>{m(null)},[]);return{isCapturing:s,isDownloading:n,showPreview:l,previewData:o,error:h,captureScreenshot:y,confirmDownload:x,cancelPreview:c,clearError:w}}function Gl({isOpen:t,onClose:s,onConfirm:a,previewUrl:n,fileName:r,isDownloading:o=!1}){const[i,l]=d.useState(!1),u=()=>{l(!0),setTimeout(()=>{a(),l(!1)},800)};return e.jsx(Pe,{open:t,onOpenChange:s,children:e.jsxs(Te,{className:"max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx(Je,{children:e.jsxs(Xe,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-5 w-5"}),"Screenshot Preview"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(G,{variant:"secondary",className:"font-mono text-xs",children:[r,".png"]}),e.jsx(G,{variant:"outline",className:"text-xs",children:"High Quality"})]})}),e.jsx("div",{className:"relative bg-checkered rounded-lg overflow-hidden border",children:n?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:n,alt:"Screenshot preview",className:S("w-full h-auto max-h-[60vh] object-contain transition-all duration-300",i&&"scale-95 opacity-80")}),i&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-purple-600/20 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-full p-6 shadow-lg animate-pulse",children:e.jsxs("div",{className:"relative",children:[e.jsx(mt,{className:"h-8 w-8 text-blue-600 animate-bounce"}),e.jsx(ws,{className:"h-4 w-4 text-purple-500 absolute -top-1 -right-1 animate-spin"})]})})})]}):e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(es,{className:"h-12 w-12 mx-auto opacity-50"}),e.jsx("p",{children:"Loading preview..."})]})})}),o&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-500 border-t-transparent"}),"Preparing download..."]})]}),e.jsxs(Qe,{className:"gap-2",children:[e.jsxs(D,{variant:"outline",onClick:s,disabled:i||o,children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsx(D,{onClick:u,disabled:i||o||!n,className:S("relative overflow-hidden",i&&"bg-gradient-to-r from-blue-500 to-purple-600"),children:i?e.jsxs(e.Fragment,{children:[e.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}),"Downloading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Download PNG"]})})]})]})})}const Yl=`
.bg-checkered {
  background-image: 
    linear-gradient(45deg, #f1f5f9 25%, transparent 25%), 
    linear-gradient(-45deg, #f1f5f9 25%, transparent 25%), 
    linear-gradient(45deg, transparent 75%, #f1f5f9 75%), 
    linear-gradient(-45deg, transparent 75%, #f1f5f9 75%);
  background-size: 20px 20px;
  background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
}
`;if(typeof document<"u"){const t=document.createElement("style");t.textContent=Yl,document.head.appendChild(t)}const Kl=1,ql=1e6;let Jt=0;function Jl(){return Jt=(Jt+1)%Number.MAX_SAFE_INTEGER,Jt.toString()}const Qt=new Map,Fs=t=>{if(Qt.has(t))return;const s=setTimeout(()=>{Qt.delete(t),ut({type:"REMOVE_TOAST",toastId:t})},ql);Qt.set(t,s)},Ql=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,Kl)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(a=>a.id===s.toast.id?{...a,...s.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=s;return a?Fs(a):t.toasts.forEach(n=>{Fs(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==s.toastId)}}},St=[];let kt={toasts:[]};function ut(t){kt=Ql(kt,t),St.forEach(s=>{s(kt)})}function Xl({...t}){const s=Jl(),a=r=>ut({type:"UPDATE_TOAST",toast:{...r,id:s}}),n=()=>ut({type:"DISMISS_TOAST",toastId:s});return ut({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:r=>{r||n()}}}),{id:s,dismiss:n,update:a}}function Zl(){const[t,s]=d.useState(kt);return d.useEffect(()=>(St.push(s),()=>{const a=St.indexOf(s);a>-1&&St.splice(a,1)}),[t]),{...t,toast:Xl,dismiss:a=>ut({type:"DISMISS_TOAST",toastId:a})}}const yn=d.forwardRef(({className:t,...s},a)=>e.jsx(na,{ref:a,className:S("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s}));yn.displayName=na.displayName;const wn=d.forwardRef(({className:t,...s},a)=>e.jsx(ra,{ref:a,className:S("aspect-square h-full w-full",t),...s}));wn.displayName=ra.displayName;const vn=d.forwardRef(({className:t,...s},a)=>e.jsx(oa,{ref:a,className:S("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...s}));vn.displayName=oa.displayName;const jn=["from-violet-500 to-pink-500","from-blue-500 to-purple-600","from-green-500 to-teal-600","from-orange-500 to-red-600","from-pink-500 to-rose-600","from-indigo-500 to-blue-600","from-yellow-500 to-orange-600","from-purple-500 to-pink-600","from-teal-500 to-green-600","from-red-500 to-pink-600","from-cyan-500 to-blue-600"];function ec(t){let s=0;for(let a=0;a<t.length;a++){const n=t.charCodeAt(a);s=(s<<5)-s+n,s=s&s}return Math.abs(s)%jn.length}function tc(t){return t?t.username?t.username.charAt(0).toUpperCase():t.email?t.email.charAt(0).toUpperCase():"?":"?"}function sc(t){return t&&(t.username||t.email)||"anonymous"}function Cn({user:t,size:s="md",className:a,onClick:n,showHoverEffect:r=!0}){const o=tc(t),i=sc(t),l=ec(i),u=jn[l],m=S({sm:"h-6 w-6 text-xs",md:"h-8 w-8 text-sm",lg:"h-10 w-10 text-base"}[s],r&&n&&"cursor-pointer transition-transform hover:scale-105",a),y=S("bg-gradient-to-br text-white font-semibold flex items-center justify-center",u,r&&n&&"transition-all duration-200 hover:shadow-md");return e.jsxs(yn,{className:m,onClick:n,children:[e.jsx(wn,{src:t?.avatar_url,alt:t?.username||t?.email||"User"}),e.jsx(vn,{className:y,children:o})]})}const Nn=cr,Sn=dr,ac=d.forwardRef(({className:t,inset:s,children:a,...n},r)=>e.jsxs(ia,{ref:r,className:S("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",s&&"pl-8",t),...n,children:[a,e.jsx(Rt,{className:"ml-auto h-4 w-4"})]}));ac.displayName=ia.displayName;const nc=d.forwardRef(({className:t,...s},a)=>e.jsx(la,{ref:a,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));nc.displayName=la.displayName;const bs=d.forwardRef(({className:t,...s},a)=>e.jsx(lr,{children:e.jsx(ca,{ref:a,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));bs.displayName=ca.displayName;const Ye=d.forwardRef(({className:t,inset:s,...a},n)=>e.jsx(da,{ref:n,className:S("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",t),...a}));Ye.displayName=da.displayName;const rc=d.forwardRef(({className:t,children:s,checked:a,...n},r)=>e.jsxs(ma,{ref:r,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:a,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ua,{children:e.jsx(ke,{className:"h-4 w-4"})})}),s]}));rc.displayName=ma.displayName;const oc=d.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(fa,{ref:n,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ua,{children:e.jsx(Aa,{className:"h-2 w-2 fill-current"})})}),s]}));oc.displayName=fa.displayName;const ic=d.forwardRef(({className:t,inset:s,...a},n)=>e.jsx(ha,{ref:n,className:S("px-2 py-1.5 text-sm font-semibold text-foreground",s&&"pl-8",t),...a}));ic.displayName=ha.displayName;const kn=d.forwardRef(({className:t,...s},a)=>e.jsx(ga,{ref:a,className:S("-mx-1 my-1 h-px bg-border",t),...s}));kn.displayName=ga.displayName;function Ps({children:t,folderId:s,folderName:a,onRename:n,onDelete:r,onCreateSubfolder:o,disabled:i=!1}){return i?e.jsx(e.Fragment,{children:t}):e.jsxs(Nn,{children:[e.jsx(Sn,{asChild:!0,children:t}),e.jsxs(bs,{className:"w-48",children:[e.jsxs(Ye,{onClick:()=>n(s),children:[e.jsx(La,{className:"h-4 w-4 mr-2"}),"Rename Folder"]}),e.jsxs(Ye,{onClick:()=>o(s),children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"New Subfolder"]}),e.jsx(kn,{}),e.jsxs(Ye,{onClick:()=>r(s),className:"text-destructive focus:text-destructive",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Delete Folder"]})]})]})}const lc=pr,cc=xr,Tn=d.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(pa,{ref:n,className:S("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...a,children:[s,e.jsx(mr,{asChild:!0,children:e.jsx(ms,{className:"h-4 w-4 opacity-50"})})]}));Tn.displayName=pa.displayName;const En=d.forwardRef(({className:t,...s},a)=>e.jsx(xa,{ref:a,className:S("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Rr,{className:"h-4 w-4"})}));En.displayName=xa.displayName;const Dn=d.forwardRef(({className:t,...s},a)=>e.jsx(ba,{ref:a,className:S("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(ms,{className:"h-4 w-4"})}));Dn.displayName=ba.displayName;const _n=d.forwardRef(({className:t,children:s,position:a="popper",...n},r)=>e.jsx(ur,{children:e.jsxs(ya,{ref:r,className:S("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...n,children:[e.jsx(En,{}),e.jsx(fr,{className:S("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Dn,{})]})}));_n.displayName=ya.displayName;const dc=d.forwardRef(({className:t,...s},a)=>e.jsx(wa,{ref:a,className:S("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));dc.displayName=wa.displayName;const Rn=d.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(va,{ref:n,className:S("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(hr,{children:e.jsx(ke,{className:"h-4 w-4"})})}),e.jsx(gr,{children:s})]}));Rn.displayName=va.displayName;const mc=d.forwardRef(({className:t,...s},a)=>e.jsx(ja,{ref:a,className:S("-mx-1 my-1 h-px bg-muted",t),...s}));mc.displayName=ja.displayName;const uc=[{value:"#3b82f6",label:"Blue"},{value:"#8b5cf6",label:"Purple"},{value:"#10b981",label:"Green"},{value:"#f59e0b",label:"Orange"},{value:"#ef4444",label:"Red"},{value:"#06b6d4",label:"Cyan"},{value:"#84cc16",label:"Lime"},{value:"#f97316",label:"Orange"}],Xt=[{value:"Folder",label:"Folder",icon:Se},{value:"Code",label:"Code",icon:Ar},{value:"Palette",label:"Design",icon:Pa},{value:"BookOpen",label:"Learning",icon:Fr},{value:"Star",label:"Favorites",icon:Pr},{value:"Heart",label:"Personal",icon:Ir},{value:"Zap",label:"Quick",icon:Mr},{value:"Target",label:"Goals",icon:Lr},{value:"Lightbulb",label:"Ideas",icon:zr},{value:"Coffee",label:"Work",icon:Or}];function fc({isOpen:t,onClose:s,onConfirm:a,parentId:n,initialData:r,mode:o="create"}){const[i,l]=d.useState(""),[u,h]=d.useState("#3b82f6"),[m,y]=d.useState("Folder");d.useEffect(()=>{t&&(r?(l(r.name),h(r.color),y(r.icon)):(l(""),h("#3b82f6"),y("Folder")))},[t]),d.useEffect(()=>{t&&r&&(l(r.name),h(r.color),y(r.icon))},[r,t]);const x=w=>{w.preventDefault(),i.trim()&&(a({name:i.trim(),color:u,icon:m,parentId:n}),s())},c=Xt.find(w=>w.value===m)?.icon||Se;return e.jsx(Pe,{open:t,onOpenChange:s,children:e.jsxs(Te,{className:"sm:max-w-md",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:o==="create"?"Create New Folder":"Edit Folder"}),e.jsx(At,{children:o==="create"?"Create a new folder to organize your cards.":"Update folder details."})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"folder-name",children:"Folder Name"}),e.jsx(ie,{id:"folder-name",value:i,onChange:w=>l(w.target.value),placeholder:"Enter folder name...",autoFocus:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{children:"Color"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:uc.map(w=>e.jsx("button",{type:"button",onClick:()=>h(w.value),className:`w-8 h-8 rounded-full border-2 transition-all ${u===w.value?"border-foreground scale-110":"border-muted hover:scale-105"}`,style:{backgroundColor:w.value},title:w.label},w.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{children:"Icon"}),e.jsxs(lc,{value:m,onValueChange:y,children:[e.jsx(Tn,{children:e.jsx(cc,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[T.createElement(c,{className:"h-4 w-4",style:{color:u}}),Xt.find(w=>w.value===m)?.label]})})}),e.jsx(_n,{children:Xt.map(w=>{const b=w.icon;return e.jsx(Rn,{value:w.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),w.label]})},w.value)})})]})]}),n&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(G,{variant:"secondary",children:"Subfolder"})}),e.jsxs(Qe,{children:[e.jsx(D,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsx(D,{type:"submit",disabled:!i.trim(),children:o==="create"?"Create Folder":"Save Changes"})]})]})]})})}const hc=yr,gc=br,An=d.forwardRef(({className:t,...s},a)=>e.jsx(Ca,{className:S("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:a}));An.displayName=Ca.displayName;const Fn=d.forwardRef(({className:t,...s},a)=>e.jsxs(gc,{children:[e.jsx(An,{}),e.jsx(Na,{ref:a,className:S("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s})]}));Fn.displayName=Na.displayName;const Pn=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col space-y-2 text-center sm:text-left",t),...s});Pn.displayName="AlertDialogHeader";const In=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});In.displayName="AlertDialogFooter";const Mn=d.forwardRef(({className:t,...s},a)=>e.jsx(Sa,{ref:a,className:S("text-lg font-semibold",t),...s}));Mn.displayName=Sa.displayName;const Ln=d.forwardRef(({className:t,...s},a)=>e.jsx(ka,{ref:a,className:S("text-sm text-muted-foreground",t),...s}));Ln.displayName=ka.displayName;const zn=d.forwardRef(({className:t,...s},a)=>e.jsx(Ta,{ref:a,className:S(fs(),t),...s}));zn.displayName=Ta.displayName;const On=d.forwardRef(({className:t,...s},a)=>e.jsx(Ea,{ref:a,className:S(fs({variant:"outline"}),"mt-2 sm:mt-0",t),...s}));On.displayName=Ea.displayName;function pc({isOpen:t,onClose:s,onConfirm:a,folderName:n,cardCount:r,hasSubfolders:o=!1,subfolderCount:i=0}){const l=()=>{a(),s()};return e.jsx(hc,{open:t,onOpenChange:s,children:e.jsxs(Fn,{children:[e.jsxs(Pn,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-5 w-5 text-destructive"}),e.jsx(Mn,{children:"Delete Folder"})]}),e.jsxs(Ln,{className:"space-y-3",children:[e.jsxs("p",{children:["Are you sure you want to delete the folder ",e.jsxs("strong",{children:['"',n,'"']}),"?"]}),e.jsxs("div",{className:"bg-destructive/10 p-3 rounded-lg space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:"This action will permanently delete:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r>0&&e.jsxs(G,{variant:"destructive",children:[r," card",r!==1?"s":""]}),o&&i>0&&e.jsxs(G,{variant:"destructive",children:[i," subfolder",i!==1?"s":""]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This action cannot be undone."})]})]}),e.jsxs(In,{children:[e.jsx(On,{children:"Cancel"}),e.jsx(zn,{onClick:l,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Forever"})]})]})})}function xc({children:t,tagName:s,onRename:a,onDelete:n,disabled:r=!1}){const o=()=>{r||a(s)},i=()=>{r||n(s)};return r?e.jsx(e.Fragment,{children:t}):e.jsxs(Nn,{children:[e.jsx(Sn,{asChild:!0,children:t}),e.jsxs(bs,{className:"w-48",children:[e.jsxs(Ye,{onClick:o,className:"flex items-center gap-2",children:[e.jsx(La,{className:"h-4 w-4"}),"Rename Tag"]}),e.jsxs(Ye,{onClick:i,className:"flex items-center gap-2 text-destructive focus:text-destructive",children:[e.jsx(ds,{className:"h-4 w-4"}),"Delete Tag"]})]})]})}function bc({isOpen:t,onClose:s,onConfirm:a,tagName:n,existingTags:r}){const[o,i]=d.useState(""),[l,u]=d.useState("");d.useEffect(()=>{t&&(i(n),u(""))},[t,n]);const h=x=>{const c=x.trim();return c?c===n?"Please enter a different name":r.includes(c)?"A tag with this name already exists":c.length>50?"Tag name must be less than 50 characters":"":"Tag name cannot be empty"},m=()=>{const x=o.trim(),c=h(x);if(c){u(c);return}a(n,x),s()},y=x=>{x.key==="Enter"&&m()};return e.jsx(Pe,{open:t,onOpenChange:s,children:e.jsxs(Te,{className:"sm:max-w-md",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Rename Tag"}),e.jsxs(At,{children:['Enter a new name for the tag "',n,'". This will update all cards using this tag.']})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"tag-name",children:"Tag Name"}),e.jsx(ie,{id:"tag-name",value:o,onChange:x=>{i(x.target.value),l&&u("")},onKeyPress:y,placeholder:"Enter tag name...",autoFocus:!0}),l&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive",children:[e.jsx(ge,{className:"h-4 w-4"}),l]})]})}),e.jsxs(Qe,{children:[e.jsx(D,{variant:"outline",onClick:s,children:"Cancel"}),e.jsx(D,{onClick:m,disabled:!!l||!o.trim(),children:"Rename Tag"})]})]})})}function yc({isOpen:t,onClose:s,onConfirm:a,tagName:n,cardCount:r}){return e.jsx(Pe,{open:t,onOpenChange:s,children:e.jsxs(Te,{className:"sm:max-w-md",children:[e.jsxs(Je,{children:[e.jsxs(Xe,{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-5 w-5 text-destructive"}),"Delete Tag"]}),e.jsxs(At,{children:['Are you sure you want to delete the tag "',n,'"?']})]}),e.jsx("div",{className:"py-4",children:e.jsxs("div",{className:"rounded-lg bg-destructive/10 p-4 border border-destructive/20",children:[e.jsx("p",{className:"text-sm text-destructive font-medium mb-2",children:"This action cannot be undone."}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["This tag will be removed from ",e.jsx("strong",{children:r})," ",r===1?"card":"cards","."]})]})}),e.jsxs(Qe,{children:[e.jsx(D,{variant:"outline",onClick:s,children:"Cancel"}),e.jsx(D,{variant:"destructive",onClick:a,children:"Delete Tag"})]})]})})}const wc=({tag:t,isSelected:s,onClick:a,className:n,showCount:r=!0})=>e.jsxs("button",{onClick:()=>a(t),className:S("relative flex items-center justify-between px-3 py-2 rounded-xl border transition-all duration-300 ease-out","hover:shadow-lg hover:shadow-black/10 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-blue-500/30","backdrop-blur-sm group",s?"bg-gradient-to-r from-blue-500 to-blue-600 border-blue-500 text-white shadow-md shadow-blue-500/25":"bg-white/80 border-gray-200/60 text-gray-700 hover:bg-white hover:border-gray-300/80",n),style:{boxShadow:s?"0 4px 20px -4px rgba(59, 130, 246, 0.3), 0 0 0 1px rgba(59, 130, 246, 0.1)":void 0},children:[e.jsxs("div",{className:"flex items-center gap-2.5 flex-1 min-w-0",children:[e.jsx("div",{className:S("w-2 h-2 rounded-full flex-shrink-0 transition-all duration-300",s?"bg-white/90 shadow-sm":"shadow-sm"),style:{backgroundColor:s?"rgba(255, 255, 255, 0.9)":t.color,boxShadow:s?"0 1px 3px rgba(0, 0, 0, 0.1)":`0 1px 3px ${t.color}40`}}),e.jsx("span",{className:S("text-sm font-medium truncate transition-all duration-300",s?"text-white":"text-gray-700 group-hover:text-gray-900"),children:t.name}),s&&e.jsx(ke,{className:"w-3.5 h-3.5 text-white/90 flex-shrink-0 animate-in fade-in-0 zoom-in-95 duration-200"})]}),r&&e.jsx("span",{className:S("text-xs font-medium px-2 py-0.5 rounded-full ml-2 flex-shrink-0 transition-all duration-300",s?"text-blue-600 bg-white/90 shadow-sm":"text-gray-500 bg-gray-100/80 group-hover:bg-gray-200/80 group-hover:text-gray-600"),children:t.count})]}),vc=({tags:t,selectedTags:s,onTagClick:a,className:n,emptyMessage:r="No tags found"})=>t.length===0?e.jsx("div",{className:S("text-center py-8 text-gray-500",n),children:e.jsx("p",{className:"text-sm",children:r})}):e.jsx("div",{className:S("grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",n),children:t.map(o=>e.jsx(wc,{tag:o,isSelected:s.includes(o.name),onClick:a},o.id))}),jc=({onSearch:t,onCreateTag:s,searchResults:a,searchQuery:n,className:r})=>{const[o,i]=d.useState(n);d.useEffect(()=>{i(n)},[n]);const l=m=>{const y=m.target.value;i(y),t(y)},u=()=>{o.trim()&&(s(o.trim()),i(""),t(""))},h=o.trim()&&a.length===0&&!a.some(m=>m.name.toLowerCase()===o.toLowerCase());return e.jsxs("div",{className:S("space-y-3",r),children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(ie,{placeholder:"Search tags or create new...",value:o,onChange:l,className:"pl-11 pr-4 py-3 rounded-2xl border-gray-200/60 bg-gray-50/50 backdrop-blur-sm focus:bg-white focus:border-blue-300 transition-all duration-300"})]}),h&&e.jsxs(D,{onClick:u,variant:"outline",className:"w-full justify-start text-left rounded-xl border-dashed border-2 border-gray-300 hover:border-blue-400 hover:bg-blue-50/50 transition-all duration-300 py-3",children:[e.jsx(Nt,{className:"h-4 w-4 mr-2 text-blue-500"}),e.jsxs("span",{className:"text-gray-700",children:['Create tag "',e.jsx("span",{className:"font-medium text-blue-600",children:o}),'"']})]})]})},Cc=({isOpen:t,onClose:s,currentCardTags:a,onTagsChange:n})=>{const{tags:r,searchTags:o,dispatch:i,createTagIfNotExists:l}=Ua(),[u,h]=d.useState(""),[m,y]=d.useState([]),[x,c]=d.useState(a);d.useEffect(()=>{if(u.trim()){const p=o(u);y(p)}else{const p=[...r].sort((v,j)=>j.count-v.count);y(p)}},[u,r,o]),d.useEffect(()=>{c(a)},[a]);const w=p=>{h(p)},b=p=>{i({type:"CREATE_TAG",payload:{name:p,color:"#3b82f6"}});const v=[...x,p];c(v),n(v),h("")},f=p=>{const v=x.includes(p.name);let j;v?j=x.filter(k=>k!==p.name):j=[...x,p.name],c(j),n(j)},g=()=>{h(""),s()};return t?e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.15)",backdropFilter:"blur(8px)"},children:[e.jsx("div",{className:"absolute inset-0",onClick:g}),e.jsxs("div",{className:"relative bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl border border-gray-200/50 p-6 w-full max-w-sm sm:max-w-md lg:max-w-2xl max-h-[85vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Manage Tags"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Select tags for this card"})]}),e.jsx("button",{onClick:g,className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(Ie,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx(jc,{onSearch:w,onCreateTag:b,searchResults:m,searchQuery:u,className:"mb-4"}),x.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl border border-blue-100/50",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-700 mb-3",children:["Selected tags (",x.length,"):"]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map(p=>e.jsx("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-sm",children:p},p))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(vc,{tags:m,selectedTags:x,onTagClick:f,emptyMessage:u?`No tags found for "${u}"`:"No tags available"})}),e.jsx("div",{className:"text-xs text-gray-400 text-center mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-gray-300"}),e.jsx("span",{children:"Click tags to add/remove them from this card"}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-gray-300"})]})})]})]}):null},Nc=()=>{const{isOpen:t,currentCardTags:s,onTagsChange:a,closeTagPanel:n}=Ka();return!t||!a?null:e.jsx(Cc,{isOpen:t,onClose:n,currentCardTags:s,onTagsChange:a})};class Sc{static generateSuggestions(s){const a=[];switch(s.type){case"card_content":a.push(...this.generateCardContentSuggestions(s));break;case"folder_name":a.push(...this.generateFolderNameSuggestions(s));break;case"tag_rename":a.push(...this.generateTagRenameSuggestions(s));break;default:a.push(this.getDefaultSuggestion())}return a.sort((n,r)=>r.confidence-n.confidence)}static generateCardContentSuggestions(s){const a=[],{localVersion:n,remoteVersion:r}=s,o=this.calculateSimilarity(n.content.frontContent.title,r.content.frontContent.title),i=this.calculateSimilarity(n.content.frontContent.text,r.content.frontContent.text),u=Math.abs(n.updatedAt.getTime()-r.updatedAt.getTime())<5*60*1e3,h=n.content.frontContent.text.length,m=r.content.frontContent.text.length,y=Math.max(h,m)/Math.min(h,m);o>.8&&i>.6&&u&&a.push({type:"merge",confidence:.9,reason:"内容高度相似，建议智能合并保留最佳内容",preview:{mergedTitle:this.mergeTitles(n.content.frontContent.title,r.content.frontContent.title),mergedLength:Math.max(h,m)}}),r.updatedAt.getTime()>n.updatedAt.getTime()&&y>2&&m>h&&a.push({type:"keep_remote",confidence:.8,reason:"远程版本内容更丰富且更新时间更近"});const x=new Set(n.content.frontContent.tags),c=new Set(r.content.frontContent.tags),w=[...x].filter(f=>!c.has(f));w.length>0&&w.length/x.size>.3&&a.push({type:"keep_local",confidence:.7,reason:"本地版本包含独特标签，可能包含重要分类信息"});const b=n.updatedAt.getTime()>r.updatedAt.getTime()?"local":"remote";return a.push({type:b==="local"?"keep_local":"keep_remote",confidence:.6,reason:`保留最新版本（${b==="local"?"本地":"远程"}设备）`}),a}static generateFolderNameSuggestions(s){const a=[],{localVersion:n,remoteVersion:r}=s,o=n.name.toLowerCase(),i=r.name.toLowerCase();if(o===i)return[];if(this.calculateSimilarity(n.name,r.name)>.8&&a.push({type:"merge",confidence:.9,reason:"文件夹名称相似，建议统一命名"}),o.includes(i)||i.includes(o)){const h=n.name.length>r.name.length?"local":"remote";a.push({type:h==="local"?"keep_local":"keep_remote",confidence:.8,reason:"保留更具描述性的文件夹名称"})}const u=n.updatedAt.getTime()>r.updatedAt.getTime()?"local":"remote";return a.push({type:u==="local"?"keep_local":"keep_remote",confidence:.6,reason:`保留最新修改的版本（${u==="local"?"本地":"远程"}）`}),a}static generateTagRenameSuggestions(s){const a=[],{localVersion:n,remoteVersion:r}=s,o=n.count/Math.max(r.count,1);o>2?a.push({type:"keep_local",confidence:.9,reason:`本地标签使用频率更高（${n.count}次 vs ${r.count}次）`}):o<.5&&a.push({type:"keep_remote",confidence:.9,reason:`远程标签使用频率更高（${r.count}次 vs ${n.count}次）`});const i=this.evaluateTagNameQuality(n.name),l=this.evaluateTagNameQuality(r.name);if(Math.abs(i-l)>.3){const h=i>l?"local":"remote";a.push({type:h==="local"?"keep_local":"keep_remote",confidence:.8,reason:`${h==="local"?"本地":"远程"}标签名称质量更好`})}const u=n.updatedAt.getTime()>r.updatedAt.getTime()?"local":"remote";return a.push({type:u==="local"?"keep_local":"keep_remote",confidence:.6,reason:"保留最新修改的版本"}),a}static calculateSimilarity(s,a){if(!s||!a)return 0;const n=s.toLowerCase().trim(),r=a.toLowerCase().trim();if(n===r)return 1;const o=Math.max(n.length,r.length);return o===0?1:1-this.levenshteinDistance(n,r)/o}static levenshteinDistance(s,a){const n=Array(a.length+1).fill(null).map(()=>Array(s.length+1).fill(null));for(let r=0;r<=s.length;r+=1)n[0][r]=r;for(let r=0;r<=a.length;r+=1)n[r][0]=r;for(let r=1;r<=a.length;r+=1)for(let o=1;o<=s.length;o+=1){const i=s[o-1]===a[r-1]?0:1;n[r][o]=Math.min(n[r][o-1]+1,n[r-1][o]+1,n[r-1][o-1]+i)}return n[a.length][s.length]}static mergeTitles(s,a){if(s===a||s.includes(a)&&s.length>a.length)return s;if(a.includes(s)&&a.length>s.length)return a;const n=new Set(s.toLowerCase().split(/\s+/)),r=new Set(a.toLowerCase().split(/\s+/)),o=new Set([...n,...r]),i=s.split(/\s+/),l=a.split(/\s+/),u=[];return i.forEach(h=>{!u.includes(h)&&o.has(h.toLowerCase())&&u.push(h)}),l.forEach(h=>{!u.includes(h)&&o.has(h.toLowerCase())&&u.push(h)}),u.join(" ")}static evaluateTagNameQuality(s){let a=.5;s.length>=3&&s.length<=20&&(a+=.2),s.length>30&&(a-=.1),/^[a-zA-Z0-9\u4e00-\u9fff\s\-_]+$/.test(s)&&(a+=.2),(s===s.toLowerCase()||/^[A-Z][a-z]+([A-Z][a-z]*)*$/.test(s))&&(a+=.1);const r=s.match(/[^a-zA-Z0-9\u4e00-\u9fff\s]/g);return r&&r.length>2&&(a-=.1),Math.max(0,Math.min(1,a))}static getDefaultSuggestion(){return{type:"manual",confidence:.5,reason:"无法自动确定最佳解决方案，建议手动处理"}}static applyResolution(s,a){switch(a.type){case"keep_local":return this.getLocalVersion(s);case"keep_remote":return this.getRemoteVersion(s);case"merge":return this.mergeVersions(s,a.mergedData);case"manual":return a.mergedData||a.manualChanges;default:throw new Error(`Unknown resolution type: ${a.type}`)}}static getLocalVersion(s){return s.entityType==="card",s.localVersion}static getRemoteVersion(s){return s.entityType==="card",s.remoteVersion}static mergeVersions(s,a){return a||this.smartMerge(s)}static smartMerge(s){if(s.entityType==="card"){const a=s,n=a.localVersion,r=a.remoteVersion;return{content:{frontContent:{title:this.mergeTitles(n.content.frontContent.title,r.content.frontContent.title),text:this.mergeText(n.content.frontContent.text,r.content.frontContent.text),tags:[...new Set([...n.content.frontContent.tags,...r.content.frontContent.tags])],lastModified:new Date},backContent:{title:this.mergeTitles(n.content.backContent.title,r.content.backContent.title),text:this.mergeText(n.content.backContent.text,r.content.backContent.text),tags:[...new Set([...n.content.backContent.tags,...r.content.backContent.tags])],lastModified:new Date}},style:n.style,folderId:n.folderId,isFlipped:n.isFlipped,updatedAt:new Date}}return this.getLocalVersion(s)}static mergeText(s,a){if(s===a)return s;const n=s.split(/[.!?]+/).filter(i=>i.trim()),r=a.split(/[.!?]+/).filter(i=>i.trim()),o=new Set([...n.map(i=>i.trim()),...r.map(i=>i.trim())]);return Array.from(o).filter(i=>i.length>0).join(". ")+"."}}const Zt=[{id:"1",type:"card_content",entityType:"card",entityId:"card-1",timestamp:new Date,sourceDevice:"Mobile Device",severity:"medium",status:"pending",createdAt:new Date(Date.now()-5*60*1e3),localVersion:{content:{frontContent:{title:"React Best Practices",text:"Key principles for writing maintainable React code including component composition, state management, and performance optimization.",tags:["react","frontend"],lastModified:new Date(Date.now()-10*60*1e3)},backContent:{title:"Implementation Details",text:"Use functional components with hooks, implement proper error boundaries, optimize with React.memo and useMemo for expensive calculations.",tags:["react","frontend"],lastModified:new Date(Date.now()-10*60*1e3)}},style:{type:"solid",backgroundColor:"#f8fafc",fontFamily:"system-ui",fontSize:"base",fontWeight:"normal",textColor:"#1f2937",borderRadius:"xl",shadow:"md",borderWidth:0},folderId:"folder-1",isFlipped:!1,updatedAt:new Date(Date.now()-10*60*1e3),version:"local-1"},remoteVersion:{content:{frontContent:{title:"React Best Practices - Updated",text:"Key principles for writing maintainable React code including component composition, state management, performance optimization, and modern patterns.",tags:["react","frontend","updated"],lastModified:new Date(Date.now()-2*60*1e3)},backContent:{title:"Implementation Details",text:"Use functional components with hooks, implement proper error boundaries, optimize with React.memo and useMemo for expensive calculations. Consider using React Query for data fetching.",tags:["react","frontend","updated"],lastModified:new Date(Date.now()-2*60*1e3)}},style:{type:"solid",backgroundColor:"#f8fafc",fontFamily:"system-ui",fontSize:"base",fontWeight:"normal",textColor:"#1f2937",borderRadius:"xl",shadow:"md",borderWidth:0},folderId:"folder-1",isFlipped:!1,updatedAt:new Date(Date.now()-2*60*1e3),version:"remote-1"},conflictFields:["frontContent.title","frontContent.text","frontContent.tags","backContent.text"],suggestions:[{type:"merge",confidence:.8,reason:"内容相似度高，可以智能合并"}]},{id:"2",type:"folder_name",entityType:"folder",entityId:"folder-2",timestamp:new Date,sourceDevice:"Web Browser",severity:"low",status:"pending",createdAt:new Date(Date.now()-15*60*1e3),localVersion:{name:"Learning Resources",color:"#3b82f6",icon:"Book",parentId:void 0,cardIds:["card-3","card-4"],isExpanded:!0,updatedAt:new Date(Date.now()-20*60*1e3),version:"local-1"},remoteVersion:{name:"Study Materials",color:"#3b82f6",icon:"Book",parentId:void 0,cardIds:["card-3","card-4"],isExpanded:!0,updatedAt:new Date(Date.now()-5*60*1e3),version:"remote-1"},affectedCards:["card-3","card-4"]}];function Lt(){const[t,s]=d.useState(Zt),[a,n]=d.useState(null),[r,o]=d.useState(!1),[i,l]=d.useState({totalConflicts:0,resolvedConflicts:0,pendingConflicts:0,conflictsByType:{},conflictsBySeverity:{},averageResolutionTime:0});d.useEffect(()=>{const f={totalConflicts:t.length,resolvedConflicts:t.filter(g=>g.status==="resolved").length,pendingConflicts:t.filter(g=>g.status==="pending").length,conflictsByType:{},conflictsBySeverity:{},averageResolutionTime:0};t.forEach(g=>{f.conflictsByType[g.type]=(f.conflictsByType[g.type]||0)+1,f.conflictsBySeverity[g.severity]=(f.conflictsBySeverity[g.severity]||0)+1}),l(f)},[t]),d.useEffect(()=>{const f=setInterval(()=>{},3e4);return()=>clearInterval(f)},[]);const u=d.useCallback(f=>t.find(g=>g.id===f),[t]),h=d.useCallback(()=>t.filter(f=>f.status==="pending"),[t]),m=d.useCallback(()=>t.filter(f=>f.severity==="high"||f.severity==="critical"),[t]),y=d.useCallback(async(f,g)=>{o(!0);try{return await new Promise(p=>setTimeout(p,1e3)),s(p=>p.map(v=>v.id===f?{...v,status:"resolved",resolvedAt:new Date,resolution:g}:v)),n(null),!0}catch(p){return console.error("Failed to resolve conflict:",p),!1}finally{o(!1)}},[]),x=d.useCallback(async f=>{s(g=>g.map(p=>p.id===f?{...p,status:"ignored"}:p)),n(null)},[]),c=d.useCallback(async(f,g)=>{o(!0);try{return await new Promise(p=>setTimeout(p,1500)),s(p=>p.map(v=>f.includes(v.id)?{...v,status:"resolved",resolvedAt:new Date,resolution:g}:v)),!0}catch(p){return console.error("Failed to batch resolve conflicts:",p),!1}finally{o(!1)}},[]),w=d.useCallback(f=>{const g=u(f);return g?Sc.generateSuggestions(g):[]},[u]),b=d.useCallback(async()=>{const f=await new Promise(g=>{setTimeout(()=>{if(Math.random()<.1){const p={id:Date.now().toString(),type:"card_content",entityType:"card",entityId:`card-${Math.floor(Math.random()*100)}`,timestamp:new Date,sourceDevice:"Unknown Device",severity:Math.random()>.7?"high":"medium",status:"pending",createdAt:new Date,localVersion:Zt[0].localVersion,remoteVersion:Zt[0].remoteVersion,conflictFields:["frontContent.title"],suggestions:[{type:"keep_remote",confidence:.9,reason:"远程版本更新"}]};g([...t,p])}else g(t)},1e3)});return s(f),f.filter(g=>g.status==="pending")},[t]);return{conflicts:t,selectedConflict:a,setSelectedConflict:n,isResolving:r,stats:i,getConflictById:u,getPendingConflicts:h,getHighPriorityConflicts:m,resolveConflict:y,ignoreConflict:x,batchResolveConflicts:c,getSuggestions:w,detectConflicts:b}}const kc=_t("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ls=d.forwardRef(({className:t,variant:s,...a},n)=>e.jsx("div",{ref:n,role:"alert",className:S(kc({variant:s}),t),...a}));ls.displayName="Alert";const $n=d.forwardRef(({className:t,...s},a)=>e.jsx("h5",{ref:a,className:S("mb-1 font-medium leading-none tracking-tight",t),...s}));$n.displayName="AlertTitle";const Bn=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("text-sm [&_p]:leading-relaxed",t),...s}));Bn.displayName="AlertDescription";function Tc({className:t,onOpenConflictPanel:s}){const{stats:a,getHighPriorityConflicts:n,detectConflicts:r,setSelectedConflict:o}=Lt(),i=n();if(!(a.pendingConflicts>0))return null;const u=async()=>{await r()},h=y=>{o(y),s?.()},m=y=>{switch(y){case"critical":return"bg-red-500 text-white";case"high":return"bg-orange-500 text-white";case"medium":return"bg-yellow-500 text-white";case"low":return"bg-blue-500 text-white";default:return"bg-gray-500 text-white"}};return e.jsxs("div",{className:S("space-y-2",t),children:[e.jsxs(ls,{className:"border-orange-200 bg-orange-50",children:[e.jsx(qe,{className:"h-4 w-4 text-orange-600"}),e.jsx($n,{className:"text-orange-800",children:"检测到数据冲突"}),e.jsxs(Bn,{className:"text-orange-700",children:["发现 ",a.pendingConflicts," 个待解决的数据冲突，建议及时处理以避免数据丢失。",i.length>0&&e.jsxs("span",{className:"ml-2 font-medium",children:["其中 ",i.length," 个需要立即处理。"]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:s,className:"text-orange-700 border-orange-300 hover:bg-orange-100",children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"查看所有冲突"]}),e.jsxs(D,{variant:"ghost",size:"sm",onClick:u,className:"text-orange-600 hover:bg-orange-100",children:[e.jsx(za,{className:"h-4 w-4 mr-2"}),"刷新检测"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(G,{variant:"secondary",className:"text-orange-700 bg-orange-100",children:["总计: ",a.totalConflicts]}),e.jsxs(G,{variant:"destructive",className:"bg-red-100 text-red-700",children:["待解决: ",a.pendingConflicts]})]})]})]}),i.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-red-700",children:"高优先级冲突"}),e.jsxs(G,{variant:"destructive",className:"text-xs",children:[i.length," 个"]})]}),i.slice(0,3).map(y=>e.jsx(ls,{className:"border-red-200 bg-red-50 cursor-pointer hover:bg-red-100 transition-colors",onClick:()=>h(y.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{variant:"outline",className:S("text-xs",m(y.severity)),children:y.severity}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:Ec(y)}),e.jsx("p",{className:"text-xs text-red-600",children:Dc(y)})]})]}),e.jsx(D,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:bg-red-100",onClick:x=>{x.stopPropagation(),h(y.id)},children:e.jsx(vs,{className:"h-4 w-4"})})]})},y.id)),i.length>3&&e.jsxs(D,{variant:"ghost",size:"sm",onClick:s,className:"w-full text-red-600 hover:bg-red-100",children:["查看剩余 ",i.length-3," 个高优先级冲突"]})]})]})}function Ec(t){switch(t.type){case"card_content":return"卡片内容冲突";case"card_style":return"卡片样式冲突";case"card_tags":return"卡片标签冲突";case"card_folder":return"卡片文件夹冲突";case"folder_name":return"文件夹名称冲突";case"folder_structure":return"文件夹结构冲突";case"tag_rename":return"标签重命名冲突";case"tag_delete":return"标签删除冲突";case"tag_color":return"标签颜色冲突";default:return"数据冲突"}}function Dc(t){switch(t.type){case"card_content":return`卡片 "${t.localVersion.content.frontContent.title}" 在多设备上被同时编辑`;case"folder_name":return`文件夹 "${t.localVersion.name}" 与远程版本名称不一致`;case"tag_rename":return`标签 "${t.localVersion.name}" 重命名冲突`;default:return"数据版本不一致，需要手动解决"}}const de=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s}));de.displayName="Card";const Ae=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("flex flex-col space-y-1.5 p-6",t),...s}));Ae.displayName="CardHeader";const Fe=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("text-2xl font-semibold leading-none tracking-tight",t),...s}));Fe.displayName="CardTitle";const Un=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("text-sm text-muted-foreground",t),...s}));Un.displayName="CardDescription";const me=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("p-6 pt-0",t),...s}));me.displayName="CardContent";const _c=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("flex items-center p-6 pt-0",t),...s}));_c.displayName="CardFooter";function Rc({isOpen:t,onClose:s,className:a}){const{conflicts:n,setSelectedConflict:r,stats:o,getPendingConflicts:i,getHighPriorityConflicts:l,resolveConflict:u,ignoreConflict:h,batchResolveConflicts:m,detectConflicts:y,isResolving:x}=Lt(),[c,w]=d.useState("all"),[b,f]=d.useState(""),[g,p]=d.useState(new Set),[v,j]=d.useState(new Set),k=T.useMemo(()=>{let E=n;switch(c){case"pending":E=i();break;case"high":E=l();break;case"resolved":E=n.filter(U=>U.status==="resolved");break}if(b){const U=b.toLowerCase();E=E.filter(H=>{switch(H.entityType){case"card":return H.localVersion.content.frontContent.title.toLowerCase().includes(U);case"folder":return H.localVersion.name.toLowerCase().includes(U);case"tag":return H.localVersion.name.toLowerCase().includes(U);default:return!1}})}return E.sort((U,H)=>{const ee={critical:4,high:3,medium:2,low:1},X=ee[H.severity]-ee[U.severity];return X!==0?-X:H.timestamp.getTime()-U.timestamp.getTime()})},[n,c,b,i,l]),_=E=>{p(U=>{const H=new Set(U);return H.has(E)?H.delete(E):H.add(E),H})},N=E=>{j(U=>{const H=new Set(U);return H.has(E)?H.delete(E):H.add(E),H})},F=()=>{v.size===k.length?j(new Set):j(new Set(k.map(E=>E.id)))},W=async E=>{if(v.size===0)return;const U=Array.from(v);await m(U,{type:E,reason:`批量选择${E==="keep_local"?"本地":"远程"}版本`}),j(new Set)},Z=E=>{switch(E){case"critical":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},A=E=>{switch(E){case"resolved":return e.jsx(as,{className:"h-4 w-4 text-green-500"});case"ignored":return e.jsx(ss,{className:"h-4 w-4 text-gray-500"});default:return e.jsx(Oa,{className:"h-4 w-4 text-yellow-500"})}};return t?e.jsx("div",{className:S("fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",a),children:e.jsxs(de,{className:"w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs(Ae,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{className:"h-5 w-5 text-orange-500"}),e.jsx(Fe,{className:"text-xl",children:"冲突管理中心"}),e.jsxs(G,{variant:"outline",className:"ml-2",children:[o.pendingConflicts," 待解决"]})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:s,children:"×"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["总计: ",o.totalConflicts]}),e.jsxs("span",{children:["已解决: ",o.resolvedConflicts]}),e.jsxs("span",{children:["待处理: ",o.pendingConflicts]}),e.jsxs("span",{children:["高优先级: ",l().length]})]})]}),e.jsxs(me,{className:"flex-1 flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"搜索冲突...",value:b,onChange:E=>f(E.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:c==="all"?"default":"outline",size:"sm",onClick:()=>w("all"),children:"全部"}),e.jsx(D,{variant:c==="pending"?"default":"outline",size:"sm",onClick:()=>w("pending"),children:"待解决"}),e.jsx(D,{variant:c==="high"?"default":"outline",size:"sm",onClick:()=>w("high"),children:"高优先级"}),e.jsx(D,{variant:c==="resolved"?"default":"outline",size:"sm",onClick:()=>w("resolved"),children:"已解决"})]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:y,children:[e.jsx(za,{className:"h-4 w-4 mr-2"}),"刷新"]})]}),v.size>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:["已选择 ",v.size," 个冲突"]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:F,children:v.size===k.length?"取消全选":"全选"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"outline",size:"sm",onClick:()=>W("keep_local"),disabled:x,children:"批量保留本地"}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>W("keep_remote"),disabled:x,children:"批量保留远程"})]})]}),e.jsx(He,{className:"flex-1",children:e.jsx("div",{className:"space-y-3",children:k.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:b?"没有找到匹配的冲突":"暂无冲突"}):k.map(E=>e.jsx(Ac,{conflict:E,isExpanded:g.has(E.id),isSelected:v.has(E.id),onToggleExpand:()=>_(E.id),onToggleSelect:()=>N(E.id),onSelect:()=>r(E.id),onResolve:U=>u(E.id,U),onIgnore:()=>h(E.id),getSeverityColor:Z,getStatusIcon:A,isResolving:x},E.id))})})]})]})}):null}function Ac({conflict:t,isExpanded:s,isSelected:a,onToggleExpand:n,onToggleSelect:r,onSelect:o,onResolve:i,onIgnore:l,getSeverityColor:u,getStatusIcon:h,isResolving:m}){return e.jsx(de,{className:S("transition-all duration-200 cursor-pointer hover:shadow-md",u(t.severity),a&&"ring-2 ring-blue-500"),onClick:o,children:e.jsx(me,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("input",{type:"checkbox",checked:a,onChange:r,onClick:y=>y.stopPropagation(),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h(t.status),e.jsx(G,{variant:"outline",className:"text-xs",children:t.severity}),e.jsx(G,{variant:"secondary",className:"text-xs",children:Fc(t.type)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Is(t.timestamp)})]}),e.jsx("h4",{className:"font-medium mb-1",children:Pc(t)}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:Ic(t)}),s&&e.jsxs("div",{className:"mt-3 pt-3 border-t space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"来源设备:"}),e.jsx("span",{className:"ml-2",children:t.sourceDevice})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"冲突时间:"}),e.jsx("span",{className:"ml-2",children:Is(t.timestamp)})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(D,{variant:"outline",size:"sm",onClick:y=>{y.stopPropagation(),i({type:"keep_local",reason:"保留本地版本"})},disabled:m,children:"保留本地"}),e.jsx(D,{variant:"outline",size:"sm",onClick:y=>{y.stopPropagation(),i({type:"keep_remote",reason:"保留远程版本"})},disabled:m,children:"保留远程"}),e.jsx(D,{variant:"ghost",size:"sm",onClick:y=>{y.stopPropagation(),l()},children:"忽略"})]})]})]})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:y=>{y.stopPropagation(),n()},className:"ml-2",children:s?e.jsx(ms,{className:"h-4 w-4"}):e.jsx(Rt,{className:"h-4 w-4"})})]})})})}function Fc(t){return{card_content:"卡片内容",card_style:"卡片样式",card_tags:"卡片标签",card_folder:"卡片文件夹",folder_name:"文件夹名称",folder_structure:"文件夹结构",tag_rename:"标签重命名",tag_delete:"标签删除",tag_color:"标签颜色"}[t]||t}function Pc(t){switch(t.entityType){case"card":return t.localVersion.content.frontContent.title;case"folder":return t.localVersion.name;case"tag":return t.localVersion.name;default:return"未知冲突"}}function Ic(t){switch(t.type){case"card_content":return"卡片内容在多设备上被同时编辑";case"folder_name":return"文件夹名称与远程版本不一致";case"tag_rename":return"标签重命名冲突";default:return"数据版本不一致"}}function Is(t){const a=new Date().getTime()-t.getTime(),n=Math.floor(a/6e4);return n<1?"刚刚":n<60?`${n}分钟前`:n<1440?`${Math.floor(n/60)}小时前`:`${Math.floor(n/1440)}天前`}const Mc=wr,Wn=d.forwardRef(({className:t,...s},a)=>e.jsx(Da,{ref:a,className:S("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s}));Wn.displayName=Da.displayName;const ct=d.forwardRef(({className:t,...s},a)=>e.jsx(_a,{ref:a,className:S("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s}));ct.displayName=_a.displayName;const dt=d.forwardRef(({className:t,...s},a)=>e.jsx(Ra,{ref:a,className:S("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));dt.displayName=Ra.displayName;const Vn=d.forwardRef(({className:t,...s},a)=>e.jsx("textarea",{className:S("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...s}));Vn.displayName="Textarea";function Lc({conflictId:t,onClose:s,className:a}){const{getConflictById:n,resolveConflict:r,ignoreConflict:o,getSuggestions:i,isResolving:l}=Lt(),[u,h]=d.useState("compare"),[m,y]=d.useState("local"),[x,c]=d.useState({}),[w,b]=d.useState(!0),f=n(t),g=i(t);if(!f)return e.jsx(de,{className:S("w-full max-w-6xl max-h-[90vh]",a),children:e.jsxs(me,{className:"p-8 text-center",children:[e.jsx(ss,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"冲突不存在"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"指定的冲突ID未找到或已被解决"}),e.jsx(D,{onClick:s,children:"关闭"})]})});const p=async()=>{let N;switch(m){case"local":N={type:"keep_local",reason:"用户选择保留本地版本"};break;case"remote":N={type:"keep_remote",reason:"用户选择保留远程版本"};break;case"merge":N={type:"merge",reason:"用户选择智能合并",mergedData:v()};break;case"manual":N={type:"manual",reason:"用户手动编辑",mergedData:x,manualChanges:Object.entries(x).map(([W,Z])=>({field:W,value:Z,source:"custom"}))};break}await r(t,N)&&s()},v=()=>f.entityType==="card"?{content:{frontContent:j(f.localVersion.content.frontContent,f.remoteVersion.content.frontContent),backContent:j(f.localVersion.content.backContent,f.remoteVersion.content.backContent)},style:f.localVersion.style}:f.localVersion,j=(N,F)=>({title:N.title.length>F.title.length?N.title:F.title,text:N.text+`

`+F.text,tags:[...new Set([...N.tags,...F.tags])],lastModified:new Date}),_=f.type==="card_content"?[{field:"title",label:"标题",local:f.localVersion.content.frontContent.title,remote:f.remoteVersion.content.frontContent.title},{field:"frontText",label:"正面内容",local:f.localVersion.content.frontContent.text,remote:f.remoteVersion.content.frontContent.text},{field:"backText",label:"背面内容",local:f.localVersion.content.backContent.text,remote:f.remoteVersion.content.backContent.text},{field:"tags",label:"标签",local:f.localVersion.content.frontContent.tags,remote:f.remoteVersion.content.frontContent.tags}]:[];return e.jsxs(de,{className:S("w-full max-w-6xl max-h-[90vh] flex flex-col",a),children:[e.jsxs(Ae,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{className:S("h-5 w-5",Bc(f.severity))}),e.jsxs("div",{children:[e.jsx(Fe,{className:"text-xl",children:zc(f)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Oc(f)})]})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:s,children:"×"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["类型: ",$c(f.type)]}),e.jsxs("span",{children:["优先级: ",f.severity]}),e.jsxs("span",{children:["来源: ",f.sourceDevice]}),e.jsxs("span",{children:["时间: ",Be(f.timestamp)]}),e.jsx(G,{variant:"outline",children:f.status==="pending"?"待解决":f.status==="resolved"?"已解决":"已忽略"})]})]}),e.jsxs(me,{className:"flex-1 flex flex-col",children:[e.jsxs(Mc,{value:u,onValueChange:h,className:"flex-1 flex flex-col",children:[e.jsxs(Wn,{className:"grid w-full grid-cols-4",children:[e.jsx(ct,{value:"compare",children:"对比视图"}),e.jsx(ct,{value:"suggestions",children:"智能建议"}),e.jsx(ct,{value:"history",children:"历史记录"}),e.jsx(ct,{value:"manual",children:"手动合并"})]}),e.jsxs("div",{className:"flex-1 mt-4",children:[e.jsx(dt,{value:"compare",className:"h-full",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[e.jsxs(de,{className:"border-green-200",children:[e.jsxs(Ae,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Fe,{className:"text-base flex items-center gap-2",children:[e.jsx($r,{className:"h-4 w-4 text-green-600"}),"本地版本"]}),e.jsx(G,{variant:"outline",className:"text-green-600 border-green-200",children:"本地设备"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["更新时间: ",Be(f.localVersion.updatedAt)]})]}),e.jsx(me,{className:"p-4",children:e.jsx(He,{className:"h-96",children:Ms(f,"local")})})]}),e.jsxs(de,{className:"border-blue-200",children:[e.jsxs(Ae,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Fe,{className:"text-base flex items-center gap-2",children:[e.jsx(Br,{className:"h-4 w-4 text-blue-600"}),"远程版本"]}),e.jsx(G,{variant:"outline",className:"text-blue-600 border-blue-200",children:f.sourceDevice})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["更新时间: ",Be(f.remoteVersion.updatedAt)]})]}),e.jsx(me,{className:"p-4",children:e.jsx(He,{className:"h-96",children:Ms(f,"remote")})})]})]})}),e.jsx(dt,{value:"suggestions",className:"h-full",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ur,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"智能解决建议"})]}),g.length>0?e.jsx("div",{className:"grid gap-3",children:g.map((N,F)=>e.jsx(de,{className:"cursor-pointer hover:shadow-md transition-shadow",children:e.jsx(me,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(G,{variant:N.type==="merge"?"default":"secondary",children:Uc(N.type)}),e.jsxs(G,{variant:"outline",children:["置信度: ",Math.round(N.confidence*100),"%"]})]}),e.jsx("p",{className:"text-sm mb-2",children:N.reason}),N.preview&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-gray-50 p-2 rounded",children:["预览: ",JSON.stringify(N.preview)]})]}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>y(N.type),children:"应用建议"})]})})},F))}):e.jsx(de,{children:e.jsxs(me,{className:"p-8 text-center",children:[e.jsx(ss,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"暂无智能建议，请手动选择解决方案"})]})})]})}),e.jsx(dt,{value:"history",className:"h-full",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oa,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"冲突历史"})]}),e.jsx(de,{children:e.jsx(me,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"冲突检测"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Be(f.timestamp)})]}),e.jsx(G,{variant:"destructive",children:"冲突"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"本地版本更新"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Be(f.localVersion.updatedAt)})]}),e.jsx(G,{variant:"outline",children:"本地"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"远程版本更新"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Be(f.remoteVersion.updatedAt)})]}),e.jsx(G,{variant:"outline",children:"远程"})]})]})})})]})}),e.jsx(dt,{value:"manual",className:"h-full",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"手动合并"}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>b(!w),children:[w?e.jsx(ns,{className:"h-4 w-4 mr-1"}):e.jsx(Tt,{className:"h-4 w-4 mr-1"}),w?"隐藏差异":"显示差异"]})]}),e.jsx(He,{className:"h-96",children:e.jsx("div",{className:"space-y-4",children:_.map(N=>e.jsxs(de,{children:[e.jsx(Ae,{className:"pb-3",children:e.jsx(Fe,{className:"text-base",children:N.label})}),e.jsxs(me,{className:"space-y-3",children:[w&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"p-2 bg-green-50 rounded text-sm",children:[e.jsx("p",{className:"font-medium text-green-700 mb-1",children:"本地:"}),e.jsx("p",{children:N.local})]}),e.jsxs("div",{className:"p-2 bg-blue-50 rounded text-sm",children:[e.jsx("p",{className:"font-medium text-blue-700 mb-1",children:"远程:"}),e.jsx("p",{children:N.remote})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"合并结果:"}),N.field==="tags"?e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Array.isArray(N.local)&&N.local.map(F=>e.jsx(G,{variant:"secondary",children:F},F)),Array.isArray(N.remote)&&N.remote.map(F=>e.jsx(G,{variant:"outline",children:F},F))]}):e.jsx(Vn,{value:x[N.field]||N.local,onChange:F=>c(W=>({...W,[N.field]:F.target.value})),className:"min-h-[100px]"})]})]})]},N.field))})})]})})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"解决方案:"}),e.jsx("div",{className:"flex gap-2",children:["local","remote","merge","manual"].map(N=>e.jsx(D,{variant:m===N?"default":"outline",size:"sm",onClick:()=>y(N),children:Wc(N)},N))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"outline",onClick:s,children:"取消"}),e.jsx(D,{variant:"ghost",onClick:()=>o(t),children:"忽略冲突"}),e.jsx(D,{onClick:p,disabled:l,children:l?"解决中...":"应用解决方案"})]})]})})]})]})}function Ms(t,s){const a=s==="local"?t.localVersion:t.remoteVersion;return t.entityType==="card"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"正面内容"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsx("h5",{className:"font-semibold mb-2",children:a.content.frontContent.title}),e.jsx("p",{className:"text-sm text-gray-600",children:a.content.frontContent.text}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:a.content.frontContent.tags.map(n=>e.jsx(G,{variant:"secondary",className:"text-xs",children:n},n))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"背面内容"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsx("h5",{className:"font-semibold mb-2",children:a.content.backContent.title}),e.jsx("p",{className:"text-sm text-gray-600",children:a.content.backContent.text}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:a.content.backContent.tags.map(n=>e.jsx(G,{variant:"secondary",className:"text-xs",children:n},n))})]})]})]}):e.jsx("pre",{className:"text-sm",children:JSON.stringify(a,null,2)})}function zc(t){switch(t.entityType){case"card":return t.localVersion.content.frontContent.title;case"folder":return t.localVersion.name;case"tag":return t.localVersion.name;default:return"未知冲突"}}function Oc(t){switch(t.type){case"card_content":return"卡片内容在多设备上被同时编辑，需要选择保留的版本";case"folder_name":return"文件夹名称与远程版本不一致";case"tag_rename":return"标签重命名冲突";default:return"数据版本不一致，需要手动解决"}}function $c(t){return{card_content:"卡片内容",card_style:"卡片样式",card_tags:"卡片标签",card_folder:"卡片文件夹",folder_name:"文件夹名称",folder_structure:"文件夹结构",tag_rename:"标签重命名",tag_delete:"标签删除",tag_color:"标签颜色"}[t]||t}function Bc(t){switch(t){case"critical":return"text-red-600";case"high":return"text-orange-600";case"medium":return"text-yellow-600";case"low":return"text-blue-600";default:return"text-gray-600"}}function Uc(t){return{keep_local:"保留本地",keep_remote:"保留远程",merge:"智能合并",manual:"手动处理"}[t]||t}function Wc(t){return{local:"保留本地",remote:"保留远程",merge:"智能合并",manual:"手动合并"}[t]||t}function Be(t){const a=new Date().getTime()-t.getTime(),n=Math.floor(a/6e4);return n<1?"刚刚":n<60?`${n}分钟前`:n<1440?`${Math.floor(n/60)}小时前`:`${Math.floor(n/1440)}天前`}function Vc({className:t}){const[s,a]=d.useState({user:null,session:null,loading:!1,error:null}),{openModal:n}=Va(),{cards:r,filter:o,setFilter:i,viewSettings:l,setViewSettings:u,dispatch:h,getAllTags:m,updateTagsInAllCards:y,getCardsWithTag:x}=bo(),{folderTree:c,selectedFolderId:w,setSelectedFolderId:b,dispatch:f,getFolderById:g,folders:p}=Ba(),{tags:v,popularTags:j,renameTag:k,deleteTagByName:_,getAllTagNames:N}=Ua(),{toast:F}=Zl(),[W,Z]=d.useState(!1),[A,E]=d.useState(!1),[U,H]=d.useState({gap:16,showLayoutControls:!1}),{stats:ee,selectedConflict:X,setSelectedConflict:se}=Lt(),[fe,R]=d.useState(!1),[O,q]=d.useState(!1);d.useEffect(()=>Re.onAuthStateChange(a),[]);const[$,z]=d.useState(!1),[V,J]=d.useState(!1),[I,M]=d.useState(null),[Q,ye]=d.useState(null),[Me,pe]=d.useState(),[Ze,Le]=d.useState(!1),[zt,et]=d.useState(!1),[xt,tt]=d.useState(""),[ce,st]=d.useState(null),{isDownloading:bt,showPreview:De,previewData:at,captureScreenshot:we,confirmDownload:Ot,cancelPreview:$t}=Hl({onSuccess:C=>{F({title:"Screenshot saved!",description:`${C}.png has been downloaded successfully.`})},onError:C=>{F({title:"Screenshot failed",description:C.message,variant:"destructive"})}}),re=C=>{h({type:"FLIP_CARD",payload:C})},Ne=(C,P)=>{h({type:"UPDATE_CARD",payload:{id:C,updates:P}})},Bt=async C=>{const P=r.find(B=>B.id===C);if(P){const B=P.isFlipped?P.backContent:P.frontContent,ae=vi(B.title,B.text);await ji(ae)?console.log("Card content copied to clipboard"):console.error("Failed to copy card content")}},Ut=async C=>{const P=r.find(te=>te.id===C);if(!P)return;const B=document.querySelector(`[data-card-id="${C}"]`);if(!B){F({title:"Screenshot failed",description:"Could not find card element. Please try again.",variant:"destructive"});return}const ne=(P.isFlipped?P.backContent:P.frontContent).title||"Untitled Card";await we(B,ne)},ze=C=>{console.log("Share card:",C)},Wt=C=>{h({type:"DELETE_CARD",payload:C})},yt=(C,P)=>{const B=r.find(te=>te.id===C);if(!B)return;const ae=B.folderId;if(h({type:"UPDATE_CARD",payload:{id:C,updates:{folderId:P||void 0}}}),ae){const te=g(ae);te&&f({type:"UPDATE_FOLDER",payload:{id:ae,updates:{cardIds:te.cardIds.filter(Hn=>Hn!==C)}}})}if(P){const te=g(P);te&&f({type:"UPDATE_FOLDER",payload:{id:P,updates:{cardIds:[...te.cardIds,C]}}})}const ne=P?g(P)?.name:"Root";F({title:"Card moved",description:`Card has been moved to "${ne}".`})},_e=()=>{h({type:"CREATE_CARD",payload:{frontContent:{title:"New Card",text:"Click to edit this card...",images:[],tags:[],lastModified:new Date},backContent:{title:"Back Side",text:"Add additional content here...",images:[],tags:[],lastModified:new Date},style:{type:"solid",backgroundColor:"#ffffff",fontFamily:"system-ui",fontSize:"base",fontWeight:"normal",textColor:"#1f2937",borderRadius:"xl",shadow:"md",borderWidth:0},isFlipped:!1,folderId:w||void 0}})},ve=()=>{pe(void 0),M(null),z(!0)},nt=C=>{pe(C),M(null),z(!0)},je=C=>{const P=g(C);P&&(M({id:C,name:P.name,color:P.color,icon:P.icon||"Folder"}),pe(void 0),z(!0))},wt=C=>{const P=g(C);if(P){const B=p.filter(ae=>ae.parentId===C);ye({id:C,name:P.name,cardCount:P.cardIds.length,hasSubfolders:B.length>0,subfolderCount:B.length}),J(!0)}},Vt=C=>{I?(f({type:"UPDATE_FOLDER",payload:{id:I.id,updates:{name:C.name,color:C.color,icon:C.icon}}}),F({title:"Folder updated",description:`"${C.name}" has been updated successfully.`})):(f({type:"CREATE_FOLDER",payload:{name:C.name,color:C.color,icon:C.icon,cardIds:[],parentId:C.parentId,isExpanded:!0}}),F({title:"Folder created",description:`"${C.name}" has been created successfully.`}))},vt=()=>{Q&&(f({type:"DELETE_FOLDER",payload:Q.id,onDeleteCards:C=>{C.forEach(P=>{h({type:"DELETE_CARD",payload:P})})}}),F({title:"Folder deleted",description:`"${Q.name}" and ${Q.cardCount} cards have been deleted.`}),w===Q.id&&Oe(null))},jt=C=>{const P=o.tags.includes(C);i({...o,tags:P?o.tags.filter(B=>B!==C):[...o.tags,C]})},Oe=C=>{b(C),i({...o,folderId:C||void 0})},rt=C=>{tt(C),Le(!0)},xe=C=>{const P=x(C);st({name:C,cardCount:P.length}),et(!0)},Ht=(C,P)=>{k(C,P)?(y(C,P),F({title:"Tag renamed",description:`"${C}" has been renamed to "${P}".`}),Le(!1),tt("")):F({title:"Rename failed",description:"A tag with this name already exists.",variant:"destructive"})},L=()=>{ce&&_(ce.name)&&(y(ce.name),o.tags.includes(ce.name)&&i({...o,tags:o.tags.filter(P=>P!==ce.name)}),F({title:"Tag deleted",description:`"${ce.name}" has been removed from ${ce.cardCount} cards.`}),et(!1),st(null))},Y=(C,P=0)=>C.map(B=>e.jsxs("div",{style:{marginLeft:P*16},children:[e.jsx(Ps,{folderId:B.id,folderName:B.name,onRename:je,onDelete:wt,onCreateSubfolder:nt,children:e.jsxs(D,{variant:w===B.id?"secondary":"ghost",className:"w-full justify-start text-sm mb-1",onClick:()=>Oe(B.id),children:[e.jsx(Se,{className:"h-4 w-4 mr-2",style:{color:B.color}}),B.name,e.jsx(G,{variant:"secondary",className:"ml-auto",children:B.cardIds.length})]})}),B.children&&B.children.length>0&&B.isExpanded&&e.jsx("div",{className:"ml-4",children:Y(B.children,P+1)})]},B.id)),K=C=>C.map(P=>e.jsxs("div",{children:[e.jsx(Ps,{folderId:P.id,folderName:P.name,onRename:je,onDelete:wt,onCreateSubfolder:nt,children:e.jsx(D,{variant:w===P.id?"secondary":"ghost",className:"w-full h-10 p-0 mb-1",onClick:()=>Oe(P.id),title:P.name,children:e.jsx(Se,{className:"h-4 w-4",style:{color:P.color}})})}),P.children&&P.children.length>0&&P.isExpanded&&e.jsx("div",{children:K(P.children)})]},P.id));return e.jsx(fi,{children:e.jsxs("div",{className:S("min-h-screen bg-background",t),children:[e.jsx("header",{className:"sticky top-0 z-40 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"container flex h-16 items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-lg bg-gradient-to-br from-violet-500 to-pink-500 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"CA"})}),e.jsxs("h1",{className:"text-xl font-bold",children:[e.jsx("span",{className:"text-violet-600",children:"Card"}),e.jsx("span",{className:"text-pink-500",children:"All"})]})]}),e.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 hidden md:block",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{placeholder:"Search cards...",value:o.searchTerm,onChange:C=>i({...o,searchTerm:C.target.value}),className:"pl-10 rounded-full w-80"})]})}),e.jsx("div",{className:"md:hidden absolute left-1/2 transform -translate-x-1/2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{placeholder:"Search...",value:o.searchTerm,onChange:C=>i({...o,searchTerm:C.target.value}),className:"pl-10 rounded-full w-60"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[ee.pendingConflicts>0&&e.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>R(!0),className:"relative text-orange-600 hover:bg-orange-50",children:[e.jsx(qe,{className:"h-4 w-4"}),ee.pendingConflicts>0&&e.jsx(G,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 flex items-center justify-center p-0 text-xs",children:ee.pendingConflicts>99?"99+":ee.pendingConflicts}),e.jsx("span",{className:"sr-only",children:"Conflict Notifications"})]}),e.jsxs(yi,{children:[e.jsx(wi,{asChild:!0,children:e.jsx(D,{variant:"ghost",size:"sm",children:e.jsx(Wr,{className:"h-4 w-4"})})}),e.jsx(Za,{className:"w-80",align:"end",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Layout Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Customize the masonry layout appearance"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(le,{children:["Gap Size: ",U.gap,"px"]}),e.jsx(Xa,{value:[U.gap],onValueChange:([C])=>H(P=>({...P,gap:C})),max:32,min:8,step:4,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{children:"Card Size"}),e.jsx("div",{className:"flex gap-2",children:["small","medium","large"].map(C=>e.jsx(D,{variant:l.cardSize===C?"default":"outline",size:"sm",onClick:()=>u(P=>({...P,cardSize:C})),children:C.charAt(0).toUpperCase()+C.slice(1)},C))})]})]})})]}),e.jsxs(D,{onClick:_e,variant:"ghost",size:"sm",className:"text-black font-bold hover:bg-gray-100 rounded-full w-10 h-10 p-0 flex items-center justify-center",children:[e.jsx(Nt,{className:"h-6 w-6"}),e.jsx("span",{className:"sr-only",children:"Add Card"})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:n,className:"flex items-center gap-2",children:s.user?e.jsxs(e.Fragment,{children:[e.jsx(Cn,{user:s.user,size:"sm",onClick:n,showHoverEffect:!0}),e.jsx("span",{className:"hidden sm:inline text-sm",children:s.user.username||"User"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Vr,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline text-sm",children:"Login"})]})})]})]})}),e.jsxs("main",{className:"flex h-[calc(100vh-4rem)]",children:[e.jsx("div",{className:"absolute top-16 left-0 right-0 z-30 bg-background border-b",children:e.jsx(Tc,{onOpenConflictPanel:()=>R(!0)})}),e.jsxs("aside",{className:S("border-r transition-all duration-300 ease-in-out flex flex-col",A?"w-16":"w-72"),children:[e.jsx("div",{className:"p-3 flex items-center justify-end",children:e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>E(!A),className:"h-8 w-8 p-0",children:A?e.jsx(Rt,{className:"h-4 w-4"}):e.jsx(Hr,{className:"h-4 w-4"})})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-3 space-y-4",children:[!A&&e.jsxs("div",{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(D,{className:"w-full justify-start",onClick:_e,children:[e.jsx(Nt,{className:"h-4 w-4 mr-2"}),"New Card"]}),e.jsxs(D,{variant:"outline",className:"w-full justify-start",onClick:ve,children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"New Folder"]})]}),e.jsx(lt,{className:"my-4"})]}),A&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{variant:"ghost",size:"sm",className:"w-full h-10 p-0",onClick:_e,title:"New Card",children:e.jsx(Nt,{className:"h-4 w-4"})}),e.jsx(D,{variant:"ghost",size:"sm",className:"w-full h-10 p-0",onClick:ve,title:"New Folder",children:e.jsx(ts,{className:"h-4 w-4"})}),e.jsx(lt,{className:"my-4"})]}),e.jsxs("div",{children:[!A&&e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Folders"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(D,{variant:w?"ghost":"secondary",className:S("w-full text-sm",A?"h-10 p-0":"justify-start"),onClick:()=>Oe(null),title:A?"All Cards":void 0,children:[e.jsx(Se,{className:"h-4 w-4"}),!A&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"ml-2",children:"All Cards"}),e.jsx(G,{variant:"secondary",className:"ml-auto",children:r.length})]})]}),A?K(c):Y(c)]})]}),e.jsx(lt,{}),e.jsxs("div",{children:[!A&&e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Tags"}),o.tags.length>0&&e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>i({...o,tags:[]}),className:"h-6 px-2 text-xs",children:"Clear"})]}),e.jsx("div",{className:"space-y-1",children:j(A?5:10).map(C=>e.jsx(xc,{tagName:C.name,onRename:rt,onDelete:xe,disabled:A,children:e.jsxs(D,{variant:o.tags.includes(C.name)?"secondary":"ghost",className:S("w-full text-sm",A?"h-10 p-0":"justify-start"),onClick:()=>jt(C.name),title:A?`${C.name} (Right-click to expand sidebar for tag management)`:C.name,children:[e.jsx(Ia,{className:"h-3 w-3",style:{color:C.color}}),!A&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"ml-2",children:C.name}),e.jsx(G,{variant:"secondary",className:"ml-auto",children:C.count})]})]})},C.id))})]}),!A&&(o.tags.length>0||o.searchTerm)&&e.jsxs(e.Fragment,{children:[e.jsx(lt,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Active Filters"}),e.jsxs("div",{className:"space-y-2",children:[o.searchTerm&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-3 w-3"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:['"',o.searchTerm,'"']})]}),o.tags.map(C=>e.jsx(G,{variant:"secondary",className:"mr-1",children:C},C))]})]})]})]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"p-4",children:e.jsx(xi,{cards:r,onCardFlip:re,onCardUpdate:Ne,onCardCopy:Bt,onCardScreenshot:Ut,onCardShare:ze,onCardDelete:Wt,onMoveToFolder:yt,cardSize:l.cardSize==="small"?"sm":l.cardSize==="large"?"lg":"md",enableVirtualization:r.length>20,gap:U.gap,overscan:3})})})]}),e.jsx(Gl,{isOpen:De,onClose:$t,onConfirm:Ot,previewUrl:at?.previewUrl||null,fileName:at?.fileName||"",isDownloading:bt}),e.jsx(fc,{isOpen:$,onClose:()=>{z(!1),M(null),pe(void 0)},onConfirm:Vt,parentId:Me,initialData:d.useMemo(()=>I?{name:I.name,color:I.color,icon:I.icon}:void 0,[I]),mode:I?"edit":"create"}),e.jsx(pc,{isOpen:V,onClose:()=>{J(!1),ye(null)},onConfirm:vt,folderName:Q?.name||"",cardCount:Q?.cardCount||0,hasSubfolders:Q?.hasSubfolders||!1,subfolderCount:Q?.subfolderCount||0}),e.jsx(bc,{isOpen:Ze,onClose:()=>{Le(!1),tt("")},onConfirm:Ht,tagName:xt,existingTags:N()}),e.jsx(yc,{isOpen:zt,onClose:()=>{et(!1),st(null)},onConfirm:L,tagName:ce?.name||"",cardCount:ce?.cardCount||0}),e.jsx(Nc,{}),e.jsx(Rc,{isOpen:fe,onClose:()=>R(!1)}),X&&e.jsx(Lc,{conflictId:X,onClose:()=>{q(!1),se(null)}})]})})}const Hc={theme:"system",setTheme:()=>null},Gc=d.createContext(Hc);function Yc({children:t,defaultTheme:s="system",storageKey:a="vite-ui-theme",...n}){const[r,o]=d.useState(()=>localStorage.getItem(a)||s);d.useEffect(()=>{const l=window.document.documentElement;if(l.classList.remove("light","dark"),r==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";l.classList.add(u);return}l.classList.add(r)},[r]);const i={theme:r,setTheme:l=>{localStorage.setItem(a,l),o(l)}};return e.jsx(Gc.Provider,{...n,value:i,children:t})}var Kc=t=>{switch(t){case"success":return Qc;case"info":return Zc;case"warning":return Xc;case"error":return ed;default:return null}},qc=Array(12).fill(0),Jc=({visible:t,className:s})=>T.createElement("div",{className:["sonner-loading-wrapper",s].filter(Boolean).join(" "),"data-visible":t},T.createElement("div",{className:"sonner-spinner"},qc.map((a,n)=>T.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),Qc=T.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},T.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Xc=T.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},T.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Zc=T.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},T.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ed=T.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},T.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),td=T.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},T.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),T.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),sd=()=>{let[t,s]=T.useState(document.hidden);return T.useEffect(()=>{let a=()=>{s(document.hidden)};return document.addEventListener("visibilitychange",a),()=>window.removeEventListener("visibilitychange",a)},[]),t},cs=1,ad=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let s=this.subscribers.indexOf(t);this.subscribers.splice(s,1)}),this.publish=t=>{this.subscribers.forEach(s=>s(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var s;let{message:a,...n}=t,r=typeof t?.id=="number"||((s=t.id)==null?void 0:s.length)>0?t.id:cs++,o=this.toasts.find(l=>l.id===r),i=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(r)&&this.dismissedToasts.delete(r),o?this.toasts=this.toasts.map(l=>l.id===r?(this.publish({...l,...t,id:r,title:a}),{...l,...t,id:r,dismissible:i,title:a}):l):this.addToast({title:a,...n,dismissible:i,id:r}),r},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(s=>{this.subscribers.forEach(a=>a({id:s.id,dismiss:!0}))}),this.subscribers.forEach(s=>s({id:t,dismiss:!0})),t),this.message=(t,s)=>this.create({...s,message:t}),this.error=(t,s)=>this.create({...s,message:t,type:"error"}),this.success=(t,s)=>this.create({...s,type:"success",message:t}),this.info=(t,s)=>this.create({...s,type:"info",message:t}),this.warning=(t,s)=>this.create({...s,type:"warning",message:t}),this.loading=(t,s)=>this.create({...s,type:"loading",message:t}),this.promise=(t,s)=>{if(!s)return;let a;s.loading!==void 0&&(a=this.create({...s,promise:t,type:"loading",message:s.loading,description:typeof s.description!="function"?s.description:void 0}));let n=t instanceof Promise?t:t(),r=a!==void 0,o,i=n.then(async u=>{if(o=["resolve",u],T.isValidElement(u))r=!1,this.create({id:a,type:"default",message:u});else if(rd(u)&&!u.ok){r=!1;let h=typeof s.error=="function"?await s.error(`HTTP error! status: ${u.status}`):s.error,m=typeof s.description=="function"?await s.description(`HTTP error! status: ${u.status}`):s.description;this.create({id:a,type:"error",message:h,description:m})}else if(s.success!==void 0){r=!1;let h=typeof s.success=="function"?await s.success(u):s.success,m=typeof s.description=="function"?await s.description(u):s.description;this.create({id:a,type:"success",message:h,description:m})}}).catch(async u=>{if(o=["reject",u],s.error!==void 0){r=!1;let h=typeof s.error=="function"?await s.error(u):s.error,m=typeof s.description=="function"?await s.description(u):s.description;this.create({id:a,type:"error",message:h,description:m})}}).finally(()=>{var u;r&&(this.dismiss(a),a=void 0),(u=s.finally)==null||u.call(s)}),l=()=>new Promise((u,h)=>i.then(()=>o[0]==="reject"?h(o[1]):u(o[1])).catch(h));return typeof a!="string"&&typeof a!="number"?{unwrap:l}:Object.assign(a,{unwrap:l})},this.custom=(t,s)=>{let a=s?.id||cs++;return this.create({jsx:t(a),id:a,...s}),a},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},oe=new ad,nd=(t,s)=>{let a=s?.id||cs++;return oe.addToast({title:t,...s,id:a}),a},rd=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",od=nd,id=()=>oe.toasts,ld=()=>oe.getActiveToasts();Object.assign(od,{success:oe.success,info:oe.info,warning:oe.warning,error:oe.error,custom:oe.custom,message:oe.message,promise:oe.promise,dismiss:oe.dismiss,loading:oe.loading},{getHistory:id,getToasts:ld});function cd(t,{insertAt:s}={}){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",s==="top"&&a.firstChild?a.insertBefore(n,a.firstChild):a.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}cd(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Ct(t){return t.label!==void 0}var dd=3,md="32px",ud="16px",Ls=4e3,fd=356,hd=14,gd=20,pd=200;function he(...t){return t.filter(Boolean).join(" ")}function xd(t){let[s,a]=t.split("-"),n=[];return s&&n.push(s),a&&n.push(a),n}var bd=t=>{var s,a,n,r,o,i,l,u,h,m,y;let{invert:x,toast:c,unstyled:w,interacting:b,setHeights:f,visibleToasts:g,heights:p,index:v,toasts:j,expanded:k,removeToast:_,defaultRichColors:N,closeButton:F,style:W,cancelButtonStyle:Z,actionButtonStyle:A,className:E="",descriptionClassName:U="",duration:H,position:ee,gap:X,loadingIcon:se,expandByDefault:fe,classNames:R,icons:O,closeButtonAriaLabel:q="Close toast",pauseWhenPageIsHidden:$}=t,[z,V]=T.useState(null),[J,I]=T.useState(null),[M,Q]=T.useState(!1),[ye,Me]=T.useState(!1),[pe,Ze]=T.useState(!1),[Le,zt]=T.useState(!1),[et,xt]=T.useState(!1),[tt,ce]=T.useState(0),[st,bt]=T.useState(0),De=T.useRef(c.duration||H||Ls),at=T.useRef(null),we=T.useRef(null),Ot=v===0,$t=v+1<=g,re=c.type,Ne=c.dismissible!==!1,Bt=c.className||"",Ut=c.descriptionClassName||"",ze=T.useMemo(()=>p.findIndex(L=>L.toastId===c.id)||0,[p,c.id]),Wt=T.useMemo(()=>{var L;return(L=c.closeButton)!=null?L:F},[c.closeButton,F]),yt=T.useMemo(()=>c.duration||H||Ls,[c.duration,H]),_e=T.useRef(0),ve=T.useRef(0),nt=T.useRef(0),je=T.useRef(null),[wt,Vt]=ee.split("-"),vt=T.useMemo(()=>p.reduce((L,Y,K)=>K>=ze?L:L+Y.height,0),[p,ze]),jt=sd(),Oe=c.invert||x,rt=re==="loading";ve.current=T.useMemo(()=>ze*X+vt,[ze,vt]),T.useEffect(()=>{De.current=yt},[yt]),T.useEffect(()=>{Q(!0)},[]),T.useEffect(()=>{let L=we.current;if(L){let Y=L.getBoundingClientRect().height;return bt(Y),f(K=>[{toastId:c.id,height:Y,position:c.position},...K]),()=>f(K=>K.filter(C=>C.toastId!==c.id))}},[f,c.id]),T.useLayoutEffect(()=>{if(!M)return;let L=we.current,Y=L.style.height;L.style.height="auto";let K=L.getBoundingClientRect().height;L.style.height=Y,bt(K),f(C=>C.find(P=>P.toastId===c.id)?C.map(P=>P.toastId===c.id?{...P,height:K}:P):[{toastId:c.id,height:K,position:c.position},...C])},[M,c.title,c.description,f,c.id]);let xe=T.useCallback(()=>{Me(!0),ce(ve.current),f(L=>L.filter(Y=>Y.toastId!==c.id)),setTimeout(()=>{_(c)},pd)},[c,_,f,ve]);T.useEffect(()=>{if(c.promise&&re==="loading"||c.duration===1/0||c.type==="loading")return;let L;return k||b||$&&jt?(()=>{if(nt.current<_e.current){let Y=new Date().getTime()-_e.current;De.current=De.current-Y}nt.current=new Date().getTime()})():De.current!==1/0&&(_e.current=new Date().getTime(),L=setTimeout(()=>{var Y;(Y=c.onAutoClose)==null||Y.call(c,c),xe()},De.current)),()=>clearTimeout(L)},[k,b,c,re,$,jt,xe]),T.useEffect(()=>{c.delete&&xe()},[xe,c.delete]);function Ht(){var L,Y,K;return O!=null&&O.loading?T.createElement("div",{className:he(R?.loader,(L=c?.classNames)==null?void 0:L.loader,"sonner-loader"),"data-visible":re==="loading"},O.loading):se?T.createElement("div",{className:he(R?.loader,(Y=c?.classNames)==null?void 0:Y.loader,"sonner-loader"),"data-visible":re==="loading"},se):T.createElement(Jc,{className:he(R?.loader,(K=c?.classNames)==null?void 0:K.loader),visible:re==="loading"})}return T.createElement("li",{tabIndex:0,ref:we,className:he(E,Bt,R?.toast,(s=c?.classNames)==null?void 0:s.toast,R?.default,R?.[re],(a=c?.classNames)==null?void 0:a[re]),"data-sonner-toast":"","data-rich-colors":(n=c.richColors)!=null?n:N,"data-styled":!(c.jsx||c.unstyled||w),"data-mounted":M,"data-promise":!!c.promise,"data-swiped":et,"data-removed":ye,"data-visible":$t,"data-y-position":wt,"data-x-position":Vt,"data-index":v,"data-front":Ot,"data-swiping":pe,"data-dismissible":Ne,"data-type":re,"data-invert":Oe,"data-swipe-out":Le,"data-swipe-direction":J,"data-expanded":!!(k||fe&&M),style:{"--index":v,"--toasts-before":v,"--z-index":j.length-v,"--offset":`${ye?tt:ve.current}px`,"--initial-height":fe?"auto":`${st}px`,...W,...c.style},onDragEnd:()=>{Ze(!1),V(null),je.current=null},onPointerDown:L=>{rt||!Ne||(at.current=new Date,ce(ve.current),L.target.setPointerCapture(L.pointerId),L.target.tagName!=="BUTTON"&&(Ze(!0),je.current={x:L.clientX,y:L.clientY}))},onPointerUp:()=>{var L,Y,K,C;if(Le||!Ne)return;je.current=null;let P=Number(((L=we.current)==null?void 0:L.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),B=Number(((Y=we.current)==null?void 0:Y.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ae=new Date().getTime()-((K=at.current)==null?void 0:K.getTime()),ne=z==="x"?P:B,te=Math.abs(ne)/ae;if(Math.abs(ne)>=gd||te>.11){ce(ve.current),(C=c.onDismiss)==null||C.call(c,c),I(z==="x"?P>0?"right":"left":B>0?"down":"up"),xe(),zt(!0),xt(!1);return}Ze(!1),V(null)},onPointerMove:L=>{var Y,K,C,P;if(!je.current||!Ne||((Y=window.getSelection())==null?void 0:Y.toString().length)>0)return;let B=L.clientY-je.current.y,ae=L.clientX-je.current.x,ne=(K=t.swipeDirections)!=null?K:xd(ee);!z&&(Math.abs(ae)>1||Math.abs(B)>1)&&V(Math.abs(ae)>Math.abs(B)?"x":"y");let te={x:0,y:0};z==="y"?(ne.includes("top")||ne.includes("bottom"))&&(ne.includes("top")&&B<0||ne.includes("bottom")&&B>0)&&(te.y=B):z==="x"&&(ne.includes("left")||ne.includes("right"))&&(ne.includes("left")&&ae<0||ne.includes("right")&&ae>0)&&(te.x=ae),(Math.abs(te.x)>0||Math.abs(te.y)>0)&&xt(!0),(C=we.current)==null||C.style.setProperty("--swipe-amount-x",`${te.x}px`),(P=we.current)==null||P.style.setProperty("--swipe-amount-y",`${te.y}px`)}},Wt&&!c.jsx?T.createElement("button",{"aria-label":q,"data-disabled":rt,"data-close-button":!0,onClick:rt||!Ne?()=>{}:()=>{var L;xe(),(L=c.onDismiss)==null||L.call(c,c)},className:he(R?.closeButton,(r=c?.classNames)==null?void 0:r.closeButton)},(o=O?.close)!=null?o:td):null,c.jsx||d.isValidElement(c.title)?c.jsx?c.jsx:typeof c.title=="function"?c.title():c.title:T.createElement(T.Fragment,null,re||c.icon||c.promise?T.createElement("div",{"data-icon":"",className:he(R?.icon,(i=c?.classNames)==null?void 0:i.icon)},c.promise||c.type==="loading"&&!c.icon?c.icon||Ht():null,c.type!=="loading"?c.icon||O?.[re]||Kc(re):null):null,T.createElement("div",{"data-content":"",className:he(R?.content,(l=c?.classNames)==null?void 0:l.content)},T.createElement("div",{"data-title":"",className:he(R?.title,(u=c?.classNames)==null?void 0:u.title)},typeof c.title=="function"?c.title():c.title),c.description?T.createElement("div",{"data-description":"",className:he(U,Ut,R?.description,(h=c?.classNames)==null?void 0:h.description)},typeof c.description=="function"?c.description():c.description):null),d.isValidElement(c.cancel)?c.cancel:c.cancel&&Ct(c.cancel)?T.createElement("button",{"data-button":!0,"data-cancel":!0,style:c.cancelButtonStyle||Z,onClick:L=>{var Y,K;Ct(c.cancel)&&Ne&&((K=(Y=c.cancel).onClick)==null||K.call(Y,L),xe())},className:he(R?.cancelButton,(m=c?.classNames)==null?void 0:m.cancelButton)},c.cancel.label):null,d.isValidElement(c.action)?c.action:c.action&&Ct(c.action)?T.createElement("button",{"data-button":!0,"data-action":!0,style:c.actionButtonStyle||A,onClick:L=>{var Y,K;Ct(c.action)&&((K=(Y=c.action).onClick)==null||K.call(Y,L),!L.defaultPrevented&&xe())},className:he(R?.actionButton,(y=c?.classNames)==null?void 0:y.actionButton)},c.action.label):null))};function zs(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function yd(t,s){let a={};return[t,s].forEach((n,r)=>{let o=r===1,i=o?"--mobile-offset":"--offset",l=o?ud:md;function u(h){["top","right","bottom","left"].forEach(m=>{a[`${i}-${m}`]=typeof h=="number"?`${h}px`:h})}typeof n=="number"||typeof n=="string"?u(n):typeof n=="object"?["top","right","bottom","left"].forEach(h=>{n[h]===void 0?a[`${i}-${h}`]=l:a[`${i}-${h}`]=typeof n[h]=="number"?`${n[h]}px`:n[h]}):u(l)}),a}var wd=d.forwardRef(function(t,s){let{invert:a,position:n="bottom-right",hotkey:r=["altKey","KeyT"],expand:o,closeButton:i,className:l,offset:u,mobileOffset:h,theme:m="light",richColors:y,duration:x,style:c,visibleToasts:w=dd,toastOptions:b,dir:f=zs(),gap:g=hd,loadingIcon:p,icons:v,containerAriaLabel:j="Notifications",pauseWhenPageIsHidden:k}=t,[_,N]=T.useState([]),F=T.useMemo(()=>Array.from(new Set([n].concat(_.filter($=>$.position).map($=>$.position)))),[_,n]),[W,Z]=T.useState([]),[A,E]=T.useState(!1),[U,H]=T.useState(!1),[ee,X]=T.useState(m!=="system"?m:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),se=T.useRef(null),fe=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),R=T.useRef(null),O=T.useRef(!1),q=T.useCallback($=>{N(z=>{var V;return(V=z.find(J=>J.id===$.id))!=null&&V.delete||oe.dismiss($.id),z.filter(({id:J})=>J!==$.id)})},[]);return T.useEffect(()=>oe.subscribe($=>{if($.dismiss){N(z=>z.map(V=>V.id===$.id?{...V,delete:!0}:V));return}setTimeout(()=>{vr.flushSync(()=>{N(z=>{let V=z.findIndex(J=>J.id===$.id);return V!==-1?[...z.slice(0,V),{...z[V],...$},...z.slice(V+1)]:[$,...z]})})})}),[]),T.useEffect(()=>{if(m!=="system"){X(m);return}if(m==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?X("dark"):X("light")),typeof window>"u")return;let $=window.matchMedia("(prefers-color-scheme: dark)");try{$.addEventListener("change",({matches:z})=>{X(z?"dark":"light")})}catch{$.addListener(({matches:V})=>{try{X(V?"dark":"light")}catch(J){console.error(J)}})}},[m]),T.useEffect(()=>{_.length<=1&&E(!1)},[_]),T.useEffect(()=>{let $=z=>{var V,J;r.every(I=>z[I]||z.code===I)&&(E(!0),(V=se.current)==null||V.focus()),z.code==="Escape"&&(document.activeElement===se.current||(J=se.current)!=null&&J.contains(document.activeElement))&&E(!1)};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[r]),T.useEffect(()=>{if(se.current)return()=>{R.current&&(R.current.focus({preventScroll:!0}),R.current=null,O.current=!1)}},[se.current]),T.createElement("section",{ref:s,"aria-label":`${j} ${fe}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},F.map(($,z)=>{var V;let[J,I]=$.split("-");return _.length?T.createElement("ol",{key:$,dir:f==="auto"?zs():f,tabIndex:-1,ref:se,className:l,"data-sonner-toaster":!0,"data-theme":ee,"data-y-position":J,"data-lifted":A&&_.length>1&&!o,"data-x-position":I,style:{"--front-toast-height":`${((V=W[0])==null?void 0:V.height)||0}px`,"--width":`${fd}px`,"--gap":`${g}px`,...c,...yd(u,h)},onBlur:M=>{O.current&&!M.currentTarget.contains(M.relatedTarget)&&(O.current=!1,R.current&&(R.current.focus({preventScroll:!0}),R.current=null))},onFocus:M=>{M.target instanceof HTMLElement&&M.target.dataset.dismissible==="false"||O.current||(O.current=!0,R.current=M.relatedTarget)},onMouseEnter:()=>E(!0),onMouseMove:()=>E(!0),onMouseLeave:()=>{U||E(!1)},onDragEnd:()=>E(!1),onPointerDown:M=>{M.target instanceof HTMLElement&&M.target.dataset.dismissible==="false"||H(!0)},onPointerUp:()=>H(!1)},_.filter(M=>!M.position&&z===0||M.position===$).map((M,Q)=>{var ye,Me;return T.createElement(bd,{key:M.id,icons:v,index:Q,toast:M,defaultRichColors:y,duration:(ye=b?.duration)!=null?ye:x,className:b?.className,descriptionClassName:b?.descriptionClassName,invert:a,visibleToasts:w,closeButton:(Me=b?.closeButton)!=null?Me:i,interacting:U,position:$,style:b?.style,unstyled:b?.unstyled,classNames:b?.classNames,cancelButtonStyle:b?.cancelButtonStyle,actionButtonStyle:b?.actionButtonStyle,removeToast:q,toasts:_.filter(pe=>pe.position==M.position),heights:W.filter(pe=>pe.position==M.position),setHeights:Z,expandByDefault:o,gap:g,loadingIcon:p,expanded:A,pauseWhenPageIsHidden:k,swipeDirections:t.swipeDirections})})):null}))});const vd=({...t})=>e.jsx(wd,{theme:"light",className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t});function jd({open:t,onOpenChange:s}){const[a,n]=d.useState({user:null,session:null,loading:!1,error:null}),[r,o]=d.useState("main"),[i,l]=d.useState(!1),[u,h]=d.useState({email:"",password:"",confirmPassword:"",name:""}),[m,y]=d.useState({}),[x,c]=d.useState(!1);d.useEffect(()=>Re.onAuthStateChange(n),[]);const w=()=>{h({email:"",password:"",confirmPassword:"",name:""}),y({}),c(!1),l(!1)},b=A=>{const E={};return(A==="email-login"||A==="email-signup"||A==="forgot-password")&&(u.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)||(E.email="请输入有效的邮箱地址"):E.email="请输入邮箱地址"),(A==="email-login"||A==="email-signup")&&(u.password?u.password.length<6&&(E.password="密码至少需要6个字符"):E.password="请输入密码"),A==="email-signup"&&(u.name||(E.name="请输入姓名"),u.password!==u.confirmPassword&&(E.confirmPassword="两次输入的密码不一致")),y(E),Object.keys(E).length===0},f=async()=>{c(!0);const{error:A}=await Re.signInWithGitHub();A&&console.error("GitHub登录失败:",A),c(!1)},g=async()=>{if(!b("email-login"))return;c(!0);const{error:A}=await Re.signInWithEmail(u.email,u.password);A?y({general:A.message}):(s(!1),w(),o("main")),c(!1)},p=async()=>{if(!b("email-signup"))return;c(!0);const{error:A}=await Re.signUpWithEmail(u.email,u.password,{name:u.name});A?y({general:A.message}):o("check-email"),c(!1)},v=async()=>{if(!b("forgot-password"))return;c(!0);const{error:A}=await Re.resetPassword(u.email);A?y({general:A.message}):o("check-email"),c(!1)},j=async()=>{const{error:A}=await Re.signOut();A&&console.error("登出失败:",A)},k=async()=>{await jr.performFullSync()};if(a.user)return e.jsx(Pe,{open:t,onOpenChange:s,children:e.jsx(Te,{className:"sm:max-w-md border-0 shadow-2xl",children:e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsx(de,{className:"border-0 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20",children:e.jsx(me,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Cn,{user:a.user,size:"lg",className:"h-16 w-16 shadow-lg",showHoverEffect:!1}),e.jsx("div",{className:"absolute -bottom-1 -right-1 h-5 w-5 bg-green-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:a.user.username||"用户"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.user.email}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(as,{className:"h-3 w-3 text-green-500"}),e.jsx("span",{className:"text-xs text-green-600",children:"云端同步已启用"})]})]})]})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(D,{onClick:k,variant:"outline",className:"w-full h-12 rounded-2xl border-2 hover:bg-blue-50 transition-all duration-200",disabled:a.loading,children:[a.loading?e.jsx(ot,{className:"h-5 w-5 mr-2 animate-spin"}):e.jsx(as,{className:"h-5 w-5 mr-2 text-blue-500"}),"立即同步数据"]}),e.jsx(D,{onClick:j,variant:"ghost",className:"w-full h-12 rounded-2xl hover:bg-red-50 hover:text-red-600 transition-all duration-200",disabled:a.loading,children:"退出登录"})]})]})})});const _=()=>e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"欢迎使用 CardAll"}),e.jsx("p",{className:"text-muted-foreground",children:"选择您的登录方式"})]}),e.jsxs(D,{onClick:f,disabled:x,className:"w-full h-14 rounded-2xl bg-gray-900 hover:bg-gray-800 text-white shadow-lg transition-all duration-200 transform hover:scale-[1.02]",size:"lg",children:[x?e.jsx(ot,{className:"h-5 w-5 mr-3 animate-spin"}):e.jsx(Gr,{className:"h-5 w-5 mr-3"}),"使用 GitHub 登录"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-4 text-muted-foreground",children:"或"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(D,{onClick:()=>o("email-login"),variant:"outline",className:"w-full h-14 rounded-2xl border-2 hover:bg-blue-50 transition-all duration-200 transform hover:scale-[1.02]",size:"lg",children:[e.jsx(it,{className:"h-5 w-5 mr-3 text-blue-500"}),"使用邮箱登录"]}),e.jsxs(D,{onClick:()=>o("email-signup"),variant:"ghost",className:"w-full h-12 rounded-2xl hover:bg-green-50 hover:text-green-600 transition-all duration-200",children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),"创建新账户"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center space-y-1 pt-4",children:[e.jsx("p",{children:"登录后可享受云端同步功能"}),e.jsx("p",{children:"即使不登录也可正常使用本地功能"})]})]}),N=()=>e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>o("main"),className:"rounded-full p-2",children:e.jsx(Gt,{className:"h-4 w-4"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"邮箱登录"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"email",children:"邮箱地址"}),e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{id:"email",type:"email",placeholder:"输入您的邮箱地址",value:u.email,onChange:A=>h(E=>({...E,email:A.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.email&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),m.email]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"password",children:"密码"}),e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{id:"password",type:i?"text":"password",placeholder:"输入您的密码",value:u.password,onChange:A=>h(E=>({...E,password:A.target.value})),className:"pl-10 pr-10 h-12 rounded-2xl border-2"}),e.jsx(D,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-10 w-10 rounded-xl",onClick:()=>l(!i),children:i?e.jsx(ns,{className:"h-4 w-4"}):e.jsx(Tt,{className:"h-4 w-4"})})]}),m.password&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),m.password]})]}),e.jsx("div",{className:"text-right",children:e.jsx(D,{variant:"link",size:"sm",onClick:()=>o("forgot-password"),className:"text-blue-600 hover:text-blue-700 p-0 h-auto",children:"忘记密码？"})}),m.general&&e.jsxs("div",{className:"text-sm text-red-500 text-center bg-red-50 p-3 rounded-2xl flex items-center justify-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),m.general]}),e.jsxs(D,{onClick:g,disabled:x,className:"w-full h-12 rounded-2xl bg-blue-600 hover:bg-blue-700 transition-all duration-200",children:[x?e.jsx(ot,{className:"h-4 w-4 mr-2 animate-spin"}):null,"登录"]})]})]}),F=()=>e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>o("main"),className:"rounded-full p-2",children:e.jsx(Gt,{className:"h-4 w-4"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"创建账户"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"name",children:"姓名"}),e.jsxs("div",{className:"relative",children:[e.jsx(js,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{id:"name",type:"text",placeholder:"输入您的姓名",value:u.name,onChange:A=>h(E=>({...E,name:A.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.name&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),m.name]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"signup-email",children:"邮箱地址"}),e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{id:"signup-email",type:"email",placeholder:"输入您的邮箱地址",value:u.email,onChange:A=>h(E=>({...E,email:A.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.email&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),m.email]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"signup-password",children:"密码"}),e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{id:"signup-password",type:i?"text":"password",placeholder:"设置您的密码（至少6个字符）",value:u.password,onChange:A=>h(E=>({...E,password:A.target.value})),className:"pl-10 pr-10 h-12 rounded-2xl border-2"}),e.jsx(D,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-10 w-10 rounded-xl",onClick:()=>l(!i),children:i?e.jsx(ns,{className:"h-4 w-4"}):e.jsx(Tt,{className:"h-4 w-4"})})]}),m.password&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),m.password]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"confirm-password",children:"确认密码"}),e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{id:"confirm-password",type:i?"text":"password",placeholder:"再次输入密码",value:u.confirmPassword,onChange:A=>h(E=>({...E,confirmPassword:A.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.confirmPassword&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),m.confirmPassword]})]}),m.general&&e.jsxs("div",{className:"text-sm text-red-500 text-center bg-red-50 p-3 rounded-2xl flex items-center justify-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),m.general]}),e.jsxs(D,{onClick:p,disabled:x,className:"w-full h-12 rounded-2xl bg-green-600 hover:bg-green-700 transition-all duration-200",children:[x?e.jsx(ot,{className:"h-4 w-4 mr-2 animate-spin"}):null,"创建账户"]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:e.jsx("p",{children:"注册即表示您同意我们的服务条款和隐私政策"})})]})]}),W=()=>e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>o("email-login"),className:"rounded-full p-2",children:e.jsx(Gt,{className:"h-4 w-4"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"重置密码"})]}),e.jsx("div",{className:"text-center space-y-2",children:e.jsx("p",{className:"text-muted-foreground",children:"输入您的邮箱地址，我们将发送重置密码的链接"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"reset-email",children:"邮箱地址"}),e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ie,{id:"reset-email",type:"email",placeholder:"输入您的邮箱地址",value:u.email,onChange:A=>h(E=>({...E,email:A.target.value})),className:"pl-10 h-12 rounded-2xl border-2"})]}),m.email&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),m.email]})]}),m.general&&e.jsxs("div",{className:"text-sm text-red-500 text-center bg-red-50 p-3 rounded-2xl flex items-center justify-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),m.general]}),e.jsxs(D,{onClick:v,disabled:x,className:"w-full h-12 rounded-2xl bg-blue-600 hover:bg-blue-700 transition-all duration-200",children:[x?e.jsx(ot,{className:"h-4 w-4 mr-2 animate-spin"}):null,"发送重置链接"]})]})]}),Z=()=>e.jsxs("div",{className:"space-y-6 p-2 text-center",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"h-16 w-16 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(it,{className:"h-8 w-8 text-blue-600"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"检查您的邮箱"}),e.jsxs("p",{className:"text-muted-foreground",children:["我们已向 ",e.jsx("span",{className:"font-medium",children:u.email})," 发送了一封邮件"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["请点击邮件中的链接来完成",r==="check-email"?"账户激活":"密码重置"]})]}),e.jsx(D,{onClick:()=>{o("main"),w()},variant:"outline",className:"w-full h-12 rounded-2xl border-2",children:"返回登录"})]});return e.jsx(Pe,{open:t,onOpenChange:A=>{s(A),A||(o("main"),w())},children:e.jsxs(Te,{className:"sm:max-w-md border-0 shadow-2xl rounded-3xl",children:[r==="main"&&_(),r==="email-login"&&N(),r==="email-signup"&&F(),r==="forgot-password"&&W(),r==="check-email"&&Z()]})})}const Cd=({onClose:t})=>{const[s,a]=d.useState(null),[n,r]=d.useState(!1),[o,i]=d.useState(!1),[l,u]=d.useState(navigator.onLine);d.useEffect(()=>{const y=()=>{window.matchMedia("(display-mode: standalone)").matches&&i(!0)},x=f=>{f.preventDefault(),a(f),setTimeout(()=>{o||r(!0)},3e3)},c=()=>{i(!0),r(!1),a(null),console.log("PWA was installed")},w=()=>u(!0),b=()=>u(!1);return y(),window.addEventListener("beforeinstallprompt",x),window.addEventListener("appinstalled",c),window.addEventListener("online",w),window.addEventListener("offline",b),()=>{window.removeEventListener("beforeinstallprompt",x),window.removeEventListener("appinstalled",c),window.removeEventListener("online",w),window.removeEventListener("offline",b)}},[o]);const h=async()=>{if(s)try{await s.prompt();const{outcome:y}=await s.userChoice;console.log(y==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),a(null),r(!1)}catch(y){console.error("Error during installation:",y)}},m=()=>{r(!1),t?.()};return!n||o?null:e.jsx("div",{className:"fixed bottom-4 right-4 z-50 max-w-sm",children:e.jsxs(de,{className:"shadow-lg border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-white",children:[e.jsxs(Ae,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"h-5 w-5 text-blue-600"}),e.jsx(Fe,{className:"text-lg",children:"安装 CardAll"})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:m,className:"h-6 w-6 p-0",children:e.jsx(Ie,{className:"h-4 w-4"})})]}),e.jsx(Un,{children:"将 CardAll 安装到您的设备上，享受更好的体验"})]}),e.jsxs(me,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[l?e.jsx(Yr,{className:"h-4 w-4"}):e.jsx(Kr,{className:"h-4 w-4"}),e.jsx("span",{children:l?"在线使用":"离线可用"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(qr,{className:"h-4 w-4"}),e.jsx("span",{children:"移动优化"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-purple-600",children:[e.jsx(Jr,{className:"h-4 w-4"}),e.jsx("span",{children:"桌面应用"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[e.jsx(mt,{className:"h-4 w-4"}),e.jsx("span",{children:"快速启动"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"安装后您将获得："}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("li",{children:"• 完全离线功能"}),e.jsx("li",{children:"• 更快的加载速度"}),e.jsx("li",{children:"• 桌面快捷方式"}),e.jsx("li",{children:"• 推送通知支持"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{onClick:h,className:"flex-1 bg-blue-600 hover:bg-blue-700",disabled:!s,children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"立即安装"]}),e.jsx(D,{variant:"outline",onClick:m,className:"px-3",children:"稍后"})]})]})]})})};function Nd(){const{isOpen:t,closeModal:s}=Va();return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(xo,{children:e.jsx(li,{children:e.jsx(ci,{children:e.jsx(Vc,{})})})}),e.jsx(Cd,{}),e.jsx(jd,{open:t,onOpenChange:s}),e.jsx(vd,{})]})}function Sd(){return e.jsx(Yc,{defaultTheme:"light",storageKey:"cardall-theme",children:e.jsx(yo,{children:e.jsx(Nd,{})})})}rs.createRoot(document.getElementById("root")).render(e.jsx(T.StrictMode,{children:e.jsx(Sd,{})}));
